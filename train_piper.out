Sat Nov  1 01:22:06 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H800                    On  | 00000000:DF:00.0 Off |                    0 |
| N/A   26C    P0              72W / 700W |      4MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
0
warning: The `tool.uv.dev-dependencies` field (used in `packages/openpi-client/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
01:22:27.379 [I] Running on: dgx-38                                                               (2624378:train.py:196)
INFO:2025-11-01 01:22:28,430:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
01:22:28.430 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (2624378:xla_bridge.py:925)
INFO:2025-11-01 01:22:28,435:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
01:22:28.435 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (2624378:xla_bridge.py:925)
01:22:29.595 [I] Wiped checkpoint directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2624378:checkpoints.py:29)
01:22:29.595 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1555021d26d0> (2624378:base_pytree_checkpoint_handler.py:334)
01:22:29.595 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1555021d26d0> (2624378:base_pytree_checkpoint_handler.py:334)
01:22:29.595 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (2624378:multihost.py:390)
01:22:29.596 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x1553c726b590>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c72b8cd0>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c71e53d0>}, handler_registry=None (2624378:checkpoint_manager.py:620)
01:22:29.596 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x1553c726b590>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (2624378:composite_checkpoint_handler.py:234)
01:22:29.596 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c72b8cd0>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2624378:composite_checkpoint_handler.py:234)
01:22:29.596 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c71e53d0>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2624378:composite_checkpoint_handler.py:234)
01:22:29.596 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c7590350>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (2624378:composite_checkpoint_handler.py:234)
01:22:29.596 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x1553c726b590>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x1553c726b590>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c72b8cd0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c72b8cd0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c71e53d0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c71e53d0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c7590350>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c7590350>}). (2624378:composite_checkpoint_handler.py:502)
01:22:29.596 [I] orbax-checkpoint version: 0.11.13                                                (2624378:abstract_checkpointer.py:35)
01:22:29.596 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x1553c7270360> timeout: 7200 secs and primary_host=0 for async checkpoint writes (2624378:async_checkpointer.py:170)
01:22:29.598 [I] Found 0 checkpoint steps in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2624378:checkpoint_manager.py:1701)
01:22:29.598 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=True), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, prevent_write_metrics=False), root_directory=/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x1553c726bb10> (2624378:checkpoint_manager.py:801)
wandb: Currently logged in as: heisen0928 (heisen0928-the-hong-kong-polytechnic-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/wandb/run-20251101_012230-sxps42l0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run real
wandb: ‚≠êÔ∏è View project at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi
wandb: üöÄ View run at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/sxps42l0
01:22:31.433 [I] Loaded norm stats from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/assets/pi0_base_piper/aloha_sweeping (2624378:config.py:196)
01:22:31.434 [I] data_config: DataConfig(repo_id='aloha_sweeping', asset_id='aloha_sweeping', norm_stats={'state': NormStats(mean=array([ 0.47424394,  1.93239212, -1.21354711,  0.02150275,  0.90646011,
        0.49164048,  0.05461168]), std=array([0.17103249, 0.14320549, 0.25212812, 0.05638926, 0.14822352,
       0.11071946, 0.00993702]), q01=array([ 0.25117052,  1.69599698, -1.85752935, -0.0792199 ,  0.65580877,
        0.27204885,  0.0458824 ]), q99=array([ 0.82077601,  2.30108927, -0.91839277,  0.18234723,  1.21471596,
        0.7448781 ,  0.08129722])), 'actions': NormStats(mean=array([-0.0244057 , -0.00734879,  0.04024221,  0.0005264 , -0.03342618,
       -0.02444903,  0.03626091]), std=array([0.16685677, 0.14164105, 0.26111194, 0.04983826, 0.14566314,
       0.10277452, 0.03212533]), q01=array([-4.92804351e-01, -4.31920097e-01, -5.53970138e-01, -1.66209970e-01,
       -4.47979820e-01, -3.10425970e-01, -3.49400386e-05]), q99=array([0.26887509, 0.26059457, 0.77529773, 0.10606248, 0.26833984,
       0.21120921, 0.08889262]))}, repack_transforms=Group(inputs=[RepackTransform(structure={'images': {'cam_high': 'observation.images.cam_high', 'cam_right_wrist': 'observation.images.cam_right_wrist'}, 'state': 'observation.state', 'actions': 'action', 'prompt': 'prompt'})], outputs=()), data_transforms=Group(inputs=(PiperInputs(adapt_to_pi=False), DeltaActions(mask=(True, True, True, True, True, True, False))), outputs=(AbsoluteActions(mask=(True, True, True, True, True, True, False)), PiperOutputs(adapt_to_pi=False))), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizePrompt(tokenizer=<openpi.models.tokenizer.PaligemmaTokenizer object at 0x1553c73b9a50>, discrete_state_input=False), PadStatesAndActions(model_action_dim=32)], outputs=()), use_quantile_norm=False, action_sequence_keys=('action',), prompt_from_task=True, rlds_data_dir=None, action_space=None, filter_dict_path=None) (2624378:data_loader.py:243)
01:22:32.313 [I] local_batch_size: 32                                                             (2624378:data_loader.py:324)
01:22:50.042 [I] Initialized data loader:
[0].images['base_0_rgb']: (32, 224, 224, 3)@float32
[0].images['left_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].images['right_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (32,)@bool
[0].image_masks['left_wrist_0_rgb']: (32,)@bool
[0].image_masks['right_wrist_0_rgb']: (32,)@bool
[0].state: (32, 32)@float32
[0].tokenized_prompt: (32, 48)@int32
[0].tokenized_prompt_mask: (32, 48)@bool
[1]: (32, 50, 32)@float32 (2624378:train.py:227)
01:22:51.427 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1555021d26d0> (2624378:base_pytree_checkpoint_handler.py:334)
01:22:51.444 [I] Restoring checkpoint from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2624378:checkpointer.py:298)
01:22:57.265 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 2.1 GiB/s (total bytes: 12.1 GiB) (time elapsed: 5 seconds) (per-host) (2624378:base_pytree_checkpoint_handler.py:114)
01:22:57.265 [I] Finished restoring checkpoint in 5.82 seconds from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2624378:checkpointer.py:309)
01:23:19.803 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@float32
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@float32
['PaliGemma']['img']['head']['bias'].value: (2048,)@float32
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@float32
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@float32
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@bfloat16
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@bfloat16
['PaliGemma']['llm']['final_norm_1']['scale'].value: (1024,)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_a'].value: (18, 8, 256, 16)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value: (18, 8, 16, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value: (18, 8, 256, 32)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value: (18, 8, 32, 1024)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value: (18, 8, 256, 1024)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value: (18, 2, 1, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_b'].value: (18, 2, 1, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value: (18, 2, 1, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_b'].value: (18, 2, 1, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value: (18, 2, 1, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value: (18, 8, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_b'].value: (18, 8, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value: (18, 8, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value: (18, 8, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value: (18, 8, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value: (18, 2, 2048, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value: (18, 2, 16, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value: (18, 16384, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['linear_lora_b'].value: (18, 16, 2048)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value: (18, 2, 1024, 4096)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value: (18, 2, 1024, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value: (18, 2, 32, 4096)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear'].value: (18, 4096, 1024)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value: (18, 4096, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_b'].value: (18, 32, 1024)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['scale'].value: (18, 1024)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['scale'].value: (18, 1024)@bfloat16
['action_in_proj']['bias'].value: (1024,)@float32
['action_in_proj']['kernel'].value: (32, 1024)@float32
['action_out_proj']['bias'].value: (32,)@float32
['action_out_proj']['kernel'].value: (1024, 32)@float32
['action_time_mlp_in']['bias'].value: (1024,)@float32
['action_time_mlp_in']['kernel'].value: (2048, 1024)@float32
['action_time_mlp_out']['bias'].value: (1024,)@float32
['action_time_mlp_out']['kernel'].value: (1024, 1024)@float32
['state_proj']['bias'].value: (1024,)@float32
['state_proj']['kernel'].value: (32, 1024)@float32 (2624378:train.py:238)
01:23:19.812 [I] Progress on: -/30000 rate:- remaining:? elapsed:00:00 postfix:-                  (2624378:tqdm_logging.py:145)
E1101 01:23:25.684156 2624378 pjrt_stream_executor_client.cc:3077] Execution of replica 0 failed: UNIMPLEMENTED: StreamBeginCaptureToGraph is not implemented for CUDA below version 12.3. Therefore tracing is not supported.
01:23:25.688 [I] Progress on: -/30000 rate:- remaining:? elapsed:00:05 postfix:-                  (2624378:tqdm_logging.py:145)
Traceback (most recent call last):
  File "/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/scripts/train.py", line 280, in <module>
    main(_config.cli())
  File "/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/scripts/train.py", line 261, in main
    train_state, info = ptrain_step(train_rng, train_state, batch)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
jaxlib.xla_extension.XlaRuntimeError: UNIMPLEMENTED: StreamBeginCaptureToGraph is not implemented for CUDA below version 12.3. Therefore tracing is not supported.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mreal[0m at: [34mhttps://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/sxps42l0[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20251101_012230-sxps42l0/logs[0m
Sat Nov  1 01:25:07 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H800                    On  | 00000000:DF:00.0 Off |                    0 |
| N/A   26C    P0              72W / 700W |      4MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
0
warning: The `tool.uv.dev-dependencies` field (used in `packages/openpi-client/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
01:25:26.690 [I] Running on: dgx-38                                                               (2628487:train.py:196)
INFO:2025-11-01 01:25:27,410:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
01:25:27.410 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (2628487:xla_bridge.py:925)
INFO:2025-11-01 01:25:27,416:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
01:25:27.416 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (2628487:xla_bridge.py:925)
01:25:28.658 [I] Wiped checkpoint directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2628487:checkpoints.py:29)
01:25:28.659 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x15550219ce90> (2628487:base_pytree_checkpoint_handler.py:334)
01:25:28.659 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x15550219ce90> (2628487:base_pytree_checkpoint_handler.py:334)
01:25:28.659 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (2628487:multihost.py:390)
01:25:28.659 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x1553c7327590>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c71f1350>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c7391350>}, handler_registry=None (2628487:checkpoint_manager.py:620)
01:25:28.659 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x1553c7327590>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (2628487:composite_checkpoint_handler.py:234)
01:25:28.660 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c71f1350>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2628487:composite_checkpoint_handler.py:234)
01:25:28.660 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c7391350>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2628487:composite_checkpoint_handler.py:234)
01:25:28.660 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c74db290>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (2628487:composite_checkpoint_handler.py:234)
01:25:28.660 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x1553c7327590>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x1553c7327590>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c71f1350>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c71f1350>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c7391350>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c7391350>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c74db290>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c74db290>}). (2628487:composite_checkpoint_handler.py:502)
01:25:28.660 [I] orbax-checkpoint version: 0.11.13                                                (2628487:abstract_checkpointer.py:35)
01:25:28.660 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x1553c72a4360> timeout: 7200 secs and primary_host=0 for async checkpoint writes (2628487:async_checkpointer.py:170)
01:25:28.662 [I] Found 0 checkpoint steps in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2628487:checkpoint_manager.py:1701)
01:25:28.662 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=True), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, prevent_write_metrics=False), root_directory=/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x1553c74da750> (2628487:checkpoint_manager.py:801)
wandb: Currently logged in as: heisen0928 (heisen0928-the-hong-kong-polytechnic-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/wandb/run-20251101_012529-0zmke4yy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run real
wandb: ‚≠êÔ∏è View project at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi
wandb: üöÄ View run at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/0zmke4yy
01:25:30.343 [I] Loaded norm stats from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/assets/pi0_base_piper/aloha_sweeping (2628487:config.py:196)
01:25:30.343 [I] data_config: DataConfig(repo_id='aloha_sweeping', asset_id='aloha_sweeping', norm_stats={'state': NormStats(mean=array([ 0.47424394,  1.93239212, -1.21354711,  0.02150275,  0.90646011,
        0.49164048,  0.05461168]), std=array([0.17103249, 0.14320549, 0.25212812, 0.05638926, 0.14822352,
       0.11071946, 0.00993702]), q01=array([ 0.25117052,  1.69599698, -1.85752935, -0.0792199 ,  0.65580877,
        0.27204885,  0.0458824 ]), q99=array([ 0.82077601,  2.30108927, -0.91839277,  0.18234723,  1.21471596,
        0.7448781 ,  0.08129722])), 'actions': NormStats(mean=array([-0.0244057 , -0.00734879,  0.04024221,  0.0005264 , -0.03342618,
       -0.02444903,  0.03626091]), std=array([0.16685677, 0.14164105, 0.26111194, 0.04983826, 0.14566314,
       0.10277452, 0.03212533]), q01=array([-4.92804351e-01, -4.31920097e-01, -5.53970138e-01, -1.66209970e-01,
       -4.47979820e-01, -3.10425970e-01, -3.49400386e-05]), q99=array([0.26887509, 0.26059457, 0.77529773, 0.10606248, 0.26833984,
       0.21120921, 0.08889262]))}, repack_transforms=Group(inputs=[RepackTransform(structure={'images': {'cam_high': 'observation.images.cam_high', 'cam_right_wrist': 'observation.images.cam_right_wrist'}, 'state': 'observation.state', 'actions': 'action', 'prompt': 'prompt'})], outputs=()), data_transforms=Group(inputs=(PiperInputs(adapt_to_pi=False), DeltaActions(mask=(True, True, True, True, True, True, False))), outputs=(AbsoluteActions(mask=(True, True, True, True, True, True, False)), PiperOutputs(adapt_to_pi=False))), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizePrompt(tokenizer=<openpi.models.tokenizer.PaligemmaTokenizer object at 0x1553c732bfd0>, discrete_state_input=False), PadStatesAndActions(model_action_dim=32)], outputs=()), use_quantile_norm=False, action_sequence_keys=('action',), prompt_from_task=True, rlds_data_dir=None, action_space=None, filter_dict_path=None) (2628487:data_loader.py:243)
01:25:31.424 [I] local_batch_size: 32                                                             (2628487:data_loader.py:324)
01:25:49.209 [I] Initialized data loader:
[0].images['base_0_rgb']: (32, 224, 224, 3)@float32
[0].images['left_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].images['right_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (32,)@bool
[0].image_masks['left_wrist_0_rgb']: (32,)@bool
[0].image_masks['right_wrist_0_rgb']: (32,)@bool
[0].state: (32, 32)@float32
[0].tokenized_prompt: (32, 48)@int32
[0].tokenized_prompt_mask: (32, 48)@bool
[1]: (32, 50, 32)@float32 (2628487:train.py:227)
01:25:50.405 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x15550219ce90> (2628487:base_pytree_checkpoint_handler.py:334)
01:25:50.422 [I] Restoring checkpoint from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2628487:checkpointer.py:298)
01:25:56.164 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 2.1 GiB/s (total bytes: 12.1 GiB) (time elapsed: 5 seconds) (per-host) (2628487:base_pytree_checkpoint_handler.py:114)
01:25:56.165 [I] Finished restoring checkpoint in 5.74 seconds from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2628487:checkpointer.py:309)
01:26:03.035 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@float32
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@float32
['PaliGemma']['img']['head']['bias'].value: (2048,)@float32
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@float32
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@float32
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@bfloat16
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@bfloat16
['PaliGemma']['llm']['final_norm_1']['scale'].value: (1024,)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_a'].value: (18, 8, 256, 16)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value: (18, 8, 16, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value: (18, 8, 256, 32)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value: (18, 8, 32, 1024)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value: (18, 8, 256, 1024)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value: (18, 2, 1, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_b'].value: (18, 2, 1, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value: (18, 2, 1, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_b'].value: (18, 2, 1, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value: (18, 2, 1, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value: (18, 8, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_b'].value: (18, 8, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value: (18, 8, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value: (18, 8, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value: (18, 8, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value: (18, 2, 2048, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value: (18, 2, 16, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value: (18, 16384, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['linear_lora_b'].value: (18, 16, 2048)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value: (18, 2, 1024, 4096)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value: (18, 2, 1024, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value: (18, 2, 32, 4096)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear'].value: (18, 4096, 1024)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value: (18, 4096, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_b'].value: (18, 32, 1024)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['scale'].value: (18, 1024)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['scale'].value: (18, 1024)@bfloat16
['action_in_proj']['bias'].value: (1024,)@float32
['action_in_proj']['kernel'].value: (32, 1024)@float32
['action_out_proj']['bias'].value: (32,)@float32
['action_out_proj']['kernel'].value: (1024, 32)@float32
['action_time_mlp_in']['bias'].value: (1024,)@float32
['action_time_mlp_in']['kernel'].value: (2048, 1024)@float32
['action_time_mlp_out']['bias'].value: (1024,)@float32
['action_time_mlp_out']['kernel'].value: (1024, 1024)@float32
['state_proj']['bias'].value: (1024,)@float32
['state_proj']['kernel'].value: (32, 1024)@float32 (2628487:train.py:238)
01:26:03.043 [I] Progress on: -/30000 rate:- remaining:? elapsed:00:00 postfix:-                  (2628487:tqdm_logging.py:145)
E1101 01:26:08.895665 2628487 pjrt_stream_executor_client.cc:3077] Execution of replica 0 failed: UNIMPLEMENTED: StreamBeginCaptureToGraph is not implemented for CUDA below version 12.3. Therefore tracing is not supported.
01:26:08.898 [I] Progress on: -/30000 rate:- remaining:? elapsed:00:05 postfix:-                  (2628487:tqdm_logging.py:145)
Traceback (most recent call last):
  File "/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/scripts/train.py", line 280, in <module>
    main(_config.cli())
  File "/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/scripts/train.py", line 261, in main
    train_state, info = ptrain_step(train_rng, train_state, batch)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
jaxlib.xla_extension.XlaRuntimeError: UNIMPLEMENTED: StreamBeginCaptureToGraph is not implemented for CUDA below version 12.3. Therefore tracing is not supported.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mreal[0m at: [34mhttps://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/0zmke4yy[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20251101_012529-0zmke4yy/logs[0m
Sat Nov  1 01:27:30 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H800                    On  |   00000000:9D:00.0 Off |                    0 |
| N/A   25C    P0            101W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
0
warning: The `tool.uv.dev-dependencies` field (used in `packages/openpi-client/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
01:27:49.539 [I] Running on: dgx-46                                                               (2341257:train.py:196)
INFO:2025-11-01 01:27:50,053:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
01:27:50.053 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (2341257:xla_bridge.py:925)
INFO:2025-11-01 01:27:50,058:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
01:27:50.058 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (2341257:xla_bridge.py:925)
01:27:51.205 [I] Wiped checkpoint directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2341257:checkpoints.py:29)
01:27:51.205 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1555021a8310> (2341257:base_pytree_checkpoint_handler.py:334)
01:27:51.205 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1555021a8310> (2341257:base_pytree_checkpoint_handler.py:334)
01:27:51.205 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (2341257:multihost.py:390)
01:27:51.206 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x1553c4d5e350>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x155554645450>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c4cb2ed0>}, handler_registry=None (2341257:checkpoint_manager.py:620)
01:27:51.206 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x1553c4d5e350>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (2341257:composite_checkpoint_handler.py:234)
01:27:51.206 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x155554645450>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2341257:composite_checkpoint_handler.py:234)
01:27:51.206 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c4cb2ed0>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2341257:composite_checkpoint_handler.py:234)
01:27:51.206 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c4e342d0>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (2341257:composite_checkpoint_handler.py:234)
01:27:51.206 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x1553c4d5e350>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x1553c4d5e350>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x155554645450>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x155554645450>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c4cb2ed0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553c4cb2ed0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c4e342d0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x1553c4e342d0>}). (2341257:composite_checkpoint_handler.py:502)
01:27:51.206 [I] orbax-checkpoint version: 0.11.13                                                (2341257:abstract_checkpointer.py:35)
01:27:51.206 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x1553c4959440> timeout: 7200 secs and primary_host=0 for async checkpoint writes (2341257:async_checkpointer.py:170)
01:27:51.208 [I] Found 0 checkpoint steps in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2341257:checkpoint_manager.py:1701)
01:27:51.208 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=True), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, prevent_write_metrics=False), root_directory=/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x1553c4dd2410> (2341257:checkpoint_manager.py:801)
wandb: Currently logged in as: heisen0928 (heisen0928-the-hong-kong-polytechnic-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/wandb/run-20251101_012751-zdwzryu6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run real
wandb: ‚≠êÔ∏è View project at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi
wandb: üöÄ View run at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/zdwzryu6
01:27:52.868 [I] Loaded norm stats from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/assets/pi0_base_piper/aloha_sweeping (2341257:config.py:196)
01:27:52.869 [I] data_config: DataConfig(repo_id='aloha_sweeping', asset_id='aloha_sweeping', norm_stats={'state': NormStats(mean=array([ 0.47424394,  1.93239212, -1.21354711,  0.02150275,  0.90646011,
        0.49164048,  0.05461168]), std=array([0.17103249, 0.14320549, 0.25212812, 0.05638926, 0.14822352,
       0.11071946, 0.00993702]), q01=array([ 0.25117052,  1.69599698, -1.85752935, -0.0792199 ,  0.65580877,
        0.27204885,  0.0458824 ]), q99=array([ 0.82077601,  2.30108927, -0.91839277,  0.18234723,  1.21471596,
        0.7448781 ,  0.08129722])), 'actions': NormStats(mean=array([-0.0244057 , -0.00734879,  0.04024221,  0.0005264 , -0.03342618,
       -0.02444903,  0.03626091]), std=array([0.16685677, 0.14164105, 0.26111194, 0.04983826, 0.14566314,
       0.10277452, 0.03212533]), q01=array([-4.92804351e-01, -4.31920097e-01, -5.53970138e-01, -1.66209970e-01,
       -4.47979820e-01, -3.10425970e-01, -3.49400386e-05]), q99=array([0.26887509, 0.26059457, 0.77529773, 0.10606248, 0.26833984,
       0.21120921, 0.08889262]))}, repack_transforms=Group(inputs=[RepackTransform(structure={'images': {'cam_high': 'observation.images.cam_high', 'cam_right_wrist': 'observation.images.cam_right_wrist'}, 'state': 'observation.state', 'actions': 'action', 'prompt': 'prompt'})], outputs=()), data_transforms=Group(inputs=(PiperInputs(adapt_to_pi=False), DeltaActions(mask=(True, True, True, True, True, True, False))), outputs=(AbsoluteActions(mask=(True, True, True, True, True, True, False)), PiperOutputs(adapt_to_pi=False))), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizePrompt(tokenizer=<openpi.models.tokenizer.PaligemmaTokenizer object at 0x1553c4b4d4d0>, discrete_state_input=False), PadStatesAndActions(model_action_dim=32)], outputs=()), use_quantile_norm=False, action_sequence_keys=('action',), prompt_from_task=True, rlds_data_dir=None, action_space=None, filter_dict_path=None) (2341257:data_loader.py:243)
01:27:54.078 [I] local_batch_size: 32                                                             (2341257:data_loader.py:324)
01:28:11.905 [I] Initialized data loader:
[0].images['base_0_rgb']: (32, 224, 224, 3)@float32
[0].images['left_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].images['right_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (32,)@bool
[0].image_masks['left_wrist_0_rgb']: (32,)@bool
[0].image_masks['right_wrist_0_rgb']: (32,)@bool
[0].state: (32, 32)@float32
[0].tokenized_prompt: (32, 48)@int32
[0].tokenized_prompt_mask: (32, 48)@bool
[1]: (32, 50, 32)@float32 (2341257:train.py:227)
01:28:13.090 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1555021a8310> (2341257:base_pytree_checkpoint_handler.py:334)
01:28:13.106 [I] Restoring checkpoint from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2341257:checkpointer.py:298)
01:28:19.058 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 2.0 GiB/s (total bytes: 12.1 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
01:28:19.059 [I] Finished restoring checkpoint in 5.95 seconds from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2341257:checkpointer.py:309)
01:28:57.670 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@float32
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@float32
['PaliGemma']['img']['head']['bias'].value: (2048,)@float32
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@float32
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@float32
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@bfloat16
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@bfloat16
['PaliGemma']['llm']['final_norm_1']['scale'].value: (1024,)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_a'].value: (18, 8, 256, 16)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value: (18, 8, 16, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value: (18, 8, 256, 32)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value: (18, 8, 32, 1024)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value: (18, 8, 256, 1024)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value: (18, 2, 1, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_b'].value: (18, 2, 1, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value: (18, 2, 1, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_b'].value: (18, 2, 1, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value: (18, 2, 1, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value: (18, 8, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_b'].value: (18, 8, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value: (18, 8, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value: (18, 8, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value: (18, 8, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value: (18, 2, 2048, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value: (18, 2, 16, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value: (18, 16384, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['linear_lora_b'].value: (18, 16, 2048)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value: (18, 2, 1024, 4096)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value: (18, 2, 1024, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value: (18, 2, 32, 4096)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear'].value: (18, 4096, 1024)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value: (18, 4096, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_b'].value: (18, 32, 1024)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['scale'].value: (18, 1024)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['scale'].value: (18, 1024)@bfloat16
['action_in_proj']['bias'].value: (1024,)@float32
['action_in_proj']['kernel'].value: (32, 1024)@float32
['action_out_proj']['bias'].value: (32,)@float32
['action_out_proj']['kernel'].value: (1024, 32)@float32
['action_time_mlp_in']['bias'].value: (1024,)@float32
['action_time_mlp_in']['kernel'].value: (2048, 1024)@float32
['action_time_mlp_out']['bias'].value: (1024,)@float32
['action_time_mlp_out']['kernel'].value: (1024, 1024)@float32
['state_proj']['bias'].value: (1024,)@float32
['state_proj']['kernel'].value: (32, 1024)@float32 (2341257:train.py:238)
01:28:57.679 [I] Progress on: -/30000 rate:- remaining:? elapsed:00:00 postfix:-                  (2341257:tqdm_logging.py:145)
Step 0: grad_norm=1.7439, loss=0.1160, param_norm=1379.7463
01:29:08.156 [I] Progress on: 4.00it/30.0kit rate:1.9s/it remaining:16:05:29 elapsed:00:10 postfix:- (2341257:tqdm_logging.py:145)
01:29:18.367 [I] Progress on: 13.0it/30.0kit rate:1.2s/it remaining:9:39:03 elapsed:00:20 postfix:- (2341257:tqdm_logging.py:145)
01:29:28.596 [I] Progress on: 22.0it/30.0kit rate:1.1s/it remaining:9:28:43 elapsed:00:30 postfix:- (2341257:tqdm_logging.py:145)
01:29:38.831 [I] Progress on: 31.0it/30.0kit rate:1.1s/it remaining:9:27:37 elapsed:00:41 postfix:- (2341257:tqdm_logging.py:145)
01:29:49.076 [I] Progress on: 40.0it/30.0kit rate:1.1s/it remaining:9:28:25 elapsed:00:51 postfix:- (2341257:tqdm_logging.py:145)
01:29:59.316 [I] Progress on: 49.0it/30.0kit rate:1.1s/it remaining:9:28:22 elapsed:01:01 postfix:- (2341257:tqdm_logging.py:145)
01:30:09.540 [I] Progress on: 58.0it/30.0kit rate:1.1s/it remaining:9:26:19 elapsed:01:11 postfix:- (2341257:tqdm_logging.py:145)
01:30:19.743 [I] Progress on: 67.0it/30.0kit rate:1.1s/it remaining:9:25:57 elapsed:01:22 postfix:- (2341257:tqdm_logging.py:145)
01:30:29.941 [I] Progress on: 76.0it/30.0kit rate:1.1s/it remaining:9:25:12 elapsed:01:32 postfix:- (2341257:tqdm_logging.py:145)
01:30:40.136 [I] Progress on: 85.0it/30.0kit rate:1.1s/it remaining:9:24:44 elapsed:01:42 postfix:- (2341257:tqdm_logging.py:145)
01:30:50.335 [I] Progress on: 94.0it/30.0kit rate:1.1s/it remaining:9:24:52 elapsed:01:52 postfix:- (2341257:tqdm_logging.py:145)
Step 100: grad_norm=1.0490, loss=0.0786, param_norm=1379.7463
01:31:00.654 [I] Progress on: 103it/30.0kit rate:1.1s/it remaining:9:28:48 elapsed:02:02 postfix:- (2341257:tqdm_logging.py:145)
01:31:10.854 [I] Progress on: 112it/30.0kit rate:1.1s/it remaining:9:24:35 elapsed:02:13 postfix:- (2341257:tqdm_logging.py:145)
01:31:21.050 [I] Progress on: 121it/30.0kit rate:1.1s/it remaining:9:24:14 elapsed:02:23 postfix:- (2341257:tqdm_logging.py:145)
01:31:31.246 [I] Progress on: 130it/30.0kit rate:1.1s/it remaining:9:23:59 elapsed:02:33 postfix:- (2341257:tqdm_logging.py:145)
01:31:41.444 [I] Progress on: 139it/30.0kit rate:1.1s/it remaining:9:23:57 elapsed:02:43 postfix:- (2341257:tqdm_logging.py:145)
01:31:51.640 [I] Progress on: 148it/30.0kit rate:1.1s/it remaining:9:23:38 elapsed:02:53 postfix:- (2341257:tqdm_logging.py:145)
01:32:01.838 [I] Progress on: 157it/30.0kit rate:1.1s/it remaining:9:23:36 elapsed:03:04 postfix:- (2341257:tqdm_logging.py:145)
01:32:12.042 [I] Progress on: 166it/30.0kit rate:1.1s/it remaining:9:24:06 elapsed:03:14 postfix:- (2341257:tqdm_logging.py:145)
01:32:22.239 [I] Progress on: 175it/30.0kit rate:1.1s/it remaining:9:23:07 elapsed:03:24 postfix:- (2341257:tqdm_logging.py:145)
01:32:32.434 [I] Progress on: 184it/30.0kit rate:1.1s/it remaining:9:22:54 elapsed:03:34 postfix:- (2341257:tqdm_logging.py:145)
01:32:42.640 [I] Progress on: 193it/30.0kit rate:1.1s/it remaining:9:23:06 elapsed:03:44 postfix:- (2341257:tqdm_logging.py:145)
Step 200: grad_norm=0.5893, loss=0.0385, param_norm=1379.7466
01:32:52.882 [I] Progress on: 202it/30.0kit rate:1.1s/it remaining:9:20:55 elapsed:03:55 postfix:- (2341257:tqdm_logging.py:145)
01:33:03.079 [I] Progress on: 211it/30.0kit rate:1.1s/it remaining:9:22:27 elapsed:04:05 postfix:- (2341257:tqdm_logging.py:145)
01:33:13.277 [I] Progress on: 220it/30.0kit rate:1.1s/it remaining:9:22:22 elapsed:04:15 postfix:- (2341257:tqdm_logging.py:145)
01:33:23.473 [I] Progress on: 229it/30.0kit rate:1.1s/it remaining:9:22:14 elapsed:04:25 postfix:- (2341257:tqdm_logging.py:145)
01:33:33.669 [I] Progress on: 238it/30.0kit rate:1.1s/it remaining:9:21:54 elapsed:04:35 postfix:- (2341257:tqdm_logging.py:145)
01:33:43.875 [I] Progress on: 247it/30.0kit rate:1.1s/it remaining:9:22:06 elapsed:04:46 postfix:- (2341257:tqdm_logging.py:145)
01:33:54.072 [I] Progress on: 256it/30.0kit rate:1.1s/it remaining:9:21:39 elapsed:04:56 postfix:- (2341257:tqdm_logging.py:145)
01:34:04.269 [I] Progress on: 265it/30.0kit rate:1.1s/it remaining:9:21:27 elapsed:05:06 postfix:- (2341257:tqdm_logging.py:145)
01:34:14.473 [I] Progress on: 274it/30.0kit rate:1.1s/it remaining:9:21:16 elapsed:05:16 postfix:- (2341257:tqdm_logging.py:145)
01:34:24.670 [I] Progress on: 283it/30.0kit rate:1.1s/it remaining:9:21:11 elapsed:05:26 postfix:- (2341257:tqdm_logging.py:145)
01:34:34.864 [I] Progress on: 292it/30.0kit rate:1.1s/it remaining:9:20:45 elapsed:05:37 postfix:- (2341257:tqdm_logging.py:145)
Step 300: grad_norm=0.4642, loss=0.0298, param_norm=1379.7469
01:34:45.267 [I] Progress on: 300it/30.0kit rate:1.1s/it remaining:9:22:30 elapsed:05:47 postfix:- (2341257:tqdm_logging.py:145)
01:34:55.368 [I] Progress on: 310it/30.0kit rate:1.1s/it remaining:9:22:16 elapsed:05:57 postfix:- (2341257:tqdm_logging.py:145)
01:35:05.590 [I] Progress on: 319it/30.0kit rate:1.1s/it remaining:9:21:35 elapsed:06:07 postfix:- (2341257:tqdm_logging.py:145)
01:35:15.815 [I] Progress on: 328it/30.0kit rate:1.1s/it remaining:9:21:02 elapsed:06:18 postfix:- (2341257:tqdm_logging.py:145)
01:35:26.046 [I] Progress on: 337it/30.0kit rate:1.1s/it remaining:9:21:54 elapsed:06:28 postfix:- (2341257:tqdm_logging.py:145)
01:35:36.286 [I] Progress on: 346it/30.0kit rate:1.1s/it remaining:9:22:18 elapsed:06:38 postfix:- (2341257:tqdm_logging.py:145)
01:35:46.520 [I] Progress on: 355it/30.0kit rate:1.1s/it remaining:9:21:55 elapsed:06:48 postfix:- (2341257:tqdm_logging.py:145)
01:35:56.758 [I] Progress on: 364it/30.0kit rate:1.1s/it remaining:9:21:40 elapsed:06:59 postfix:- (2341257:tqdm_logging.py:145)
01:36:06.993 [I] Progress on: 373it/30.0kit rate:1.1s/it remaining:9:21:41 elapsed:07:09 postfix:- (2341257:tqdm_logging.py:145)
01:36:17.220 [I] Progress on: 382it/30.0kit rate:1.1s/it remaining:9:20:53 elapsed:07:19 postfix:- (2341257:tqdm_logging.py:145)
01:36:27.463 [I] Progress on: 391it/30.0kit rate:1.1s/it remaining:9:21:21 elapsed:07:29 postfix:- (2341257:tqdm_logging.py:145)
01:36:37.695 [I] Progress on: 400it/30.0kit rate:1.1s/it remaining:9:20:54 elapsed:07:40 postfix:- (2341257:tqdm_logging.py:145)
Step 400: grad_norm=0.4182, loss=0.0260, param_norm=1379.7480
01:36:47.974 [I] Progress on: 409it/30.0kit rate:1.1s/it remaining:9:21:14 elapsed:07:50 postfix:- (2341257:tqdm_logging.py:145)
01:36:58.203 [I] Progress on: 418it/30.0kit rate:1.1s/it remaining:9:20:29 elapsed:08:00 postfix:- (2341257:tqdm_logging.py:145)
01:37:08.639 [I] Progress on: 427it/30.0kit rate:1.1s/it remaining:9:22:58 elapsed:08:10 postfix:- (2341257:tqdm_logging.py:145)
01:37:18.874 [I] Progress on: 436it/30.0kit rate:1.1s/it remaining:9:20:48 elapsed:08:21 postfix:- (2341257:tqdm_logging.py:145)
01:37:29.111 [I] Progress on: 445it/30.0kit rate:1.1s/it remaining:9:19:50 elapsed:08:31 postfix:- (2341257:tqdm_logging.py:145)
01:37:39.347 [I] Progress on: 454it/30.0kit rate:1.1s/it remaining:9:20:05 elapsed:08:41 postfix:- (2341257:tqdm_logging.py:145)
01:37:49.581 [I] Progress on: 463it/30.0kit rate:1.1s/it remaining:9:19:55 elapsed:08:51 postfix:- (2341257:tqdm_logging.py:145)
01:37:59.818 [I] Progress on: 472it/30.0kit rate:1.1s/it remaining:9:19:52 elapsed:09:02 postfix:- (2341257:tqdm_logging.py:145)
01:38:10.058 [I] Progress on: 481it/30.0kit rate:1.1s/it remaining:9:19:36 elapsed:09:12 postfix:- (2341257:tqdm_logging.py:145)
01:38:20.299 [I] Progress on: 490it/30.0kit rate:1.1s/it remaining:9:19:25 elapsed:09:22 postfix:- (2341257:tqdm_logging.py:145)
01:38:30.532 [I] Progress on: 499it/30.0kit rate:1.1s/it remaining:9:19:04 elapsed:09:32 postfix:- (2341257:tqdm_logging.py:145)
Step 500: grad_norm=0.3915, loss=0.0242, param_norm=1379.7496
01:38:40.810 [I] Progress on: 508it/30.0kit rate:1.1s/it remaining:9:17:58 elapsed:09:43 postfix:- (2341257:tqdm_logging.py:145)
01:38:51.053 [I] Progress on: 517it/30.0kit rate:1.1s/it remaining:9:19:24 elapsed:09:53 postfix:- (2341257:tqdm_logging.py:145)
01:39:01.297 [I] Progress on: 526it/30.0kit rate:1.1s/it remaining:9:19:00 elapsed:10:03 postfix:- (2341257:tqdm_logging.py:145)
01:39:11.547 [I] Progress on: 535it/30.0kit rate:1.1s/it remaining:9:19:16 elapsed:10:13 postfix:- (2341257:tqdm_logging.py:145)
01:39:21.783 [I] Progress on: 544it/30.0kit rate:1.1s/it remaining:9:18:29 elapsed:10:24 postfix:- (2341257:tqdm_logging.py:145)
01:39:32.021 [I] Progress on: 553it/30.0kit rate:1.1s/it remaining:9:18:23 elapsed:10:34 postfix:- (2341257:tqdm_logging.py:145)
01:39:42.254 [I] Progress on: 562it/30.0kit rate:1.1s/it remaining:9:17:48 elapsed:10:44 postfix:- (2341257:tqdm_logging.py:145)
01:39:52.482 [I] Progress on: 571it/30.0kit rate:1.1s/it remaining:9:17:33 elapsed:10:54 postfix:- (2341257:tqdm_logging.py:145)
01:40:02.710 [I] Progress on: 580it/30.0kit rate:1.1s/it remaining:9:16:59 elapsed:11:05 postfix:- (2341257:tqdm_logging.py:145)
01:40:12.945 [I] Progress on: 589it/30.0kit rate:1.1s/it remaining:9:17:01 elapsed:11:15 postfix:- (2341257:tqdm_logging.py:145)
01:40:23.179 [I] Progress on: 598it/30.0kit rate:1.1s/it remaining:9:17:28 elapsed:11:25 postfix:- (2341257:tqdm_logging.py:145)
Step 600: grad_norm=0.4500, loss=0.0243, param_norm=1379.7522
01:40:33.451 [I] Progress on: 607it/30.0kit rate:1.1s/it remaining:9:17:00 elapsed:11:35 postfix:- (2341257:tqdm_logging.py:145)
01:40:43.683 [I] Progress on: 616it/30.0kit rate:1.1s/it remaining:9:16:36 elapsed:11:46 postfix:- (2341257:tqdm_logging.py:145)
01:40:53.916 [I] Progress on: 625it/30.0kit rate:1.1s/it remaining:9:16:58 elapsed:11:56 postfix:- (2341257:tqdm_logging.py:145)
01:41:04.148 [I] Progress on: 634it/30.0kit rate:1.1s/it remaining:9:16:11 elapsed:12:06 postfix:- (2341257:tqdm_logging.py:145)
01:41:14.382 [I] Progress on: 643it/30.0kit rate:1.1s/it remaining:9:16:20 elapsed:12:16 postfix:- (2341257:tqdm_logging.py:145)
01:41:24.620 [I] Progress on: 652it/30.0kit rate:1.1s/it remaining:9:16:18 elapsed:12:26 postfix:- (2341257:tqdm_logging.py:145)
01:41:34.854 [I] Progress on: 661it/30.0kit rate:1.1s/it remaining:9:15:58 elapsed:12:37 postfix:- (2341257:tqdm_logging.py:145)
01:41:45.086 [I] Progress on: 670it/30.0kit rate:1.1s/it remaining:9:15:42 elapsed:12:47 postfix:- (2341257:tqdm_logging.py:145)
01:41:55.318 [I] Progress on: 679it/30.0kit rate:1.1s/it remaining:9:15:36 elapsed:12:57 postfix:- (2341257:tqdm_logging.py:145)
01:42:05.555 [I] Progress on: 688it/30.0kit rate:1.1s/it remaining:9:15:01 elapsed:13:07 postfix:- (2341257:tqdm_logging.py:145)
01:42:15.753 [I] Progress on: 697it/30.0kit rate:1.1s/it remaining:9:13:31 elapsed:13:18 postfix:- (2341257:tqdm_logging.py:145)
Step 700: grad_norm=0.4764, loss=0.0229, param_norm=1379.7559
01:42:25.991 [I] Progress on: 706it/30.0kit rate:1.1s/it remaining:9:12:31 elapsed:13:28 postfix:- (2341257:tqdm_logging.py:145)
01:42:36.335 [I] Progress on: 715it/30.0kit rate:1.1s/it remaining:9:15:52 elapsed:13:38 postfix:- (2341257:tqdm_logging.py:145)
01:42:46.569 [I] Progress on: 724it/30.0kit rate:1.1s/it remaining:9:15:20 elapsed:13:48 postfix:- (2341257:tqdm_logging.py:145)
01:42:56.806 [I] Progress on: 733it/30.0kit rate:1.1s/it remaining:9:14:24 elapsed:13:59 postfix:- (2341257:tqdm_logging.py:145)
01:43:07.045 [I] Progress on: 742it/30.0kit rate:1.1s/it remaining:9:14:38 elapsed:14:09 postfix:- (2341257:tqdm_logging.py:145)
01:43:17.280 [I] Progress on: 751it/30.0kit rate:1.1s/it remaining:9:14:08 elapsed:14:19 postfix:- (2341257:tqdm_logging.py:145)
01:43:27.523 [I] Progress on: 760it/30.0kit rate:1.1s/it remaining:9:14:41 elapsed:14:29 postfix:- (2341257:tqdm_logging.py:145)
01:43:37.757 [I] Progress on: 769it/30.0kit rate:1.1s/it remaining:9:13:47 elapsed:14:40 postfix:- (2341257:tqdm_logging.py:145)
01:43:47.998 [I] Progress on: 778it/30.0kit rate:1.1s/it remaining:9:13:51 elapsed:14:50 postfix:- (2341257:tqdm_logging.py:145)
01:43:58.214 [I] Progress on: 787it/30.0kit rate:1.1s/it remaining:9:13:26 elapsed:15:00 postfix:- (2341257:tqdm_logging.py:145)
01:44:08.419 [I] Progress on: 796it/30.0kit rate:1.1s/it remaining:9:11:35 elapsed:15:10 postfix:- (2341257:tqdm_logging.py:145)
Step 800: grad_norm=0.3721, loss=0.0219, param_norm=1379.7612
01:44:18.660 [I] Progress on: 805it/30.0kit rate:1.1s/it remaining:9:10:39 elapsed:15:20 postfix:- (2341257:tqdm_logging.py:145)
01:44:28.869 [I] Progress on: 814it/30.0kit rate:1.1s/it remaining:9:11:33 elapsed:15:31 postfix:- (2341257:tqdm_logging.py:145)
01:44:39.065 [I] Progress on: 823it/30.0kit rate:1.1s/it remaining:9:10:58 elapsed:15:41 postfix:- (2341257:tqdm_logging.py:145)
01:44:49.264 [I] Progress on: 832it/30.0kit rate:1.1s/it remaining:9:10:38 elapsed:15:51 postfix:- (2341257:tqdm_logging.py:145)
01:44:59.473 [I] Progress on: 841it/30.0kit rate:1.1s/it remaining:9:11:11 elapsed:16:01 postfix:- (2341257:tqdm_logging.py:145)
01:45:09.905 [I] Progress on: 850it/30.0kit rate:1.1s/it remaining:9:12:32 elapsed:16:12 postfix:- (2341257:tqdm_logging.py:145)
01:45:20.099 [I] Progress on: 859it/30.0kit rate:1.1s/it remaining:9:10:08 elapsed:16:22 postfix:- (2341257:tqdm_logging.py:145)
01:45:30.300 [I] Progress on: 868it/30.0kit rate:1.1s/it remaining:9:10:14 elapsed:16:32 postfix:- (2341257:tqdm_logging.py:145)
01:45:40.496 [I] Progress on: 877it/30.0kit rate:1.1s/it remaining:9:09:52 elapsed:16:42 postfix:- (2341257:tqdm_logging.py:145)
01:45:50.706 [I] Progress on: 886it/30.0kit rate:1.1s/it remaining:9:10:01 elapsed:16:53 postfix:- (2341257:tqdm_logging.py:145)
01:46:00.904 [I] Progress on: 895it/30.0kit rate:1.1s/it remaining:9:09:49 elapsed:17:03 postfix:- (2341257:tqdm_logging.py:145)
Step 900: grad_norm=0.3505, loss=0.0204, param_norm=1379.7675
01:46:11.147 [I] Progress on: 904it/30.0kit rate:1.1s/it remaining:9:08:35 elapsed:17:13 postfix:- (2341257:tqdm_logging.py:145)
01:46:21.341 [I] Progress on: 913it/30.0kit rate:1.1s/it remaining:9:09:00 elapsed:17:23 postfix:- (2341257:tqdm_logging.py:145)
01:46:31.539 [I] Progress on: 922it/30.0kit rate:1.1s/it remaining:9:09:03 elapsed:17:33 postfix:- (2341257:tqdm_logging.py:145)
01:46:41.736 [I] Progress on: 931it/30.0kit rate:1.1s/it remaining:9:08:50 elapsed:17:44 postfix:- (2341257:tqdm_logging.py:145)
01:46:51.931 [I] Progress on: 940it/30.0kit rate:1.1s/it remaining:9:08:43 elapsed:17:54 postfix:- (2341257:tqdm_logging.py:145)
01:47:02.139 [I] Progress on: 949it/30.0kit rate:1.1s/it remaining:9:08:46 elapsed:18:04 postfix:- (2341257:tqdm_logging.py:145)
01:47:12.337 [I] Progress on: 958it/30.0kit rate:1.1s/it remaining:9:08:30 elapsed:18:14 postfix:- (2341257:tqdm_logging.py:145)
01:47:22.539 [I] Progress on: 967it/30.0kit rate:1.1s/it remaining:9:08:20 elapsed:18:24 postfix:- (2341257:tqdm_logging.py:145)
01:47:32.737 [I] Progress on: 976it/30.0kit rate:1.1s/it remaining:9:08:04 elapsed:18:35 postfix:- (2341257:tqdm_logging.py:145)
01:47:42.932 [I] Progress on: 985it/30.0kit rate:1.1s/it remaining:9:07:46 elapsed:18:45 postfix:- (2341257:tqdm_logging.py:145)
01:47:53.142 [I] Progress on: 994it/30.0kit rate:1.1s/it remaining:9:08:49 elapsed:18:55 postfix:- (2341257:tqdm_logging.py:145)
Step 1000: grad_norm=0.3181, loss=0.0193, param_norm=1379.7750
01:48:01.271 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
01:48:01.272 [I] [process=0] Saving checkpoint at step 1000                                       (2341257:checkpoint_manager.py:1408)
01:48:01.272 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (2341257:async_checkpointer.py:439)
01:48:01.274 [I] Using ThreadSafeKeyValueSignalingClient                                          (2341257:signaling_client.py:332)
01:48:01.282 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 (2341257:atomicity.py:144)
01:48:01.287 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 (2341257:atomicity.py:144)
01:48:01.288 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (2341257:atomicity.py:144)
01:48:01.288 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (2341257:atomicity.py:144)
01:48:01.288 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1761932881284912716, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1761932881284912716, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2341257:checkpoint.py:186)
01:48:01.304 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
01:48:38.698 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
01:48:38.717 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
01:48:39.409 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
01:49:51.178 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
01:49:51.178 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 65.2 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
01:49:51.197 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 97.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
01:49:51.199 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
01:49:51.199 [I] Finished blocking save in 109.93 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (2341257:async_checkpointer.py:548)
01:49:51.200 [I] [process=0][thread=MainThread][step=1000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
01:49:51.200 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
01:49:51.200 [I] {'step': 1000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761932881.271729, 'wait_for_prev_duration_secs': 0.0001919269561767578, 'checkpointer_blocking_start_time': 1761932881.2722232, 'checkpointer_blocking_duration_secs': 109.92781209945679, 'get_old_steps_start_time': 1761932991.2000556, 'get_old_steps_duration_secs': 5.7220458984375e-06, 'checkpoint_manager_blocking_start_time': 1761932881.2716222, 'checkpoint_manager_blocking_duration_secs': 109.92908978462219} (2341257:standard_logger.py:34)
01:49:51.200 [I] Progress on: 1.00kit/30.0kit rate:34.2s/it remaining:275:15:39 elapsed:20:53 postfix:- (2341257:tqdm_logging.py:145)
01:49:51.226 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 65.2 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
01:49:51.257 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
01:50:01.281 [I] Progress on: 1.01kit/30.0kit rate:2.5s/it remaining:19:52:26 elapsed:21:03 postfix:- (2341257:tqdm_logging.py:145)
01:50:04.686 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 87.0 MiB/s (total bytes: 10.5 GiB) (time elapsed: 2 minutes) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
01:50:04.687 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
01:50:04.694 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1761932881284912716, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2341257:checkpoint.py:226)
01:50:04.695 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets (2341257:atomicity.py:289)
01:50:04.699 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'train_state': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1761932881284912716, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2341257:checkpoint.py:245)
01:50:04.705 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
01:50:04.825 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state (2341257:atomicity.py:289)
01:50:04.829 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
01:50:04.891 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params (2341257:atomicity.py:289)
01:50:04.892 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (2341257:atomicity.py:289)
01:50:04.897 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000`. (2341257:atomicity.py:573)
01:50:04.897 [I] Finished asynchronous save (blocking + background) in 123.62 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (2341257:async_checkpointer.py:412)
01:50:04.897 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
01:50:04.897 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
01:50:04.897 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
01:50:04.897 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
01:50:04.897 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
01:50:11.517 [I] Progress on: 1.02kit/30.0kit rate:1.2s/it remaining:9:36:42 elapsed:21:13 postfix:- (2341257:tqdm_logging.py:145)
01:50:21.733 [I] Progress on: 1.03kit/30.0kit rate:1.1s/it remaining:9:10:23 elapsed:21:24 postfix:- (2341257:tqdm_logging.py:145)
01:50:31.952 [I] Progress on: 1.04kit/30.0kit rate:1.1s/it remaining:9:07:22 elapsed:21:34 postfix:- (2341257:tqdm_logging.py:145)
01:50:42.149 [I] Progress on: 1.05kit/30.0kit rate:1.1s/it remaining:9:06:50 elapsed:21:44 postfix:- (2341257:tqdm_logging.py:145)
01:50:52.345 [I] Progress on: 1.05kit/30.0kit rate:1.1s/it remaining:9:06:33 elapsed:21:54 postfix:- (2341257:tqdm_logging.py:145)
01:51:02.542 [I] Progress on: 1.06kit/30.0kit rate:1.1s/it remaining:9:06:16 elapsed:22:04 postfix:- (2341257:tqdm_logging.py:145)
01:51:12.738 [I] Progress on: 1.07kit/30.0kit rate:1.1s/it remaining:9:06:13 elapsed:22:15 postfix:- (2341257:tqdm_logging.py:145)
01:51:22.933 [I] Progress on: 1.08kit/30.0kit rate:1.1s/it remaining:9:06:00 elapsed:22:25 postfix:- (2341257:tqdm_logging.py:145)
01:51:33.131 [I] Progress on: 1.09kit/30.0kit rate:1.1s/it remaining:9:06:06 elapsed:22:35 postfix:- (2341257:tqdm_logging.py:145)
01:51:43.333 [I] Progress on: 1.10kit/30.0kit rate:1.1s/it remaining:9:05:55 elapsed:22:45 postfix:- (2341257:tqdm_logging.py:145)
Step 1100: grad_norm=0.2900, loss=0.0192, param_norm=1379.7843
01:51:53.574 [I] Progress on: 1.11kit/30.0kit rate:1.1s/it remaining:9:05:21 elapsed:22:55 postfix:- (2341257:tqdm_logging.py:145)
01:52:03.771 [I] Progress on: 1.12kit/30.0kit rate:1.1s/it remaining:9:05:17 elapsed:23:06 postfix:- (2341257:tqdm_logging.py:145)
01:52:13.968 [I] Progress on: 1.13kit/30.0kit rate:1.1s/it remaining:9:05:11 elapsed:23:16 postfix:- (2341257:tqdm_logging.py:145)
01:52:24.164 [I] Progress on: 1.14kit/30.0kit rate:1.1s/it remaining:9:04:54 elapsed:23:26 postfix:- (2341257:tqdm_logging.py:145)
01:52:34.362 [I] Progress on: 1.15kit/30.0kit rate:1.1s/it remaining:9:04:48 elapsed:23:36 postfix:- (2341257:tqdm_logging.py:145)
01:52:44.568 [I] Progress on: 1.15kit/30.0kit rate:1.1s/it remaining:9:04:43 elapsed:23:46 postfix:- (2341257:tqdm_logging.py:145)
01:52:54.764 [I] Progress on: 1.16kit/30.0kit rate:1.1s/it remaining:9:04:27 elapsed:23:57 postfix:- (2341257:tqdm_logging.py:145)
01:53:04.964 [I] Progress on: 1.17kit/30.0kit rate:1.1s/it remaining:9:04:25 elapsed:24:07 postfix:- (2341257:tqdm_logging.py:145)
01:53:15.165 [I] Progress on: 1.18kit/30.0kit rate:1.1s/it remaining:9:04:31 elapsed:24:17 postfix:- (2341257:tqdm_logging.py:145)
01:53:25.365 [I] Progress on: 1.19kit/30.0kit rate:1.1s/it remaining:9:04:25 elapsed:24:27 postfix:- (2341257:tqdm_logging.py:145)
01:53:35.569 [I] Progress on: 1.20kit/30.0kit rate:1.1s/it remaining:9:04:19 elapsed:24:37 postfix:- (2341257:tqdm_logging.py:145)
Step 1200: grad_norm=0.2586, loss=0.0169, param_norm=1379.7941
01:53:45.813 [I] Progress on: 1.21kit/30.0kit rate:1.1s/it remaining:9:03:30 elapsed:24:48 postfix:- (2341257:tqdm_logging.py:145)
01:53:56.009 [I] Progress on: 1.22kit/30.0kit rate:1.1s/it remaining:9:03:20 elapsed:24:58 postfix:- (2341257:tqdm_logging.py:145)
01:54:06.208 [I] Progress on: 1.23kit/30.0kit rate:1.1s/it remaining:9:03:21 elapsed:25:08 postfix:- (2341257:tqdm_logging.py:145)
01:54:16.406 [I] Progress on: 1.24kit/30.0kit rate:1.1s/it remaining:9:03:26 elapsed:25:18 postfix:- (2341257:tqdm_logging.py:145)
01:54:26.600 [I] Progress on: 1.24kit/30.0kit rate:1.1s/it remaining:9:03:00 elapsed:25:28 postfix:- (2341257:tqdm_logging.py:145)
01:54:36.796 [I] Progress on: 1.25kit/30.0kit rate:1.1s/it remaining:9:02:40 elapsed:25:39 postfix:- (2341257:tqdm_logging.py:145)
01:54:46.996 [I] Progress on: 1.26kit/30.0kit rate:1.1s/it remaining:9:02:43 elapsed:25:49 postfix:- (2341257:tqdm_logging.py:145)
01:54:57.404 [I] Progress on: 1.27kit/30.0kit rate:1.1s/it remaining:9:03:40 elapsed:25:59 postfix:- (2341257:tqdm_logging.py:145)
01:55:07.601 [I] Progress on: 1.28kit/30.0kit rate:1.1s/it remaining:9:02:16 elapsed:26:09 postfix:- (2341257:tqdm_logging.py:145)
01:55:17.798 [I] Progress on: 1.29kit/30.0kit rate:1.1s/it remaining:9:02:05 elapsed:26:20 postfix:- (2341257:tqdm_logging.py:145)
01:55:27.993 [I] Progress on: 1.30kit/30.0kit rate:1.1s/it remaining:9:01:53 elapsed:26:30 postfix:- (2341257:tqdm_logging.py:145)
Step 1300: grad_norm=0.2483, loss=0.0155, param_norm=1379.8027
01:55:38.249 [I] Progress on: 1.31kit/30.0kit rate:1.1s/it remaining:9:01:39 elapsed:26:40 postfix:- (2341257:tqdm_logging.py:145)
01:55:48.445 [I] Progress on: 1.32kit/30.0kit rate:1.1s/it remaining:9:01:36 elapsed:26:50 postfix:- (2341257:tqdm_logging.py:145)
01:55:58.642 [I] Progress on: 1.32kit/30.0kit rate:1.1s/it remaining:9:01:27 elapsed:27:00 postfix:- (2341257:tqdm_logging.py:145)
01:56:08.839 [I] Progress on: 1.33kit/30.0kit rate:1.1s/it remaining:9:01:12 elapsed:27:11 postfix:- (2341257:tqdm_logging.py:145)
01:56:19.037 [I] Progress on: 1.34kit/30.0kit rate:1.1s/it remaining:9:01:07 elapsed:27:21 postfix:- (2341257:tqdm_logging.py:145)
01:56:29.233 [I] Progress on: 1.35kit/30.0kit rate:1.1s/it remaining:9:00:56 elapsed:27:31 postfix:- (2341257:tqdm_logging.py:145)
01:56:39.432 [I] Progress on: 1.36kit/30.0kit rate:1.1s/it remaining:9:01:04 elapsed:27:41 postfix:- (2341257:tqdm_logging.py:145)
01:56:49.635 [I] Progress on: 1.37kit/30.0kit rate:1.1s/it remaining:9:01:24 elapsed:27:51 postfix:- (2341257:tqdm_logging.py:145)
01:56:59.831 [I] Progress on: 1.38kit/30.0kit rate:1.1s/it remaining:9:00:25 elapsed:28:02 postfix:- (2341257:tqdm_logging.py:145)
01:57:10.028 [I] Progress on: 1.39kit/30.0kit rate:1.1s/it remaining:9:00:16 elapsed:28:12 postfix:- (2341257:tqdm_logging.py:145)
01:57:20.236 [I] Progress on: 1.40kit/30.0kit rate:1.1s/it remaining:9:00:14 elapsed:28:22 postfix:- (2341257:tqdm_logging.py:145)
Step 1400: grad_norm=0.2763, loss=0.0155, param_norm=1379.8121
01:57:30.476 [I] Progress on: 1.41kit/30.0kit rate:1.1s/it remaining:8:59:26 elapsed:28:32 postfix:- (2341257:tqdm_logging.py:145)
01:57:40.671 [I] Progress on: 1.42kit/30.0kit rate:1.1s/it remaining:8:59:38 elapsed:28:42 postfix:- (2341257:tqdm_logging.py:145)
01:57:50.868 [I] Progress on: 1.42kit/30.0kit rate:1.1s/it remaining:8:59:36 elapsed:28:53 postfix:- (2341257:tqdm_logging.py:145)
01:58:01.067 [I] Progress on: 1.43kit/30.0kit rate:1.1s/it remaining:8:59:40 elapsed:29:03 postfix:- (2341257:tqdm_logging.py:145)
01:58:11.264 [I] Progress on: 1.44kit/30.0kit rate:1.1s/it remaining:8:59:33 elapsed:29:13 postfix:- (2341257:tqdm_logging.py:145)
01:58:21.468 [I] Progress on: 1.45kit/30.0kit rate:1.1s/it remaining:8:59:04 elapsed:29:23 postfix:- (2341257:tqdm_logging.py:145)
01:58:31.666 [I] Progress on: 1.46kit/30.0kit rate:1.1s/it remaining:8:59:04 elapsed:29:33 postfix:- (2341257:tqdm_logging.py:145)
01:58:41.861 [I] Progress on: 1.47kit/30.0kit rate:1.1s/it remaining:8:58:34 elapsed:29:44 postfix:- (2341257:tqdm_logging.py:145)
01:58:52.070 [I] Progress on: 1.48kit/30.0kit rate:1.1s/it remaining:8:59:11 elapsed:29:54 postfix:- (2341257:tqdm_logging.py:145)
01:59:02.266 [I] Progress on: 1.49kit/30.0kit rate:1.1s/it remaining:8:58:19 elapsed:30:04 postfix:- (2341257:tqdm_logging.py:145)
01:59:12.463 [I] Progress on: 1.50kit/30.0kit rate:1.1s/it remaining:8:58:17 elapsed:30:14 postfix:- (2341257:tqdm_logging.py:145)
Step 1500: grad_norm=0.2337, loss=0.0138, param_norm=1379.8212
01:59:22.707 [I] Progress on: 1.50kit/30.0kit rate:1.1s/it remaining:8:57:24 elapsed:30:25 postfix:- (2341257:tqdm_logging.py:145)
01:59:32.902 [I] Progress on: 1.51kit/30.0kit rate:1.1s/it remaining:8:57:47 elapsed:30:35 postfix:- (2341257:tqdm_logging.py:145)
01:59:43.096 [I] Progress on: 1.52kit/30.0kit rate:1.1s/it remaining:8:57:30 elapsed:30:45 postfix:- (2341257:tqdm_logging.py:145)
01:59:53.302 [I] Progress on: 1.53kit/30.0kit rate:1.1s/it remaining:8:57:44 elapsed:30:55 postfix:- (2341257:tqdm_logging.py:145)
02:00:03.501 [I] Progress on: 1.54kit/30.0kit rate:1.1s/it remaining:8:55:51 elapsed:31:05 postfix:- (2341257:tqdm_logging.py:145)
02:00:13.696 [I] Progress on: 1.55kit/30.0kit rate:1.1s/it remaining:8:57:08 elapsed:31:16 postfix:- (2341257:tqdm_logging.py:145)
02:00:23.891 [I] Progress on: 1.56kit/30.0kit rate:1.1s/it remaining:8:56:53 elapsed:31:26 postfix:- (2341257:tqdm_logging.py:145)
02:00:34.102 [I] Progress on: 1.57kit/30.0kit rate:1.1s/it remaining:8:58:10 elapsed:31:36 postfix:- (2341257:tqdm_logging.py:145)
02:00:44.302 [I] Progress on: 1.58kit/30.0kit rate:1.1s/it remaining:8:56:45 elapsed:31:46 postfix:- (2341257:tqdm_logging.py:145)
02:00:54.499 [I] Progress on: 1.59kit/30.0kit rate:1.1s/it remaining:8:56:31 elapsed:31:56 postfix:- (2341257:tqdm_logging.py:145)
02:01:04.693 [I] Progress on: 1.59kit/30.0kit rate:1.1s/it remaining:8:56:13 elapsed:32:07 postfix:- (2341257:tqdm_logging.py:145)
Step 1600: grad_norm=0.2551, loss=0.0137, param_norm=1379.8304
02:01:14.941 [I] Progress on: 1.60kit/30.0kit rate:1.1s/it remaining:8:55:23 elapsed:32:17 postfix:- (2341257:tqdm_logging.py:145)
02:01:25.138 [I] Progress on: 1.61kit/30.0kit rate:1.1s/it remaining:8:55:56 elapsed:32:27 postfix:- (2341257:tqdm_logging.py:145)
02:01:35.336 [I] Progress on: 1.62kit/30.0kit rate:1.1s/it remaining:8:55:57 elapsed:32:37 postfix:- (2341257:tqdm_logging.py:145)
02:01:45.531 [I] Progress on: 1.63kit/30.0kit rate:1.1s/it remaining:8:55:39 elapsed:32:47 postfix:- (2341257:tqdm_logging.py:145)
02:01:55.732 [I] Progress on: 1.64kit/30.0kit rate:1.1s/it remaining:8:56:02 elapsed:32:58 postfix:- (2341257:tqdm_logging.py:145)
02:02:05.929 [I] Progress on: 1.65kit/30.0kit rate:1.1s/it remaining:8:55:13 elapsed:33:08 postfix:- (2341257:tqdm_logging.py:145)
02:02:16.133 [I] Progress on: 1.66kit/30.0kit rate:1.1s/it remaining:8:55:09 elapsed:33:18 postfix:- (2341257:tqdm_logging.py:145)
02:02:26.327 [I] Progress on: 1.67kit/30.0kit rate:1.1s/it remaining:8:54:50 elapsed:33:28 postfix:- (2341257:tqdm_logging.py:145)
02:02:36.530 [I] Progress on: 1.68kit/30.0kit rate:1.1s/it remaining:8:55:29 elapsed:33:38 postfix:- (2341257:tqdm_logging.py:145)
02:02:46.935 [I] Progress on: 1.69kit/30.0kit rate:1.2s/it remaining:9:09:05 elapsed:33:49 postfix:- (2341257:tqdm_logging.py:145)
02:02:57.133 [I] Progress on: 1.69kit/30.0kit rate:1.1s/it remaining:8:55:12 elapsed:33:59 postfix:- (2341257:tqdm_logging.py:145)
Step 1700: grad_norm=0.2269, loss=0.0121, param_norm=1379.8396
02:03:07.372 [I] Progress on: 1.70kit/30.0kit rate:1.1s/it remaining:8:52:51 elapsed:34:09 postfix:- (2341257:tqdm_logging.py:145)
02:03:17.570 [I] Progress on: 1.71kit/30.0kit rate:1.1s/it remaining:8:54:09 elapsed:34:19 postfix:- (2341257:tqdm_logging.py:145)
02:03:27.766 [I] Progress on: 1.72kit/30.0kit rate:1.1s/it remaining:8:53:58 elapsed:34:30 postfix:- (2341257:tqdm_logging.py:145)
02:03:37.962 [I] Progress on: 1.73kit/30.0kit rate:1.1s/it remaining:8:53:50 elapsed:34:40 postfix:- (2341257:tqdm_logging.py:145)
02:03:48.162 [I] Progress on: 1.74kit/30.0kit rate:1.1s/it remaining:8:53:58 elapsed:34:50 postfix:- (2341257:tqdm_logging.py:145)
02:03:58.368 [I] Progress on: 1.75kit/30.0kit rate:1.1s/it remaining:8:53:44 elapsed:35:00 postfix:- (2341257:tqdm_logging.py:145)
02:04:08.565 [I] Progress on: 1.76kit/30.0kit rate:1.1s/it remaining:8:53:09 elapsed:35:10 postfix:- (2341257:tqdm_logging.py:145)
02:04:18.760 [I] Progress on: 1.77kit/30.0kit rate:1.1s/it remaining:8:52:57 elapsed:35:21 postfix:- (2341257:tqdm_logging.py:145)
02:04:28.966 [I] Progress on: 1.77kit/30.0kit rate:1.1s/it remaining:8:53:00 elapsed:35:31 postfix:- (2341257:tqdm_logging.py:145)
02:04:39.164 [I] Progress on: 1.78kit/30.0kit rate:1.1s/it remaining:8:52:59 elapsed:35:41 postfix:- (2341257:tqdm_logging.py:145)
02:04:49.363 [I] Progress on: 1.79kit/30.0kit rate:1.1s/it remaining:8:52:58 elapsed:35:51 postfix:- (2341257:tqdm_logging.py:145)
Step 1800: grad_norm=0.2094, loss=0.0114, param_norm=1379.8484
02:04:59.657 [I] Progress on: 1.80kit/30.0kit rate:1.1s/it remaining:8:54:30 elapsed:36:01 postfix:- (2341257:tqdm_logging.py:145)
02:05:09.972 [I] Progress on: 1.81kit/30.0kit rate:1.1s/it remaining:8:53:16 elapsed:36:12 postfix:- (2341257:tqdm_logging.py:145)
02:05:20.168 [I] Progress on: 1.82kit/30.0kit rate:1.1s/it remaining:8:52:23 elapsed:36:22 postfix:- (2341257:tqdm_logging.py:145)
02:05:30.364 [I] Progress on: 1.83kit/30.0kit rate:1.1s/it remaining:8:51:59 elapsed:36:32 postfix:- (2341257:tqdm_logging.py:145)
02:05:40.564 [I] Progress on: 1.84kit/30.0kit rate:1.1s/it remaining:8:52:16 elapsed:36:42 postfix:- (2341257:tqdm_logging.py:145)
02:05:50.767 [I] Progress on: 1.85kit/30.0kit rate:1.1s/it remaining:8:51:36 elapsed:36:53 postfix:- (2341257:tqdm_logging.py:145)
02:06:00.967 [I] Progress on: 1.86kit/30.0kit rate:1.1s/it remaining:8:51:50 elapsed:37:03 postfix:- (2341257:tqdm_logging.py:145)
02:06:11.162 [I] Progress on: 1.86kit/30.0kit rate:1.1s/it remaining:8:51:13 elapsed:37:13 postfix:- (2341257:tqdm_logging.py:145)
02:06:21.362 [I] Progress on: 1.87kit/30.0kit rate:1.1s/it remaining:8:51:05 elapsed:37:23 postfix:- (2341257:tqdm_logging.py:145)
02:06:31.564 [I] Progress on: 1.88kit/30.0kit rate:1.1s/it remaining:8:51:25 elapsed:37:33 postfix:- (2341257:tqdm_logging.py:145)
02:06:41.779 [I] Progress on: 1.89kit/30.0kit rate:1.1s/it remaining:8:51:25 elapsed:37:44 postfix:- (2341257:tqdm_logging.py:145)
Step 1900: grad_norm=0.2712, loss=0.0123, param_norm=1379.8572
02:06:52.141 [I] Progress on: 1.90kit/30.0kit rate:1.1s/it remaining:8:50:41 elapsed:37:54 postfix:- (2341257:tqdm_logging.py:145)
02:07:02.218 [I] Progress on: 1.91kit/30.0kit rate:1.1s/it remaining:8:50:35 elapsed:38:04 postfix:- (2341257:tqdm_logging.py:145)
02:07:12.413 [I] Progress on: 1.92kit/30.0kit rate:1.1s/it remaining:8:50:02 elapsed:38:14 postfix:- (2341257:tqdm_logging.py:145)
02:07:22.610 [I] Progress on: 1.93kit/30.0kit rate:1.1s/it remaining:8:50:06 elapsed:38:24 postfix:- (2341257:tqdm_logging.py:145)
02:07:32.805 [I] Progress on: 1.94kit/30.0kit rate:1.1s/it remaining:8:49:56 elapsed:38:35 postfix:- (2341257:tqdm_logging.py:145)
02:07:43.002 [I] Progress on: 1.95kit/30.0kit rate:1.1s/it remaining:8:49:47 elapsed:38:45 postfix:- (2341257:tqdm_logging.py:145)
02:07:53.195 [I] Progress on: 1.96kit/30.0kit rate:1.1s/it remaining:8:49:23 elapsed:38:55 postfix:- (2341257:tqdm_logging.py:145)
02:08:03.395 [I] Progress on: 1.96kit/30.0kit rate:1.1s/it remaining:8:49:33 elapsed:39:05 postfix:- (2341257:tqdm_logging.py:145)
02:08:13.595 [I] Progress on: 1.97kit/30.0kit rate:1.1s/it remaining:8:49:20 elapsed:39:15 postfix:- (2341257:tqdm_logging.py:145)
02:08:23.802 [I] Progress on: 1.98kit/30.0kit rate:1.1s/it remaining:8:49:26 elapsed:39:26 postfix:- (2341257:tqdm_logging.py:145)
02:08:34.001 [I] Progress on: 1.99kit/30.0kit rate:1.1s/it remaining:8:49:04 elapsed:39:36 postfix:- (2341257:tqdm_logging.py:145)
02:08:44.198 [I] Progress on: 2.00kit/30.0kit rate:1.1s/it remaining:8:48:48 elapsed:39:46 postfix:- (2341257:tqdm_logging.py:145)
Step 2000: grad_norm=0.2038, loss=0.0105, param_norm=1379.8662
02:08:45.527 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
02:08:45.527 [I] [process=0] Saving checkpoint at step 2000                                       (2341257:checkpoint_manager.py:1408)
02:08:45.528 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (2341257:async_checkpointer.py:439)
02:08:45.537 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 (2341257:atomicity.py:144)
02:08:45.542 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 (2341257:atomicity.py:144)
02:08:45.542 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 (2341257:atomicity.py:144)
02:08:45.542 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 (2341257:atomicity.py:144)
02:08:45.557 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
02:09:25.095 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
02:09:25.097 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
02:09:25.173 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
02:10:37.475 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
02:10:37.475 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 64.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:10:37.492 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 95.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:10:37.496 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
02:10:37.496 [I] Finished blocking save in 111.97 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (2341257:async_checkpointer.py:548)
02:10:37.497 [I] Deleting Checkpoint[step=1000 | time=2025-10-31 17:49:51.200043+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
02:10:37.497 [I] [process=0][thread=MainThread][step=2000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
02:10:37.498 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
02:10:37.498 [I] {'step': 2000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761934125.5276294, 'wait_for_prev_duration_secs': 0.00015497207641601562, 'checkpointer_blocking_start_time': 1761934125.528053, 'checkpointer_blocking_duration_secs': 111.96937251091003, 'get_old_steps_start_time': 1761934237.4974465, 'get_old_steps_duration_secs': 0.00011157989501953125, 'checkpoint_manager_blocking_start_time': 1761934125.5275214, 'checkpoint_manager_blocking_duration_secs': 111.97090601921082} (2341257:standard_logger.py:34)
02:10:37.502 [I] Progress on: 2.00kit/30.0kit rate:34.8s/it remaining:270:32:10 elapsed:41:39 postfix:- (2341257:tqdm_logging.py:145)
02:10:37.517 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 64.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:10:37.539 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
02:10:47.607 [I] Progress on: 2.01kit/30.0kit rate:4.1s/it remaining:32:08:03 elapsed:41:49 postfix:- (2341257:tqdm_logging.py:145)
02:10:51.551 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 85.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: 2 minutes) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:10:51.551 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
02:10:51.552 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets (2341257:atomicity.py:289)
02:10:51.558 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
02:10:51.678 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state (2341257:atomicity.py:289)
02:10:51.682 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
02:10:51.747 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params (2341257:atomicity.py:289)
02:10:51.749 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (2341257:atomicity.py:289)
02:10:51.753 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000`. (2341257:atomicity.py:573)
02:10:51.753 [I] Finished asynchronous save (blocking + background) in 126.23 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (2341257:async_checkpointer.py:412)
02:10:51.753 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
02:10:51.753 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
02:10:51.754 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
02:10:52.286 [I] Deleted step 1000.                                                               (2341257:deleter.py:114)
02:10:52.286 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
02:10:52.286 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
02:10:57.848 [I] Progress on: 2.02kit/30.0kit rate:1.3s/it remaining:9:46:37 elapsed:42:00 postfix:- (2341257:tqdm_logging.py:145)
02:11:08.090 [I] Progress on: 2.03kit/30.0kit rate:1.1s/it remaining:8:52:38 elapsed:42:10 postfix:- (2341257:tqdm_logging.py:145)
02:11:18.322 [I] Progress on: 2.04kit/30.0kit rate:1.1s/it remaining:8:49:30 elapsed:42:20 postfix:- (2341257:tqdm_logging.py:145)
02:11:28.505 [I] Progress on: 2.04kit/30.0kit rate:1.1s/it remaining:8:47:45 elapsed:42:30 postfix:- (2341257:tqdm_logging.py:145)
02:11:38.702 [I] Progress on: 2.05kit/30.0kit rate:1.1s/it remaining:8:47:40 elapsed:42:41 postfix:- (2341257:tqdm_logging.py:145)
02:11:48.899 [I] Progress on: 2.06kit/30.0kit rate:1.1s/it remaining:8:47:35 elapsed:42:51 postfix:- (2341257:tqdm_logging.py:145)
02:11:59.094 [I] Progress on: 2.07kit/30.0kit rate:1.1s/it remaining:8:47:05 elapsed:43:01 postfix:- (2341257:tqdm_logging.py:145)
02:12:09.303 [I] Progress on: 2.08kit/30.0kit rate:1.1s/it remaining:8:48:28 elapsed:43:11 postfix:- (2341257:tqdm_logging.py:145)
02:12:19.499 [I] Progress on: 2.09kit/30.0kit rate:1.1s/it remaining:8:47:05 elapsed:43:21 postfix:- (2341257:tqdm_logging.py:145)
02:12:29.696 [I] Progress on: 2.10kit/30.0kit rate:1.1s/it remaining:8:47:05 elapsed:43:32 postfix:- (2341257:tqdm_logging.py:145)
Step 2100: grad_norm=0.2081, loss=0.0106, param_norm=1379.8748
02:12:40.147 [I] Progress on: 2.11kit/30.0kit rate:1.2s/it remaining:8:56:19 elapsed:43:42 postfix:- (2341257:tqdm_logging.py:145)
02:12:50.342 [I] Progress on: 2.12kit/30.0kit rate:1.1s/it remaining:8:46:53 elapsed:43:52 postfix:- (2341257:tqdm_logging.py:145)
02:13:00.540 [I] Progress on: 2.12kit/30.0kit rate:1.1s/it remaining:8:46:30 elapsed:44:02 postfix:- (2341257:tqdm_logging.py:145)
02:13:10.735 [I] Progress on: 2.13kit/30.0kit rate:1.1s/it remaining:8:46:02 elapsed:44:13 postfix:- (2341257:tqdm_logging.py:145)
02:13:20.930 [I] Progress on: 2.14kit/30.0kit rate:1.1s/it remaining:8:45:52 elapsed:44:23 postfix:- (2341257:tqdm_logging.py:145)
02:13:31.128 [I] Progress on: 2.15kit/30.0kit rate:1.1s/it remaining:8:45:55 elapsed:44:33 postfix:- (2341257:tqdm_logging.py:145)
02:13:41.328 [I] Progress on: 2.16kit/30.0kit rate:1.1s/it remaining:8:46:08 elapsed:44:43 postfix:- (2341257:tqdm_logging.py:145)
02:13:51.525 [I] Progress on: 2.17kit/30.0kit rate:1.1s/it remaining:8:45:25 elapsed:44:53 postfix:- (2341257:tqdm_logging.py:145)
02:14:01.734 [I] Progress on: 2.18kit/30.0kit rate:1.1s/it remaining:8:45:39 elapsed:45:04 postfix:- (2341257:tqdm_logging.py:145)
02:14:11.931 [I] Progress on: 2.19kit/30.0kit rate:1.1s/it remaining:8:45:07 elapsed:45:14 postfix:- (2341257:tqdm_logging.py:145)
02:14:22.127 [I] Progress on: 2.20kit/30.0kit rate:1.1s/it remaining:8:45:02 elapsed:45:24 postfix:- (2341257:tqdm_logging.py:145)
Step 2200: grad_norm=0.2411, loss=0.0108, param_norm=1379.8835
02:14:32.367 [I] Progress on: 2.21kit/30.0kit rate:1.1s/it remaining:8:44:26 elapsed:45:34 postfix:- (2341257:tqdm_logging.py:145)
02:14:42.565 [I] Progress on: 2.21kit/30.0kit rate:1.1s/it remaining:8:44:45 elapsed:45:44 postfix:- (2341257:tqdm_logging.py:145)
02:14:52.760 [I] Progress on: 2.22kit/30.0kit rate:1.1s/it remaining:8:44:31 elapsed:45:55 postfix:- (2341257:tqdm_logging.py:145)
02:15:02.960 [I] Progress on: 2.23kit/30.0kit rate:1.1s/it remaining:8:44:38 elapsed:46:05 postfix:- (2341257:tqdm_logging.py:145)
02:15:13.166 [I] Progress on: 2.24kit/30.0kit rate:1.1s/it remaining:8:44:20 elapsed:46:15 postfix:- (2341257:tqdm_logging.py:145)
02:15:23.361 [I] Progress on: 2.25kit/30.0kit rate:1.1s/it remaining:8:43:47 elapsed:46:25 postfix:- (2341257:tqdm_logging.py:145)
02:15:33.561 [I] Progress on: 2.26kit/30.0kit rate:1.1s/it remaining:8:44:09 elapsed:46:35 postfix:- (2341257:tqdm_logging.py:145)
02:15:43.756 [I] Progress on: 2.27kit/30.0kit rate:1.1s/it remaining:8:43:28 elapsed:46:46 postfix:- (2341257:tqdm_logging.py:145)
02:15:53.965 [I] Progress on: 2.28kit/30.0kit rate:1.1s/it remaining:8:43:36 elapsed:46:56 postfix:- (2341257:tqdm_logging.py:145)
02:16:04.161 [I] Progress on: 2.29kit/30.0kit rate:1.1s/it remaining:8:43:04 elapsed:47:06 postfix:- (2341257:tqdm_logging.py:145)
02:16:14.362 [I] Progress on: 2.30kit/30.0kit rate:1.1s/it remaining:8:43:31 elapsed:47:16 postfix:- (2341257:tqdm_logging.py:145)
Step 2300: grad_norm=0.1861, loss=0.0096, param_norm=1379.8925
02:16:24.604 [I] Progress on: 2.31kit/30.0kit rate:1.1s/it remaining:8:42:06 elapsed:47:26 postfix:- (2341257:tqdm_logging.py:145)
02:16:34.801 [I] Progress on: 2.31kit/30.0kit rate:1.1s/it remaining:8:42:46 elapsed:47:37 postfix:- (2341257:tqdm_logging.py:145)
02:16:44.996 [I] Progress on: 2.32kit/30.0kit rate:1.1s/it remaining:8:42:18 elapsed:47:47 postfix:- (2341257:tqdm_logging.py:145)
02:16:55.195 [I] Progress on: 2.33kit/30.0kit rate:1.1s/it remaining:8:42:31 elapsed:47:57 postfix:- (2341257:tqdm_logging.py:145)
02:17:05.390 [I] Progress on: 2.34kit/30.0kit rate:1.1s/it remaining:8:42:06 elapsed:48:07 postfix:- (2341257:tqdm_logging.py:145)
02:17:15.592 [I] Progress on: 2.35kit/30.0kit rate:1.1s/it remaining:8:42:20 elapsed:48:17 postfix:- (2341257:tqdm_logging.py:145)
02:17:25.790 [I] Progress on: 2.36kit/30.0kit rate:1.1s/it remaining:8:41:49 elapsed:48:28 postfix:- (2341257:tqdm_logging.py:145)
02:17:36.002 [I] Progress on: 2.37kit/30.0kit rate:1.1s/it remaining:8:43:26 elapsed:48:38 postfix:- (2341257:tqdm_logging.py:145)
02:17:46.198 [I] Progress on: 2.38kit/30.0kit rate:1.1s/it remaining:8:41:31 elapsed:48:48 postfix:- (2341257:tqdm_logging.py:145)
02:17:56.394 [I] Progress on: 2.39kit/30.0kit rate:1.1s/it remaining:8:41:27 elapsed:48:58 postfix:- (2341257:tqdm_logging.py:145)
02:18:06.590 [I] Progress on: 2.40kit/30.0kit rate:1.1s/it remaining:8:41:04 elapsed:49:08 postfix:- (2341257:tqdm_logging.py:145)
Step 2400: grad_norm=0.1834, loss=0.0096, param_norm=1379.9009
02:18:16.850 [I] Progress on: 2.40kit/30.0kit rate:1.1s/it remaining:8:40:55 elapsed:49:19 postfix:- (2341257:tqdm_logging.py:145)
02:18:27.044 [I] Progress on: 2.41kit/30.0kit rate:1.1s/it remaining:8:40:45 elapsed:49:29 postfix:- (2341257:tqdm_logging.py:145)
02:18:37.245 [I] Progress on: 2.42kit/30.0kit rate:1.1s/it remaining:8:41:10 elapsed:49:39 postfix:- (2341257:tqdm_logging.py:145)
02:18:47.441 [I] Progress on: 2.43kit/30.0kit rate:1.1s/it remaining:8:40:22 elapsed:49:49 postfix:- (2341257:tqdm_logging.py:145)
02:18:57.638 [I] Progress on: 2.44kit/30.0kit rate:1.1s/it remaining:8:40:28 elapsed:49:59 postfix:- (2341257:tqdm_logging.py:145)
02:19:07.835 [I] Progress on: 2.45kit/30.0kit rate:1.1s/it remaining:8:40:09 elapsed:50:10 postfix:- (2341257:tqdm_logging.py:145)
02:19:18.045 [I] Progress on: 2.46kit/30.0kit rate:1.1s/it remaining:8:40:53 elapsed:50:20 postfix:- (2341257:tqdm_logging.py:145)
02:19:28.240 [I] Progress on: 2.47kit/30.0kit rate:1.1s/it remaining:8:39:54 elapsed:50:30 postfix:- (2341257:tqdm_logging.py:145)
02:19:38.438 [I] Progress on: 2.48kit/30.0kit rate:1.1s/it remaining:8:39:59 elapsed:50:40 postfix:- (2341257:tqdm_logging.py:145)
02:19:48.632 [I] Progress on: 2.48kit/30.0kit rate:1.1s/it remaining:8:39:27 elapsed:50:50 postfix:- (2341257:tqdm_logging.py:145)
02:19:58.841 [I] Progress on: 2.49kit/30.0kit rate:1.1s/it remaining:8:39:25 elapsed:51:01 postfix:- (2341257:tqdm_logging.py:145)
Step 2500: grad_norm=0.3109, loss=0.0102, param_norm=1379.9091
02:20:09.081 [I] Progress on: 2.50kit/30.0kit rate:1.1s/it remaining:8:37:52 elapsed:51:11 postfix:- (2341257:tqdm_logging.py:145)
02:20:19.278 [I] Progress on: 2.51kit/30.0kit rate:1.1s/it remaining:8:39:03 elapsed:51:21 postfix:- (2341257:tqdm_logging.py:145)
02:20:29.474 [I] Progress on: 2.52kit/30.0kit rate:1.1s/it remaining:8:38:34 elapsed:51:31 postfix:- (2341257:tqdm_logging.py:145)
02:20:39.882 [I] Progress on: 2.53kit/30.0kit rate:1.1s/it remaining:8:43:39 elapsed:51:42 postfix:- (2341257:tqdm_logging.py:145)
02:20:50.075 [I] Progress on: 2.54kit/30.0kit rate:1.1s/it remaining:8:38:23 elapsed:51:52 postfix:- (2341257:tqdm_logging.py:145)
02:21:00.273 [I] Progress on: 2.55kit/30.0kit rate:1.1s/it remaining:8:38:26 elapsed:52:02 postfix:- (2341257:tqdm_logging.py:145)
02:21:10.470 [I] Progress on: 2.56kit/30.0kit rate:1.1s/it remaining:8:38:15 elapsed:52:12 postfix:- (2341257:tqdm_logging.py:145)
02:21:20.677 [I] Progress on: 2.57kit/30.0kit rate:1.1s/it remaining:8:38:32 elapsed:52:22 postfix:- (2341257:tqdm_logging.py:145)
02:21:30.871 [I] Progress on: 2.58kit/30.0kit rate:1.1s/it remaining:8:37:47 elapsed:52:33 postfix:- (2341257:tqdm_logging.py:145)
02:21:41.080 [I] Progress on: 2.58kit/30.0kit rate:1.1s/it remaining:8:38:02 elapsed:52:43 postfix:- (2341257:tqdm_logging.py:145)
02:21:51.276 [I] Progress on: 2.59kit/30.0kit rate:1.1s/it remaining:8:37:29 elapsed:52:53 postfix:- (2341257:tqdm_logging.py:145)
Step 2600: grad_norm=0.1852, loss=0.0097, param_norm=1379.9175
02:22:01.521 [I] Progress on: 2.60kit/30.0kit rate:1.1s/it remaining:8:36:04 elapsed:53:03 postfix:- (2341257:tqdm_logging.py:145)
02:22:11.718 [I] Progress on: 2.61kit/30.0kit rate:1.1s/it remaining:8:37:04 elapsed:53:14 postfix:- (2341257:tqdm_logging.py:145)
02:22:21.917 [I] Progress on: 2.62kit/30.0kit rate:1.1s/it remaining:8:37:10 elapsed:53:24 postfix:- (2341257:tqdm_logging.py:145)
02:22:32.114 [I] Progress on: 2.63kit/30.0kit rate:1.1s/it remaining:8:36:49 elapsed:53:34 postfix:- (2341257:tqdm_logging.py:145)
02:22:42.311 [I] Progress on: 2.64kit/30.0kit rate:1.1s/it remaining:8:36:46 elapsed:53:44 postfix:- (2341257:tqdm_logging.py:145)
02:22:52.506 [I] Progress on: 2.65kit/30.0kit rate:1.1s/it remaining:8:36:16 elapsed:53:54 postfix:- (2341257:tqdm_logging.py:145)
02:23:02.731 [I] Progress on: 2.66kit/30.0kit rate:1.1s/it remaining:8:37:30 elapsed:54:05 postfix:- (2341257:tqdm_logging.py:145)
02:23:12.936 [I] Progress on: 2.67kit/30.0kit rate:1.1s/it remaining:8:36:12 elapsed:54:15 postfix:- (2341257:tqdm_logging.py:145)
02:23:23.134 [I] Progress on: 2.67kit/30.0kit rate:1.1s/it remaining:8:36:06 elapsed:54:25 postfix:- (2341257:tqdm_logging.py:145)
02:23:33.328 [I] Progress on: 2.68kit/30.0kit rate:1.1s/it remaining:8:35:41 elapsed:54:35 postfix:- (2341257:tqdm_logging.py:145)
02:23:43.530 [I] Progress on: 2.69kit/30.0kit rate:1.1s/it remaining:8:36:23 elapsed:54:45 postfix:- (2341257:tqdm_logging.py:145)
Step 2700: grad_norm=0.1995, loss=0.0093, param_norm=1379.9258
02:23:53.892 [I] Progress on: 2.70kit/30.0kit rate:1.1s/it remaining:8:35:33 elapsed:54:56 postfix:- (2341257:tqdm_logging.py:145)
02:24:03.970 [I] Progress on: 2.71kit/30.0kit rate:1.1s/it remaining:8:35:12 elapsed:55:06 postfix:- (2341257:tqdm_logging.py:145)
02:24:14.166 [I] Progress on: 2.72kit/30.0kit rate:1.1s/it remaining:8:35:00 elapsed:55:16 postfix:- (2341257:tqdm_logging.py:145)
02:24:24.363 [I] Progress on: 2.73kit/30.0kit rate:1.1s/it remaining:8:34:52 elapsed:55:26 postfix:- (2341257:tqdm_logging.py:145)
02:24:34.559 [I] Progress on: 2.74kit/30.0kit rate:1.1s/it remaining:8:34:41 elapsed:55:36 postfix:- (2341257:tqdm_logging.py:145)
02:24:44.756 [I] Progress on: 2.75kit/30.0kit rate:1.1s/it remaining:8:34:44 elapsed:55:47 postfix:- (2341257:tqdm_logging.py:145)
02:24:54.961 [I] Progress on: 2.75kit/30.0kit rate:1.1s/it remaining:8:34:30 elapsed:55:57 postfix:- (2341257:tqdm_logging.py:145)
02:25:05.160 [I] Progress on: 2.76kit/30.0kit rate:1.1s/it remaining:8:34:37 elapsed:56:07 postfix:- (2341257:tqdm_logging.py:145)
02:25:15.358 [I] Progress on: 2.77kit/30.0kit rate:1.1s/it remaining:8:34:22 elapsed:56:17 postfix:- (2341257:tqdm_logging.py:145)
02:25:25.554 [I] Progress on: 2.78kit/30.0kit rate:1.1s/it remaining:8:33:37 elapsed:56:27 postfix:- (2341257:tqdm_logging.py:145)
02:25:35.772 [I] Progress on: 2.79kit/30.0kit rate:1.1s/it remaining:8:35:31 elapsed:56:38 postfix:- (2341257:tqdm_logging.py:145)
02:25:45.980 [I] Progress on: 2.80kit/30.0kit rate:1.1s/it remaining:8:34:11 elapsed:56:48 postfix:- (2341257:tqdm_logging.py:145)
Step 2800: grad_norm=0.1912, loss=0.0089, param_norm=1379.9341
02:25:56.223 [I] Progress on: 2.81kit/30.0kit rate:1.1s/it remaining:8:33:16 elapsed:56:58 postfix:- (2341257:tqdm_logging.py:145)
02:26:06.424 [I] Progress on: 2.82kit/30.0kit rate:1.1s/it remaining:8:33:48 elapsed:57:08 postfix:- (2341257:tqdm_logging.py:145)
02:26:16.629 [I] Progress on: 2.83kit/30.0kit rate:1.1s/it remaining:8:33:20 elapsed:57:18 postfix:- (2341257:tqdm_logging.py:145)
02:26:26.826 [I] Progress on: 2.84kit/30.0kit rate:1.1s/it remaining:8:32:56 elapsed:57:29 postfix:- (2341257:tqdm_logging.py:145)
02:26:37.023 [I] Progress on: 2.85kit/30.0kit rate:1.1s/it remaining:8:32:40 elapsed:57:39 postfix:- (2341257:tqdm_logging.py:145)
02:26:47.224 [I] Progress on: 2.85kit/30.0kit rate:1.1s/it remaining:8:32:45 elapsed:57:49 postfix:- (2341257:tqdm_logging.py:145)
02:26:57.426 [I] Progress on: 2.86kit/30.0kit rate:1.1s/it remaining:8:32:27 elapsed:57:59 postfix:- (2341257:tqdm_logging.py:145)
02:27:07.624 [I] Progress on: 2.87kit/30.0kit rate:1.1s/it remaining:8:32:13 elapsed:58:09 postfix:- (2341257:tqdm_logging.py:145)
02:27:17.827 [I] Progress on: 2.88kit/30.0kit rate:1.1s/it remaining:8:32:11 elapsed:58:20 postfix:- (2341257:tqdm_logging.py:145)
02:27:28.026 [I] Progress on: 2.89kit/30.0kit rate:1.1s/it remaining:8:31:56 elapsed:58:30 postfix:- (2341257:tqdm_logging.py:145)
02:27:38.222 [I] Progress on: 2.90kit/30.0kit rate:1.1s/it remaining:8:31:41 elapsed:58:40 postfix:- (2341257:tqdm_logging.py:145)
Step 2900: grad_norm=0.2319, loss=0.0091, param_norm=1379.9427
02:27:48.466 [I] Progress on: 2.91kit/30.0kit rate:1.1s/it remaining:8:31:29 elapsed:58:50 postfix:- (2341257:tqdm_logging.py:145)
02:27:58.662 [I] Progress on: 2.92kit/30.0kit rate:1.1s/it remaining:8:31:18 elapsed:59:00 postfix:- (2341257:tqdm_logging.py:145)
02:28:08.979 [I] Progress on: 2.93kit/30.0kit rate:1.1s/it remaining:8:36:45 elapsed:59:11 postfix:- (2341257:tqdm_logging.py:145)
02:28:19.174 [I] Progress on: 2.94kit/30.0kit rate:1.1s/it remaining:8:31:11 elapsed:59:21 postfix:- (2341257:tqdm_logging.py:145)
02:28:29.370 [I] Progress on: 2.94kit/30.0kit rate:1.1s/it remaining:8:30:42 elapsed:59:31 postfix:- (2341257:tqdm_logging.py:145)
02:28:39.777 [I] Progress on: 2.95kit/30.0kit rate:1.1s/it remaining:8:32:59 elapsed:59:42 postfix:- (2341257:tqdm_logging.py:145)
02:28:49.973 [I] Progress on: 2.96kit/30.0kit rate:1.1s/it remaining:8:30:39 elapsed:59:52 postfix:- (2341257:tqdm_logging.py:145)
02:29:00.168 [I] Progress on: 2.97kit/30.0kit rate:1.1s/it remaining:8:30:14 elapsed:1:00:02 postfix:- (2341257:tqdm_logging.py:145)
02:29:10.380 [I] Progress on: 2.98kit/30.0kit rate:1.1s/it remaining:8:32:05 elapsed:1:00:12 postfix:- (2341257:tqdm_logging.py:145)
02:29:20.573 [I] Progress on: 2.99kit/30.0kit rate:1.1s/it remaining:8:30:01 elapsed:1:00:22 postfix:- (2341257:tqdm_logging.py:145)
02:29:30.769 [I] Progress on: 3.00kit/30.0kit rate:1.1s/it remaining:8:29:50 elapsed:1:00:33 postfix:- (2341257:tqdm_logging.py:145)
Step 3000: grad_norm=0.1695, loss=0.0083, param_norm=1379.9512
02:29:34.375 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
02:29:34.376 [I] [process=0] Saving checkpoint at step 3000                                       (2341257:checkpoint_manager.py:1408)
02:29:34.376 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000. (2341257:async_checkpointer.py:439)
02:29:34.386 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8 (2341257:atomicity.py:144)
02:29:34.392 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11 (2341257:atomicity.py:144)
02:29:34.392 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets.orbax-checkpoint-tmp-9 (2341257:atomicity.py:144)
02:29:34.392 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10 (2341257:atomicity.py:144)
02:29:34.417 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
02:30:12.450 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
02:30:12.452 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
02:30:12.580 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
02:31:24.480 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 65.1 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:31:24.482 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
02:31:24.506 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 97.5 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:31:24.516 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
02:31:24.517 [I] Finished blocking save in 110.14 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000. (2341257:async_checkpointer.py:548)
02:31:24.519 [I] Deleting Checkpoint[step=2000 | time=2025-10-31 18:10:37.497434+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
02:31:24.519 [I] [process=0][thread=MainThread][step=3000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
02:31:24.520 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
02:31:24.520 [I] {'step': 3000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761935374.3758197, 'wait_for_prev_duration_secs': 0.00018525123596191406, 'checkpointer_blocking_start_time': 1761935374.3762667, 'checkpointer_blocking_duration_secs': 110.14305400848389, 'get_old_steps_start_time': 1761935484.5193398, 'get_old_steps_duration_secs': 0.00011777877807617188, 'checkpoint_manager_blocking_start_time': 1761935374.3756936, 'checkpoint_manager_blocking_duration_secs': 110.14507985115051} (2341257:standard_logger.py:34)
02:31:24.521 [I] Progress on: 3.00kit/30.0kit rate:34.2s/it remaining:256:46:56 elapsed:1:02:26 postfix:- (2341257:tqdm_logging.py:145)
02:31:24.541 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 65.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:31:24.551 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
02:31:34.592 [I] Progress on: 3.01kit/30.0kit rate:2.5s/it remaining:18:30:38 elapsed:1:02:36 postfix:- (2341257:tqdm_logging.py:145)
02:31:37.452 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 87.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: 2 minutes) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:31:37.452 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
02:31:37.453 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets.orbax-checkpoint-tmp-9 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets (2341257:atomicity.py:289)
02:31:37.458 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
02:31:37.564 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state (2341257:atomicity.py:289)
02:31:37.568 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
02:31:37.629 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params (2341257:atomicity.py:289)
02:31:37.631 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000 (2341257:atomicity.py:289)
02:31:37.635 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000`. (2341257:atomicity.py:573)
02:31:37.635 [I] Finished asynchronous save (blocking + background) in 123.26 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000 (2341257:async_checkpointer.py:412)
02:31:37.635 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
02:31:37.635 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
02:31:37.636 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
02:31:38.149 [I] Deleted step 2000.                                                               (2341257:deleter.py:114)
02:31:38.150 [I] [process=0][thread=save_finalize][step=3000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
02:31:38.150 [I] [process=0][thread=save_finalize][step=3000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
02:31:44.812 [I] Progress on: 3.02kit/30.0kit rate:1.2s/it remaining:8:55:13 elapsed:1:02:47 postfix:- (2341257:tqdm_logging.py:145)
02:31:55.047 [I] Progress on: 3.03kit/30.0kit rate:1.1s/it remaining:8:31:36 elapsed:1:02:57 postfix:- (2341257:tqdm_logging.py:145)
02:32:05.254 [I] Progress on: 3.04kit/30.0kit rate:1.1s/it remaining:8:29:53 elapsed:1:03:07 postfix:- (2341257:tqdm_logging.py:145)
02:32:15.453 [I] Progress on: 3.05kit/30.0kit rate:1.1s/it remaining:8:29:19 elapsed:1:03:17 postfix:- (2341257:tqdm_logging.py:145)
02:32:25.651 [I] Progress on: 3.06kit/30.0kit rate:1.1s/it remaining:8:28:58 elapsed:1:03:27 postfix:- (2341257:tqdm_logging.py:145)
02:32:35.853 [I] Progress on: 3.06kit/30.0kit rate:1.1s/it remaining:8:28:43 elapsed:1:03:38 postfix:- (2341257:tqdm_logging.py:145)
02:32:46.060 [I] Progress on: 3.07kit/30.0kit rate:1.1s/it remaining:8:28:45 elapsed:1:03:48 postfix:- (2341257:tqdm_logging.py:145)
02:32:56.254 [I] Progress on: 3.08kit/30.0kit rate:1.1s/it remaining:8:28:12 elapsed:1:03:58 postfix:- (2341257:tqdm_logging.py:145)
02:33:06.461 [I] Progress on: 3.09kit/30.0kit rate:1.1s/it remaining:8:28:39 elapsed:1:04:08 postfix:- (2341257:tqdm_logging.py:145)
02:33:16.659 [I] Progress on: 3.10kit/30.0kit rate:1.1s/it remaining:8:28:01 elapsed:1:04:18 postfix:- (2341257:tqdm_logging.py:145)
Step 3100: grad_norm=0.1761, loss=0.0078, param_norm=1379.9598
02:33:26.902 [I] Progress on: 3.11kit/30.0kit rate:1.1s/it remaining:8:27:27 elapsed:1:04:29 postfix:- (2341257:tqdm_logging.py:145)
02:33:37.108 [I] Progress on: 3.12kit/30.0kit rate:1.1s/it remaining:8:28:28 elapsed:1:04:39 postfix:- (2341257:tqdm_logging.py:145)
02:33:47.304 [I] Progress on: 3.13kit/30.0kit rate:1.1s/it remaining:8:27:30 elapsed:1:04:49 postfix:- (2341257:tqdm_logging.py:145)
02:33:57.500 [I] Progress on: 3.14kit/30.0kit rate:1.1s/it remaining:8:27:15 elapsed:1:04:59 postfix:- (2341257:tqdm_logging.py:145)
02:34:07.707 [I] Progress on: 3.15kit/30.0kit rate:1.1s/it remaining:8:27:25 elapsed:1:05:10 postfix:- (2341257:tqdm_logging.py:145)
02:34:17.902 [I] Progress on: 3.15kit/30.0kit rate:1.1s/it remaining:8:26:51 elapsed:1:05:20 postfix:- (2341257:tqdm_logging.py:145)
02:34:28.098 [I] Progress on: 3.16kit/30.0kit rate:1.1s/it remaining:8:26:38 elapsed:1:05:30 postfix:- (2341257:tqdm_logging.py:145)
02:34:38.303 [I] Progress on: 3.17kit/30.0kit rate:1.1s/it remaining:8:27:51 elapsed:1:05:40 postfix:- (2341257:tqdm_logging.py:145)
02:34:48.491 [I] Progress on: 3.18kit/30.0kit rate:1.1s/it remaining:8:26:22 elapsed:1:05:50 postfix:- (2341257:tqdm_logging.py:145)
02:34:58.687 [I] Progress on: 3.19kit/30.0kit rate:1.1s/it remaining:8:26:16 elapsed:1:06:01 postfix:- (2341257:tqdm_logging.py:145)
02:35:08.894 [I] Progress on: 3.20kit/30.0kit rate:1.1s/it remaining:8:27:18 elapsed:1:06:11 postfix:- (2341257:tqdm_logging.py:145)
Step 3200: grad_norm=0.1903, loss=0.0086, param_norm=1379.9681
02:35:19.132 [I] Progress on: 3.21kit/30.0kit rate:1.1s/it remaining:8:25:36 elapsed:1:06:21 postfix:- (2341257:tqdm_logging.py:145)
02:35:29.329 [I] Progress on: 3.22kit/30.0kit rate:1.1s/it remaining:8:25:37 elapsed:1:06:31 postfix:- (2341257:tqdm_logging.py:145)
02:35:39.527 [I] Progress on: 3.23kit/30.0kit rate:1.1s/it remaining:8:25:36 elapsed:1:06:41 postfix:- (2341257:tqdm_logging.py:145)
02:35:49.724 [I] Progress on: 3.23kit/30.0kit rate:1.1s/it remaining:8:25:25 elapsed:1:06:52 postfix:- (2341257:tqdm_logging.py:145)
02:35:59.920 [I] Progress on: 3.24kit/30.0kit rate:1.1s/it remaining:8:25:19 elapsed:1:07:02 postfix:- (2341257:tqdm_logging.py:145)
02:36:10.121 [I] Progress on: 3.25kit/30.0kit rate:1.1s/it remaining:8:25:33 elapsed:1:07:12 postfix:- (2341257:tqdm_logging.py:145)
02:36:20.328 [I] Progress on: 3.26kit/30.0kit rate:1.1s/it remaining:8:25:44 elapsed:1:07:22 postfix:- (2341257:tqdm_logging.py:145)
02:36:30.523 [I] Progress on: 3.27kit/30.0kit rate:1.1s/it remaining:8:24:38 elapsed:1:07:32 postfix:- (2341257:tqdm_logging.py:145)
02:36:40.724 [I] Progress on: 3.28kit/30.0kit rate:1.1s/it remaining:8:24:48 elapsed:1:07:43 postfix:- (2341257:tqdm_logging.py:145)
02:36:50.918 [I] Progress on: 3.29kit/30.0kit rate:1.1s/it remaining:8:24:17 elapsed:1:07:53 postfix:- (2341257:tqdm_logging.py:145)
02:37:01.119 [I] Progress on: 3.30kit/30.0kit rate:1.1s/it remaining:8:24:47 elapsed:1:08:03 postfix:- (2341257:tqdm_logging.py:145)
Step 3300: grad_norm=0.1711, loss=0.0075, param_norm=1379.9763
02:37:11.367 [I] Progress on: 3.31kit/30.0kit rate:1.1s/it remaining:8:23:44 elapsed:1:08:13 postfix:- (2341257:tqdm_logging.py:145)
02:37:21.580 [I] Progress on: 3.32kit/30.0kit rate:1.1s/it remaining:8:24:13 elapsed:1:08:23 postfix:- (2341257:tqdm_logging.py:145)
02:37:31.775 [I] Progress on: 3.33kit/30.0kit rate:1.1s/it remaining:8:23:34 elapsed:1:08:34 postfix:- (2341257:tqdm_logging.py:145)
02:37:41.973 [I] Progress on: 3.33kit/30.0kit rate:1.1s/it remaining:8:23:35 elapsed:1:08:44 postfix:- (2341257:tqdm_logging.py:145)
02:37:52.168 [I] Progress on: 3.34kit/30.0kit rate:1.1s/it remaining:8:23:13 elapsed:1:08:54 postfix:- (2341257:tqdm_logging.py:145)
02:38:02.368 [I] Progress on: 3.35kit/30.0kit rate:1.1s/it remaining:8:23:20 elapsed:1:09:04 postfix:- (2341257:tqdm_logging.py:145)
02:38:12.563 [I] Progress on: 3.36kit/30.0kit rate:1.1s/it remaining:8:23:01 elapsed:1:09:14 postfix:- (2341257:tqdm_logging.py:145)
02:38:22.965 [I] Progress on: 3.37kit/30.0kit rate:1.2s/it remaining:8:32:10 elapsed:1:09:25 postfix:- (2341257:tqdm_logging.py:145)
02:38:33.164 [I] Progress on: 3.38kit/30.0kit rate:1.1s/it remaining:8:23:19 elapsed:1:09:35 postfix:- (2341257:tqdm_logging.py:145)
02:38:43.359 [I] Progress on: 3.39kit/30.0kit rate:1.1s/it remaining:8:22:38 elapsed:1:09:45 postfix:- (2341257:tqdm_logging.py:145)
02:38:53.558 [I] Progress on: 3.40kit/30.0kit rate:1.1s/it remaining:8:22:21 elapsed:1:09:55 postfix:- (2341257:tqdm_logging.py:145)
Step 3400: grad_norm=0.1750, loss=0.0076, param_norm=1379.9849
02:39:03.803 [I] Progress on: 3.41kit/30.0kit rate:1.1s/it remaining:8:21:55 elapsed:1:10:06 postfix:- (2341257:tqdm_logging.py:145)
02:39:13.996 [I] Progress on: 3.42kit/30.0kit rate:1.1s/it remaining:8:21:49 elapsed:1:10:16 postfix:- (2341257:tqdm_logging.py:145)
02:39:24.194 [I] Progress on: 3.42kit/30.0kit rate:1.1s/it remaining:8:21:51 elapsed:1:10:26 postfix:- (2341257:tqdm_logging.py:145)
02:39:34.392 [I] Progress on: 3.43kit/30.0kit rate:1.1s/it remaining:8:21:56 elapsed:1:10:36 postfix:- (2341257:tqdm_logging.py:145)
02:39:44.588 [I] Progress on: 3.44kit/30.0kit rate:1.1s/it remaining:8:21:28 elapsed:1:10:46 postfix:- (2341257:tqdm_logging.py:145)
02:39:54.783 [I] Progress on: 3.45kit/30.0kit rate:1.1s/it remaining:8:21:12 elapsed:1:10:57 postfix:- (2341257:tqdm_logging.py:145)
02:40:04.986 [I] Progress on: 3.46kit/30.0kit rate:1.1s/it remaining:8:21:17 elapsed:1:11:07 postfix:- (2341257:tqdm_logging.py:145)
02:40:15.188 [I] Progress on: 3.47kit/30.0kit rate:1.1s/it remaining:8:21:06 elapsed:1:11:17 postfix:- (2341257:tqdm_logging.py:145)
02:40:25.385 [I] Progress on: 3.48kit/30.0kit rate:1.1s/it remaining:8:20:47 elapsed:1:11:27 postfix:- (2341257:tqdm_logging.py:145)
02:40:35.595 [I] Progress on: 3.49kit/30.0kit rate:1.1s/it remaining:8:21:13 elapsed:1:11:37 postfix:- (2341257:tqdm_logging.py:145)
02:40:45.792 [I] Progress on: 3.50kit/30.0kit rate:1.1s/it remaining:8:20:34 elapsed:1:11:48 postfix:- (2341257:tqdm_logging.py:145)
Step 3500: grad_norm=0.1802, loss=0.0077, param_norm=1379.9933
02:40:56.031 [I] Progress on: 3.50kit/30.0kit rate:1.1s/it remaining:8:19:30 elapsed:1:11:58 postfix:- (2341257:tqdm_logging.py:145)
02:41:06.230 [I] Progress on: 3.51kit/30.0kit rate:1.1s/it remaining:8:20:20 elapsed:1:12:08 postfix:- (2341257:tqdm_logging.py:145)
02:41:16.424 [I] Progress on: 3.52kit/30.0kit rate:1.1s/it remaining:8:19:49 elapsed:1:12:18 postfix:- (2341257:tqdm_logging.py:145)
02:41:26.623 [I] Progress on: 3.53kit/30.0kit rate:1.1s/it remaining:8:19:52 elapsed:1:12:28 postfix:- (2341257:tqdm_logging.py:145)
02:41:36.817 [I] Progress on: 3.54kit/30.0kit rate:1.1s/it remaining:8:19:34 elapsed:1:12:39 postfix:- (2341257:tqdm_logging.py:145)
02:41:47.026 [I] Progress on: 3.55kit/30.0kit rate:1.1s/it remaining:8:19:51 elapsed:1:12:49 postfix:- (2341257:tqdm_logging.py:145)
02:41:57.221 [I] Progress on: 3.56kit/30.0kit rate:1.1s/it remaining:8:19:05 elapsed:1:12:59 postfix:- (2341257:tqdm_logging.py:145)
02:42:07.419 [I] Progress on: 3.57kit/30.0kit rate:1.1s/it remaining:8:19:13 elapsed:1:13:09 postfix:- (2341257:tqdm_logging.py:145)
02:42:17.627 [I] Progress on: 3.58kit/30.0kit rate:1.1s/it remaining:8:19:50 elapsed:1:13:19 postfix:- (2341257:tqdm_logging.py:145)
02:42:27.824 [I] Progress on: 3.59kit/30.0kit rate:1.1s/it remaining:8:18:40 elapsed:1:13:30 postfix:- (2341257:tqdm_logging.py:145)
02:42:38.021 [I] Progress on: 3.60kit/30.0kit rate:1.1s/it remaining:8:18:33 elapsed:1:13:40 postfix:- (2341257:tqdm_logging.py:145)
Step 3600: grad_norm=0.1775, loss=0.0076, param_norm=1380.0013
02:42:48.266 [I] Progress on: 3.60kit/30.0kit rate:1.1s/it remaining:8:17:47 elapsed:1:13:50 postfix:- (2341257:tqdm_logging.py:145)
02:42:58.463 [I] Progress on: 3.61kit/30.0kit rate:1.1s/it remaining:8:18:11 elapsed:1:14:00 postfix:- (2341257:tqdm_logging.py:145)
02:43:08.660 [I] Progress on: 3.62kit/30.0kit rate:1.1s/it remaining:8:18:06 elapsed:1:14:10 postfix:- (2341257:tqdm_logging.py:145)
02:43:18.856 [I] Progress on: 3.63kit/30.0kit rate:1.1s/it remaining:8:17:49 elapsed:1:14:21 postfix:- (2341257:tqdm_logging.py:145)
02:43:29.053 [I] Progress on: 3.64kit/30.0kit rate:1.1s/it remaining:8:17:33 elapsed:1:14:31 postfix:- (2341257:tqdm_logging.py:145)
02:43:39.251 [I] Progress on: 3.65kit/30.0kit rate:1.1s/it remaining:8:17:32 elapsed:1:14:41 postfix:- (2341257:tqdm_logging.py:145)
02:43:49.456 [I] Progress on: 3.66kit/30.0kit rate:1.1s/it remaining:8:17:37 elapsed:1:14:51 postfix:- (2341257:tqdm_logging.py:145)
02:43:59.652 [I] Progress on: 3.67kit/30.0kit rate:1.1s/it remaining:8:17:10 elapsed:1:15:01 postfix:- (2341257:tqdm_logging.py:145)
02:44:09.858 [I] Progress on: 3.68kit/30.0kit rate:1.1s/it remaining:8:17:31 elapsed:1:15:12 postfix:- (2341257:tqdm_logging.py:145)
02:44:20.055 [I] Progress on: 3.69kit/30.0kit rate:1.1s/it remaining:8:16:57 elapsed:1:15:22 postfix:- (2341257:tqdm_logging.py:145)
02:44:30.251 [I] Progress on: 3.69kit/30.0kit rate:1.1s/it remaining:8:16:42 elapsed:1:15:32 postfix:- (2341257:tqdm_logging.py:145)
Step 3700: grad_norm=0.1759, loss=0.0077, param_norm=1380.0098
02:44:40.500 [I] Progress on: 3.70kit/30.0kit rate:1.1s/it remaining:8:15:45 elapsed:1:15:42 postfix:- (2341257:tqdm_logging.py:145)
02:44:50.696 [I] Progress on: 3.71kit/30.0kit rate:1.1s/it remaining:8:16:23 elapsed:1:15:53 postfix:- (2341257:tqdm_logging.py:145)
02:45:00.892 [I] Progress on: 3.72kit/30.0kit rate:1.1s/it remaining:8:16:10 elapsed:1:16:03 postfix:- (2341257:tqdm_logging.py:145)
02:45:11.090 [I] Progress on: 3.73kit/30.0kit rate:1.1s/it remaining:8:16:06 elapsed:1:16:13 postfix:- (2341257:tqdm_logging.py:145)
02:45:21.287 [I] Progress on: 3.74kit/30.0kit rate:1.1s/it remaining:8:15:48 elapsed:1:16:23 postfix:- (2341257:tqdm_logging.py:145)
02:45:31.483 [I] Progress on: 3.75kit/30.0kit rate:1.1s/it remaining:8:15:35 elapsed:1:16:33 postfix:- (2341257:tqdm_logging.py:145)
02:45:41.684 [I] Progress on: 3.76kit/30.0kit rate:1.1s/it remaining:8:15:35 elapsed:1:16:44 postfix:- (2341257:tqdm_logging.py:145)
02:45:51.891 [I] Progress on: 3.77kit/30.0kit rate:1.1s/it remaining:8:15:45 elapsed:1:16:54 postfix:- (2341257:tqdm_logging.py:145)
02:46:02.088 [I] Progress on: 3.77kit/30.0kit rate:1.1s/it remaining:8:15:13 elapsed:1:17:04 postfix:- (2341257:tqdm_logging.py:145)
02:46:12.284 [I] Progress on: 3.78kit/30.0kit rate:1.1s/it remaining:8:14:58 elapsed:1:17:14 postfix:- (2341257:tqdm_logging.py:145)
02:46:22.692 [I] Progress on: 3.79kit/30.0kit rate:1.1s/it remaining:8:20:13 elapsed:1:17:25 postfix:- (2341257:tqdm_logging.py:145)
Step 3800: grad_norm=0.1721, loss=0.0074, param_norm=1380.0178
02:46:32.931 [I] Progress on: 3.80kit/30.0kit rate:1.1s/it remaining:8:13:03 elapsed:1:17:35 postfix:- (2341257:tqdm_logging.py:145)
02:46:43.126 [I] Progress on: 3.81kit/30.0kit rate:1.1s/it remaining:8:14:21 elapsed:1:17:45 postfix:- (2341257:tqdm_logging.py:145)
02:46:53.324 [I] Progress on: 3.82kit/30.0kit rate:1.1s/it remaining:8:14:32 elapsed:1:17:55 postfix:- (2341257:tqdm_logging.py:145)
02:47:03.517 [I] Progress on: 3.83kit/30.0kit rate:1.1s/it remaining:8:14:03 elapsed:1:18:05 postfix:- (2341257:tqdm_logging.py:145)
02:47:13.720 [I] Progress on: 3.84kit/30.0kit rate:1.1s/it remaining:8:14:38 elapsed:1:18:16 postfix:- (2341257:tqdm_logging.py:145)
02:47:23.924 [I] Progress on: 3.85kit/30.0kit rate:1.1s/it remaining:8:14:01 elapsed:1:18:26 postfix:- (2341257:tqdm_logging.py:145)
02:47:34.126 [I] Progress on: 3.86kit/30.0kit rate:1.1s/it remaining:8:14:21 elapsed:1:18:36 postfix:- (2341257:tqdm_logging.py:145)
02:47:44.334 [I] Progress on: 3.87kit/30.0kit rate:1.1s/it remaining:8:13:24 elapsed:1:18:46 postfix:- (2341257:tqdm_logging.py:145)
02:47:54.530 [I] Progress on: 3.87kit/30.0kit rate:1.1s/it remaining:8:13:13 elapsed:1:18:56 postfix:- (2341257:tqdm_logging.py:145)
02:48:04.726 [I] Progress on: 3.88kit/30.0kit rate:1.1s/it remaining:8:12:58 elapsed:1:19:07 postfix:- (2341257:tqdm_logging.py:145)
02:48:14.936 [I] Progress on: 3.89kit/30.0kit rate:1.1s/it remaining:8:13:42 elapsed:1:19:17 postfix:- (2341257:tqdm_logging.py:145)
Step 3900: grad_norm=0.1676, loss=0.0067, param_norm=1380.0254
02:48:25.297 [I] Progress on: 3.90kit/30.0kit rate:1.1s/it remaining:8:13:03 elapsed:1:19:27 postfix:- (2341257:tqdm_logging.py:145)
02:48:35.377 [I] Progress on: 3.91kit/30.0kit rate:1.1s/it remaining:8:12:44 elapsed:1:19:37 postfix:- (2341257:tqdm_logging.py:145)
02:48:45.573 [I] Progress on: 3.92kit/30.0kit rate:1.1s/it remaining:8:12:20 elapsed:1:19:47 postfix:- (2341257:tqdm_logging.py:145)
02:48:55.770 [I] Progress on: 3.93kit/30.0kit rate:1.1s/it remaining:8:12:18 elapsed:1:19:58 postfix:- (2341257:tqdm_logging.py:145)
02:49:05.967 [I] Progress on: 3.94kit/30.0kit rate:1.1s/it remaining:8:12:08 elapsed:1:20:08 postfix:- (2341257:tqdm_logging.py:145)
02:49:16.165 [I] Progress on: 3.95kit/30.0kit rate:1.1s/it remaining:8:12:03 elapsed:1:20:18 postfix:- (2341257:tqdm_logging.py:145)
02:49:26.361 [I] Progress on: 3.96kit/30.0kit rate:1.1s/it remaining:8:11:47 elapsed:1:20:28 postfix:- (2341257:tqdm_logging.py:145)
02:49:36.558 [I] Progress on: 3.96kit/30.0kit rate:1.1s/it remaining:8:11:40 elapsed:1:20:38 postfix:- (2341257:tqdm_logging.py:145)
02:49:46.755 [I] Progress on: 3.97kit/30.0kit rate:1.1s/it remaining:8:11:19 elapsed:1:20:49 postfix:- (2341257:tqdm_logging.py:145)
02:49:56.952 [I] Progress on: 3.98kit/30.0kit rate:1.1s/it remaining:8:11:19 elapsed:1:20:59 postfix:- (2341257:tqdm_logging.py:145)
02:50:07.151 [I] Progress on: 3.99kit/30.0kit rate:1.1s/it remaining:8:11:23 elapsed:1:21:09 postfix:- (2341257:tqdm_logging.py:145)
02:50:17.357 [I] Progress on: 4.00kit/30.0kit rate:1.1s/it remaining:8:10:56 elapsed:1:21:19 postfix:- (2341257:tqdm_logging.py:145)
Step 4000: grad_norm=0.2590, loss=0.0075, param_norm=1380.0334
02:50:18.687 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
02:50:18.687 [I] [process=0] Saving checkpoint at step 4000                                       (2341257:checkpoint_manager.py:1408)
02:50:18.688 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000. (2341257:async_checkpointer.py:439)
02:50:18.696 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12 (2341257:atomicity.py:144)
02:50:18.700 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/train_state.orbax-checkpoint-tmp-15 (2341257:atomicity.py:144)
02:50:18.700 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (2341257:atomicity.py:144)
02:50:18.700 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (2341257:atomicity.py:144)
02:50:18.720 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
02:50:46.167 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
02:50:46.174 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
02:50:46.287 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
02:51:57.283 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
02:51:57.283 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 72.7 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:51:57.585 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 108.6 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:51:57.588 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
02:51:57.588 [I] Finished blocking save in 98.90 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000. (2341257:async_checkpointer.py:548)
02:51:57.589 [I] Deleting Checkpoint[step=3000 | time=2025-10-31 18:31:24.519327+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
02:51:57.589 [I] [process=0][thread=MainThread][step=4000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
02:51:57.589 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
02:51:57.589 [I] {'step': 4000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761936618.6872988, 'wait_for_prev_duration_secs': 0.0001575946807861328, 'checkpointer_blocking_start_time': 1761936618.6877403, 'checkpointer_blocking_duration_secs': 98.90148830413818, 'get_old_steps_start_time': 1761936717.5892472, 'get_old_steps_duration_secs': 0.00015926361083984375, 'checkpoint_manager_blocking_start_time': 1761936618.687196, 'checkpoint_manager_blocking_duration_secs': 98.90275001525879} (2341257:standard_logger.py:34)
02:51:57.590 [I] Progress on: 4.00kit/30.0kit rate:30.9s/it remaining:222:53:26 elapsed:1:22:59 postfix:- (2341257:tqdm_logging.py:145)
02:51:57.610 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 72.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:51:57.628 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/train_state.orbax-checkpoint-tmp-15/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
02:52:07.655 [I] Progress on: 4.01kit/30.0kit rate:2.3s/it remaining:16:51:10 elapsed:1:23:09 postfix:- (2341257:tqdm_logging.py:145)
02:52:11.580 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 95.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
02:52:11.581 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
02:52:11.582 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/assets (2341257:atomicity.py:289)
02:52:11.588 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
02:52:11.699 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/train_state.orbax-checkpoint-tmp-15 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/train_state (2341257:atomicity.py:289)
02:52:11.703 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
02:52:11.765 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/params (2341257:atomicity.py:289)
02:52:11.767 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000 (2341257:atomicity.py:289)
02:52:11.771 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000`. (2341257:atomicity.py:573)
02:52:11.771 [I] Finished asynchronous save (blocking + background) in 113.08 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000 (2341257:async_checkpointer.py:412)
02:52:11.771 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
02:52:11.771 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
02:52:11.772 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
02:52:12.242 [I] Deleted step 3000.                                                               (2341257:deleter.py:114)
02:52:12.242 [I] [process=0][thread=save_finalize][step=4000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
02:52:12.242 [I] [process=0][thread=save_finalize][step=4000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
02:52:17.890 [I] Progress on: 4.02kit/30.0kit rate:1.2s/it remaining:8:33:27 elapsed:1:23:20 postfix:- (2341257:tqdm_logging.py:145)
02:52:28.135 [I] Progress on: 4.03kit/30.0kit rate:1.1s/it remaining:8:13:42 elapsed:1:23:30 postfix:- (2341257:tqdm_logging.py:145)
02:52:38.352 [I] Progress on: 4.04kit/30.0kit rate:1.1s/it remaining:8:11:37 elapsed:1:23:40 postfix:- (2341257:tqdm_logging.py:145)
02:52:48.583 [I] Progress on: 4.05kit/30.0kit rate:1.1s/it remaining:8:11:43 elapsed:1:23:50 postfix:- (2341257:tqdm_logging.py:145)
02:52:58.815 [I] Progress on: 4.05kit/30.0kit rate:1.1s/it remaining:8:11:44 elapsed:1:24:01 postfix:- (2341257:tqdm_logging.py:145)
02:53:09.015 [I] Progress on: 4.06kit/30.0kit rate:1.1s/it remaining:8:09:47 elapsed:1:24:11 postfix:- (2341257:tqdm_logging.py:145)
02:53:19.214 [I] Progress on: 4.07kit/30.0kit rate:1.1s/it remaining:8:09:38 elapsed:1:24:21 postfix:- (2341257:tqdm_logging.py:145)
02:53:29.419 [I] Progress on: 4.08kit/30.0kit rate:1.1s/it remaining:8:10:03 elapsed:1:24:31 postfix:- (2341257:tqdm_logging.py:145)
02:53:39.614 [I] Progress on: 4.09kit/30.0kit rate:1.1s/it remaining:8:09:05 elapsed:1:24:41 postfix:- (2341257:tqdm_logging.py:145)
02:53:49.816 [I] Progress on: 4.10kit/30.0kit rate:1.1s/it remaining:8:09:46 elapsed:1:24:52 postfix:- (2341257:tqdm_logging.py:145)
Step 4100: grad_norm=0.1608, loss=0.0066, param_norm=1380.0419
02:54:00.071 [I] Progress on: 4.11kit/30.0kit rate:1.1s/it remaining:8:09:49 elapsed:1:25:02 postfix:- (2341257:tqdm_logging.py:145)
02:54:10.265 [I] Progress on: 4.12kit/30.0kit rate:1.1s/it remaining:8:08:57 elapsed:1:25:12 postfix:- (2341257:tqdm_logging.py:145)
02:54:20.461 [I] Progress on: 4.13kit/30.0kit rate:1.1s/it remaining:8:08:25 elapsed:1:25:22 postfix:- (2341257:tqdm_logging.py:145)
02:54:30.657 [I] Progress on: 4.14kit/30.0kit rate:1.1s/it remaining:8:08:17 elapsed:1:25:32 postfix:- (2341257:tqdm_logging.py:145)
02:54:40.854 [I] Progress on: 4.14kit/30.0kit rate:1.1s/it remaining:8:08:13 elapsed:1:25:43 postfix:- (2341257:tqdm_logging.py:145)
02:54:51.051 [I] Progress on: 4.15kit/30.0kit rate:1.1s/it remaining:8:08:02 elapsed:1:25:53 postfix:- (2341257:tqdm_logging.py:145)
02:55:01.246 [I] Progress on: 4.16kit/30.0kit rate:1.1s/it remaining:8:07:54 elapsed:1:26:03 postfix:- (2341257:tqdm_logging.py:145)
02:55:11.449 [I] Progress on: 4.17kit/30.0kit rate:1.1s/it remaining:8:08:07 elapsed:1:26:13 postfix:- (2341257:tqdm_logging.py:145)
02:55:21.653 [I] Progress on: 4.18kit/30.0kit rate:1.1s/it remaining:8:07:28 elapsed:1:26:23 postfix:- (2341257:tqdm_logging.py:145)
02:55:31.849 [I] Progress on: 4.19kit/30.0kit rate:1.1s/it remaining:8:07:19 elapsed:1:26:34 postfix:- (2341257:tqdm_logging.py:145)
02:55:42.054 [I] Progress on: 4.20kit/30.0kit rate:1.1s/it remaining:8:07:46 elapsed:1:26:44 postfix:- (2341257:tqdm_logging.py:145)
Step 4200: grad_norm=0.1712, loss=0.0070, param_norm=1380.0497
02:55:52.301 [I] Progress on: 4.21kit/30.0kit rate:1.1s/it remaining:8:06:45 elapsed:1:26:54 postfix:- (2341257:tqdm_logging.py:145)
02:56:02.723 [I] Progress on: 4.22kit/30.0kit rate:1.1s/it remaining:8:09:19 elapsed:1:27:05 postfix:- (2341257:tqdm_logging.py:145)
02:56:12.915 [I] Progress on: 4.23kit/30.0kit rate:1.1s/it remaining:8:06:40 elapsed:1:27:15 postfix:- (2341257:tqdm_logging.py:145)
02:56:23.117 [I] Progress on: 4.24kit/30.0kit rate:1.1s/it remaining:8:07:09 elapsed:1:27:25 postfix:- (2341257:tqdm_logging.py:145)
02:56:33.321 [I] Progress on: 4.24kit/30.0kit rate:1.1s/it remaining:8:07:04 elapsed:1:27:35 postfix:- (2341257:tqdm_logging.py:145)
02:56:43.518 [I] Progress on: 4.25kit/30.0kit rate:1.1s/it remaining:8:06:16 elapsed:1:27:45 postfix:- (2341257:tqdm_logging.py:145)
02:56:53.713 [I] Progress on: 4.26kit/30.0kit rate:1.1s/it remaining:8:05:56 elapsed:1:27:56 postfix:- (2341257:tqdm_logging.py:145)
02:57:03.915 [I] Progress on: 4.27kit/30.0kit rate:1.1s/it remaining:8:06:05 elapsed:1:28:06 postfix:- (2341257:tqdm_logging.py:145)
02:57:14.116 [I] Progress on: 4.28kit/30.0kit rate:1.1s/it remaining:8:06:20 elapsed:1:28:16 postfix:- (2341257:tqdm_logging.py:145)
02:57:24.317 [I] Progress on: 4.29kit/30.0kit rate:1.1s/it remaining:8:01:37 elapsed:1:28:26 postfix:- (2341257:tqdm_logging.py:145)
02:57:34.529 [I] Progress on: 4.30kit/30.0kit rate:1.1s/it remaining:8:05:42 elapsed:1:28:36 postfix:- (2341257:tqdm_logging.py:145)
Step 4300: grad_norm=0.1733, loss=0.0067, param_norm=1380.0571
02:57:44.779 [I] Progress on: 4.31kit/30.0kit rate:1.1s/it remaining:8:05:10 elapsed:1:28:47 postfix:- (2341257:tqdm_logging.py:145)
02:57:54.983 [I] Progress on: 4.32kit/30.0kit rate:1.1s/it remaining:8:05:12 elapsed:1:28:57 postfix:- (2341257:tqdm_logging.py:145)
02:58:05.180 [I] Progress on: 4.33kit/30.0kit rate:1.1s/it remaining:8:04:43 elapsed:1:29:07 postfix:- (2341257:tqdm_logging.py:145)
02:58:15.385 [I] Progress on: 4.33kit/30.0kit rate:1.1s/it remaining:8:05:08 elapsed:1:29:17 postfix:- (2341257:tqdm_logging.py:145)
02:58:25.582 [I] Progress on: 4.34kit/30.0kit rate:1.1s/it remaining:8:04:42 elapsed:1:29:27 postfix:- (2341257:tqdm_logging.py:145)
02:58:35.778 [I] Progress on: 4.35kit/30.0kit rate:1.1s/it remaining:8:04:21 elapsed:1:29:38 postfix:- (2341257:tqdm_logging.py:145)
02:58:45.984 [I] Progress on: 4.36kit/30.0kit rate:1.1s/it remaining:8:04:12 elapsed:1:29:48 postfix:- (2341257:tqdm_logging.py:145)
02:58:56.178 [I] Progress on: 4.37kit/30.0kit rate:1.1s/it remaining:8:03:47 elapsed:1:29:58 postfix:- (2341257:tqdm_logging.py:145)
02:59:06.395 [I] Progress on: 4.38kit/30.0kit rate:1.1s/it remaining:8:04:54 elapsed:1:30:08 postfix:- (2341257:tqdm_logging.py:145)
02:59:16.594 [I] Progress on: 4.39kit/30.0kit rate:1.1s/it remaining:8:03:50 elapsed:1:30:18 postfix:- (2341257:tqdm_logging.py:145)
02:59:26.804 [I] Progress on: 4.40kit/30.0kit rate:1.1s/it remaining:8:03:50 elapsed:1:30:29 postfix:- (2341257:tqdm_logging.py:145)
Step 4400: grad_norm=0.2373, loss=0.0071, param_norm=1380.0649
02:59:37.047 [I] Progress on: 4.41kit/30.0kit rate:1.1s/it remaining:8:03:07 elapsed:1:30:39 postfix:- (2341257:tqdm_logging.py:145)
02:59:47.267 [I] Progress on: 4.42kit/30.0kit rate:1.1s/it remaining:8:04:18 elapsed:1:30:49 postfix:- (2341257:tqdm_logging.py:145)
02:59:57.468 [I] Progress on: 4.42kit/30.0kit rate:1.1s/it remaining:8:03:15 elapsed:1:30:59 postfix:- (2341257:tqdm_logging.py:145)
03:00:07.660 [I] Progress on: 4.43kit/30.0kit rate:1.1s/it remaining:8:02:36 elapsed:1:31:09 postfix:- (2341257:tqdm_logging.py:145)
03:00:17.857 [I] Progress on: 4.44kit/30.0kit rate:1.1s/it remaining:8:02:35 elapsed:1:31:20 postfix:- (2341257:tqdm_logging.py:145)
03:00:28.053 [I] Progress on: 4.45kit/30.0kit rate:1.1s/it remaining:8:02:29 elapsed:1:31:30 postfix:- (2341257:tqdm_logging.py:145)
03:00:38.249 [I] Progress on: 4.46kit/30.0kit rate:1.1s/it remaining:8:02:18 elapsed:1:31:40 postfix:- (2341257:tqdm_logging.py:145)
03:00:48.444 [I] Progress on: 4.47kit/30.0kit rate:1.1s/it remaining:8:02:02 elapsed:1:31:50 postfix:- (2341257:tqdm_logging.py:145)
03:00:58.656 [I] Progress on: 4.48kit/30.0kit rate:1.1s/it remaining:8:02:18 elapsed:1:32:00 postfix:- (2341257:tqdm_logging.py:145)
03:01:08.851 [I] Progress on: 4.49kit/30.0kit rate:1.1s/it remaining:8:01:42 elapsed:1:32:11 postfix:- (2341257:tqdm_logging.py:145)
03:01:19.048 [I] Progress on: 4.50kit/30.0kit rate:1.1s/it remaining:8:01:30 elapsed:1:32:21 postfix:- (2341257:tqdm_logging.py:145)
Step 4500: grad_norm=0.1576, loss=0.0065, param_norm=1380.0731
03:01:29.292 [I] Progress on: 4.50kit/30.0kit rate:1.1s/it remaining:8:00:56 elapsed:1:32:31 postfix:- (2341257:tqdm_logging.py:145)
03:01:39.499 [I] Progress on: 4.51kit/30.0kit rate:1.1s/it remaining:8:02:12 elapsed:1:32:41 postfix:- (2341257:tqdm_logging.py:145)
03:01:49.711 [I] Progress on: 4.52kit/30.0kit rate:1.1s/it remaining:8:02:40 elapsed:1:32:52 postfix:- (2341257:tqdm_logging.py:145)
03:01:59.916 [I] Progress on: 4.53kit/30.0kit rate:1.1s/it remaining:8:01:13 elapsed:1:33:02 postfix:- (2341257:tqdm_logging.py:145)
03:02:10.113 [I] Progress on: 4.54kit/30.0kit rate:1.1s/it remaining:8:00:45 elapsed:1:33:12 postfix:- (2341257:tqdm_logging.py:145)
03:02:20.321 [I] Progress on: 4.55kit/30.0kit rate:1.1s/it remaining:8:00:50 elapsed:1:33:22 postfix:- (2341257:tqdm_logging.py:145)
03:02:30.519 [I] Progress on: 4.56kit/30.0kit rate:1.1s/it remaining:8:00:26 elapsed:1:33:32 postfix:- (2341257:tqdm_logging.py:145)
03:02:40.716 [I] Progress on: 4.57kit/30.0kit rate:1.1s/it remaining:8:00:19 elapsed:1:33:43 postfix:- (2341257:tqdm_logging.py:145)
03:02:50.912 [I] Progress on: 4.58kit/30.0kit rate:1.1s/it remaining:8:00:12 elapsed:1:33:53 postfix:- (2341257:tqdm_logging.py:145)
03:03:01.120 [I] Progress on: 4.59kit/30.0kit rate:1.1s/it remaining:7:59:58 elapsed:1:34:03 postfix:- (2341257:tqdm_logging.py:145)
03:03:11.315 [I] Progress on: 4.59kit/30.0kit rate:1.1s/it remaining:7:59:36 elapsed:1:34:13 postfix:- (2341257:tqdm_logging.py:145)
Step 4600: grad_norm=0.1581, loss=0.0063, param_norm=1380.0809
03:03:21.560 [I] Progress on: 4.60kit/30.0kit rate:1.1s/it remaining:7:59:02 elapsed:1:34:23 postfix:- (2341257:tqdm_logging.py:145)
03:03:31.765 [I] Progress on: 4.61kit/30.0kit rate:1.1s/it remaining:7:59:38 elapsed:1:34:34 postfix:- (2341257:tqdm_logging.py:145)
03:03:41.962 [I] Progress on: 4.62kit/30.0kit rate:1.1s/it remaining:7:59:18 elapsed:1:34:44 postfix:- (2341257:tqdm_logging.py:145)
03:03:52.517 [I] Progress on: 4.63kit/30.0kit rate:1.2s/it remaining:8:44:39 elapsed:1:34:54 postfix:- (2341257:tqdm_logging.py:145)
03:04:02.566 [I] Progress on: 4.64kit/30.0kit rate:1.1s/it remaining:7:59:31 elapsed:1:35:04 postfix:- (2341257:tqdm_logging.py:145)
03:04:12.762 [I] Progress on: 4.65kit/30.0kit rate:1.1s/it remaining:7:58:38 elapsed:1:35:15 postfix:- (2341257:tqdm_logging.py:145)
03:04:22.960 [I] Progress on: 4.66kit/30.0kit rate:1.1s/it remaining:7:58:39 elapsed:1:35:25 postfix:- (2341257:tqdm_logging.py:145)
03:04:33.166 [I] Progress on: 4.67kit/30.0kit rate:1.1s/it remaining:7:58:45 elapsed:1:35:35 postfix:- (2341257:tqdm_logging.py:145)
03:04:43.363 [I] Progress on: 4.68kit/30.0kit rate:1.1s/it remaining:7:58:15 elapsed:1:35:45 postfix:- (2341257:tqdm_logging.py:145)
03:04:53.571 [I] Progress on: 4.68kit/30.0kit rate:1.1s/it remaining:7:59:28 elapsed:1:35:55 postfix:- (2341257:tqdm_logging.py:145)
03:05:03.767 [I] Progress on: 4.69kit/30.0kit rate:1.1s/it remaining:7:57:54 elapsed:1:36:06 postfix:- (2341257:tqdm_logging.py:145)
Step 4700: grad_norm=0.1588, loss=0.0063, param_norm=1380.0887
03:05:14.013 [I] Progress on: 4.70kit/30.0kit rate:1.1s/it remaining:7:57:09 elapsed:1:36:16 postfix:- (2341257:tqdm_logging.py:145)
03:05:24.219 [I] Progress on: 4.71kit/30.0kit rate:1.1s/it remaining:7:57:37 elapsed:1:36:26 postfix:- (2341257:tqdm_logging.py:145)
03:05:34.425 [I] Progress on: 4.72kit/30.0kit rate:1.1s/it remaining:7:57:14 elapsed:1:36:36 postfix:- (2341257:tqdm_logging.py:145)
03:05:44.623 [I] Progress on: 4.73kit/30.0kit rate:1.1s/it remaining:7:57:07 elapsed:1:36:46 postfix:- (2341257:tqdm_logging.py:145)
03:05:54.830 [I] Progress on: 4.74kit/30.0kit rate:1.1s/it remaining:7:57:36 elapsed:1:36:57 postfix:- (2341257:tqdm_logging.py:145)
03:06:05.027 [I] Progress on: 4.75kit/30.0kit rate:1.1s/it remaining:7:56:47 elapsed:1:37:07 postfix:- (2341257:tqdm_logging.py:145)
03:06:15.263 [I] Progress on: 4.76kit/30.0kit rate:1.1s/it remaining:7:59:11 elapsed:1:37:17 postfix:- (2341257:tqdm_logging.py:145)
03:06:25.462 [I] Progress on: 4.77kit/30.0kit rate:1.1s/it remaining:7:56:37 elapsed:1:37:27 postfix:- (2341257:tqdm_logging.py:145)
03:06:35.666 [I] Progress on: 4.78kit/30.0kit rate:1.1s/it remaining:7:56:18 elapsed:1:37:37 postfix:- (2341257:tqdm_logging.py:145)
03:06:45.861 [I] Progress on: 4.78kit/30.0kit rate:1.1s/it remaining:7:56:06 elapsed:1:37:48 postfix:- (2341257:tqdm_logging.py:145)
03:06:56.068 [I] Progress on: 4.79kit/30.0kit rate:1.1s/it remaining:7:56:20 elapsed:1:37:58 postfix:- (2341257:tqdm_logging.py:145)
Step 4800: grad_norm=0.1545, loss=0.0060, param_norm=1380.0962
03:07:06.313 [I] Progress on: 4.80kit/30.0kit rate:1.1s/it remaining:7:54:33 elapsed:1:38:08 postfix:- (2341257:tqdm_logging.py:145)
03:07:16.521 [I] Progress on: 4.81kit/30.0kit rate:1.1s/it remaining:7:56:15 elapsed:1:38:18 postfix:- (2341257:tqdm_logging.py:145)
03:07:26.730 [I] Progress on: 4.82kit/30.0kit rate:1.1s/it remaining:7:56:14 elapsed:1:38:29 postfix:- (2341257:tqdm_logging.py:145)
03:07:36.923 [I] Progress on: 4.83kit/30.0kit rate:1.1s/it remaining:7:55:03 elapsed:1:38:39 postfix:- (2341257:tqdm_logging.py:145)
03:07:47.133 [I] Progress on: 4.84kit/30.0kit rate:1.1s/it remaining:7:55:50 elapsed:1:38:49 postfix:- (2341257:tqdm_logging.py:145)
03:07:57.327 [I] Progress on: 4.85kit/30.0kit rate:1.1s/it remaining:7:54:50 elapsed:1:38:59 postfix:- (2341257:tqdm_logging.py:145)
03:08:07.540 [I] Progress on: 4.86kit/30.0kit rate:1.1s/it remaining:7:55:10 elapsed:1:39:09 postfix:- (2341257:tqdm_logging.py:145)
03:08:17.739 [I] Progress on: 4.87kit/30.0kit rate:1.1s/it remaining:7:54:42 elapsed:1:39:20 postfix:- (2341257:tqdm_logging.py:145)
03:08:27.935 [I] Progress on: 4.87kit/30.0kit rate:1.1s/it remaining:7:54:31 elapsed:1:39:30 postfix:- (2341257:tqdm_logging.py:145)
03:08:38.132 [I] Progress on: 4.88kit/30.0kit rate:1.1s/it remaining:7:54:10 elapsed:1:39:40 postfix:- (2341257:tqdm_logging.py:145)
03:08:48.329 [I] Progress on: 4.89kit/30.0kit rate:1.1s/it remaining:7:54:08 elapsed:1:39:50 postfix:- (2341257:tqdm_logging.py:145)
Step 4900: grad_norm=0.1667, loss=0.0063, param_norm=1380.1034
03:08:58.693 [I] Progress on: 4.90kit/30.0kit rate:1.1s/it remaining:7:53:53 elapsed:1:40:01 postfix:- (2341257:tqdm_logging.py:145)
03:09:08.783 [I] Progress on: 4.91kit/30.0kit rate:1.1s/it remaining:7:54:08 elapsed:1:40:11 postfix:- (2341257:tqdm_logging.py:145)
03:09:19.001 [I] Progress on: 4.92kit/30.0kit rate:1.1s/it remaining:7:53:53 elapsed:1:40:21 postfix:- (2341257:tqdm_logging.py:145)
03:09:29.200 [I] Progress on: 4.93kit/30.0kit rate:1.1s/it remaining:7:53:31 elapsed:1:40:31 postfix:- (2341257:tqdm_logging.py:145)
03:09:39.394 [I] Progress on: 4.94kit/30.0kit rate:1.1s/it remaining:7:53:03 elapsed:1:40:41 postfix:- (2341257:tqdm_logging.py:145)
03:09:49.592 [I] Progress on: 4.95kit/30.0kit rate:1.1s/it remaining:7:53:10 elapsed:1:40:51 postfix:- (2341257:tqdm_logging.py:145)
03:09:59.787 [I] Progress on: 4.96kit/30.0kit rate:1.1s/it remaining:7:52:42 elapsed:1:41:02 postfix:- (2341257:tqdm_logging.py:145)
03:10:09.996 [I] Progress on: 4.96kit/30.0kit rate:1.1s/it remaining:7:53:47 elapsed:1:41:12 postfix:- (2341257:tqdm_logging.py:145)
03:10:20.190 [I] Progress on: 4.97kit/30.0kit rate:1.1s/it remaining:7:52:25 elapsed:1:41:22 postfix:- (2341257:tqdm_logging.py:145)
03:10:30.388 [I] Progress on: 4.98kit/30.0kit rate:1.1s/it remaining:7:52:24 elapsed:1:41:32 postfix:- (2341257:tqdm_logging.py:145)
03:10:40.595 [I] Progress on: 4.99kit/30.0kit rate:1.1s/it remaining:7:52:32 elapsed:1:41:42 postfix:- (2341257:tqdm_logging.py:145)
03:10:50.814 [I] Progress on: 5.00kit/30.0kit rate:1.1s/it remaining:7:53:39 elapsed:1:41:53 postfix:- (2341257:tqdm_logging.py:145)
Step 5000: grad_norm=0.1748, loss=0.0062, param_norm=1380.1110
03:10:52.145 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
03:10:52.145 [I] [process=0] Saving checkpoint at step 5000                                       (2341257:checkpoint_manager.py:1408)
03:10:52.145 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000. (2341257:async_checkpointer.py:439)
03:10:52.153 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16 (2341257:atomicity.py:144)
03:10:52.159 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/assets.orbax-checkpoint-tmp-17 (2341257:atomicity.py:144)
03:10:52.159 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/params.orbax-checkpoint-tmp-18 (2341257:atomicity.py:144)
03:10:52.159 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/train_state.orbax-checkpoint-tmp-19 (2341257:atomicity.py:144)
03:10:52.172 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
03:11:22.494 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
03:11:22.514 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
03:11:22.679 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/params.orbax-checkpoint-tmp-18/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
03:12:32.983 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 71.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:12:32.985 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
03:12:32.991 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 106.5 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:12:33.007 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
03:12:33.008 [I] Finished blocking save in 100.86 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000. (2341257:async_checkpointer.py:548)
03:12:33.010 [I] Deleting Checkpoint[step=4000 | time=2025-10-31 18:51:57.589234+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
03:12:33.011 [I] [process=0][thread=MainThread][step=5000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
03:12:33.011 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
03:12:33.011 [I] {'step': 5000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761937852.1452966, 'wait_for_prev_duration_secs': 0.00016498565673828125, 'checkpointer_blocking_start_time': 1761937852.14571, 'checkpointer_blocking_duration_secs': 100.86520218849182, 'get_old_steps_start_time': 1761937953.0109293, 'get_old_steps_duration_secs': 0.00027441978454589844, 'checkpoint_manager_blocking_start_time': 1761937852.1451952, 'checkpoint_manager_blocking_duration_secs': 100.86667728424072} (2341257:standard_logger.py:34)
03:12:33.012 [I] Progress on: 5.00kit/30.0kit rate:31.5s/it remaining:218:25:49 elapsed:1:43:35 postfix:- (2341257:tqdm_logging.py:145)
03:12:33.017 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 71.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:12:33.038 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/train_state.orbax-checkpoint-tmp-19/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
03:12:43.079 [I] Progress on: 5.01kit/30.0kit rate:2.4s/it remaining:16:21:29 elapsed:1:43:45 postfix:- (2341257:tqdm_logging.py:145)
03:12:45.837 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 94.4 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:12:45.837 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
03:12:45.838 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/assets.orbax-checkpoint-tmp-17 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/assets (2341257:atomicity.py:289)
03:12:45.843 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
03:12:45.972 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/train_state.orbax-checkpoint-tmp-19 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/train_state (2341257:atomicity.py:289)
03:12:45.977 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
03:12:46.073 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/params.orbax-checkpoint-tmp-18 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/params (2341257:atomicity.py:289)
03:12:46.075 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000 (2341257:atomicity.py:289)
03:12:46.080 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000`. (2341257:atomicity.py:573)
03:12:46.080 [I] Finished asynchronous save (blocking + background) in 113.93 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000 (2341257:async_checkpointer.py:412)
03:12:46.080 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
03:12:46.080 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
03:12:46.080 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
03:12:46.517 [I] Deleted step 4000.                                                               (2341257:deleter.py:114)
03:12:46.517 [I] [process=0][thread=save_finalize][step=5000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
03:12:46.517 [I] [process=0][thread=save_finalize][step=5000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
03:12:53.322 [I] Progress on: 5.02kit/30.0kit rate:1.2s/it remaining:8:14:20 elapsed:1:43:55 postfix:- (2341257:tqdm_logging.py:145)
03:13:03.557 [I] Progress on: 5.03kit/30.0kit rate:1.1s/it remaining:7:54:19 elapsed:1:44:05 postfix:- (2341257:tqdm_logging.py:145)
03:13:13.759 [I] Progress on: 5.04kit/30.0kit rate:1.1s/it remaining:7:52:12 elapsed:1:44:16 postfix:- (2341257:tqdm_logging.py:145)
03:13:24.076 [I] Progress on: 5.05kit/30.0kit rate:1.1s/it remaining:7:53:01 elapsed:1:44:26 postfix:- (2341257:tqdm_logging.py:145)
03:13:34.494 [I] Progress on: 5.05kit/30.0kit rate:1.1s/it remaining:7:56:24 elapsed:1:44:36 postfix:- (2341257:tqdm_logging.py:145)
03:13:44.731 [I] Progress on: 5.06kit/30.0kit rate:1.1s/it remaining:7:54:43 elapsed:1:44:47 postfix:- (2341257:tqdm_logging.py:145)
03:13:54.895 [I] Progress on: 5.07kit/30.0kit rate:1.1s/it remaining:7:48:25 elapsed:1:44:57 postfix:- (2341257:tqdm_logging.py:145)
03:14:05.119 [I] Progress on: 5.08kit/30.0kit rate:1.1s/it remaining:7:52:05 elapsed:1:45:07 postfix:- (2341257:tqdm_logging.py:145)
03:14:15.288 [I] Progress on: 5.09kit/30.0kit rate:1.1s/it remaining:7:48:03 elapsed:1:45:17 postfix:- (2341257:tqdm_logging.py:145)
03:14:25.533 [I] Progress on: 5.10kit/30.0kit rate:1.1s/it remaining:7:54:09 elapsed:1:45:27 postfix:- (2341257:tqdm_logging.py:145)
Step 5100: grad_norm=0.1528, loss=0.0059, param_norm=1380.1184
03:14:35.707 [I] Progress on: 5.11kit/30.0kit rate:1.1s/it remaining:7:46:35 elapsed:1:45:38 postfix:- (2341257:tqdm_logging.py:145)
03:14:45.931 [I] Progress on: 5.12kit/30.0kit rate:1.1s/it remaining:7:51:21 elapsed:1:45:48 postfix:- (2341257:tqdm_logging.py:145)
03:14:56.101 [I] Progress on: 5.13kit/30.0kit rate:1.1s/it remaining:7:47:24 elapsed:1:45:58 postfix:- (2341257:tqdm_logging.py:145)
03:15:06.351 [I] Progress on: 5.14kit/30.0kit rate:1.1s/it remaining:7:53:16 elapsed:1:46:08 postfix:- (2341257:tqdm_logging.py:145)
03:15:16.503 [I] Progress on: 5.14kit/30.0kit rate:1.1s/it remaining:7:46:20 elapsed:1:46:18 postfix:- (2341257:tqdm_logging.py:145)
03:15:26.739 [I] Progress on: 5.15kit/30.0kit rate:1.1s/it remaining:7:50:55 elapsed:1:46:29 postfix:- (2341257:tqdm_logging.py:145)
03:15:36.907 [I] Progress on: 5.16kit/30.0kit rate:1.1s/it remaining:7:46:35 elapsed:1:46:39 postfix:- (2341257:tqdm_logging.py:145)
03:15:47.148 [I] Progress on: 5.17kit/30.0kit rate:1.1s/it remaining:7:52:32 elapsed:1:46:49 postfix:- (2341257:tqdm_logging.py:145)
03:15:57.309 [I] Progress on: 5.18kit/30.0kit rate:1.1s/it remaining:7:45:33 elapsed:1:46:59 postfix:- (2341257:tqdm_logging.py:145)
03:16:07.534 [I] Progress on: 5.19kit/30.0kit rate:1.1s/it remaining:7:49:59 elapsed:1:47:09 postfix:- (2341257:tqdm_logging.py:145)
03:16:17.702 [I] Progress on: 5.20kit/30.0kit rate:1.1s/it remaining:7:45:58 elapsed:1:47:20 postfix:- (2341257:tqdm_logging.py:145)
Step 5200: grad_norm=0.1705, loss=0.0065, param_norm=1380.1262
03:16:27.965 [I] Progress on: 5.21kit/30.0kit rate:1.1s/it remaining:7:51:09 elapsed:1:47:30 postfix:- (2341257:tqdm_logging.py:145)
03:16:38.123 [I] Progress on: 5.22kit/30.0kit rate:1.1s/it remaining:7:45:31 elapsed:1:47:40 postfix:- (2341257:tqdm_logging.py:145)
03:16:48.367 [I] Progress on: 5.23kit/30.0kit rate:1.1s/it remaining:7:49:54 elapsed:1:47:50 postfix:- (2341257:tqdm_logging.py:145)
03:16:58.537 [I] Progress on: 5.24kit/30.0kit rate:1.1s/it remaining:7:45:27 elapsed:1:48:00 postfix:- (2341257:tqdm_logging.py:145)
03:17:08.786 [I] Progress on: 5.24kit/30.0kit rate:1.1s/it remaining:7:51:32 elapsed:1:48:11 postfix:- (2341257:tqdm_logging.py:145)
03:17:18.939 [I] Progress on: 5.25kit/30.0kit rate:1.1s/it remaining:7:44:31 elapsed:1:48:21 postfix:- (2341257:tqdm_logging.py:145)
03:17:29.164 [I] Progress on: 5.26kit/30.0kit rate:1.1s/it remaining:7:48:44 elapsed:1:48:31 postfix:- (2341257:tqdm_logging.py:145)
03:17:39.348 [I] Progress on: 5.27kit/30.0kit rate:1.1s/it remaining:7:44:54 elapsed:1:48:41 postfix:- (2341257:tqdm_logging.py:145)
03:17:49.587 [I] Progress on: 5.28kit/30.0kit rate:1.1s/it remaining:7:50:22 elapsed:1:48:51 postfix:- (2341257:tqdm_logging.py:145)
03:17:59.742 [I] Progress on: 5.29kit/30.0kit rate:1.1s/it remaining:7:43:38 elapsed:1:49:02 postfix:- (2341257:tqdm_logging.py:145)
03:18:09.969 [I] Progress on: 5.30kit/30.0kit rate:1.1s/it remaining:7:48:05 elapsed:1:49:12 postfix:- (2341257:tqdm_logging.py:145)
Step 5300: grad_norm=0.1576, loss=0.0059, param_norm=1380.1340
03:18:20.170 [I] Progress on: 5.31kit/30.0kit rate:1.1s/it remaining:7:43:36 elapsed:1:49:22 postfix:- (2341257:tqdm_logging.py:145)
03:18:30.406 [I] Progress on: 5.32kit/30.0kit rate:1.1s/it remaining:7:49:33 elapsed:1:49:32 postfix:- (2341257:tqdm_logging.py:145)
03:18:40.569 [I] Progress on: 5.33kit/30.0kit rate:1.1s/it remaining:7:43:03 elapsed:1:49:42 postfix:- (2341257:tqdm_logging.py:145)
03:18:50.794 [I] Progress on: 5.33kit/30.0kit rate:1.1s/it remaining:7:47:17 elapsed:1:49:53 postfix:- (2341257:tqdm_logging.py:145)
03:19:00.975 [I] Progress on: 5.34kit/30.0kit rate:1.1s/it remaining:7:43:23 elapsed:1:50:03 postfix:- (2341257:tqdm_logging.py:145)
03:19:11.213 [I] Progress on: 5.35kit/30.0kit rate:1.1s/it remaining:7:48:54 elapsed:1:50:13 postfix:- (2341257:tqdm_logging.py:145)
03:19:21.375 [I] Progress on: 5.36kit/30.0kit rate:1.1s/it remaining:7:42:32 elapsed:1:50:23 postfix:- (2341257:tqdm_logging.py:145)
03:19:31.602 [I] Progress on: 5.37kit/30.0kit rate:1.1s/it remaining:7:46:41 elapsed:1:50:33 postfix:- (2341257:tqdm_logging.py:145)
03:19:41.770 [I] Progress on: 5.38kit/30.0kit rate:1.1s/it remaining:7:42:37 elapsed:1:50:44 postfix:- (2341257:tqdm_logging.py:145)
03:19:52.018 [I] Progress on: 5.39kit/30.0kit rate:1.1s/it remaining:7:49:10 elapsed:1:50:54 postfix:- (2341257:tqdm_logging.py:145)
03:20:02.171 [I] Progress on: 5.40kit/30.0kit rate:1.1s/it remaining:7:41:36 elapsed:1:51:04 postfix:- (2341257:tqdm_logging.py:145)
Step 5400: grad_norm=0.1495, loss=0.0058, param_norm=1380.1414
03:20:12.422 [I] Progress on: 5.41kit/30.0kit rate:1.1s/it remaining:7:45:00 elapsed:1:51:14 postfix:- (2341257:tqdm_logging.py:145)
03:20:22.592 [I] Progress on: 5.42kit/30.0kit rate:1.1s/it remaining:7:41:53 elapsed:1:51:24 postfix:- (2341257:tqdm_logging.py:145)
03:20:32.830 [I] Progress on: 5.42kit/30.0kit rate:1.1s/it remaining:7:47:32 elapsed:1:51:35 postfix:- (2341257:tqdm_logging.py:145)
03:20:42.995 [I] Progress on: 5.43kit/30.0kit rate:1.1s/it remaining:7:41:51 elapsed:1:51:45 postfix:- (2341257:tqdm_logging.py:145)
03:20:53.235 [I] Progress on: 5.44kit/30.0kit rate:1.1s/it remaining:7:45:49 elapsed:1:51:55 postfix:- (2341257:tqdm_logging.py:145)
03:21:03.402 [I] Progress on: 5.45kit/30.0kit rate:1.1s/it remaining:7:41:25 elapsed:1:52:05 postfix:- (2341257:tqdm_logging.py:145)
03:21:13.648 [I] Progress on: 5.46kit/30.0kit rate:1.1s/it remaining:7:47:16 elapsed:1:52:15 postfix:- (2341257:tqdm_logging.py:145)
03:21:23.815 [I] Progress on: 5.47kit/30.0kit rate:1.1s/it remaining:7:41:15 elapsed:1:52:26 postfix:- (2341257:tqdm_logging.py:145)
03:21:34.244 [I] Progress on: 5.48kit/30.0kit rate:1.1s/it remaining:7:46:20 elapsed:1:52:36 postfix:- (2341257:tqdm_logging.py:145)
03:21:44.446 [I] Progress on: 5.49kit/30.0kit rate:1.1s/it remaining:7:43:25 elapsed:1:52:46 postfix:- (2341257:tqdm_logging.py:145)
03:21:54.674 [I] Progress on: 5.50kit/30.0kit rate:1.1s/it remaining:7:46:06 elapsed:1:52:56 postfix:- (2341257:tqdm_logging.py:145)
Step 5500: grad_norm=0.1610, loss=0.0061, param_norm=1380.1487
03:22:04.909 [I] Progress on: 5.50kit/30.0kit rate:1.1s/it remaining:7:42:16 elapsed:1:53:07 postfix:- (2341257:tqdm_logging.py:145)
03:22:15.125 [I] Progress on: 5.51kit/30.0kit rate:1.1s/it remaining:7:42:38 elapsed:1:53:17 postfix:- (2341257:tqdm_logging.py:145)
03:22:25.320 [I] Progress on: 5.52kit/30.0kit rate:1.1s/it remaining:7:42:07 elapsed:1:53:27 postfix:- (2341257:tqdm_logging.py:145)
03:22:35.530 [I] Progress on: 5.53kit/30.0kit rate:1.1s/it remaining:7:42:46 elapsed:1:53:37 postfix:- (2341257:tqdm_logging.py:145)
03:22:45.744 [I] Progress on: 5.54kit/30.0kit rate:1.1s/it remaining:7:43:49 elapsed:1:53:48 postfix:- (2341257:tqdm_logging.py:145)
03:22:55.937 [I] Progress on: 5.55kit/30.0kit rate:1.1s/it remaining:7:42:30 elapsed:1:53:58 postfix:- (2341257:tqdm_logging.py:145)
03:23:06.145 [I] Progress on: 5.56kit/30.0kit rate:1.1s/it remaining:7:41:35 elapsed:1:54:08 postfix:- (2341257:tqdm_logging.py:145)
03:23:16.341 [I] Progress on: 5.57kit/30.0kit rate:1.1s/it remaining:7:41:26 elapsed:1:54:18 postfix:- (2341257:tqdm_logging.py:145)
03:23:26.549 [I] Progress on: 5.58kit/30.0kit rate:1.1s/it remaining:7:41:36 elapsed:1:54:28 postfix:- (2341257:tqdm_logging.py:145)
03:23:36.757 [I] Progress on: 5.59kit/30.0kit rate:1.1s/it remaining:7:41:12 elapsed:1:54:39 postfix:- (2341257:tqdm_logging.py:145)
03:23:46.964 [I] Progress on: 5.59kit/30.0kit rate:1.1s/it remaining:7:42:12 elapsed:1:54:49 postfix:- (2341257:tqdm_logging.py:145)
Step 5600: grad_norm=0.1576, loss=0.0056, param_norm=1380.1562
03:23:57.205 [I] Progress on: 5.60kit/30.0kit rate:1.1s/it remaining:7:40:00 elapsed:1:54:59 postfix:- (2341257:tqdm_logging.py:145)
03:24:07.401 [I] Progress on: 5.61kit/30.0kit rate:1.1s/it remaining:7:40:22 elapsed:1:55:09 postfix:- (2341257:tqdm_logging.py:145)
03:24:17.599 [I] Progress on: 5.62kit/30.0kit rate:1.1s/it remaining:7:40:21 elapsed:1:55:19 postfix:- (2341257:tqdm_logging.py:145)
03:24:27.812 [I] Progress on: 5.63kit/30.0kit rate:1.1s/it remaining:7:40:31 elapsed:1:55:30 postfix:- (2341257:tqdm_logging.py:145)
03:24:38.008 [I] Progress on: 5.64kit/30.0kit rate:1.1s/it remaining:7:39:55 elapsed:1:55:40 postfix:- (2341257:tqdm_logging.py:145)
03:24:48.215 [I] Progress on: 5.65kit/30.0kit rate:1.1s/it remaining:7:40:30 elapsed:1:55:50 postfix:- (2341257:tqdm_logging.py:145)
03:24:58.413 [I] Progress on: 5.66kit/30.0kit rate:1.1s/it remaining:7:39:48 elapsed:1:56:00 postfix:- (2341257:tqdm_logging.py:145)
03:25:08.608 [I] Progress on: 5.67kit/30.0kit rate:1.1s/it remaining:7:39:25 elapsed:1:56:10 postfix:- (2341257:tqdm_logging.py:145)
03:25:18.809 [I] Progress on: 5.68kit/30.0kit rate:1.1s/it remaining:7:39:52 elapsed:1:56:21 postfix:- (2341257:tqdm_logging.py:145)
03:25:29.025 [I] Progress on: 5.68kit/30.0kit rate:1.1s/it remaining:7:39:56 elapsed:1:56:31 postfix:- (2341257:tqdm_logging.py:145)
03:25:39.223 [I] Progress on: 5.69kit/30.0kit rate:1.1s/it remaining:7:39:05 elapsed:1:56:41 postfix:- (2341257:tqdm_logging.py:145)
Step 5700: grad_norm=0.1599, loss=0.0054, param_norm=1380.1635
03:25:49.481 [I] Progress on: 5.70kit/30.0kit rate:1.1s/it remaining:7:39:08 elapsed:1:56:51 postfix:- (2341257:tqdm_logging.py:145)
03:25:59.677 [I] Progress on: 5.71kit/30.0kit rate:1.1s/it remaining:7:38:35 elapsed:1:57:01 postfix:- (2341257:tqdm_logging.py:145)
03:26:09.873 [I] Progress on: 5.72kit/30.0kit rate:1.1s/it remaining:7:38:26 elapsed:1:57:12 postfix:- (2341257:tqdm_logging.py:145)
03:26:20.083 [I] Progress on: 5.73kit/30.0kit rate:1.1s/it remaining:7:38:52 elapsed:1:57:22 postfix:- (2341257:tqdm_logging.py:145)
03:26:30.277 [I] Progress on: 5.74kit/30.0kit rate:1.1s/it remaining:7:38:00 elapsed:1:57:32 postfix:- (2341257:tqdm_logging.py:145)
03:26:40.474 [I] Progress on: 5.75kit/30.0kit rate:1.1s/it remaining:7:38:00 elapsed:1:57:42 postfix:- (2341257:tqdm_logging.py:145)
03:26:50.673 [I] Progress on: 5.76kit/30.0kit rate:1.1s/it remaining:7:37:51 elapsed:1:57:52 postfix:- (2341257:tqdm_logging.py:145)
03:27:00.879 [I] Progress on: 5.77kit/30.0kit rate:1.1s/it remaining:7:37:46 elapsed:1:58:03 postfix:- (2341257:tqdm_logging.py:145)
03:27:11.073 [I] Progress on: 5.78kit/30.0kit rate:1.1s/it remaining:7:37:19 elapsed:1:58:13 postfix:- (2341257:tqdm_logging.py:145)
03:27:21.284 [I] Progress on: 5.78kit/30.0kit rate:1.1s/it remaining:7:38:36 elapsed:1:58:23 postfix:- (2341257:tqdm_logging.py:145)
03:27:31.490 [I] Progress on: 5.79kit/30.0kit rate:1.1s/it remaining:7:37:21 elapsed:1:58:33 postfix:- (2341257:tqdm_logging.py:145)
Step 5800: grad_norm=0.1550, loss=0.0059, param_norm=1380.1708
03:27:41.757 [I] Progress on: 5.80kit/30.0kit rate:1.1s/it remaining:7:36:22 elapsed:1:58:44 postfix:- (2341257:tqdm_logging.py:145)
03:27:51.953 [I] Progress on: 5.81kit/30.0kit rate:1.1s/it remaining:7:36:41 elapsed:1:58:54 postfix:- (2341257:tqdm_logging.py:145)
03:28:02.160 [I] Progress on: 5.82kit/30.0kit rate:1.1s/it remaining:7:36:55 elapsed:1:59:04 postfix:- (2341257:tqdm_logging.py:145)
03:28:12.356 [I] Progress on: 5.83kit/30.0kit rate:1.1s/it remaining:7:36:18 elapsed:1:59:14 postfix:- (2341257:tqdm_logging.py:145)
03:28:22.565 [I] Progress on: 5.84kit/30.0kit rate:1.1s/it remaining:7:37:34 elapsed:1:59:24 postfix:- (2341257:tqdm_logging.py:145)
03:28:32.759 [I] Progress on: 5.85kit/30.0kit rate:1.1s/it remaining:7:35:55 elapsed:1:59:35 postfix:- (2341257:tqdm_logging.py:145)
03:28:42.956 [I] Progress on: 5.86kit/30.0kit rate:1.1s/it remaining:7:35:52 elapsed:1:59:45 postfix:- (2341257:tqdm_logging.py:145)
03:28:53.163 [I] Progress on: 5.87kit/30.0kit rate:1.1s/it remaining:7:36:14 elapsed:1:59:55 postfix:- (2341257:tqdm_logging.py:145)
03:29:03.359 [I] Progress on: 5.87kit/30.0kit rate:1.1s/it remaining:7:35:39 elapsed:2:00:05 postfix:- (2341257:tqdm_logging.py:145)
03:29:13.554 [I] Progress on: 5.88kit/30.0kit rate:1.1s/it remaining:7:35:20 elapsed:2:00:15 postfix:- (2341257:tqdm_logging.py:145)
03:29:23.751 [I] Progress on: 5.89kit/30.0kit rate:1.1s/it remaining:7:35:15 elapsed:2:00:26 postfix:- (2341257:tqdm_logging.py:145)
Step 5900: grad_norm=0.1588, loss=0.0056, param_norm=1380.1785
03:29:34.324 [I] Progress on: 5.90kit/30.0kit rate:1.1s/it remaining:7:37:15 elapsed:2:00:36 postfix:- (2341257:tqdm_logging.py:145)
03:29:44.400 [I] Progress on: 5.91kit/30.0kit rate:1.1s/it remaining:7:34:58 elapsed:2:00:46 postfix:- (2341257:tqdm_logging.py:145)
03:29:54.596 [I] Progress on: 5.92kit/30.0kit rate:1.1s/it remaining:7:34:47 elapsed:2:00:56 postfix:- (2341257:tqdm_logging.py:145)
03:30:04.793 [I] Progress on: 5.93kit/30.0kit rate:1.1s/it remaining:7:34:31 elapsed:2:01:07 postfix:- (2341257:tqdm_logging.py:145)
03:30:14.989 [I] Progress on: 5.94kit/30.0kit rate:1.1s/it remaining:7:34:18 elapsed:2:01:17 postfix:- (2341257:tqdm_logging.py:145)
03:30:25.187 [I] Progress on: 5.95kit/30.0kit rate:1.1s/it remaining:7:34:15 elapsed:2:01:27 postfix:- (2341257:tqdm_logging.py:145)
03:30:35.395 [I] Progress on: 5.96kit/30.0kit rate:1.1s/it remaining:7:34:03 elapsed:2:01:37 postfix:- (2341257:tqdm_logging.py:145)
03:30:45.591 [I] Progress on: 5.96kit/30.0kit rate:1.1s/it remaining:7:33:54 elapsed:2:01:47 postfix:- (2341257:tqdm_logging.py:145)
03:30:55.785 [I] Progress on: 5.97kit/30.0kit rate:1.1s/it remaining:7:33:25 elapsed:2:01:58 postfix:- (2341257:tqdm_logging.py:145)
03:31:05.993 [I] Progress on: 5.98kit/30.0kit rate:1.1s/it remaining:7:33:48 elapsed:2:02:08 postfix:- (2341257:tqdm_logging.py:145)
03:31:16.187 [I] Progress on: 5.99kit/30.0kit rate:1.1s/it remaining:7:33:17 elapsed:2:02:18 postfix:- (2341257:tqdm_logging.py:145)
03:31:26.395 [I] Progress on: 6.00kit/30.0kit rate:1.1s/it remaining:7:34:07 elapsed:2:02:28 postfix:- (2341257:tqdm_logging.py:145)
Step 6000: grad_norm=0.1470, loss=0.0052, param_norm=1380.1855
03:31:27.735 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
03:31:27.735 [I] [process=0] Saving checkpoint at step 6000                                       (2341257:checkpoint_manager.py:1408)
03:31:27.735 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000. (2341257:async_checkpointer.py:439)
03:31:27.745 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20 (2341257:atomicity.py:144)
03:31:27.751 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/params.orbax-checkpoint-tmp-22 (2341257:atomicity.py:144)
03:31:27.751 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/train_state.orbax-checkpoint-tmp-23 (2341257:atomicity.py:144)
03:31:27.751 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/assets.orbax-checkpoint-tmp-21 (2341257:atomicity.py:144)
03:31:27.770 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
03:32:03.673 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
03:32:03.674 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
03:32:03.784 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/params.orbax-checkpoint-tmp-22/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
03:33:14.062 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
03:33:14.063 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 67.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:33:14.072 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 101.0 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:33:14.088 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
03:33:14.088 [I] Finished blocking save in 106.35 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000. (2341257:async_checkpointer.py:548)
03:33:14.098 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
03:33:14.098 [I] [process=0][thread=MainThread][step=6000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
03:33:14.099 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
03:33:14.101 [I] {'step': 6000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761939087.7349951, 'wait_for_prev_duration_secs': 0.00018072128295898438, 'checkpointer_blocking_start_time': 1761939087.735428, 'checkpointer_blocking_duration_secs': 106.36314058303833, 'get_old_steps_start_time': 1761939194.0985966, 'get_old_steps_duration_secs': 0.0002923011779785156, 'checkpoint_manager_blocking_start_time': 1761939087.7348888, 'checkpoint_manager_blocking_duration_secs': 106.36618447303772} (2341257:standard_logger.py:34)
03:33:14.102 [I] Progress on: 6.00kit/30.0kit rate:33.1s/it remaining:220:42:11 elapsed:2:04:16 postfix:- (2341257:tqdm_logging.py:145)
03:33:14.107 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 67.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:33:14.142 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/train_state.orbax-checkpoint-tmp-23/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
03:33:24.177 [I] Progress on: 6.01kit/30.0kit rate:2.4s/it remaining:16:09:38 elapsed:2:04:26 postfix:- (2341257:tqdm_logging.py:145)
03:33:27.409 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 89.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:33:27.409 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
03:33:27.410 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/assets.orbax-checkpoint-tmp-21 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/assets (2341257:atomicity.py:289)
03:33:27.415 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
03:33:27.531 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/train_state.orbax-checkpoint-tmp-23 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/train_state (2341257:atomicity.py:289)
03:33:27.534 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
03:33:27.599 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/params.orbax-checkpoint-tmp-22 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/params (2341257:atomicity.py:289)
03:33:27.600 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000 (2341257:atomicity.py:289)
03:33:27.604 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000`. (2341257:atomicity.py:573)
03:33:27.605 [I] Finished asynchronous save (blocking + background) in 119.87 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000 (2341257:async_checkpointer.py:412)
03:33:27.605 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
03:33:27.605 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
03:33:27.605 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
03:33:27.605 [I] [process=0][thread=save_finalize][step=6000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
03:33:27.605 [I] [process=0][thread=save_finalize][step=6000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
03:33:34.421 [I] Progress on: 6.02kit/30.0kit rate:1.2s/it remaining:7:55:32 elapsed:2:04:36 postfix:- (2341257:tqdm_logging.py:145)
03:33:44.652 [I] Progress on: 6.03kit/30.0kit rate:1.1s/it remaining:7:35:02 elapsed:2:04:46 postfix:- (2341257:tqdm_logging.py:145)
03:33:54.857 [I] Progress on: 6.04kit/30.0kit rate:1.1s/it remaining:7:33:08 elapsed:2:04:57 postfix:- (2341257:tqdm_logging.py:145)
03:34:05.041 [I] Progress on: 6.05kit/30.0kit rate:1.1s/it remaining:7:32:07 elapsed:2:05:07 postfix:- (2341257:tqdm_logging.py:145)
03:34:15.242 [I] Progress on: 6.05kit/30.0kit rate:1.1s/it remaining:7:32:15 elapsed:2:05:17 postfix:- (2341257:tqdm_logging.py:145)
03:34:25.446 [I] Progress on: 6.06kit/30.0kit rate:1.1s/it remaining:7:31:42 elapsed:2:05:27 postfix:- (2341257:tqdm_logging.py:145)
03:34:35.640 [I] Progress on: 6.07kit/30.0kit rate:1.1s/it remaining:7:31:37 elapsed:2:05:37 postfix:- (2341257:tqdm_logging.py:145)
03:34:45.835 [I] Progress on: 6.08kit/30.0kit rate:1.1s/it remaining:7:31:33 elapsed:2:05:48 postfix:- (2341257:tqdm_logging.py:145)
03:34:56.035 [I] Progress on: 6.09kit/30.0kit rate:1.1s/it remaining:7:31:24 elapsed:2:05:58 postfix:- (2341257:tqdm_logging.py:145)
03:35:06.244 [I] Progress on: 6.10kit/30.0kit rate:1.1s/it remaining:7:31:23 elapsed:2:06:08 postfix:- (2341257:tqdm_logging.py:145)
Step 6100: grad_norm=0.1480, loss=0.0054, param_norm=1380.1925
03:35:16.487 [I] Progress on: 6.11kit/30.0kit rate:1.1s/it remaining:7:31:00 elapsed:2:06:18 postfix:- (2341257:tqdm_logging.py:145)
03:35:26.693 [I] Progress on: 6.12kit/30.0kit rate:1.1s/it remaining:7:31:51 elapsed:2:06:29 postfix:- (2341257:tqdm_logging.py:145)
03:35:36.892 [I] Progress on: 6.13kit/30.0kit rate:1.1s/it remaining:7:31:03 elapsed:2:06:39 postfix:- (2341257:tqdm_logging.py:145)
03:35:47.085 [I] Progress on: 6.14kit/30.0kit rate:1.1s/it remaining:7:30:35 elapsed:2:06:49 postfix:- (2341257:tqdm_logging.py:145)
03:35:57.292 [I] Progress on: 6.14kit/30.0kit rate:1.1s/it remaining:7:30:41 elapsed:2:06:59 postfix:- (2341257:tqdm_logging.py:145)
03:36:07.491 [I] Progress on: 6.15kit/30.0kit rate:1.1s/it remaining:7:30:20 elapsed:2:07:09 postfix:- (2341257:tqdm_logging.py:145)
03:36:17.809 [I] Progress on: 6.16kit/30.0kit rate:1.1s/it remaining:7:33:29 elapsed:2:07:20 postfix:- (2341257:tqdm_logging.py:145)
03:36:28.005 [I] Progress on: 6.17kit/30.0kit rate:1.1s/it remaining:7:30:05 elapsed:2:07:30 postfix:- (2341257:tqdm_logging.py:145)
03:36:38.205 [I] Progress on: 6.18kit/30.0kit rate:1.1s/it remaining:7:29:47 elapsed:2:07:40 postfix:- (2341257:tqdm_logging.py:145)
03:36:48.406 [I] Progress on: 6.19kit/30.0kit rate:1.1s/it remaining:7:30:09 elapsed:2:07:50 postfix:- (2341257:tqdm_logging.py:145)
03:36:58.621 [I] Progress on: 6.20kit/30.0kit rate:1.1s/it remaining:7:30:04 elapsed:2:08:00 postfix:- (2341257:tqdm_logging.py:145)
Step 6200: grad_norm=0.1566, loss=0.0058, param_norm=1380.1993
03:37:08.867 [I] Progress on: 6.21kit/30.0kit rate:1.1s/it remaining:7:29:08 elapsed:2:08:11 postfix:- (2341257:tqdm_logging.py:145)
03:37:19.066 [I] Progress on: 6.22kit/30.0kit rate:1.1s/it remaining:7:28:59 elapsed:2:08:21 postfix:- (2341257:tqdm_logging.py:145)
03:37:29.268 [I] Progress on: 6.23kit/30.0kit rate:1.1s/it remaining:7:29:10 elapsed:2:08:31 postfix:- (2341257:tqdm_logging.py:145)
03:37:39.464 [I] Progress on: 6.24kit/30.0kit rate:1.1s/it remaining:7:28:32 elapsed:2:08:41 postfix:- (2341257:tqdm_logging.py:145)
03:37:49.674 [I] Progress on: 6.24kit/30.0kit rate:1.1s/it remaining:7:29:39 elapsed:2:08:51 postfix:- (2341257:tqdm_logging.py:145)
03:37:59.869 [I] Progress on: 6.25kit/30.0kit rate:1.1s/it remaining:7:28:16 elapsed:2:09:02 postfix:- (2341257:tqdm_logging.py:145)
03:38:10.078 [I] Progress on: 6.26kit/30.0kit rate:1.1s/it remaining:7:29:27 elapsed:2:09:12 postfix:- (2341257:tqdm_logging.py:145)
03:38:20.286 [I] Progress on: 6.27kit/30.0kit rate:1.1s/it remaining:7:28:17 elapsed:2:09:22 postfix:- (2341257:tqdm_logging.py:145)
03:38:30.484 [I] Progress on: 6.28kit/30.0kit rate:1.1s/it remaining:7:27:58 elapsed:2:09:32 postfix:- (2341257:tqdm_logging.py:145)
03:38:40.680 [I] Progress on: 6.29kit/30.0kit rate:1.1s/it remaining:7:27:37 elapsed:2:09:43 postfix:- (2341257:tqdm_logging.py:145)
03:38:50.888 [I] Progress on: 6.30kit/30.0kit rate:1.1s/it remaining:7:28:29 elapsed:2:09:53 postfix:- (2341257:tqdm_logging.py:145)
Step 6300: grad_norm=0.1557, loss=0.0054, param_norm=1380.2067
03:39:01.131 [I] Progress on: 6.31kit/30.0kit rate:1.1s/it remaining:7:27:16 elapsed:2:10:03 postfix:- (2341257:tqdm_logging.py:145)
03:39:11.547 [I] Progress on: 6.32kit/30.0kit rate:1.2s/it remaining:7:39:49 elapsed:2:10:13 postfix:- (2341257:tqdm_logging.py:145)
03:39:21.753 [I] Progress on: 6.33kit/30.0kit rate:1.1s/it remaining:7:27:39 elapsed:2:10:24 postfix:- (2341257:tqdm_logging.py:145)
03:39:31.951 [I] Progress on: 6.33kit/30.0kit rate:1.1s/it remaining:7:26:55 elapsed:2:10:34 postfix:- (2341257:tqdm_logging.py:145)
03:39:42.146 [I] Progress on: 6.34kit/30.0kit rate:1.1s/it remaining:7:26:37 elapsed:2:10:44 postfix:- (2341257:tqdm_logging.py:145)
03:39:52.342 [I] Progress on: 6.35kit/30.0kit rate:1.1s/it remaining:7:26:27 elapsed:2:10:54 postfix:- (2341257:tqdm_logging.py:145)
03:40:02.539 [I] Progress on: 6.36kit/30.0kit rate:1.1s/it remaining:7:26:17 elapsed:2:11:04 postfix:- (2341257:tqdm_logging.py:145)
03:40:12.734 [I] Progress on: 6.37kit/30.0kit rate:1.1s/it remaining:7:26:07 elapsed:2:11:15 postfix:- (2341257:tqdm_logging.py:145)
03:40:22.956 [I] Progress on: 6.38kit/30.0kit rate:1.1s/it remaining:7:27:38 elapsed:2:11:25 postfix:- (2341257:tqdm_logging.py:145)
03:40:33.152 [I] Progress on: 6.39kit/30.0kit rate:1.1s/it remaining:7:25:54 elapsed:2:11:35 postfix:- (2341257:tqdm_logging.py:145)
03:40:43.359 [I] Progress on: 6.40kit/30.0kit rate:1.1s/it remaining:7:26:05 elapsed:2:11:45 postfix:- (2341257:tqdm_logging.py:145)
Step 6400: grad_norm=0.1425, loss=0.0052, param_norm=1380.2137
03:40:53.604 [I] Progress on: 6.41kit/30.0kit rate:1.1s/it remaining:7:25:18 elapsed:2:11:55 postfix:- (2341257:tqdm_logging.py:145)
03:41:03.803 [I] Progress on: 6.42kit/30.0kit rate:1.1s/it remaining:7:25:43 elapsed:2:12:06 postfix:- (2341257:tqdm_logging.py:145)
03:41:14.008 [I] Progress on: 6.42kit/30.0kit rate:1.1s/it remaining:7:25:15 elapsed:2:12:16 postfix:- (2341257:tqdm_logging.py:145)
03:41:24.204 [I] Progress on: 6.43kit/30.0kit rate:1.1s/it remaining:7:24:54 elapsed:2:12:26 postfix:- (2341257:tqdm_logging.py:145)
03:41:34.403 [I] Progress on: 6.44kit/30.0kit rate:1.1s/it remaining:7:24:56 elapsed:2:12:36 postfix:- (2341257:tqdm_logging.py:145)
03:41:44.601 [I] Progress on: 6.45kit/30.0kit rate:1.1s/it remaining:7:24:35 elapsed:2:12:46 postfix:- (2341257:tqdm_logging.py:145)
03:41:54.810 [I] Progress on: 6.46kit/30.0kit rate:1.1s/it remaining:7:25:18 elapsed:2:12:57 postfix:- (2341257:tqdm_logging.py:145)
03:42:05.018 [I] Progress on: 6.47kit/30.0kit rate:1.1s/it remaining:7:24:29 elapsed:2:13:07 postfix:- (2341257:tqdm_logging.py:145)
03:42:15.214 [I] Progress on: 6.48kit/30.0kit rate:1.1s/it remaining:7:24:10 elapsed:2:13:17 postfix:- (2341257:tqdm_logging.py:145)
03:42:25.422 [I] Progress on: 6.49kit/30.0kit rate:1.1s/it remaining:7:24:07 elapsed:2:13:27 postfix:- (2341257:tqdm_logging.py:145)
03:42:35.620 [I] Progress on: 6.50kit/30.0kit rate:1.1s/it remaining:7:24:00 elapsed:2:13:37 postfix:- (2341257:tqdm_logging.py:145)
Step 6500: grad_norm=0.1451, loss=0.0053, param_norm=1380.2206
03:42:45.866 [I] Progress on: 6.50kit/30.0kit rate:1.1s/it remaining:7:23:26 elapsed:2:13:48 postfix:- (2341257:tqdm_logging.py:145)
03:42:56.072 [I] Progress on: 6.51kit/30.0kit rate:1.1s/it remaining:7:23:38 elapsed:2:13:58 postfix:- (2341257:tqdm_logging.py:145)
03:43:06.268 [I] Progress on: 6.52kit/30.0kit rate:1.1s/it remaining:7:23:13 elapsed:2:14:08 postfix:- (2341257:tqdm_logging.py:145)
03:43:16.474 [I] Progress on: 6.53kit/30.0kit rate:1.1s/it remaining:7:23:17 elapsed:2:14:18 postfix:- (2341257:tqdm_logging.py:145)
03:43:26.668 [I] Progress on: 6.54kit/30.0kit rate:1.1s/it remaining:7:22:48 elapsed:2:14:28 postfix:- (2341257:tqdm_logging.py:145)
03:43:36.871 [I] Progress on: 6.55kit/30.0kit rate:1.1s/it remaining:7:23:03 elapsed:2:14:39 postfix:- (2341257:tqdm_logging.py:145)
03:43:47.068 [I] Progress on: 6.56kit/30.0kit rate:1.1s/it remaining:7:22:38 elapsed:2:14:49 postfix:- (2341257:tqdm_logging.py:145)
03:43:57.268 [I] Progress on: 6.57kit/30.0kit rate:1.1s/it remaining:7:22:35 elapsed:2:14:59 postfix:- (2341257:tqdm_logging.py:145)
03:44:07.476 [I] Progress on: 6.58kit/30.0kit rate:1.1s/it remaining:7:22:18 elapsed:2:15:09 postfix:- (2341257:tqdm_logging.py:145)
03:44:17.674 [I] Progress on: 6.59kit/30.0kit rate:1.1s/it remaining:7:22:08 elapsed:2:15:19 postfix:- (2341257:tqdm_logging.py:145)
03:44:27.868 [I] Progress on: 6.59kit/30.0kit rate:1.1s/it remaining:7:21:49 elapsed:2:15:30 postfix:- (2341257:tqdm_logging.py:145)
Step 6600: grad_norm=0.1627, loss=0.0052, param_norm=1380.2274
03:44:38.115 [I] Progress on: 6.60kit/30.0kit rate:1.1s/it remaining:7:21:23 elapsed:2:15:40 postfix:- (2341257:tqdm_logging.py:145)
03:44:48.320 [I] Progress on: 6.61kit/30.0kit rate:1.1s/it remaining:7:21:47 elapsed:2:15:50 postfix:- (2341257:tqdm_logging.py:145)
03:44:58.517 [I] Progress on: 6.62kit/30.0kit rate:1.1s/it remaining:7:21:26 elapsed:2:16:00 postfix:- (2341257:tqdm_logging.py:145)
03:45:08.726 [I] Progress on: 6.63kit/30.0kit rate:1.1s/it remaining:7:21:34 elapsed:2:16:11 postfix:- (2341257:tqdm_logging.py:145)
03:45:18.921 [I] Progress on: 6.64kit/30.0kit rate:1.1s/it remaining:7:21:11 elapsed:2:16:21 postfix:- (2341257:tqdm_logging.py:145)
03:45:29.115 [I] Progress on: 6.65kit/30.0kit rate:1.1s/it remaining:7:20:44 elapsed:2:16:31 postfix:- (2341257:tqdm_logging.py:145)
03:45:39.326 [I] Progress on: 6.66kit/30.0kit rate:1.1s/it remaining:7:21:10 elapsed:2:16:41 postfix:- (2341257:tqdm_logging.py:145)
03:45:49.521 [I] Progress on: 6.67kit/30.0kit rate:1.1s/it remaining:7:20:34 elapsed:2:16:51 postfix:- (2341257:tqdm_logging.py:145)
03:45:59.718 [I] Progress on: 6.68kit/30.0kit rate:1.1s/it remaining:7:20:29 elapsed:2:17:02 postfix:- (2341257:tqdm_logging.py:145)
03:46:09.915 [I] Progress on: 6.68kit/30.0kit rate:1.1s/it remaining:7:20:17 elapsed:2:17:12 postfix:- (2341257:tqdm_logging.py:145)
03:46:20.123 [I] Progress on: 6.69kit/30.0kit rate:1.1s/it remaining:7:20:21 elapsed:2:17:22 postfix:- (2341257:tqdm_logging.py:145)
Step 6700: grad_norm=0.1355, loss=0.0049, param_norm=1380.2346
03:46:30.365 [I] Progress on: 6.70kit/30.0kit rate:1.1s/it remaining:7:19:04 elapsed:2:17:32 postfix:- (2341257:tqdm_logging.py:145)
03:46:40.574 [I] Progress on: 6.71kit/30.0kit rate:1.1s/it remaining:7:19:59 elapsed:2:17:42 postfix:- (2341257:tqdm_logging.py:145)
03:46:50.768 [I] Progress on: 6.72kit/30.0kit rate:1.1s/it remaining:7:19:27 elapsed:2:17:53 postfix:- (2341257:tqdm_logging.py:145)
03:47:00.977 [I] Progress on: 6.73kit/30.0kit rate:1.1s/it remaining:7:20:35 elapsed:2:18:03 postfix:- (2341257:tqdm_logging.py:145)
03:47:11.402 [I] Progress on: 6.74kit/30.0kit rate:1.2s/it remaining:7:26:10 elapsed:2:18:13 postfix:- (2341257:tqdm_logging.py:145)
03:47:21.609 [I] Progress on: 6.75kit/30.0kit rate:1.1s/it remaining:7:19:33 elapsed:2:18:23 postfix:- (2341257:tqdm_logging.py:145)
03:47:31.819 [I] Progress on: 6.76kit/30.0kit rate:1.1s/it remaining:7:19:08 elapsed:2:18:34 postfix:- (2341257:tqdm_logging.py:145)
03:47:42.015 [I] Progress on: 6.77kit/30.0kit rate:1.1s/it remaining:7:18:34 elapsed:2:18:44 postfix:- (2341257:tqdm_logging.py:145)
03:47:52.210 [I] Progress on: 6.78kit/30.0kit rate:1.1s/it remaining:7:18:28 elapsed:2:18:54 postfix:- (2341257:tqdm_logging.py:145)
03:48:02.423 [I] Progress on: 6.78kit/30.0kit rate:1.1s/it remaining:7:18:39 elapsed:2:19:04 postfix:- (2341257:tqdm_logging.py:145)
03:48:12.620 [I] Progress on: 6.79kit/30.0kit rate:1.1s/it remaining:7:18:16 elapsed:2:19:14 postfix:- (2341257:tqdm_logging.py:145)
Step 6800: grad_norm=0.1453, loss=0.0053, param_norm=1380.2416
03:48:22.864 [I] Progress on: 6.80kit/30.0kit rate:1.1s/it remaining:7:16:53 elapsed:2:19:25 postfix:- (2341257:tqdm_logging.py:145)
03:48:33.057 [I] Progress on: 6.81kit/30.0kit rate:1.1s/it remaining:7:17:37 elapsed:2:19:35 postfix:- (2341257:tqdm_logging.py:145)
03:48:43.256 [I] Progress on: 6.82kit/30.0kit rate:1.1s/it remaining:7:17:48 elapsed:2:19:45 postfix:- (2341257:tqdm_logging.py:145)
03:48:53.450 [I] Progress on: 6.83kit/30.0kit rate:1.1s/it remaining:7:17:26 elapsed:2:19:55 postfix:- (2341257:tqdm_logging.py:145)
03:49:03.648 [I] Progress on: 6.84kit/30.0kit rate:1.1s/it remaining:7:17:29 elapsed:2:20:05 postfix:- (2341257:tqdm_logging.py:145)
03:49:13.856 [I] Progress on: 6.85kit/30.0kit rate:1.1s/it remaining:7:18:44 elapsed:2:20:16 postfix:- (2341257:tqdm_logging.py:145)
03:49:24.052 [I] Progress on: 6.86kit/30.0kit rate:1.1s/it remaining:7:17:09 elapsed:2:20:26 postfix:- (2341257:tqdm_logging.py:145)
03:49:34.247 [I] Progress on: 6.87kit/30.0kit rate:1.1s/it remaining:7:16:48 elapsed:2:20:36 postfix:- (2341257:tqdm_logging.py:145)
03:49:44.457 [I] Progress on: 6.87kit/30.0kit rate:1.1s/it remaining:7:18:03 elapsed:2:20:46 postfix:- (2341257:tqdm_logging.py:145)
03:49:54.650 [I] Progress on: 6.88kit/30.0kit rate:1.1s/it remaining:7:16:19 elapsed:2:20:56 postfix:- (2341257:tqdm_logging.py:145)
03:50:04.847 [I] Progress on: 6.89kit/30.0kit rate:1.1s/it remaining:7:16:18 elapsed:2:21:07 postfix:- (2341257:tqdm_logging.py:145)
Step 6900: grad_norm=0.1421, loss=0.0047, param_norm=1380.2480
03:50:15.221 [I] Progress on: 6.90kit/30.0kit rate:1.1s/it remaining:7:17:05 elapsed:2:21:17 postfix:- (2341257:tqdm_logging.py:145)
03:50:25.300 [I] Progress on: 6.91kit/30.0kit rate:1.1s/it remaining:7:15:58 elapsed:2:21:27 postfix:- (2341257:tqdm_logging.py:145)
03:50:35.508 [I] Progress on: 6.92kit/30.0kit rate:1.1s/it remaining:7:16:24 elapsed:2:21:37 postfix:- (2341257:tqdm_logging.py:145)
03:50:45.705 [I] Progress on: 6.93kit/30.0kit rate:1.1s/it remaining:7:15:42 elapsed:2:21:48 postfix:- (2341257:tqdm_logging.py:145)
03:50:55.899 [I] Progress on: 6.94kit/30.0kit rate:1.1s/it remaining:7:15:19 elapsed:2:21:58 postfix:- (2341257:tqdm_logging.py:145)
03:51:06.109 [I] Progress on: 6.95kit/30.0kit rate:1.1s/it remaining:7:16:13 elapsed:2:22:08 postfix:- (2341257:tqdm_logging.py:145)
03:51:16.306 [I] Progress on: 6.96kit/30.0kit rate:1.1s/it remaining:7:15:08 elapsed:2:22:18 postfix:- (2341257:tqdm_logging.py:145)
03:51:26.515 [I] Progress on: 6.96kit/30.0kit rate:1.1s/it remaining:7:15:00 elapsed:2:22:28 postfix:- (2341257:tqdm_logging.py:145)
03:51:36.710 [I] Progress on: 6.97kit/30.0kit rate:1.1s/it remaining:7:14:41 elapsed:2:22:39 postfix:- (2341257:tqdm_logging.py:145)
03:51:46.919 [I] Progress on: 6.98kit/30.0kit rate:1.1s/it remaining:7:14:48 elapsed:2:22:49 postfix:- (2341257:tqdm_logging.py:145)
03:51:57.113 [I] Progress on: 6.99kit/30.0kit rate:1.1s/it remaining:7:14:19 elapsed:2:22:59 postfix:- (2341257:tqdm_logging.py:145)
03:52:07.322 [I] Progress on: 7.00kit/30.0kit rate:1.1s/it remaining:7:14:17 elapsed:2:23:09 postfix:- (2341257:tqdm_logging.py:145)
Step 7000: grad_norm=0.1428, loss=0.0051, param_norm=1380.2550
03:52:08.651 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
03:52:08.651 [I] [process=0] Saving checkpoint at step 7000                                       (2341257:checkpoint_manager.py:1408)
03:52:08.652 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000. (2341257:async_checkpointer.py:439)
03:52:08.666 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24 (2341257:atomicity.py:144)
03:52:08.673 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/train_state.orbax-checkpoint-tmp-27 (2341257:atomicity.py:144)
03:52:08.673 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (2341257:atomicity.py:144)
03:52:08.673 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (2341257:atomicity.py:144)
03:52:08.691 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
03:52:51.762 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
03:52:51.763 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
03:52:52.031 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
03:53:47.438 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
03:53:47.438 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 72.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:53:47.455 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 108.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:53:47.459 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
03:53:47.460 [I] Finished blocking save in 98.81 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000. (2341257:async_checkpointer.py:548)
03:53:47.460 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
03:53:47.461 [I] Deleting Checkpoint[step=6000 | time=2025-10-31 19:33:14.098579+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
03:53:47.461 [I] [process=0][thread=MainThread][step=7000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
03:53:47.461 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
03:53:47.461 [I] {'step': 7000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761940328.6515014, 'wait_for_prev_duration_secs': 0.00017690658569335938, 'checkpointer_blocking_start_time': 1761940328.6519604, 'checkpointer_blocking_duration_secs': 98.80895161628723, 'get_old_steps_start_time': 1761940427.46093, 'get_old_steps_duration_secs': 0.00023555755615234375, 'checkpoint_manager_blocking_start_time': 1761940328.6513965, 'checkpoint_manager_blocking_duration_secs': 98.8102867603302} (2341257:standard_logger.py:34)
03:53:47.462 [I] Progress on: 7.00kit/30.0kit rate:30.8s/it remaining:196:59:32 elapsed:2:24:49 postfix:- (2341257:tqdm_logging.py:145)
03:53:47.480 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 72.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:53:47.483 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/train_state.orbax-checkpoint-tmp-27/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
03:53:57.541 [I] Progress on: 7.01kit/30.0kit rate:2.3s/it remaining:14:53:35 elapsed:2:24:59 postfix:- (2341257:tqdm_logging.py:145)
03:54:00.736 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 95.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
03:54:00.737 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
03:54:00.738 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/assets (2341257:atomicity.py:289)
03:54:00.742 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
03:54:00.932 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/train_state.orbax-checkpoint-tmp-27 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/train_state (2341257:atomicity.py:289)
03:54:00.936 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
03:54:01.002 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/params (2341257:atomicity.py:289)
03:54:01.004 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000 (2341257:atomicity.py:289)
03:54:01.008 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000`. (2341257:atomicity.py:573)
03:54:01.008 [I] Finished asynchronous save (blocking + background) in 112.36 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000 (2341257:async_checkpointer.py:412)
03:54:01.008 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
03:54:01.008 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
03:54:01.008 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
03:54:01.410 [I] Deleted step 6000.                                                               (2341257:deleter.py:114)
03:54:01.410 [I] [process=0][thread=save_finalize][step=7000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
03:54:01.410 [I] [process=0][thread=save_finalize][step=7000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
03:54:07.784 [I] Progress on: 7.02kit/30.0kit rate:1.2s/it remaining:7:34:04 elapsed:2:25:10 postfix:- (2341257:tqdm_logging.py:145)
03:54:18.025 [I] Progress on: 7.03kit/30.0kit rate:1.1s/it remaining:7:16:11 elapsed:2:25:20 postfix:- (2341257:tqdm_logging.py:145)
03:54:28.256 [I] Progress on: 7.04kit/30.0kit rate:1.1s/it remaining:7:15:05 elapsed:2:25:30 postfix:- (2341257:tqdm_logging.py:145)
03:54:38.495 [I] Progress on: 7.05kit/30.0kit rate:1.1s/it remaining:7:15:07 elapsed:2:25:40 postfix:- (2341257:tqdm_logging.py:145)
03:54:48.731 [I] Progress on: 7.05kit/30.0kit rate:1.1s/it remaining:7:14:31 elapsed:2:25:51 postfix:- (2341257:tqdm_logging.py:145)
03:54:58.940 [I] Progress on: 7.06kit/30.0kit rate:1.1s/it remaining:7:13:20 elapsed:2:26:01 postfix:- (2341257:tqdm_logging.py:145)
03:55:09.135 [I] Progress on: 7.07kit/30.0kit rate:1.1s/it remaining:7:12:51 elapsed:2:26:11 postfix:- (2341257:tqdm_logging.py:145)
03:55:19.339 [I] Progress on: 7.08kit/30.0kit rate:1.1s/it remaining:7:13:13 elapsed:2:26:21 postfix:- (2341257:tqdm_logging.py:145)
03:55:29.534 [I] Progress on: 7.09kit/30.0kit rate:1.1s/it remaining:7:12:31 elapsed:2:26:31 postfix:- (2341257:tqdm_logging.py:145)
03:55:39.743 [I] Progress on: 7.10kit/30.0kit rate:1.1s/it remaining:7:12:52 elapsed:2:26:42 postfix:- (2341257:tqdm_logging.py:145)
Step 7100: grad_norm=0.1477, loss=0.0052, param_norm=1380.2618
03:55:49.985 [I] Progress on: 7.11kit/30.0kit rate:1.1s/it remaining:7:12:09 elapsed:2:26:52 postfix:- (2341257:tqdm_logging.py:145)
03:56:00.182 [I] Progress on: 7.12kit/30.0kit rate:1.1s/it remaining:7:12:19 elapsed:2:27:02 postfix:- (2341257:tqdm_logging.py:145)
03:56:10.376 [I] Progress on: 7.13kit/30.0kit rate:1.1s/it remaining:7:11:53 elapsed:2:27:12 postfix:- (2341257:tqdm_logging.py:145)
03:56:20.572 [I] Progress on: 7.14kit/30.0kit rate:1.1s/it remaining:7:11:48 elapsed:2:27:22 postfix:- (2341257:tqdm_logging.py:145)
03:56:30.766 [I] Progress on: 7.14kit/30.0kit rate:1.1s/it remaining:7:11:27 elapsed:2:27:33 postfix:- (2341257:tqdm_logging.py:145)
03:56:40.962 [I] Progress on: 7.15kit/30.0kit rate:1.1s/it remaining:7:11:10 elapsed:2:27:43 postfix:- (2341257:tqdm_logging.py:145)
03:56:51.407 [I] Progress on: 7.16kit/30.0kit rate:1.1s/it remaining:7:14:29 elapsed:2:27:53 postfix:- (2341257:tqdm_logging.py:145)
03:57:01.604 [I] Progress on: 7.17kit/30.0kit rate:1.1s/it remaining:7:11:12 elapsed:2:28:03 postfix:- (2341257:tqdm_logging.py:145)
03:57:11.800 [I] Progress on: 7.18kit/30.0kit rate:1.1s/it remaining:7:10:54 elapsed:2:28:14 postfix:- (2341257:tqdm_logging.py:145)
03:57:22.004 [I] Progress on: 7.19kit/30.0kit rate:1.1s/it remaining:7:10:59 elapsed:2:28:24 postfix:- (2341257:tqdm_logging.py:145)
03:57:32.200 [I] Progress on: 7.20kit/30.0kit rate:1.1s/it remaining:7:10:29 elapsed:2:28:34 postfix:- (2341257:tqdm_logging.py:145)
Step 7200: grad_norm=0.1563, loss=0.0054, param_norm=1380.2684
03:57:42.444 [I] Progress on: 7.21kit/30.0kit rate:1.1s/it remaining:7:10:02 elapsed:2:28:44 postfix:- (2341257:tqdm_logging.py:145)
03:57:52.639 [I] Progress on: 7.22kit/30.0kit rate:1.1s/it remaining:7:10:08 elapsed:2:28:54 postfix:- (2341257:tqdm_logging.py:145)
03:58:02.835 [I] Progress on: 7.23kit/30.0kit rate:1.1s/it remaining:7:09:59 elapsed:2:29:05 postfix:- (2341257:tqdm_logging.py:145)
03:58:13.030 [I] Progress on: 7.24kit/30.0kit rate:1.1s/it remaining:7:09:48 elapsed:2:29:15 postfix:- (2341257:tqdm_logging.py:145)
03:58:23.246 [I] Progress on: 7.24kit/30.0kit rate:1.1s/it remaining:7:11:08 elapsed:2:29:25 postfix:- (2341257:tqdm_logging.py:145)
03:58:33.443 [I] Progress on: 7.25kit/30.0kit rate:1.1s/it remaining:7:09:36 elapsed:2:29:35 postfix:- (2341257:tqdm_logging.py:145)
03:58:43.783 [I] Progress on: 7.26kit/30.0kit rate:1.1s/it remaining:7:11:15 elapsed:2:29:46 postfix:- (2341257:tqdm_logging.py:145)
03:58:53.980 [I] Progress on: 7.27kit/30.0kit rate:1.1s/it remaining:7:09:14 elapsed:2:29:56 postfix:- (2341257:tqdm_logging.py:145)
03:59:04.186 [I] Progress on: 7.28kit/30.0kit rate:1.1s/it remaining:7:09:16 elapsed:2:30:06 postfix:- (2341257:tqdm_logging.py:145)
03:59:14.382 [I] Progress on: 7.29kit/30.0kit rate:1.1s/it remaining:7:08:50 elapsed:2:30:16 postfix:- (2341257:tqdm_logging.py:145)
03:59:24.590 [I] Progress on: 7.30kit/30.0kit rate:1.1s/it remaining:7:09:39 elapsed:2:30:26 postfix:- (2341257:tqdm_logging.py:145)
Step 7300: grad_norm=0.1413, loss=0.0047, param_norm=1380.2753
03:59:34.833 [I] Progress on: 7.31kit/30.0kit rate:1.1s/it remaining:7:08:21 elapsed:2:30:37 postfix:- (2341257:tqdm_logging.py:145)
03:59:45.029 [I] Progress on: 7.32kit/30.0kit rate:1.1s/it remaining:7:08:09 elapsed:2:30:47 postfix:- (2341257:tqdm_logging.py:145)
03:59:55.237 [I] Progress on: 7.33kit/30.0kit rate:1.1s/it remaining:7:08:18 elapsed:2:30:57 postfix:- (2341257:tqdm_logging.py:145)
04:00:05.434 [I] Progress on: 7.33kit/30.0kit rate:1.1s/it remaining:7:08:00 elapsed:2:31:07 postfix:- (2341257:tqdm_logging.py:145)
04:00:15.630 [I] Progress on: 7.34kit/30.0kit rate:1.1s/it remaining:7:07:51 elapsed:2:31:17 postfix:- (2341257:tqdm_logging.py:145)
04:00:25.829 [I] Progress on: 7.35kit/30.0kit rate:1.1s/it remaining:7:07:34 elapsed:2:31:28 postfix:- (2341257:tqdm_logging.py:145)
04:00:36.031 [I] Progress on: 7.36kit/30.0kit rate:1.1s/it remaining:7:07:34 elapsed:2:31:38 postfix:- (2341257:tqdm_logging.py:145)
04:00:46.230 [I] Progress on: 7.37kit/30.0kit rate:1.1s/it remaining:7:07:12 elapsed:2:31:48 postfix:- (2341257:tqdm_logging.py:145)
04:00:56.435 [I] Progress on: 7.38kit/30.0kit rate:1.1s/it remaining:7:07:18 elapsed:2:31:58 postfix:- (2341257:tqdm_logging.py:145)
04:01:06.630 [I] Progress on: 7.39kit/30.0kit rate:1.1s/it remaining:7:06:53 elapsed:2:32:08 postfix:- (2341257:tqdm_logging.py:145)
04:01:16.846 [I] Progress on: 7.40kit/30.0kit rate:1.1s/it remaining:7:08:10 elapsed:2:32:19 postfix:- (2341257:tqdm_logging.py:145)
Step 7400: grad_norm=0.1398, loss=0.0050, param_norm=1380.2821
04:01:27.099 [I] Progress on: 7.41kit/30.0kit rate:1.1s/it remaining:7:07:06 elapsed:2:32:29 postfix:- (2341257:tqdm_logging.py:145)
04:01:37.313 [I] Progress on: 7.42kit/30.0kit rate:1.1s/it remaining:7:06:42 elapsed:2:32:39 postfix:- (2341257:tqdm_logging.py:145)
04:01:47.510 [I] Progress on: 7.42kit/30.0kit rate:1.1s/it remaining:7:06:17 elapsed:2:32:49 postfix:- (2341257:tqdm_logging.py:145)
04:01:57.706 [I] Progress on: 7.43kit/30.0kit rate:1.1s/it remaining:7:06:05 elapsed:2:33:00 postfix:- (2341257:tqdm_logging.py:145)
04:02:07.903 [I] Progress on: 7.44kit/30.0kit rate:1.1s/it remaining:7:05:54 elapsed:2:33:10 postfix:- (2341257:tqdm_logging.py:145)
04:02:18.100 [I] Progress on: 7.45kit/30.0kit rate:1.1s/it remaining:7:05:48 elapsed:2:33:20 postfix:- (2341257:tqdm_logging.py:145)
04:02:28.296 [I] Progress on: 7.46kit/30.0kit rate:1.1s/it remaining:7:05:27 elapsed:2:33:30 postfix:- (2341257:tqdm_logging.py:145)
04:02:38.498 [I] Progress on: 7.47kit/30.0kit rate:1.1s/it remaining:7:05:31 elapsed:2:33:40 postfix:- (2341257:tqdm_logging.py:145)
04:02:48.699 [I] Progress on: 7.48kit/30.0kit rate:1.1s/it remaining:7:05:44 elapsed:2:33:51 postfix:- (2341257:tqdm_logging.py:145)
04:02:58.904 [I] Progress on: 7.49kit/30.0kit rate:1.1s/it remaining:7:05:12 elapsed:2:34:01 postfix:- (2341257:tqdm_logging.py:145)
04:03:09.099 [I] Progress on: 7.50kit/30.0kit rate:1.1s/it remaining:7:04:50 elapsed:2:34:11 postfix:- (2341257:tqdm_logging.py:145)
Step 7500: grad_norm=0.1443, loss=0.0052, param_norm=1380.2887
04:03:19.344 [I] Progress on: 7.50kit/30.0kit rate:1.1s/it remaining:7:04:25 elapsed:2:34:21 postfix:- (2341257:tqdm_logging.py:145)
04:03:29.540 [I] Progress on: 7.51kit/30.0kit rate:1.1s/it remaining:7:04:31 elapsed:2:34:31 postfix:- (2341257:tqdm_logging.py:145)
04:03:39.748 [I] Progress on: 7.52kit/30.0kit rate:1.1s/it remaining:7:04:51 elapsed:2:34:42 postfix:- (2341257:tqdm_logging.py:145)
04:03:49.955 [I] Progress on: 7.53kit/30.0kit rate:1.1s/it remaining:7:04:38 elapsed:2:34:52 postfix:- (2341257:tqdm_logging.py:145)
04:04:00.154 [I] Progress on: 7.54kit/30.0kit rate:1.1s/it remaining:7:04:25 elapsed:2:35:02 postfix:- (2341257:tqdm_logging.py:145)
04:04:10.347 [I] Progress on: 7.55kit/30.0kit rate:1.1s/it remaining:7:03:50 elapsed:2:35:12 postfix:- (2341257:tqdm_logging.py:145)
04:04:20.554 [I] Progress on: 7.56kit/30.0kit rate:1.1s/it remaining:7:04:57 elapsed:2:35:22 postfix:- (2341257:tqdm_logging.py:145)
04:04:30.751 [I] Progress on: 7.57kit/30.0kit rate:1.1s/it remaining:7:03:36 elapsed:2:35:33 postfix:- (2341257:tqdm_logging.py:145)
04:04:40.948 [I] Progress on: 7.58kit/30.0kit rate:1.1s/it remaining:7:03:43 elapsed:2:35:43 postfix:- (2341257:tqdm_logging.py:145)
04:04:51.385 [I] Progress on: 7.59kit/30.0kit rate:1.1s/it remaining:7:06:36 elapsed:2:35:53 postfix:- (2341257:tqdm_logging.py:145)
04:05:01.555 [I] Progress on: 7.59kit/30.0kit rate:1.1s/it remaining:7:01:02 elapsed:2:36:03 postfix:- (2341257:tqdm_logging.py:145)
Step 7600: grad_norm=0.1410, loss=0.0048, param_norm=1380.2953
04:05:11.819 [I] Progress on: 7.60kit/30.0kit rate:1.1s/it remaining:7:04:21 elapsed:2:36:14 postfix:- (2341257:tqdm_logging.py:145)
04:05:21.977 [I] Progress on: 7.61kit/30.0kit rate:1.1s/it remaining:7:00:10 elapsed:2:36:24 postfix:- (2341257:tqdm_logging.py:145)
04:05:32.205 [I] Progress on: 7.62kit/30.0kit rate:1.1s/it remaining:7:04:03 elapsed:2:36:34 postfix:- (2341257:tqdm_logging.py:145)
04:05:42.382 [I] Progress on: 7.63kit/30.0kit rate:1.1s/it remaining:7:00:50 elapsed:2:36:44 postfix:- (2341257:tqdm_logging.py:145)
04:05:52.620 [I] Progress on: 7.64kit/30.0kit rate:1.1s/it remaining:7:05:25 elapsed:2:36:54 postfix:- (2341257:tqdm_logging.py:145)
04:06:02.780 [I] Progress on: 7.65kit/30.0kit rate:1.1s/it remaining:6:59:54 elapsed:2:37:05 postfix:- (2341257:tqdm_logging.py:145)
04:06:13.006 [I] Progress on: 7.66kit/30.0kit rate:1.1s/it remaining:7:03:19 elapsed:2:37:15 postfix:- (2341257:tqdm_logging.py:145)
04:06:23.175 [I] Progress on: 7.67kit/30.0kit rate:1.1s/it remaining:6:59:38 elapsed:2:37:25 postfix:- (2341257:tqdm_logging.py:145)
04:06:33.418 [I] Progress on: 7.68kit/30.0kit rate:1.1s/it remaining:7:04:51 elapsed:2:37:35 postfix:- (2341257:tqdm_logging.py:145)
04:06:43.574 [I] Progress on: 7.68kit/30.0kit rate:1.1s/it remaining:6:59:02 elapsed:2:37:45 postfix:- (2341257:tqdm_logging.py:145)
04:06:53.808 [I] Progress on: 7.69kit/30.0kit rate:1.1s/it remaining:7:02:45 elapsed:2:37:56 postfix:- (2341257:tqdm_logging.py:145)
Step 7700: grad_norm=0.1349, loss=0.0048, param_norm=1380.3014
04:07:03.992 [I] Progress on: 7.70kit/30.0kit rate:1.1s/it remaining:6:55:43 elapsed:2:38:06 postfix:- (2341257:tqdm_logging.py:145)
04:07:14.233 [I] Progress on: 7.71kit/30.0kit rate:1.1s/it remaining:7:04:10 elapsed:2:38:16 postfix:- (2341257:tqdm_logging.py:145)
04:07:24.383 [I] Progress on: 7.72kit/30.0kit rate:1.1s/it remaining:6:58:00 elapsed:2:38:26 postfix:- (2341257:tqdm_logging.py:145)
04:07:34.608 [I] Progress on: 7.73kit/30.0kit rate:1.1s/it remaining:7:01:53 elapsed:2:38:36 postfix:- (2341257:tqdm_logging.py:145)
04:07:44.777 [I] Progress on: 7.74kit/30.0kit rate:1.1s/it remaining:6:58:10 elapsed:2:38:47 postfix:- (2341257:tqdm_logging.py:145)
04:07:55.016 [I] Progress on: 7.75kit/30.0kit rate:1.1s/it remaining:7:03:24 elapsed:2:38:57 postfix:- (2341257:tqdm_logging.py:145)
04:08:05.181 [I] Progress on: 7.76kit/30.0kit rate:1.1s/it remaining:6:57:39 elapsed:2:39:07 postfix:- (2341257:tqdm_logging.py:145)
04:08:15.417 [I] Progress on: 7.77kit/30.0kit rate:1.1s/it remaining:7:01:26 elapsed:2:39:17 postfix:- (2341257:tqdm_logging.py:145)
04:08:25.597 [I] Progress on: 7.78kit/30.0kit rate:1.1s/it remaining:6:57:42 elapsed:2:39:27 postfix:- (2341257:tqdm_logging.py:145)
04:08:35.836 [I] Progress on: 7.78kit/30.0kit rate:1.1s/it remaining:7:02:44 elapsed:2:39:38 postfix:- (2341257:tqdm_logging.py:145)
04:08:45.986 [I] Progress on: 7.79kit/30.0kit rate:1.1s/it remaining:6:56:32 elapsed:2:39:48 postfix:- (2341257:tqdm_logging.py:145)
Step 7800: grad_norm=0.1369, loss=0.0049, param_norm=1380.3081
04:08:56.251 [I] Progress on: 7.80kit/30.0kit rate:1.1s/it remaining:6:57:00 elapsed:2:39:58 postfix:- (2341257:tqdm_logging.py:145)
04:09:06.434 [I] Progress on: 7.81kit/30.0kit rate:1.1s/it remaining:6:57:29 elapsed:2:40:08 postfix:- (2341257:tqdm_logging.py:145)
04:09:16.669 [I] Progress on: 7.82kit/30.0kit rate:1.1s/it remaining:7:01:59 elapsed:2:40:18 postfix:- (2341257:tqdm_logging.py:145)
04:09:26.823 [I] Progress on: 7.83kit/30.0kit rate:1.1s/it remaining:6:56:05 elapsed:2:40:29 postfix:- (2341257:tqdm_logging.py:145)
04:09:37.048 [I] Progress on: 7.84kit/30.0kit rate:1.1s/it remaining:6:59:44 elapsed:2:40:39 postfix:- (2341257:tqdm_logging.py:145)
04:09:47.218 [I] Progress on: 7.85kit/30.0kit rate:1.1s/it remaining:6:56:09 elapsed:2:40:49 postfix:- (2341257:tqdm_logging.py:145)
04:09:57.455 [I] Progress on: 7.86kit/30.0kit rate:1.1s/it remaining:7:01:16 elapsed:2:40:59 postfix:- (2341257:tqdm_logging.py:145)
04:10:07.607 [I] Progress on: 7.87kit/30.0kit rate:1.1s/it remaining:6:55:15 elapsed:2:41:09 postfix:- (2341257:tqdm_logging.py:145)
04:10:17.837 [I] Progress on: 7.87kit/30.0kit rate:1.1s/it remaining:6:59:29 elapsed:2:41:20 postfix:- (2341257:tqdm_logging.py:145)
04:10:28.029 [I] Progress on: 7.88kit/30.0kit rate:1.1s/it remaining:6:57:09 elapsed:2:41:30 postfix:- (2341257:tqdm_logging.py:145)
04:10:38.266 [I] Progress on: 7.89kit/30.0kit rate:1.1s/it remaining:7:00:39 elapsed:2:41:40 postfix:- (2341257:tqdm_logging.py:145)
Step 7900: grad_norm=0.1440, loss=0.0046, param_norm=1380.3143
04:10:48.605 [I] Progress on: 7.90kit/30.0kit rate:1.1s/it remaining:7:00:29 elapsed:2:41:50 postfix:- (2341257:tqdm_logging.py:145)
04:10:58.680 [I] Progress on: 7.91kit/30.0kit rate:1.1s/it remaining:6:59:28 elapsed:2:42:01 postfix:- (2341257:tqdm_logging.py:145)
04:11:08.860 [I] Progress on: 7.92kit/30.0kit rate:1.1s/it remaining:6:55:06 elapsed:2:42:11 postfix:- (2341257:tqdm_logging.py:145)
04:11:19.109 [I] Progress on: 7.93kit/30.0kit rate:1.1s/it remaining:7:00:49 elapsed:2:42:21 postfix:- (2341257:tqdm_logging.py:145)
04:11:29.261 [I] Progress on: 7.94kit/30.0kit rate:1.1s/it remaining:6:53:47 elapsed:2:42:31 postfix:- (2341257:tqdm_logging.py:145)
04:11:39.487 [I] Progress on: 7.95kit/30.0kit rate:1.1s/it remaining:6:57:50 elapsed:2:42:41 postfix:- (2341257:tqdm_logging.py:145)
04:11:49.655 [I] Progress on: 7.96kit/30.0kit rate:1.1s/it remaining:6:54:09 elapsed:2:42:51 postfix:- (2341257:tqdm_logging.py:145)
04:11:59.904 [I] Progress on: 7.96kit/30.0kit rate:1.1s/it remaining:6:59:54 elapsed:2:43:02 postfix:- (2341257:tqdm_logging.py:145)
04:12:10.055 [I] Progress on: 7.97kit/30.0kit rate:1.1s/it remaining:6:53:07 elapsed:2:43:12 postfix:- (2341257:tqdm_logging.py:145)
04:12:20.298 [I] Progress on: 7.98kit/30.0kit rate:1.1s/it remaining:6:57:19 elapsed:2:43:22 postfix:- (2341257:tqdm_logging.py:145)
04:12:30.484 [I] Progress on: 7.99kit/30.0kit rate:1.1s/it remaining:6:54:46 elapsed:2:43:32 postfix:- (2341257:tqdm_logging.py:145)
04:12:40.932 [I] Progress on: 8.00kit/30.0kit rate:1.2s/it remaining:7:07:13 elapsed:2:43:43 postfix:- (2341257:tqdm_logging.py:145)
Step 8000: grad_norm=0.1511, loss=0.0046, param_norm=1380.3208
04:12:42.291 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
04:12:42.291 [I] [process=0] Saving checkpoint at step 8000                                       (2341257:checkpoint_manager.py:1408)
04:12:42.292 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000. (2341257:async_checkpointer.py:439)
04:12:42.300 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28 (2341257:atomicity.py:144)
04:12:42.307 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/params.orbax-checkpoint-tmp-30 (2341257:atomicity.py:144)
04:12:42.307 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/train_state.orbax-checkpoint-tmp-31 (2341257:atomicity.py:144)
04:12:42.307 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/assets.orbax-checkpoint-tmp-29 (2341257:atomicity.py:144)
04:12:42.319 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
04:13:09.659 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
04:13:09.660 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
04:13:09.776 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/params.orbax-checkpoint-tmp-30/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
04:14:16.956 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
04:14:16.956 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 75.7 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:14:16.964 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 113.4 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:14:16.977 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
04:14:16.978 [I] Finished blocking save in 94.69 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000. (2341257:async_checkpointer.py:548)
04:14:16.978 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
04:14:16.979 [I] Deleting Checkpoint[step=7000 | time=2025-10-31 19:53:47.460918+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
04:14:16.979 [I] [process=0][thread=MainThread][step=8000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
04:14:16.981 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
04:14:16.981 [I] {'step': 8000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761941562.2915766, 'wait_for_prev_duration_secs': 0.00022029876708984375, 'checkpointer_blocking_start_time': 1761941562.2920635, 'checkpointer_blocking_duration_secs': 94.68686985969543, 'get_old_steps_start_time': 1761941656.9789498, 'get_old_steps_duration_secs': 0.00016450881958007812, 'checkpoint_manager_blocking_start_time': 1761941562.2914658, 'checkpoint_manager_blocking_duration_secs': 94.68987393379211} (2341257:standard_logger.py:34)
04:14:16.981 [I] Progress on: 8.00kit/30.0kit rate:29.6s/it remaining:181:04:00 elapsed:2:45:19 postfix:- (2341257:tqdm_logging.py:145)
04:14:17.007 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 75.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:14:17.044 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/train_state.orbax-checkpoint-tmp-31/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
04:14:27.032 [I] Progress on: 8.01kit/30.0kit rate:2.3s/it remaining:13:54:34 elapsed:2:45:29 postfix:- (2341257:tqdm_logging.py:145)
04:14:30.303 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 99.4 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:14:30.303 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
04:14:30.304 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/assets.orbax-checkpoint-tmp-29 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/assets (2341257:atomicity.py:289)
04:14:30.309 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
04:14:30.420 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/train_state.orbax-checkpoint-tmp-31 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/train_state (2341257:atomicity.py:289)
04:14:30.424 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
04:14:30.489 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/params.orbax-checkpoint-tmp-30 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/params (2341257:atomicity.py:289)
04:14:30.490 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000 (2341257:atomicity.py:289)
04:14:30.495 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000`. (2341257:atomicity.py:573)
04:14:30.495 [I] Finished asynchronous save (blocking + background) in 108.20 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000 (2341257:async_checkpointer.py:412)
04:14:30.495 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
04:14:30.495 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
04:14:30.495 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
04:14:30.927 [I] Deleted step 7000.                                                               (2341257:deleter.py:114)
04:14:30.927 [I] [process=0][thread=save_finalize][step=8000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
04:14:30.928 [I] [process=0][thread=save_finalize][step=8000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
04:14:37.314 [I] Progress on: 8.02kit/30.0kit rate:1.2s/it remaining:7:16:33 elapsed:2:45:39 postfix:- (2341257:tqdm_logging.py:145)
04:14:47.488 [I] Progress on: 8.03kit/30.0kit rate:1.1s/it remaining:6:53:29 elapsed:2:45:49 postfix:- (2341257:tqdm_logging.py:145)
04:14:57.722 [I] Progress on: 8.04kit/30.0kit rate:1.1s/it remaining:6:56:58 elapsed:2:46:00 postfix:- (2341257:tqdm_logging.py:145)
04:15:07.884 [I] Progress on: 8.05kit/30.0kit rate:1.1s/it remaining:6:52:30 elapsed:2:46:10 postfix:- (2341257:tqdm_logging.py:145)
04:15:18.125 [I] Progress on: 8.05kit/30.0kit rate:1.1s/it remaining:6:57:49 elapsed:2:46:20 postfix:- (2341257:tqdm_logging.py:145)
04:15:28.283 [I] Progress on: 8.06kit/30.0kit rate:1.1s/it remaining:6:51:55 elapsed:2:46:30 postfix:- (2341257:tqdm_logging.py:145)
04:15:38.509 [I] Progress on: 8.07kit/30.0kit rate:1.1s/it remaining:6:55:26 elapsed:2:46:40 postfix:- (2341257:tqdm_logging.py:145)
04:15:48.674 [I] Progress on: 8.08kit/30.0kit rate:1.1s/it remaining:6:51:46 elapsed:2:46:50 postfix:- (2341257:tqdm_logging.py:145)
04:15:58.914 [I] Progress on: 8.09kit/30.0kit rate:1.1s/it remaining:6:56:54 elapsed:2:47:01 postfix:- (2341257:tqdm_logging.py:145)
04:16:09.072 [I] Progress on: 8.10kit/30.0kit rate:1.1s/it remaining:6:51:23 elapsed:2:47:11 postfix:- (2341257:tqdm_logging.py:145)
Step 8100: grad_norm=0.2334, loss=0.0058, param_norm=1380.3278
04:16:19.353 [I] Progress on: 8.11kit/30.0kit rate:1.1s/it remaining:6:54:49 elapsed:2:47:21 postfix:- (2341257:tqdm_logging.py:145)
04:16:29.521 [I] Progress on: 8.12kit/30.0kit rate:1.1s/it remaining:6:51:10 elapsed:2:47:31 postfix:- (2341257:tqdm_logging.py:145)
04:16:39.759 [I] Progress on: 8.13kit/30.0kit rate:1.1s/it remaining:6:56:13 elapsed:2:47:42 postfix:- (2341257:tqdm_logging.py:145)
04:16:49.911 [I] Progress on: 8.14kit/30.0kit rate:1.1s/it remaining:6:50:10 elapsed:2:47:52 postfix:- (2341257:tqdm_logging.py:145)
04:17:00.136 [I] Progress on: 8.14kit/30.0kit rate:1.1s/it remaining:6:53:57 elapsed:2:48:02 postfix:- (2341257:tqdm_logging.py:145)
04:17:10.306 [I] Progress on: 8.15kit/30.0kit rate:1.1s/it remaining:6:50:33 elapsed:2:48:12 postfix:- (2341257:tqdm_logging.py:145)
04:17:20.547 [I] Progress on: 8.16kit/30.0kit rate:1.1s/it remaining:6:55:40 elapsed:2:48:22 postfix:- (2341257:tqdm_logging.py:145)
04:17:30.720 [I] Progress on: 8.17kit/30.0kit rate:1.1s/it remaining:6:50:02 elapsed:2:48:33 postfix:- (2341257:tqdm_logging.py:145)
04:17:40.975 [I] Progress on: 8.18kit/30.0kit rate:1.1s/it remaining:6:55:22 elapsed:2:48:43 postfix:- (2341257:tqdm_logging.py:145)
04:17:51.140 [I] Progress on: 8.19kit/30.0kit rate:1.1s/it remaining:6:49:57 elapsed:2:48:53 postfix:- (2341257:tqdm_logging.py:145)
04:18:01.382 [I] Progress on: 8.20kit/30.0kit rate:1.1s/it remaining:6:55:03 elapsed:2:49:03 postfix:- (2341257:tqdm_logging.py:145)
Step 8200: grad_norm=0.1362, loss=0.0044, param_norm=1380.3344
04:18:11.587 [I] Progress on: 8.21kit/30.0kit rate:1.1s/it remaining:6:48:51 elapsed:2:49:13 postfix:- (2341257:tqdm_logging.py:145)
04:18:21.811 [I] Progress on: 8.22kit/30.0kit rate:1.1s/it remaining:6:52:34 elapsed:2:49:24 postfix:- (2341257:tqdm_logging.py:145)
04:18:31.990 [I] Progress on: 8.23kit/30.0kit rate:1.1s/it remaining:6:49:38 elapsed:2:49:34 postfix:- (2341257:tqdm_logging.py:145)
04:18:42.228 [I] Progress on: 8.23kit/30.0kit rate:1.1s/it remaining:6:54:07 elapsed:2:49:44 postfix:- (2341257:tqdm_logging.py:145)
04:18:52.390 [I] Progress on: 8.24kit/30.0kit rate:1.1s/it remaining:6:48:13 elapsed:2:49:54 postfix:- (2341257:tqdm_logging.py:145)
04:19:02.630 [I] Progress on: 8.25kit/30.0kit rate:1.1s/it remaining:6:52:45 elapsed:2:50:04 postfix:- (2341257:tqdm_logging.py:145)
04:19:12.801 [I] Progress on: 8.26kit/30.0kit rate:1.1s/it remaining:6:48:33 elapsed:2:50:15 postfix:- (2341257:tqdm_logging.py:145)
04:19:23.040 [I] Progress on: 8.27kit/30.0kit rate:1.1s/it remaining:6:53:31 elapsed:2:50:25 postfix:- (2341257:tqdm_logging.py:145)
04:19:33.192 [I] Progress on: 8.28kit/30.0kit rate:1.1s/it remaining:6:47:32 elapsed:2:50:35 postfix:- (2341257:tqdm_logging.py:145)
04:19:43.423 [I] Progress on: 8.29kit/30.0kit rate:1.1s/it remaining:6:51:50 elapsed:2:50:45 postfix:- (2341257:tqdm_logging.py:145)
04:19:53.587 [I] Progress on: 8.30kit/30.0kit rate:1.1s/it remaining:6:47:46 elapsed:2:50:55 postfix:- (2341257:tqdm_logging.py:145)
Step 8300: grad_norm=0.1427, loss=0.0045, param_norm=1380.3403
04:20:03.884 [I] Progress on: 8.31kit/30.0kit rate:1.1s/it remaining:6:52:46 elapsed:2:51:06 postfix:- (2341257:tqdm_logging.py:145)
04:20:14.035 [I] Progress on: 8.32kit/30.0kit rate:1.1s/it remaining:6:46:50 elapsed:2:51:16 postfix:- (2341257:tqdm_logging.py:145)
04:20:24.265 [I] Progress on: 8.32kit/30.0kit rate:1.1s/it remaining:6:50:41 elapsed:2:51:26 postfix:- (2341257:tqdm_logging.py:145)
04:20:34.447 [I] Progress on: 8.33kit/30.0kit rate:1.1s/it remaining:6:48:20 elapsed:2:51:36 postfix:- (2341257:tqdm_logging.py:145)
04:20:44.687 [I] Progress on: 8.34kit/30.0kit rate:1.1s/it remaining:6:52:16 elapsed:2:51:47 postfix:- (2341257:tqdm_logging.py:145)
04:20:54.836 [I] Progress on: 8.35kit/30.0kit rate:1.1s/it remaining:6:46:07 elapsed:2:51:57 postfix:- (2341257:tqdm_logging.py:145)
04:21:05.074 [I] Progress on: 8.36kit/30.0kit rate:1.1s/it remaining:6:50:48 elapsed:2:52:07 postfix:- (2341257:tqdm_logging.py:145)
04:21:15.386 [I] Progress on: 8.37kit/30.0kit rate:1.1s/it remaining:6:47:25 elapsed:2:52:17 postfix:- (2341257:tqdm_logging.py:145)
04:21:25.622 [I] Progress on: 8.38kit/30.0kit rate:1.1s/it remaining:6:51:20 elapsed:2:52:27 postfix:- (2341257:tqdm_logging.py:145)
04:21:35.787 [I] Progress on: 8.39kit/30.0kit rate:1.1s/it remaining:6:45:58 elapsed:2:52:38 postfix:- (2341257:tqdm_logging.py:145)
04:21:46.011 [I] Progress on: 8.40kit/30.0kit rate:1.1s/it remaining:6:49:10 elapsed:2:52:48 postfix:- (2341257:tqdm_logging.py:145)
Step 8400: grad_norm=0.1323, loss=0.0044, param_norm=1380.3466
04:21:56.248 [I] Progress on: 8.41kit/30.0kit rate:1.1s/it remaining:6:46:00 elapsed:2:52:58 postfix:- (2341257:tqdm_logging.py:145)
04:22:06.486 [I] Progress on: 8.41kit/30.0kit rate:1.1s/it remaining:6:50:46 elapsed:2:53:08 postfix:- (2341257:tqdm_logging.py:145)
04:22:16.885 [I] Progress on: 8.42kit/30.0kit rate:1.1s/it remaining:6:52:03 elapsed:2:53:19 postfix:- (2341257:tqdm_logging.py:145)
04:22:27.082 [I] Progress on: 8.43kit/30.0kit rate:1.1s/it remaining:6:47:31 elapsed:2:53:29 postfix:- (2341257:tqdm_logging.py:145)
04:22:37.278 [I] Progress on: 8.44kit/30.0kit rate:1.1s/it remaining:6:47:02 elapsed:2:53:39 postfix:- (2341257:tqdm_logging.py:145)
04:22:47.476 [I] Progress on: 8.45kit/30.0kit rate:1.1s/it remaining:6:47:01 elapsed:2:53:49 postfix:- (2341257:tqdm_logging.py:145)
04:22:57.683 [I] Progress on: 8.46kit/30.0kit rate:1.1s/it remaining:6:47:04 elapsed:2:54:00 postfix:- (2341257:tqdm_logging.py:145)
04:23:07.878 [I] Progress on: 8.47kit/30.0kit rate:1.1s/it remaining:6:46:30 elapsed:2:54:10 postfix:- (2341257:tqdm_logging.py:145)
04:23:18.076 [I] Progress on: 8.48kit/30.0kit rate:1.1s/it remaining:6:46:32 elapsed:2:54:20 postfix:- (2341257:tqdm_logging.py:145)
04:23:28.271 [I] Progress on: 8.49kit/30.0kit rate:1.1s/it remaining:6:46:13 elapsed:2:54:30 postfix:- (2341257:tqdm_logging.py:145)
04:23:38.469 [I] Progress on: 8.50kit/30.0kit rate:1.1s/it remaining:6:46:02 elapsed:2:54:40 postfix:- (2341257:tqdm_logging.py:145)
Step 8500: grad_norm=0.1429, loss=0.0048, param_norm=1380.3524
04:23:48.714 [I] Progress on: 8.51kit/30.0kit rate:1.1s/it remaining:6:45:36 elapsed:2:54:51 postfix:- (2341257:tqdm_logging.py:145)
04:23:58.907 [I] Progress on: 8.51kit/30.0kit rate:1.1s/it remaining:6:45:38 elapsed:2:55:01 postfix:- (2341257:tqdm_logging.py:145)
04:24:09.105 [I] Progress on: 8.52kit/30.0kit rate:1.1s/it remaining:6:45:34 elapsed:2:55:11 postfix:- (2341257:tqdm_logging.py:145)
04:24:19.313 [I] Progress on: 8.53kit/30.0kit rate:1.1s/it remaining:6:45:32 elapsed:2:55:21 postfix:- (2341257:tqdm_logging.py:145)
04:24:29.508 [I] Progress on: 8.54kit/30.0kit rate:1.1s/it remaining:6:45:00 elapsed:2:55:31 postfix:- (2341257:tqdm_logging.py:145)
04:24:39.731 [I] Progress on: 8.55kit/30.0kit rate:1.1s/it remaining:6:45:44 elapsed:2:55:42 postfix:- (2341257:tqdm_logging.py:145)
04:24:49.926 [I] Progress on: 8.56kit/30.0kit rate:1.1s/it remaining:6:44:46 elapsed:2:55:52 postfix:- (2341257:tqdm_logging.py:145)
04:25:00.122 [I] Progress on: 8.57kit/30.0kit rate:1.1s/it remaining:6:44:36 elapsed:2:56:02 postfix:- (2341257:tqdm_logging.py:145)
04:25:10.345 [I] Progress on: 8.58kit/30.0kit rate:1.1s/it remaining:6:45:08 elapsed:2:56:12 postfix:- (2341257:tqdm_logging.py:145)
04:25:20.542 [I] Progress on: 8.59kit/30.0kit rate:1.1s/it remaining:6:44:25 elapsed:2:56:22 postfix:- (2341257:tqdm_logging.py:145)
04:25:30.755 [I] Progress on: 8.60kit/30.0kit rate:1.1s/it remaining:6:44:49 elapsed:2:56:33 postfix:- (2341257:tqdm_logging.py:145)
Step 8600: grad_norm=0.1416, loss=0.0048, param_norm=1380.3584
04:25:41.000 [I] Progress on: 8.60kit/30.0kit rate:1.1s/it remaining:6:43:34 elapsed:2:56:43 postfix:- (2341257:tqdm_logging.py:145)
04:25:51.196 [I] Progress on: 8.61kit/30.0kit rate:1.1s/it remaining:6:43:47 elapsed:2:56:53 postfix:- (2341257:tqdm_logging.py:145)
04:26:01.392 [I] Progress on: 8.62kit/30.0kit rate:1.1s/it remaining:6:43:42 elapsed:2:57:03 postfix:- (2341257:tqdm_logging.py:145)
04:26:11.593 [I] Progress on: 8.63kit/30.0kit rate:1.1s/it remaining:6:43:53 elapsed:2:57:13 postfix:- (2341257:tqdm_logging.py:145)
04:26:21.797 [I] Progress on: 8.64kit/30.0kit rate:1.1s/it remaining:6:43:21 elapsed:2:57:24 postfix:- (2341257:tqdm_logging.py:145)
04:26:31.992 [I] Progress on: 8.65kit/30.0kit rate:1.1s/it remaining:6:43:02 elapsed:2:57:34 postfix:- (2341257:tqdm_logging.py:145)
04:26:42.189 [I] Progress on: 8.66kit/30.0kit rate:1.1s/it remaining:6:42:54 elapsed:2:57:44 postfix:- (2341257:tqdm_logging.py:145)
04:26:52.392 [I] Progress on: 8.67kit/30.0kit rate:1.1s/it remaining:6:43:01 elapsed:2:57:54 postfix:- (2341257:tqdm_logging.py:145)
04:27:02.596 [I] Progress on: 8.68kit/30.0kit rate:1.1s/it remaining:6:42:54 elapsed:2:58:04 postfix:- (2341257:tqdm_logging.py:145)
04:27:12.791 [I] Progress on: 8.69kit/30.0kit rate:1.1s/it remaining:6:42:20 elapsed:2:58:15 postfix:- (2341257:tqdm_logging.py:145)
04:27:22.993 [I] Progress on: 8.69kit/30.0kit rate:1.1s/it remaining:6:42:49 elapsed:2:58:25 postfix:- (2341257:tqdm_logging.py:145)
Step 8700: grad_norm=0.1632, loss=0.0049, param_norm=1380.3649
04:27:33.242 [I] Progress on: 8.70kit/30.0kit rate:1.1s/it remaining:6:41:19 elapsed:2:58:35 postfix:- (2341257:tqdm_logging.py:145)
04:27:43.449 [I] Progress on: 8.71kit/30.0kit rate:1.1s/it remaining:6:43:04 elapsed:2:58:45 postfix:- (2341257:tqdm_logging.py:145)
04:27:53.645 [I] Progress on: 8.72kit/30.0kit rate:1.1s/it remaining:6:41:46 elapsed:2:58:55 postfix:- (2341257:tqdm_logging.py:145)
04:28:03.843 [I] Progress on: 8.73kit/30.0kit rate:1.1s/it remaining:6:41:45 elapsed:2:59:06 postfix:- (2341257:tqdm_logging.py:145)
04:28:14.038 [I] Progress on: 8.74kit/30.0kit rate:1.1s/it remaining:6:41:20 elapsed:2:59:16 postfix:- (2341257:tqdm_logging.py:145)
04:28:24.247 [I] Progress on: 8.75kit/30.0kit rate:1.1s/it remaining:6:41:23 elapsed:2:59:26 postfix:- (2341257:tqdm_logging.py:145)
04:28:34.444 [I] Progress on: 8.76kit/30.0kit rate:1.1s/it remaining:6:41:04 elapsed:2:59:36 postfix:- (2341257:tqdm_logging.py:145)
04:28:44.646 [I] Progress on: 8.77kit/30.0kit rate:1.1s/it remaining:6:41:39 elapsed:2:59:46 postfix:- (2341257:tqdm_logging.py:145)
04:28:54.836 [I] Progress on: 8.78kit/30.0kit rate:1.1s/it remaining:6:40:41 elapsed:2:59:57 postfix:- (2341257:tqdm_logging.py:145)
04:29:05.031 [I] Progress on: 8.78kit/30.0kit rate:1.1s/it remaining:6:40:38 elapsed:3:00:07 postfix:- (2341257:tqdm_logging.py:145)
04:29:15.227 [I] Progress on: 8.79kit/30.0kit rate:1.1s/it remaining:6:40:23 elapsed:3:00:17 postfix:- (2341257:tqdm_logging.py:145)
Step 8800: grad_norm=0.1322, loss=0.0043, param_norm=1380.3708
04:29:25.475 [I] Progress on: 8.80kit/30.0kit rate:1.1s/it remaining:6:39:28 elapsed:3:00:27 postfix:- (2341257:tqdm_logging.py:145)
04:29:35.684 [I] Progress on: 8.81kit/30.0kit rate:1.1s/it remaining:6:40:27 elapsed:3:00:38 postfix:- (2341257:tqdm_logging.py:145)
04:29:45.881 [I] Progress on: 8.82kit/30.0kit rate:1.1s/it remaining:6:39:25 elapsed:3:00:48 postfix:- (2341257:tqdm_logging.py:145)
04:29:56.074 [I] Progress on: 8.83kit/30.0kit rate:1.1s/it remaining:6:39:31 elapsed:3:00:58 postfix:- (2341257:tqdm_logging.py:145)
04:30:06.272 [I] Progress on: 8.84kit/30.0kit rate:1.1s/it remaining:6:39:28 elapsed:3:01:08 postfix:- (2341257:tqdm_logging.py:145)
04:30:16.681 [I] Progress on: 8.85kit/30.0kit rate:1.1s/it remaining:6:41:14 elapsed:3:01:19 postfix:- (2341257:tqdm_logging.py:145)
04:30:26.877 [I] Progress on: 8.86kit/30.0kit rate:1.1s/it remaining:6:39:15 elapsed:3:01:29 postfix:- (2341257:tqdm_logging.py:145)
04:30:37.073 [I] Progress on: 8.87kit/30.0kit rate:1.1s/it remaining:6:39:02 elapsed:3:01:39 postfix:- (2341257:tqdm_logging.py:145)
04:30:47.271 [I] Progress on: 8.87kit/30.0kit rate:1.1s/it remaining:6:38:51 elapsed:3:01:49 postfix:- (2341257:tqdm_logging.py:145)
04:30:57.479 [I] Progress on: 8.88kit/30.0kit rate:1.1s/it remaining:6:39:01 elapsed:3:01:59 postfix:- (2341257:tqdm_logging.py:145)
04:31:07.674 [I] Progress on: 8.89kit/30.0kit rate:1.1s/it remaining:6:38:33 elapsed:3:02:09 postfix:- (2341257:tqdm_logging.py:145)
Step 8900: grad_norm=0.1373, loss=0.0048, param_norm=1380.3768
04:31:18.034 [I] Progress on: 8.90kit/30.0kit rate:1.1s/it remaining:6:38:20 elapsed:3:02:20 postfix:- (2341257:tqdm_logging.py:145)
04:31:28.117 [I] Progress on: 8.91kit/30.0kit rate:1.1s/it remaining:6:38:14 elapsed:3:02:30 postfix:- (2341257:tqdm_logging.py:145)
04:31:38.314 [I] Progress on: 8.92kit/30.0kit rate:1.1s/it remaining:6:38:06 elapsed:3:02:40 postfix:- (2341257:tqdm_logging.py:145)
04:31:48.511 [I] Progress on: 8.93kit/30.0kit rate:1.1s/it remaining:6:37:52 elapsed:3:02:50 postfix:- (2341257:tqdm_logging.py:145)
04:31:58.707 [I] Progress on: 8.94kit/30.0kit rate:1.1s/it remaining:6:37:45 elapsed:3:03:01 postfix:- (2341257:tqdm_logging.py:145)
04:32:08.902 [I] Progress on: 8.95kit/30.0kit rate:1.1s/it remaining:6:37:31 elapsed:3:03:11 postfix:- (2341257:tqdm_logging.py:145)
04:32:19.110 [I] Progress on: 8.96kit/30.0kit rate:1.1s/it remaining:6:37:30 elapsed:3:03:21 postfix:- (2341257:tqdm_logging.py:145)
04:32:29.307 [I] Progress on: 8.96kit/30.0kit rate:1.1s/it remaining:6:37:17 elapsed:3:03:31 postfix:- (2341257:tqdm_logging.py:145)
04:32:39.513 [I] Progress on: 8.97kit/30.0kit rate:1.1s/it remaining:6:37:22 elapsed:3:03:41 postfix:- (2341257:tqdm_logging.py:145)
04:32:49.710 [I] Progress on: 8.98kit/30.0kit rate:1.1s/it remaining:6:36:49 elapsed:3:03:52 postfix:- (2341257:tqdm_logging.py:145)
04:32:59.906 [I] Progress on: 8.99kit/30.0kit rate:1.1s/it remaining:6:36:39 elapsed:3:04:02 postfix:- (2341257:tqdm_logging.py:145)
04:33:10.127 [I] Progress on: 9.00kit/30.0kit rate:1.1s/it remaining:6:37:18 elapsed:3:04:12 postfix:- (2341257:tqdm_logging.py:145)
Step 9000: grad_norm=0.1433, loss=0.0047, param_norm=1380.3829
04:33:11.468 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
04:33:11.468 [I] [process=0] Saving checkpoint at step 9000                                       (2341257:checkpoint_manager.py:1408)
04:33:11.468 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000. (2341257:async_checkpointer.py:439)
04:33:11.478 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32 (2341257:atomicity.py:144)
04:33:11.483 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/params.orbax-checkpoint-tmp-34 (2341257:atomicity.py:144)
04:33:11.483 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/assets.orbax-checkpoint-tmp-33 (2341257:atomicity.py:144)
04:33:11.484 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/train_state.orbax-checkpoint-tmp-35 (2341257:atomicity.py:144)
04:33:11.503 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
04:33:46.954 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
04:33:46.955 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
04:33:47.096 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/params.orbax-checkpoint-tmp-34/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
04:34:52.511 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
04:34:52.511 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 70.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:34:52.528 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 106.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:34:52.531 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
04:34:52.532 [I] Finished blocking save in 101.06 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000. (2341257:async_checkpointer.py:548)
04:34:52.532 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
04:34:52.532 [I] Deleting Checkpoint[step=8000 | time=2025-10-31 20:14:16.978940+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
04:34:52.533 [I] [process=0][thread=MainThread][step=9000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
04:34:52.534 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
04:34:52.534 [I] {'step': 9000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761942791.4679897, 'wait_for_prev_duration_secs': 0.00017452239990234375, 'checkpointer_blocking_start_time': 1761942791.468444, 'checkpointer_blocking_duration_secs': 101.063791513443, 'get_old_steps_start_time': 1761942892.53225, 'get_old_steps_duration_secs': 0.0012907981872558594, 'checkpoint_manager_blocking_start_time': 1761942791.4678915, 'checkpoint_manager_blocking_duration_secs': 101.06628656387329} (2341257:standard_logger.py:34)
04:34:52.538 [I] Progress on: 9.00kit/30.0kit rate:31.5s/it remaining:183:50:39 elapsed:3:05:54 postfix:- (2341257:tqdm_logging.py:145)
04:34:52.546 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 70.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:34:52.564 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/train_state.orbax-checkpoint-tmp-35/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
04:35:02.606 [I] Progress on: 9.01kit/30.0kit rate:2.4s/it remaining:13:45:08 elapsed:3:06:04 postfix:- (2341257:tqdm_logging.py:145)
04:35:05.638 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 94.0 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:35:05.639 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
04:35:05.640 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/assets.orbax-checkpoint-tmp-33 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/assets (2341257:atomicity.py:289)
04:35:05.645 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
04:35:05.748 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/train_state.orbax-checkpoint-tmp-35 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/train_state (2341257:atomicity.py:289)
04:35:05.752 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
04:35:05.818 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/params.orbax-checkpoint-tmp-34 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/params (2341257:atomicity.py:289)
04:35:05.819 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000 (2341257:atomicity.py:289)
04:35:05.823 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000`. (2341257:atomicity.py:573)
04:35:05.823 [I] Finished asynchronous save (blocking + background) in 114.36 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000 (2341257:async_checkpointer.py:412)
04:35:05.823 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
04:35:05.824 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
04:35:05.824 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
04:35:06.241 [I] Deleted step 8000.                                                               (2341257:deleter.py:114)
04:35:06.241 [I] [process=0][thread=save_finalize][step=9000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
04:35:06.241 [I] [process=0][thread=save_finalize][step=9000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
04:35:12.841 [I] Progress on: 9.02kit/30.0kit rate:1.2s/it remaining:6:55:01 elapsed:3:06:15 postfix:- (2341257:tqdm_logging.py:145)
04:35:23.059 [I] Progress on: 9.03kit/30.0kit rate:1.1s/it remaining:6:37:41 elapsed:3:06:25 postfix:- (2341257:tqdm_logging.py:145)
04:35:33.260 [I] Progress on: 9.04kit/30.0kit rate:1.1s/it remaining:6:36:35 elapsed:3:06:35 postfix:- (2341257:tqdm_logging.py:145)
04:35:43.458 [I] Progress on: 9.05kit/30.0kit rate:1.1s/it remaining:6:35:43 elapsed:3:06:45 postfix:- (2341257:tqdm_logging.py:145)
04:35:53.655 [I] Progress on: 9.05kit/30.0kit rate:1.1s/it remaining:6:35:33 elapsed:3:06:55 postfix:- (2341257:tqdm_logging.py:145)
04:36:03.856 [I] Progress on: 9.06kit/30.0kit rate:1.1s/it remaining:6:35:13 elapsed:3:07:06 postfix:- (2341257:tqdm_logging.py:145)
04:36:14.073 [I] Progress on: 9.07kit/30.0kit rate:1.1s/it remaining:6:36:03 elapsed:3:07:16 postfix:- (2341257:tqdm_logging.py:145)
04:36:24.270 [I] Progress on: 9.08kit/30.0kit rate:1.1s/it remaining:6:35:02 elapsed:3:07:26 postfix:- (2341257:tqdm_logging.py:145)
04:36:34.469 [I] Progress on: 9.09kit/30.0kit rate:1.1s/it remaining:6:35:02 elapsed:3:07:36 postfix:- (2341257:tqdm_logging.py:145)
04:36:44.663 [I] Progress on: 9.10kit/30.0kit rate:1.1s/it remaining:6:34:35 elapsed:3:07:46 postfix:- (2341257:tqdm_logging.py:145)
Step 9100: grad_norm=0.1292, loss=0.0043, param_norm=1380.3884
04:36:54.909 [I] Progress on: 9.11kit/30.0kit rate:1.1s/it remaining:6:34:29 elapsed:3:07:57 postfix:- (2341257:tqdm_logging.py:145)
04:37:05.103 [I] Progress on: 9.12kit/30.0kit rate:1.1s/it remaining:6:34:15 elapsed:3:08:07 postfix:- (2341257:tqdm_logging.py:145)
04:37:15.299 [I] Progress on: 9.13kit/30.0kit rate:1.1s/it remaining:6:34:03 elapsed:3:08:17 postfix:- (2341257:tqdm_logging.py:145)
04:37:25.495 [I] Progress on: 9.14kit/30.0kit rate:1.1s/it remaining:6:33:56 elapsed:3:08:27 postfix:- (2341257:tqdm_logging.py:145)
04:37:35.691 [I] Progress on: 9.14kit/30.0kit rate:1.1s/it remaining:6:33:41 elapsed:3:08:38 postfix:- (2341257:tqdm_logging.py:145)
04:37:45.889 [I] Progress on: 9.15kit/30.0kit rate:1.1s/it remaining:6:33:40 elapsed:3:08:48 postfix:- (2341257:tqdm_logging.py:145)
04:37:56.096 [I] Progress on: 9.16kit/30.0kit rate:1.1s/it remaining:6:34:12 elapsed:3:08:58 postfix:- (2341257:tqdm_logging.py:145)
04:38:06.292 [I] Progress on: 9.17kit/30.0kit rate:1.1s/it remaining:6:33:22 elapsed:3:09:08 postfix:- (2341257:tqdm_logging.py:145)
04:38:16.485 [I] Progress on: 9.18kit/30.0kit rate:1.1s/it remaining:6:33:01 elapsed:3:09:18 postfix:- (2341257:tqdm_logging.py:145)
04:38:26.692 [I] Progress on: 9.19kit/30.0kit rate:1.1s/it remaining:6:33:09 elapsed:3:09:29 postfix:- (2341257:tqdm_logging.py:145)
04:38:36.887 [I] Progress on: 9.20kit/30.0kit rate:1.1s/it remaining:6:32:36 elapsed:3:09:39 postfix:- (2341257:tqdm_logging.py:145)
Step 9200: grad_norm=0.1334, loss=0.0043, param_norm=1380.3942
04:38:47.146 [I] Progress on: 9.21kit/30.0kit rate:1.1s/it remaining:6:33:52 elapsed:3:09:49 postfix:- (2341257:tqdm_logging.py:145)
04:38:57.340 [I] Progress on: 9.22kit/30.0kit rate:1.1s/it remaining:6:32:25 elapsed:3:09:59 postfix:- (2341257:tqdm_logging.py:145)
04:39:07.537 [I] Progress on: 9.23kit/30.0kit rate:1.1s/it remaining:6:32:18 elapsed:3:10:09 postfix:- (2341257:tqdm_logging.py:145)
04:39:17.732 [I] Progress on: 9.23kit/30.0kit rate:1.1s/it remaining:6:31:59 elapsed:3:10:20 postfix:- (2341257:tqdm_logging.py:145)
04:39:27.929 [I] Progress on: 9.24kit/30.0kit rate:1.1s/it remaining:6:31:56 elapsed:3:10:30 postfix:- (2341257:tqdm_logging.py:145)
04:39:38.127 [I] Progress on: 9.25kit/30.0kit rate:1.1s/it remaining:6:31:46 elapsed:3:10:40 postfix:- (2341257:tqdm_logging.py:145)
04:39:48.680 [I] Progress on: 9.26kit/30.0kit rate:1.2s/it remaining:7:08:29 elapsed:3:10:51 postfix:- (2341257:tqdm_logging.py:145)
04:39:58.742 [I] Progress on: 9.27kit/30.0kit rate:1.1s/it remaining:6:33:09 elapsed:3:11:01 postfix:- (2341257:tqdm_logging.py:145)
04:40:08.938 [I] Progress on: 9.28kit/30.0kit rate:1.1s/it remaining:6:31:15 elapsed:3:11:11 postfix:- (2341257:tqdm_logging.py:145)
04:40:19.135 [I] Progress on: 9.29kit/30.0kit rate:1.1s/it remaining:6:30:59 elapsed:3:11:21 postfix:- (2341257:tqdm_logging.py:145)
04:40:29.332 [I] Progress on: 9.30kit/30.0kit rate:1.1s/it remaining:6:30:52 elapsed:3:11:31 postfix:- (2341257:tqdm_logging.py:145)
Step 9300: grad_norm=0.1303, loss=0.0042, param_norm=1380.4001
04:40:39.573 [I] Progress on: 9.31kit/30.0kit rate:1.1s/it remaining:6:30:23 elapsed:3:11:41 postfix:- (2341257:tqdm_logging.py:145)
04:40:49.770 [I] Progress on: 9.32kit/30.0kit rate:1.1s/it remaining:6:30:27 elapsed:3:11:52 postfix:- (2341257:tqdm_logging.py:145)
04:40:59.966 [I] Progress on: 9.32kit/30.0kit rate:1.1s/it remaining:6:30:18 elapsed:3:12:02 postfix:- (2341257:tqdm_logging.py:145)
04:41:10.174 [I] Progress on: 9.33kit/30.0kit rate:1.1s/it remaining:6:30:25 elapsed:3:12:12 postfix:- (2341257:tqdm_logging.py:145)
04:41:20.370 [I] Progress on: 9.34kit/30.0kit rate:1.1s/it remaining:6:29:59 elapsed:3:12:22 postfix:- (2341257:tqdm_logging.py:145)
04:41:30.567 [I] Progress on: 9.35kit/30.0kit rate:1.1s/it remaining:6:29:49 elapsed:3:12:32 postfix:- (2341257:tqdm_logging.py:145)
04:41:40.765 [I] Progress on: 9.36kit/30.0kit rate:1.1s/it remaining:6:29:56 elapsed:3:12:43 postfix:- (2341257:tqdm_logging.py:145)
04:41:50.960 [I] Progress on: 9.37kit/30.0kit rate:1.1s/it remaining:6:29:31 elapsed:3:12:53 postfix:- (2341257:tqdm_logging.py:145)
04:42:01.170 [I] Progress on: 9.38kit/30.0kit rate:1.1s/it remaining:6:29:30 elapsed:3:13:03 postfix:- (2341257:tqdm_logging.py:145)
04:42:11.366 [I] Progress on: 9.39kit/30.0kit rate:1.1s/it remaining:6:29:16 elapsed:3:13:13 postfix:- (2341257:tqdm_logging.py:145)
04:42:21.572 [I] Progress on: 9.40kit/30.0kit rate:1.1s/it remaining:6:29:50 elapsed:3:13:23 postfix:- (2341257:tqdm_logging.py:145)
Step 9400: grad_norm=0.1345, loss=0.0042, param_norm=1380.4058
04:42:31.823 [I] Progress on: 9.41kit/30.0kit rate:1.1s/it remaining:6:29:06 elapsed:3:13:34 postfix:- (2341257:tqdm_logging.py:145)
04:42:42.017 [I] Progress on: 9.41kit/30.0kit rate:1.1s/it remaining:6:28:29 elapsed:3:13:44 postfix:- (2341257:tqdm_logging.py:145)
04:42:52.225 [I] Progress on: 9.42kit/30.0kit rate:1.1s/it remaining:6:28:37 elapsed:3:13:54 postfix:- (2341257:tqdm_logging.py:145)
04:43:02.423 [I] Progress on: 9.43kit/30.0kit rate:1.1s/it remaining:6:28:17 elapsed:3:14:04 postfix:- (2341257:tqdm_logging.py:145)
04:43:12.621 [I] Progress on: 9.44kit/30.0kit rate:1.1s/it remaining:6:28:12 elapsed:3:14:14 postfix:- (2341257:tqdm_logging.py:145)
04:43:22.820 [I] Progress on: 9.45kit/30.0kit rate:1.1s/it remaining:6:28:14 elapsed:3:14:25 postfix:- (2341257:tqdm_logging.py:145)
04:43:33.018 [I] Progress on: 9.46kit/30.0kit rate:1.1s/it remaining:6:27:58 elapsed:3:14:35 postfix:- (2341257:tqdm_logging.py:145)
04:43:43.227 [I] Progress on: 9.47kit/30.0kit rate:1.1s/it remaining:6:27:51 elapsed:3:14:45 postfix:- (2341257:tqdm_logging.py:145)
04:43:53.548 [I] Progress on: 9.48kit/30.0kit rate:1.1s/it remaining:6:28:03 elapsed:3:14:55 postfix:- (2341257:tqdm_logging.py:145)
04:44:03.777 [I] Progress on: 9.49kit/30.0kit rate:1.1s/it remaining:6:28:24 elapsed:3:15:06 postfix:- (2341257:tqdm_logging.py:145)
04:44:13.975 [I] Progress on: 9.50kit/30.0kit rate:1.1s/it remaining:6:27:14 elapsed:3:15:16 postfix:- (2341257:tqdm_logging.py:145)
Step 9500: grad_norm=0.1519, loss=0.0042, param_norm=1380.4113
04:44:24.221 [I] Progress on: 9.51kit/30.0kit rate:1.1s/it remaining:6:26:55 elapsed:3:15:26 postfix:- (2341257:tqdm_logging.py:145)
04:44:34.426 [I] Progress on: 9.51kit/30.0kit rate:1.1s/it remaining:6:26:52 elapsed:3:15:36 postfix:- (2341257:tqdm_logging.py:145)
04:44:44.621 [I] Progress on: 9.52kit/30.0kit rate:1.1s/it remaining:6:26:32 elapsed:3:15:46 postfix:- (2341257:tqdm_logging.py:145)
04:44:54.818 [I] Progress on: 9.53kit/30.0kit rate:1.1s/it remaining:6:26:28 elapsed:3:15:57 postfix:- (2341257:tqdm_logging.py:145)
04:45:05.020 [I] Progress on: 9.54kit/30.0kit rate:1.1s/it remaining:6:26:18 elapsed:3:16:07 postfix:- (2341257:tqdm_logging.py:145)
04:45:15.221 [I] Progress on: 9.55kit/30.0kit rate:1.1s/it remaining:6:26:28 elapsed:3:16:17 postfix:- (2341257:tqdm_logging.py:145)
04:45:25.425 [I] Progress on: 9.56kit/30.0kit rate:1.1s/it remaining:6:25:56 elapsed:3:16:27 postfix:- (2341257:tqdm_logging.py:145)
04:45:35.622 [I] Progress on: 9.57kit/30.0kit rate:1.1s/it remaining:6:25:47 elapsed:3:16:37 postfix:- (2341257:tqdm_logging.py:145)
04:45:45.818 [I] Progress on: 9.58kit/30.0kit rate:1.1s/it remaining:6:25:36 elapsed:3:16:48 postfix:- (2341257:tqdm_logging.py:145)
04:45:56.027 [I] Progress on: 9.59kit/30.0kit rate:1.1s/it remaining:6:25:48 elapsed:3:16:58 postfix:- (2341257:tqdm_logging.py:145)
04:46:06.235 [I] Progress on: 9.60kit/30.0kit rate:1.1s/it remaining:6:25:39 elapsed:3:17:08 postfix:- (2341257:tqdm_logging.py:145)
Step 9600: grad_norm=0.1463, loss=0.0045, param_norm=1380.4169
04:46:16.478 [I] Progress on: 9.60kit/30.0kit rate:1.1s/it remaining:6:24:40 elapsed:3:17:18 postfix:- (2341257:tqdm_logging.py:145)
04:46:26.674 [I] Progress on: 9.61kit/30.0kit rate:1.1s/it remaining:6:24:55 elapsed:3:17:28 postfix:- (2341257:tqdm_logging.py:145)
04:46:36.870 [I] Progress on: 9.62kit/30.0kit rate:1.1s/it remaining:6:24:44 elapsed:3:17:39 postfix:- (2341257:tqdm_logging.py:145)
04:46:47.066 [I] Progress on: 9.63kit/30.0kit rate:1.1s/it remaining:6:24:35 elapsed:3:17:49 postfix:- (2341257:tqdm_logging.py:145)
04:46:57.275 [I] Progress on: 9.64kit/30.0kit rate:1.1s/it remaining:6:24:39 elapsed:3:17:59 postfix:- (2341257:tqdm_logging.py:145)
04:47:07.470 [I] Progress on: 9.65kit/30.0kit rate:1.1s/it remaining:6:24:11 elapsed:3:18:09 postfix:- (2341257:tqdm_logging.py:145)
04:47:17.667 [I] Progress on: 9.66kit/30.0kit rate:1.1s/it remaining:6:23:58 elapsed:3:18:19 postfix:- (2341257:tqdm_logging.py:145)
04:47:27.877 [I] Progress on: 9.67kit/30.0kit rate:1.1s/it remaining:6:24:01 elapsed:3:18:30 postfix:- (2341257:tqdm_logging.py:145)
04:47:38.075 [I] Progress on: 9.68kit/30.0kit rate:1.1s/it remaining:6:23:47 elapsed:3:18:40 postfix:- (2341257:tqdm_logging.py:145)
04:47:48.501 [I] Progress on: 9.69kit/30.0kit rate:1.2s/it remaining:6:32:14 elapsed:3:18:50 postfix:- (2341257:tqdm_logging.py:145)
04:47:58.705 [I] Progress on: 9.69kit/30.0kit rate:1.1s/it remaining:6:23:52 elapsed:3:19:01 postfix:- (2341257:tqdm_logging.py:145)
Step 9700: grad_norm=0.1278, loss=0.0040, param_norm=1380.4225
04:48:08.967 [I] Progress on: 9.70kit/30.0kit rate:1.1s/it remaining:6:21:44 elapsed:3:19:11 postfix:- (2341257:tqdm_logging.py:145)
04:48:19.174 [I] Progress on: 9.71kit/30.0kit rate:1.1s/it remaining:6:23:05 elapsed:3:19:21 postfix:- (2341257:tqdm_logging.py:145)
04:48:29.370 [I] Progress on: 9.72kit/30.0kit rate:1.1s/it remaining:6:22:49 elapsed:3:19:31 postfix:- (2341257:tqdm_logging.py:145)
04:48:39.573 [I] Progress on: 9.73kit/30.0kit rate:1.1s/it remaining:6:23:21 elapsed:3:19:41 postfix:- (2341257:tqdm_logging.py:145)
04:48:49.774 [I] Progress on: 9.74kit/30.0kit rate:1.1s/it remaining:6:22:47 elapsed:3:19:52 postfix:- (2341257:tqdm_logging.py:145)
04:48:59.969 [I] Progress on: 9.75kit/30.0kit rate:1.1s/it remaining:6:22:19 elapsed:3:20:02 postfix:- (2341257:tqdm_logging.py:145)
04:49:10.175 [I] Progress on: 9.76kit/30.0kit rate:1.1s/it remaining:6:22:22 elapsed:3:20:12 postfix:- (2341257:tqdm_logging.py:145)
04:49:20.373 [I] Progress on: 9.77kit/30.0kit rate:1.1s/it remaining:6:22:17 elapsed:3:20:22 postfix:- (2341257:tqdm_logging.py:145)
04:49:30.566 [I] Progress on: 9.78kit/30.0kit rate:1.1s/it remaining:6:21:34 elapsed:3:20:32 postfix:- (2341257:tqdm_logging.py:145)
04:49:40.766 [I] Progress on: 9.78kit/30.0kit rate:1.1s/it remaining:6:21:56 elapsed:3:20:43 postfix:- (2341257:tqdm_logging.py:145)
04:49:50.970 [I] Progress on: 9.79kit/30.0kit rate:1.1s/it remaining:6:22:14 elapsed:3:20:53 postfix:- (2341257:tqdm_logging.py:145)
Step 9800: grad_norm=0.1311, loss=0.0042, param_norm=1380.4277
04:50:01.216 [I] Progress on: 9.80kit/30.0kit rate:1.1s/it remaining:6:20:25 elapsed:3:21:03 postfix:- (2341257:tqdm_logging.py:145)
04:50:11.426 [I] Progress on: 9.81kit/30.0kit rate:1.1s/it remaining:6:21:25 elapsed:3:21:13 postfix:- (2341257:tqdm_logging.py:145)
04:50:21.620 [I] Progress on: 9.82kit/30.0kit rate:1.1s/it remaining:6:20:55 elapsed:3:21:23 postfix:- (2341257:tqdm_logging.py:145)
04:50:31.827 [I] Progress on: 9.83kit/30.0kit rate:1.1s/it remaining:6:21:33 elapsed:3:21:34 postfix:- (2341257:tqdm_logging.py:145)
04:50:42.031 [I] Progress on: 9.84kit/30.0kit rate:1.1s/it remaining:6:22:00 elapsed:3:21:44 postfix:- (2341257:tqdm_logging.py:145)
04:50:52.225 [I] Progress on: 9.85kit/30.0kit rate:1.1s/it remaining:6:20:10 elapsed:3:21:54 postfix:- (2341257:tqdm_logging.py:145)
04:51:02.422 [I] Progress on: 9.86kit/30.0kit rate:1.1s/it remaining:6:20:22 elapsed:3:22:04 postfix:- (2341257:tqdm_logging.py:145)
04:51:12.621 [I] Progress on: 9.87kit/30.0kit rate:1.1s/it remaining:6:20:23 elapsed:3:22:14 postfix:- (2341257:tqdm_logging.py:145)
04:51:22.836 [I] Progress on: 9.87kit/30.0kit rate:1.1s/it remaining:6:21:05 elapsed:3:22:25 postfix:- (2341257:tqdm_logging.py:145)
04:51:33.048 [I] Progress on: 9.88kit/30.0kit rate:1.1s/it remaining:6:21:21 elapsed:3:22:35 postfix:- (2341257:tqdm_logging.py:145)
04:51:43.244 [I] Progress on: 9.89kit/30.0kit rate:1.1s/it remaining:6:19:38 elapsed:3:22:45 postfix:- (2341257:tqdm_logging.py:145)
Step 9900: grad_norm=0.1278, loss=0.0040, param_norm=1380.4333
04:51:53.604 [I] Progress on: 9.90kit/30.0kit rate:1.1s/it remaining:6:19:30 elapsed:3:22:55 postfix:- (2341257:tqdm_logging.py:145)
04:52:03.689 [I] Progress on: 9.91kit/30.0kit rate:1.1s/it remaining:6:19:28 elapsed:3:23:06 postfix:- (2341257:tqdm_logging.py:145)
04:52:13.896 [I] Progress on: 9.92kit/30.0kit rate:1.1s/it remaining:6:19:34 elapsed:3:23:16 postfix:- (2341257:tqdm_logging.py:145)
04:52:24.105 [I] Progress on: 9.93kit/30.0kit rate:1.1s/it remaining:6:19:06 elapsed:3:23:26 postfix:- (2341257:tqdm_logging.py:145)
04:52:34.300 [I] Progress on: 9.94kit/30.0kit rate:1.1s/it remaining:6:18:46 elapsed:3:23:36 postfix:- (2341257:tqdm_logging.py:145)
04:52:44.497 [I] Progress on: 9.95kit/30.0kit rate:1.1s/it remaining:6:18:30 elapsed:3:23:46 postfix:- (2341257:tqdm_logging.py:145)
04:52:54.706 [I] Progress on: 9.96kit/30.0kit rate:1.1s/it remaining:6:18:43 elapsed:3:23:57 postfix:- (2341257:tqdm_logging.py:145)
04:53:04.901 [I] Progress on: 9.96kit/30.0kit rate:1.1s/it remaining:6:18:19 elapsed:3:24:07 postfix:- (2341257:tqdm_logging.py:145)
04:53:15.100 [I] Progress on: 9.97kit/30.0kit rate:1.1s/it remaining:6:18:17 elapsed:3:24:17 postfix:- (2341257:tqdm_logging.py:145)
04:53:25.306 [I] Progress on: 9.98kit/30.0kit rate:1.1s/it remaining:6:18:31 elapsed:3:24:27 postfix:- (2341257:tqdm_logging.py:145)
04:53:35.504 [I] Progress on: 9.99kit/30.0kit rate:1.1s/it remaining:6:17:47 elapsed:3:24:37 postfix:- (2341257:tqdm_logging.py:145)
04:53:45.699 [I] Progress on: 10.0kit/30.0kit rate:1.1s/it remaining:6:17:38 elapsed:3:24:48 postfix:- (2341257:tqdm_logging.py:145)
Step 10000: grad_norm=0.1603, loss=0.0044, param_norm=1380.4391
04:53:47.030 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
04:53:47.031 [I] [process=0] Saving checkpoint at step 10000                                      (2341257:checkpoint_manager.py:1408)
04:53:47.031 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000. (2341257:async_checkpointer.py:439)
04:53:47.039 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36 (2341257:atomicity.py:144)
04:53:47.045 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/train_state.orbax-checkpoint-tmp-39 (2341257:atomicity.py:144)
04:53:47.045 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/params.orbax-checkpoint-tmp-38 (2341257:atomicity.py:144)
04:53:47.045 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/assets.orbax-checkpoint-tmp-37 (2341257:atomicity.py:144)
04:53:47.064 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
04:54:22.617 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
04:54:22.618 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
04:54:22.855 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/params.orbax-checkpoint-tmp-38/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
04:55:27.267 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
04:55:27.268 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 71.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:55:27.294 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 107.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:55:27.303 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
04:55:27.304 [I] Finished blocking save in 100.27 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000. (2341257:async_checkpointer.py:548)
04:55:27.305 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
04:55:27.305 [I] Deleting Checkpoint[step=9000 | time=2025-10-31 20:34:52.532239+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
04:55:27.305 [I] [process=0][thread=MainThread][step=10000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
04:55:27.307 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
04:55:27.310 [I] {'step': 10000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761944027.03085, 'wait_for_prev_duration_secs': 0.00018453598022460938, 'checkpointer_blocking_start_time': 1761944027.0312924, 'checkpointer_blocking_duration_secs': 100.273677110672, 'get_old_steps_start_time': 1761944127.3049817, 'get_old_steps_duration_secs': 0.00014400482177734375, 'checkpoint_manager_blocking_start_time': 1761944027.03075, 'checkpoint_manager_blocking_duration_secs': 100.27986598014832} (2341257:standard_logger.py:34)
04:55:27.310 [I] Progress on: 10.0kit/30.0kit rate:31.3s/it remaining:173:44:56 elapsed:3:26:29 postfix:- (2341257:tqdm_logging.py:145)
04:55:27.316 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 71.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:55:27.325 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/train_state.orbax-checkpoint-tmp-39/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
04:55:37.977 [I] Progress on: 10.0kit/30.0kit rate:2.4s/it remaining:13:21:25 elapsed:3:26:40 postfix:- (2341257:tqdm_logging.py:145)
04:55:40.419 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 94.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
04:55:40.419 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
04:55:40.420 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/assets.orbax-checkpoint-tmp-37 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/assets (2341257:atomicity.py:289)
04:55:40.425 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
04:55:40.489 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/train_state.orbax-checkpoint-tmp-39 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/train_state (2341257:atomicity.py:289)
04:55:40.493 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
04:55:40.583 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/params.orbax-checkpoint-tmp-38 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/params (2341257:atomicity.py:289)
04:55:40.584 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000 (2341257:atomicity.py:289)
04:55:40.589 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000`. (2341257:atomicity.py:573)
04:55:40.589 [I] Finished asynchronous save (blocking + background) in 113.56 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000 (2341257:async_checkpointer.py:412)
04:55:40.589 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
04:55:40.589 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
04:55:40.589 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
04:55:40.997 [I] Deleted step 9000.                                                               (2341257:deleter.py:114)
04:55:40.997 [I] [process=0][thread=save_finalize][step=10000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
04:55:40.997 [I] [process=0][thread=save_finalize][step=10000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
04:55:48.223 [I] Progress on: 10.0kit/30.0kit rate:1.2s/it remaining:6:36:09 elapsed:3:26:50 postfix:- (2341257:tqdm_logging.py:145)
04:55:58.453 [I] Progress on: 10.0kit/30.0kit rate:1.1s/it remaining:6:19:14 elapsed:3:27:00 postfix:- (2341257:tqdm_logging.py:145)
04:56:08.655 [I] Progress on: 10.0kit/30.0kit rate:1.1s/it remaining:6:17:36 elapsed:3:27:10 postfix:- (2341257:tqdm_logging.py:145)
04:56:18.851 [I] Progress on: 10.0kit/30.0kit rate:1.1s/it remaining:6:16:58 elapsed:3:27:21 postfix:- (2341257:tqdm_logging.py:145)
04:56:29.046 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:16:33 elapsed:3:27:31 postfix:- (2341257:tqdm_logging.py:145)
04:56:39.248 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:16:25 elapsed:3:27:41 postfix:- (2341257:tqdm_logging.py:145)
04:56:49.449 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:16:11 elapsed:3:27:51 postfix:- (2341257:tqdm_logging.py:145)
04:56:59.648 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:16:03 elapsed:3:28:01 postfix:- (2341257:tqdm_logging.py:145)
04:57:09.850 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:16:06 elapsed:3:28:12 postfix:- (2341257:tqdm_logging.py:145)
04:57:20.047 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:15:54 elapsed:3:28:22 postfix:- (2341257:tqdm_logging.py:145)
Step 10100: grad_norm=0.1213, loss=0.0040, param_norm=1380.4443
04:57:30.507 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:17:56 elapsed:3:28:32 postfix:- (2341257:tqdm_logging.py:145)
04:57:40.703 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:15:31 elapsed:3:28:43 postfix:- (2341257:tqdm_logging.py:145)
04:57:50.900 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:15:27 elapsed:3:28:53 postfix:- (2341257:tqdm_logging.py:145)
04:58:01.097 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:15:14 elapsed:3:29:03 postfix:- (2341257:tqdm_logging.py:145)
04:58:11.291 [I] Progress on: 10.1kit/30.0kit rate:1.1s/it remaining:6:14:50 elapsed:3:29:13 postfix:- (2341257:tqdm_logging.py:145)
04:58:21.489 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:14:47 elapsed:3:29:23 postfix:- (2341257:tqdm_logging.py:145)
04:58:31.683 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:14:26 elapsed:3:29:34 postfix:- (2341257:tqdm_logging.py:145)
04:58:41.884 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:14:49 elapsed:3:29:44 postfix:- (2341257:tqdm_logging.py:145)
04:58:52.082 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:14:20 elapsed:3:29:54 postfix:- (2341257:tqdm_logging.py:145)
04:59:02.280 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:14:01 elapsed:3:30:04 postfix:- (2341257:tqdm_logging.py:145)
04:59:12.485 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:13:49 elapsed:3:30:14 postfix:- (2341257:tqdm_logging.py:145)
Step 10200: grad_norm=0.1358, loss=0.0041, param_norm=1380.4497
04:59:22.731 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:13:44 elapsed:3:30:25 postfix:- (2341257:tqdm_logging.py:145)
04:59:32.925 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:13:24 elapsed:3:30:35 postfix:- (2341257:tqdm_logging.py:145)
04:59:43.133 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:13:35 elapsed:3:30:45 postfix:- (2341257:tqdm_logging.py:145)
04:59:53.329 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:13:09 elapsed:3:30:55 postfix:- (2341257:tqdm_logging.py:145)
05:00:03.537 [I] Progress on: 10.2kit/30.0kit rate:1.1s/it remaining:6:13:12 elapsed:3:31:05 postfix:- (2341257:tqdm_logging.py:145)
05:00:13.731 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:12:44 elapsed:3:31:16 postfix:- (2341257:tqdm_logging.py:145)
05:00:23.928 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:12:44 elapsed:3:31:26 postfix:- (2341257:tqdm_logging.py:145)
05:00:34.134 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:12:35 elapsed:3:31:36 postfix:- (2341257:tqdm_logging.py:145)
05:00:44.332 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:12:28 elapsed:3:31:46 postfix:- (2341257:tqdm_logging.py:145)
05:00:54.528 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:12:08 elapsed:3:31:56 postfix:- (2341257:tqdm_logging.py:145)
05:01:04.725 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:12:07 elapsed:3:32:07 postfix:- (2341257:tqdm_logging.py:145)
Step 10300: grad_norm=0.1312, loss=0.0041, param_norm=1380.4548
05:01:14.965 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:11:33 elapsed:3:32:17 postfix:- (2341257:tqdm_logging.py:145)
05:01:25.164 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:11:52 elapsed:3:32:27 postfix:- (2341257:tqdm_logging.py:145)
05:01:35.370 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:12:20 elapsed:3:32:37 postfix:- (2341257:tqdm_logging.py:145)
05:01:45.567 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:11:26 elapsed:3:32:47 postfix:- (2341257:tqdm_logging.py:145)
05:01:55.764 [I] Progress on: 10.3kit/30.0kit rate:1.1s/it remaining:6:11:16 elapsed:3:32:58 postfix:- (2341257:tqdm_logging.py:145)
05:02:05.960 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:10:59 elapsed:3:33:08 postfix:- (2341257:tqdm_logging.py:145)
05:02:16.167 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:11:34 elapsed:3:33:18 postfix:- (2341257:tqdm_logging.py:145)
05:02:26.382 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:12:00 elapsed:3:33:28 postfix:- (2341257:tqdm_logging.py:145)
05:02:36.585 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:10:38 elapsed:3:33:38 postfix:- (2341257:tqdm_logging.py:145)
05:02:46.782 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:10:22 elapsed:3:33:49 postfix:- (2341257:tqdm_logging.py:145)
05:02:56.978 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:10:05 elapsed:3:33:59 postfix:- (2341257:tqdm_logging.py:145)
Step 10400: grad_norm=0.1297, loss=0.0040, param_norm=1380.4600
05:03:07.231 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:10:03 elapsed:3:34:09 postfix:- (2341257:tqdm_logging.py:145)
05:03:17.427 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:09:44 elapsed:3:34:19 postfix:- (2341257:tqdm_logging.py:145)
05:03:27.625 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:09:47 elapsed:3:34:29 postfix:- (2341257:tqdm_logging.py:145)
05:03:37.821 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:09:24 elapsed:3:34:40 postfix:- (2341257:tqdm_logging.py:145)
05:03:48.017 [I] Progress on: 10.4kit/30.0kit rate:1.1s/it remaining:6:09:20 elapsed:3:34:50 postfix:- (2341257:tqdm_logging.py:145)
05:03:58.213 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:09:03 elapsed:3:35:00 postfix:- (2341257:tqdm_logging.py:145)
05:04:08.424 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:09:31 elapsed:3:35:10 postfix:- (2341257:tqdm_logging.py:145)
05:04:18.619 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:08:46 elapsed:3:35:20 postfix:- (2341257:tqdm_logging.py:145)
05:04:28.818 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:08:45 elapsed:3:35:31 postfix:- (2341257:tqdm_logging.py:145)
05:04:39.012 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:08:18 elapsed:3:35:41 postfix:- (2341257:tqdm_logging.py:145)
05:04:49.213 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:08:36 elapsed:3:35:51 postfix:- (2341257:tqdm_logging.py:145)
Step 10500: grad_norm=0.1434, loss=0.0042, param_norm=1380.4651
05:04:59.460 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:07:46 elapsed:3:36:01 postfix:- (2341257:tqdm_logging.py:145)
05:05:09.656 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:07:58 elapsed:3:36:11 postfix:- (2341257:tqdm_logging.py:145)
05:05:19.861 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:07:49 elapsed:3:36:22 postfix:- (2341257:tqdm_logging.py:145)
05:05:30.266 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:06:36 elapsed:3:36:32 postfix:- (2341257:tqdm_logging.py:145)
05:05:40.492 [I] Progress on: 10.5kit/30.0kit rate:1.1s/it remaining:6:08:45 elapsed:3:36:42 postfix:- (2341257:tqdm_logging.py:145)
05:05:50.660 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:05:28 elapsed:3:36:52 postfix:- (2341257:tqdm_logging.py:145)
05:06:00.898 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:09:53 elapsed:3:37:03 postfix:- (2341257:tqdm_logging.py:145)
05:06:11.057 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:04:40 elapsed:3:37:13 postfix:- (2341257:tqdm_logging.py:145)
05:06:21.292 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:08:35 elapsed:3:37:23 postfix:- (2341257:tqdm_logging.py:145)
05:06:31.616 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:05:39 elapsed:3:37:33 postfix:- (2341257:tqdm_logging.py:145)
05:06:41.852 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:09:03 elapsed:3:37:44 postfix:- (2341257:tqdm_logging.py:145)
Step 10600: grad_norm=0.1607, loss=0.0039, param_norm=1380.4709
05:06:52.060 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:03:59 elapsed:3:37:54 postfix:- (2341257:tqdm_logging.py:145)
05:07:02.287 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:07:19 elapsed:3:38:04 postfix:- (2341257:tqdm_logging.py:145)
05:07:12.460 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:04:28 elapsed:3:38:14 postfix:- (2341257:tqdm_logging.py:145)
05:07:22.707 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:08:38 elapsed:3:38:25 postfix:- (2341257:tqdm_logging.py:145)
05:07:32.862 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:03:20 elapsed:3:38:35 postfix:- (2341257:tqdm_logging.py:145)
05:07:43.088 [I] Progress on: 10.6kit/30.0kit rate:1.1s/it remaining:6:06:44 elapsed:3:38:45 postfix:- (2341257:tqdm_logging.py:145)
05:07:53.264 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:03:41 elapsed:3:38:55 postfix:- (2341257:tqdm_logging.py:145)
05:08:03.521 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:08:46 elapsed:3:39:05 postfix:- (2341257:tqdm_logging.py:145)
05:08:13.716 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:03:57 elapsed:3:39:16 postfix:- (2341257:tqdm_logging.py:145)
05:08:23.984 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:07:17 elapsed:3:39:26 postfix:- (2341257:tqdm_logging.py:145)
05:08:34.199 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:04:29 elapsed:3:39:36 postfix:- (2341257:tqdm_logging.py:145)
Step 10700: grad_norm=0.1697, loss=0.0044, param_norm=1380.4762
05:08:44.519 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:07:53 elapsed:3:39:46 postfix:- (2341257:tqdm_logging.py:145)
05:08:54.705 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:03:03 elapsed:3:39:57 postfix:- (2341257:tqdm_logging.py:145)
05:09:04.973 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:06:46 elapsed:3:40:07 postfix:- (2341257:tqdm_logging.py:145)
05:09:15.178 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:03:22 elapsed:3:40:17 postfix:- (2341257:tqdm_logging.py:145)
05:09:25.449 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:07:37 elapsed:3:40:27 postfix:- (2341257:tqdm_logging.py:145)
05:09:35.638 [I] Progress on: 10.7kit/30.0kit rate:1.1s/it remaining:6:02:34 elapsed:3:40:37 postfix:- (2341257:tqdm_logging.py:145)
05:09:45.905 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:06:04 elapsed:3:40:48 postfix:- (2341257:tqdm_logging.py:145)
05:09:56.106 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:02:30 elapsed:3:40:58 postfix:- (2341257:tqdm_logging.py:145)
05:10:06.386 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:07:12 elapsed:3:41:08 postfix:- (2341257:tqdm_logging.py:145)
05:10:16.576 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:01:53 elapsed:3:41:18 postfix:- (2341257:tqdm_logging.py:145)
05:10:26.847 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:05:28 elapsed:3:41:29 postfix:- (2341257:tqdm_logging.py:145)
Step 10800: grad_norm=0.1257, loss=0.0041, param_norm=1380.4810
05:10:37.112 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:01:44 elapsed:3:41:39 postfix:- (2341257:tqdm_logging.py:145)
05:10:47.386 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:06:22 elapsed:3:41:49 postfix:- (2341257:tqdm_logging.py:145)
05:10:57.580 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:01:14 elapsed:3:41:59 postfix:- (2341257:tqdm_logging.py:145)
05:11:07.845 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:04:36 elapsed:3:42:10 postfix:- (2341257:tqdm_logging.py:145)
05:11:18.052 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:01:25 elapsed:3:42:20 postfix:- (2341257:tqdm_logging.py:145)
05:11:28.322 [I] Progress on: 10.8kit/30.0kit rate:1.1s/it remaining:6:05:37 elapsed:3:42:30 postfix:- (2341257:tqdm_logging.py:145)
05:11:38.520 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:6:00:38 elapsed:3:42:40 postfix:- (2341257:tqdm_logging.py:145)
05:11:48.781 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:6:03:52 elapsed:3:42:51 postfix:- (2341257:tqdm_logging.py:145)
05:11:58.992 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:6:00:40 elapsed:3:43:01 postfix:- (2341257:tqdm_logging.py:145)
05:12:09.274 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:6:05:23 elapsed:3:43:11 postfix:- (2341257:tqdm_logging.py:145)
05:12:19.470 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:6:00:09 elapsed:3:43:21 postfix:- (2341257:tqdm_logging.py:145)
Step 10900: grad_norm=0.1327, loss=0.0038, param_norm=1380.4860
05:12:29.891 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:5:59:34 elapsed:3:43:32 postfix:- (2341257:tqdm_logging.py:145)
05:12:39.995 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:6:00:16 elapsed:3:43:42 postfix:- (2341257:tqdm_logging.py:145)
05:12:50.266 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:6:04:19 elapsed:3:43:52 postfix:- (2341257:tqdm_logging.py:145)
05:13:00.452 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:5:59:02 elapsed:3:44:02 postfix:- (2341257:tqdm_logging.py:145)
05:13:10.728 [I] Progress on: 10.9kit/30.0kit rate:1.1s/it remaining:6:03:12 elapsed:3:44:13 postfix:- (2341257:tqdm_logging.py:145)
05:13:21.316 [I] Progress on: 10.9kit/30.0kit rate:1.2s/it remaining:6:36:24 elapsed:3:44:23 postfix:- (2341257:tqdm_logging.py:145)
05:13:31.398 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:6:01:23 elapsed:3:44:33 postfix:- (2341257:tqdm_logging.py:145)
05:13:41.640 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:6:00:55 elapsed:3:44:43 postfix:- (2341257:tqdm_logging.py:145)
05:13:51.873 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:6:00:30 elapsed:3:44:54 postfix:- (2341257:tqdm_logging.py:145)
05:14:02.111 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:6:00:23 elapsed:3:45:04 postfix:- (2341257:tqdm_logging.py:145)
05:14:12.345 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:6:00:12 elapsed:3:45:14 postfix:- (2341257:tqdm_logging.py:145)
05:14:22.574 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:6:00:01 elapsed:3:45:24 postfix:- (2341257:tqdm_logging.py:145)
Step 11000: grad_norm=0.1191, loss=0.0037, param_norm=1380.4906
05:14:23.911 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
05:14:23.912 [I] [process=0] Saving checkpoint at step 11000                                      (2341257:checkpoint_manager.py:1408)
05:14:23.912 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000. (2341257:async_checkpointer.py:439)
05:14:23.920 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40 (2341257:atomicity.py:144)
05:14:23.926 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/assets.orbax-checkpoint-tmp-41 (2341257:atomicity.py:144)
05:14:23.927 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/params.orbax-checkpoint-tmp-42 (2341257:atomicity.py:144)
05:14:23.927 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/train_state.orbax-checkpoint-tmp-43 (2341257:atomicity.py:144)
05:14:23.938 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
05:15:00.711 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
05:15:00.718 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
05:15:00.843 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/params.orbax-checkpoint-tmp-42/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
05:16:06.404 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
05:16:06.404 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 69.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:16:06.410 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 104.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:16:06.425 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
05:16:06.425 [I] Finished blocking save in 102.51 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000. (2341257:async_checkpointer.py:548)
05:16:06.427 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
05:16:06.427 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
05:16:06.427 [I] [process=0][thread=MainThread][step=11000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
05:16:06.428 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
05:16:06.431 [I] {'step': 11000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761945263.9119112, 'wait_for_prev_duration_secs': 0.00018453598022460938, 'checkpointer_blocking_start_time': 1761945263.9123588, 'checkpointer_blocking_duration_secs': 102.51535892486572, 'get_old_steps_start_time': 1761945366.4277298, 'get_old_steps_duration_secs': 0.00016498565673828125, 'checkpoint_manager_blocking_start_time': 1761945263.9118114, 'checkpoint_manager_blocking_duration_secs': 102.51997470855713} (2341257:standard_logger.py:34)
05:16:06.432 [I] Progress on: 11.0kit/30.0kit rate:32.0s/it remaining:168:37:55 elapsed:3:47:08 postfix:- (2341257:tqdm_logging.py:145)
05:16:06.457 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 69.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:16:06.488 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/train_state.orbax-checkpoint-tmp-43/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
05:16:16.493 [I] Progress on: 11.0kit/30.0kit rate:2.4s/it remaining:12:32:15 elapsed:3:47:18 postfix:- (2341257:tqdm_logging.py:145)
05:16:20.154 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 92.4 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:16:20.155 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
05:16:20.156 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/assets.orbax-checkpoint-tmp-41 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/assets (2341257:atomicity.py:289)
05:16:20.160 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
05:16:20.274 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/train_state.orbax-checkpoint-tmp-43 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/train_state (2341257:atomicity.py:289)
05:16:20.277 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
05:16:20.341 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/params.orbax-checkpoint-tmp-42 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/params (2341257:atomicity.py:289)
05:16:20.343 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000 (2341257:atomicity.py:289)
05:16:20.712 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000`. (2341257:atomicity.py:573)
05:16:20.712 [I] Finished asynchronous save (blocking + background) in 116.80 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000 (2341257:async_checkpointer.py:412)
05:16:20.712 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
05:16:20.712 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
05:16:20.712 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
05:16:20.713 [I] [process=0][thread=save_finalize][step=11000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
05:16:20.713 [I] [process=0][thread=save_finalize][step=11000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
05:16:26.733 [I] Progress on: 11.0kit/30.0kit rate:1.2s/it remaining:6:15:39 elapsed:3:47:29 postfix:- (2341257:tqdm_logging.py:145)
05:16:36.971 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:6:00:16 elapsed:3:47:39 postfix:- (2341257:tqdm_logging.py:145)
05:16:47.209 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:5:59:22 elapsed:3:47:49 postfix:- (2341257:tqdm_logging.py:145)
05:16:57.443 [I] Progress on: 11.0kit/30.0kit rate:1.1s/it remaining:5:59:08 elapsed:3:47:59 postfix:- (2341257:tqdm_logging.py:145)
05:17:07.671 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:58:56 elapsed:3:48:09 postfix:- (2341257:tqdm_logging.py:145)
05:17:17.914 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:59:16 elapsed:3:48:20 postfix:- (2341257:tqdm_logging.py:145)
05:17:28.147 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:58:26 elapsed:3:48:30 postfix:- (2341257:tqdm_logging.py:145)
05:17:38.380 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:58:29 elapsed:3:48:40 postfix:- (2341257:tqdm_logging.py:145)
05:17:48.613 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:58:41 elapsed:3:48:50 postfix:- (2341257:tqdm_logging.py:145)
05:17:58.852 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:58:31 elapsed:3:49:01 postfix:- (2341257:tqdm_logging.py:145)
Step 11100: grad_norm=0.1231, loss=0.0040, param_norm=1380.4956
05:18:09.124 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:57:42 elapsed:3:49:11 postfix:- (2341257:tqdm_logging.py:145)
05:18:19.360 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:57:56 elapsed:3:49:21 postfix:- (2341257:tqdm_logging.py:145)
05:18:29.588 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:57:19 elapsed:3:49:31 postfix:- (2341257:tqdm_logging.py:145)
05:18:39.822 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:57:28 elapsed:3:49:42 postfix:- (2341257:tqdm_logging.py:145)
05:18:50.056 [I] Progress on: 11.1kit/30.0kit rate:1.1s/it remaining:5:57:20 elapsed:3:49:52 postfix:- (2341257:tqdm_logging.py:145)
05:19:00.287 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:57:00 elapsed:3:50:02 postfix:- (2341257:tqdm_logging.py:145)
05:19:10.525 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:57:10 elapsed:3:50:12 postfix:- (2341257:tqdm_logging.py:145)
05:19:20.758 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:56:49 elapsed:3:50:23 postfix:- (2341257:tqdm_logging.py:145)
05:19:30.986 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:56:19 elapsed:3:50:33 postfix:- (2341257:tqdm_logging.py:145)
05:19:41.222 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:56:36 elapsed:3:50:43 postfix:- (2341257:tqdm_logging.py:145)
05:19:51.456 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:56:21 elapsed:3:50:53 postfix:- (2341257:tqdm_logging.py:145)
Step 11200: grad_norm=0.1327, loss=0.0040, param_norm=1380.5002
05:20:01.733 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:55:59 elapsed:3:51:04 postfix:- (2341257:tqdm_logging.py:145)
05:20:11.970 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:55:56 elapsed:3:51:14 postfix:- (2341257:tqdm_logging.py:145)
05:20:22.213 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:56:13 elapsed:3:51:24 postfix:- (2341257:tqdm_logging.py:145)
05:20:32.440 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:55:36 elapsed:3:51:34 postfix:- (2341257:tqdm_logging.py:145)
05:20:42.673 [I] Progress on: 11.2kit/30.0kit rate:1.1s/it remaining:5:55:24 elapsed:3:51:44 postfix:- (2341257:tqdm_logging.py:145)
05:20:52.911 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:55:38 elapsed:3:51:55 postfix:- (2341257:tqdm_logging.py:145)
05:21:03.153 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:55:19 elapsed:3:52:05 postfix:- (2341257:tqdm_logging.py:145)
05:21:13.385 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:54:45 elapsed:3:52:15 postfix:- (2341257:tqdm_logging.py:145)
05:21:23.626 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:55:02 elapsed:3:52:25 postfix:- (2341257:tqdm_logging.py:145)
05:21:33.858 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:54:34 elapsed:3:52:36 postfix:- (2341257:tqdm_logging.py:145)
05:21:44.097 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:54:32 elapsed:3:52:46 postfix:- (2341257:tqdm_logging.py:145)
Step 11300: grad_norm=0.1160, loss=0.0036, param_norm=1380.5050
05:21:54.376 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:54:10 elapsed:3:52:56 postfix:- (2341257:tqdm_logging.py:145)
05:22:04.612 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:54:23 elapsed:3:53:06 postfix:- (2341257:tqdm_logging.py:145)
05:22:14.846 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:53:44 elapsed:3:53:17 postfix:- (2341257:tqdm_logging.py:145)
05:22:25.088 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:54:10 elapsed:3:53:27 postfix:- (2341257:tqdm_logging.py:145)
05:22:35.326 [I] Progress on: 11.3kit/30.0kit rate:1.1s/it remaining:5:53:43 elapsed:3:53:37 postfix:- (2341257:tqdm_logging.py:145)
05:22:45.559 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:53:22 elapsed:3:53:47 postfix:- (2341257:tqdm_logging.py:145)
05:22:55.797 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:53:20 elapsed:3:53:58 postfix:- (2341257:tqdm_logging.py:145)
05:23:06.233 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:55:56 elapsed:3:54:08 postfix:- (2341257:tqdm_logging.py:145)
05:23:16.501 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:54:21 elapsed:3:54:18 postfix:- (2341257:tqdm_logging.py:145)
05:23:26.714 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:51:09 elapsed:3:54:29 postfix:- (2341257:tqdm_logging.py:145)
05:23:36.989 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:55:19 elapsed:3:54:39 postfix:- (2341257:tqdm_logging.py:145)
Step 11400: grad_norm=0.1237, loss=0.0038, param_norm=1380.5096
05:23:47.248 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:50:20 elapsed:3:54:49 postfix:- (2341257:tqdm_logging.py:145)
05:23:57.518 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:53:50 elapsed:3:54:59 postfix:- (2341257:tqdm_logging.py:145)
05:24:07.725 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:50:09 elapsed:3:55:10 postfix:- (2341257:tqdm_logging.py:145)
05:24:18.005 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:54:48 elapsed:3:55:20 postfix:- (2341257:tqdm_logging.py:145)
05:24:28.197 [I] Progress on: 11.4kit/30.0kit rate:1.1s/it remaining:5:49:40 elapsed:3:55:30 postfix:- (2341257:tqdm_logging.py:145)
05:24:38.463 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:52:50 elapsed:3:55:40 postfix:- (2341257:tqdm_logging.py:145)
05:24:48.653 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:48:33 elapsed:3:55:50 postfix:- (2341257:tqdm_logging.py:145)
05:24:59.242 [I] Progress on: 11.5kit/30.0kit rate:1.2s/it remaining:6:10:23 elapsed:3:56:01 postfix:- (2341257:tqdm_logging.py:145)
05:25:09.405 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:48:30 elapsed:3:56:11 postfix:- (2341257:tqdm_logging.py:145)
05:25:19.630 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:50:45 elapsed:3:56:21 postfix:- (2341257:tqdm_logging.py:145)
05:25:29.814 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:48:22 elapsed:3:56:32 postfix:- (2341257:tqdm_logging.py:145)
Step 11500: grad_norm=0.1427, loss=0.0036, param_norm=1380.5140
05:25:40.137 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:53:25 elapsed:3:56:42 postfix:- (2341257:tqdm_logging.py:145)
05:25:50.321 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:47:54 elapsed:3:56:52 postfix:- (2341257:tqdm_logging.py:145)
05:26:00.591 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:51:33 elapsed:3:57:02 postfix:- (2341257:tqdm_logging.py:145)
05:26:10.796 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:48:22 elapsed:3:57:13 postfix:- (2341257:tqdm_logging.py:145)
05:26:21.067 [I] Progress on: 11.5kit/30.0kit rate:1.1s/it remaining:5:52:07 elapsed:3:57:23 postfix:- (2341257:tqdm_logging.py:145)
05:26:31.261 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:47:36 elapsed:3:57:33 postfix:- (2341257:tqdm_logging.py:145)
05:26:41.520 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:50:10 elapsed:3:57:43 postfix:- (2341257:tqdm_logging.py:145)
05:26:51.728 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:48:05 elapsed:3:57:54 postfix:- (2341257:tqdm_logging.py:145)
05:27:02.003 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:51:38 elapsed:3:58:04 postfix:- (2341257:tqdm_logging.py:145)
05:27:12.192 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:46:43 elapsed:3:58:14 postfix:- (2341257:tqdm_logging.py:145)
05:27:22.449 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:49:46 elapsed:3:58:24 postfix:- (2341257:tqdm_logging.py:145)
Step 11600: grad_norm=0.1249, loss=0.0037, param_norm=1380.5187
05:27:32.709 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:46:33 elapsed:3:58:35 postfix:- (2341257:tqdm_logging.py:145)
05:27:42.961 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:50:11 elapsed:3:58:45 postfix:- (2341257:tqdm_logging.py:145)
05:27:53.119 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:45:02 elapsed:3:58:55 postfix:- (2341257:tqdm_logging.py:145)
05:28:03.345 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:48:01 elapsed:3:59:05 postfix:- (2341257:tqdm_logging.py:145)
05:28:13.514 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:45:00 elapsed:3:59:15 postfix:- (2341257:tqdm_logging.py:145)
05:28:23.762 [I] Progress on: 11.6kit/30.0kit rate:1.1s/it remaining:5:49:15 elapsed:3:59:26 postfix:- (2341257:tqdm_logging.py:145)
05:28:33.914 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:44:11 elapsed:3:59:36 postfix:- (2341257:tqdm_logging.py:145)
05:28:44.141 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:47:26 elapsed:3:59:46 postfix:- (2341257:tqdm_logging.py:145)
05:28:54.319 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:44:34 elapsed:3:59:56 postfix:- (2341257:tqdm_logging.py:145)
05:29:04.557 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:48:27 elapsed:4:00:06 postfix:- (2341257:tqdm_logging.py:145)
05:29:14.714 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:43:33 elapsed:4:00:17 postfix:- (2341257:tqdm_logging.py:145)
Step 11700: grad_norm=0.1307, loss=0.0040, param_norm=1380.5237
05:29:25.112 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:47:49 elapsed:4:00:27 postfix:- (2341257:tqdm_logging.py:145)
05:29:35.282 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:43:43 elapsed:4:00:37 postfix:- (2341257:tqdm_logging.py:145)
05:29:45.528 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:47:50 elapsed:4:00:47 postfix:- (2341257:tqdm_logging.py:145)
05:29:55.680 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:42:45 elapsed:4:00:58 postfix:- (2341257:tqdm_logging.py:145)
05:30:05.911 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:46:18 elapsed:4:01:08 postfix:- (2341257:tqdm_logging.py:145)
05:30:16.086 [I] Progress on: 11.7kit/30.0kit rate:1.1s/it remaining:5:43:02 elapsed:4:01:18 postfix:- (2341257:tqdm_logging.py:145)
05:30:26.333 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:47:27 elapsed:4:01:28 postfix:- (2341257:tqdm_logging.py:145)
05:30:36.484 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:42:05 elapsed:4:01:38 postfix:- (2341257:tqdm_logging.py:145)
05:30:46.710 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:45:13 elapsed:4:01:49 postfix:- (2341257:tqdm_logging.py:145)
05:30:56.886 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:42:47 elapsed:4:01:59 postfix:- (2341257:tqdm_logging.py:145)
05:31:07.317 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:46:07 elapsed:4:02:09 postfix:- (2341257:tqdm_logging.py:145)
Step 11800: grad_norm=0.1205, loss=0.0039, param_norm=1380.5281
05:31:17.562 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:42:49 elapsed:4:02:19 postfix:- (2341257:tqdm_logging.py:145)
05:31:27.756 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:43:19 elapsed:4:02:30 postfix:- (2341257:tqdm_logging.py:145)
05:31:37.954 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:43:24 elapsed:4:02:40 postfix:- (2341257:tqdm_logging.py:145)
05:31:48.149 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:43:04 elapsed:4:02:50 postfix:- (2341257:tqdm_logging.py:145)
05:31:58.347 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:42:52 elapsed:4:03:00 postfix:- (2341257:tqdm_logging.py:145)
05:32:08.544 [I] Progress on: 11.8kit/30.0kit rate:1.1s/it remaining:5:42:46 elapsed:4:03:10 postfix:- (2341257:tqdm_logging.py:145)
05:32:18.751 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:42:39 elapsed:4:03:21 postfix:- (2341257:tqdm_logging.py:145)
05:32:28.949 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:42:26 elapsed:4:03:31 postfix:- (2341257:tqdm_logging.py:145)
05:32:39.146 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:42:20 elapsed:4:03:41 postfix:- (2341257:tqdm_logging.py:145)
05:32:49.341 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:42:02 elapsed:4:03:51 postfix:- (2341257:tqdm_logging.py:145)
05:32:59.539 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:42:00 elapsed:4:04:01 postfix:- (2341257:tqdm_logging.py:145)
Step 11900: grad_norm=0.1238, loss=0.0039, param_norm=1380.5325
05:33:09.899 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:41:50 elapsed:4:04:12 postfix:- (2341257:tqdm_logging.py:145)
05:33:19.981 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:41:34 elapsed:4:04:22 postfix:- (2341257:tqdm_logging.py:145)
05:33:30.176 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:41:22 elapsed:4:04:32 postfix:- (2341257:tqdm_logging.py:145)
05:33:40.373 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:41:19 elapsed:4:04:42 postfix:- (2341257:tqdm_logging.py:145)
05:33:50.569 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:41:01 elapsed:4:04:52 postfix:- (2341257:tqdm_logging.py:145)
05:34:00.769 [I] Progress on: 11.9kit/30.0kit rate:1.1s/it remaining:5:41:02 elapsed:4:05:03 postfix:- (2341257:tqdm_logging.py:145)
05:34:10.976 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:40:58 elapsed:4:05:13 postfix:- (2341257:tqdm_logging.py:145)
05:34:21.172 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:40:32 elapsed:4:05:23 postfix:- (2341257:tqdm_logging.py:145)
05:34:31.377 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:40:31 elapsed:4:05:33 postfix:- (2341257:tqdm_logging.py:145)
05:34:41.585 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:40:15 elapsed:4:05:43 postfix:- (2341257:tqdm_logging.py:145)
05:34:51.781 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:39:59 elapsed:4:05:54 postfix:- (2341257:tqdm_logging.py:145)
05:35:01.988 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:40:17 elapsed:4:06:04 postfix:- (2341257:tqdm_logging.py:145)
Step 12000: grad_norm=0.1313, loss=0.0038, param_norm=1380.5369
05:35:03.330 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
05:35:03.330 [I] [process=0] Saving checkpoint at step 12000                                      (2341257:checkpoint_manager.py:1408)
05:35:03.331 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000. (2341257:async_checkpointer.py:439)
05:35:03.341 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44 (2341257:atomicity.py:144)
05:35:03.347 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/params.orbax-checkpoint-tmp-46 (2341257:atomicity.py:144)
05:35:03.347 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/assets.orbax-checkpoint-tmp-45 (2341257:atomicity.py:144)
05:35:03.347 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/train_state.orbax-checkpoint-tmp-47 (2341257:atomicity.py:144)
05:35:03.369 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
05:35:40.500 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
05:35:40.501 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
05:35:40.623 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/params.orbax-checkpoint-tmp-46/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
05:36:46.687 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
05:36:46.688 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 69.3 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:36:46.706 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 103.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:36:46.710 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
05:36:46.710 [I] Finished blocking save in 103.38 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000. (2341257:async_checkpointer.py:548)
05:36:46.715 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
05:36:46.715 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
05:36:46.715 [I] Deleting Checkpoint[step=11000 | time=2025-10-31 21:16:06.427720+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
05:36:46.715 [I] [process=0][thread=MainThread][step=12000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
05:36:46.715 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
05:36:46.715 [I] {'step': 12000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761946503.3304565, 'wait_for_prev_duration_secs': 0.00018167495727539062, 'checkpointer_blocking_start_time': 1761946503.3308861, 'checkpointer_blocking_duration_secs': 103.38418507575989, 'get_old_steps_start_time': 1761946606.715084, 'get_old_steps_duration_secs': 0.00017523765563964844, 'checkpoint_manager_blocking_start_time': 1761946503.3303633, 'checkpoint_manager_blocking_duration_secs': 103.38531875610352} (2341257:standard_logger.py:34)
05:36:46.716 [I] Progress on: 12.0kit/30.0kit rate:32.2s/it remaining:161:03:08 elapsed:4:07:49 postfix:- (2341257:tqdm_logging.py:145)
05:36:46.722 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 69.3 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:36:46.756 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/train_state.orbax-checkpoint-tmp-47/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
05:36:56.790 [I] Progress on: 12.0kit/30.0kit rate:2.4s/it remaining:11:55:59 elapsed:4:07:59 postfix:- (2341257:tqdm_logging.py:145)
05:36:57.755 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 93.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:36:57.755 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
05:36:57.756 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/assets.orbax-checkpoint-tmp-45 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/assets (2341257:atomicity.py:289)
05:36:57.761 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
05:36:57.778 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/train_state.orbax-checkpoint-tmp-47 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/train_state (2341257:atomicity.py:289)
05:36:57.781 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
05:36:57.841 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/params.orbax-checkpoint-tmp-46 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/params (2341257:atomicity.py:289)
05:36:57.842 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000 (2341257:atomicity.py:289)
05:36:57.846 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000`. (2341257:atomicity.py:573)
05:36:57.846 [I] Finished asynchronous save (blocking + background) in 114.52 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000 (2341257:async_checkpointer.py:412)
05:36:57.846 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
05:36:57.846 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
05:36:57.847 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
05:36:58.237 [I] Deleted step 11000.                                                              (2341257:deleter.py:114)
05:36:58.237 [I] [process=0][thread=save_finalize][step=12000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
05:36:58.237 [I] [process=0][thread=save_finalize][step=12000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
05:37:07.019 [I] Progress on: 12.0kit/30.0kit rate:1.2s/it remaining:5:55:59 elapsed:4:08:09 postfix:- (2341257:tqdm_logging.py:145)
05:37:17.232 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:40:15 elapsed:4:08:19 postfix:- (2341257:tqdm_logging.py:145)
05:37:27.445 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:39:56 elapsed:4:08:29 postfix:- (2341257:tqdm_logging.py:145)
05:37:37.643 [I] Progress on: 12.0kit/30.0kit rate:1.1s/it remaining:5:39:27 elapsed:4:08:39 postfix:- (2341257:tqdm_logging.py:145)
05:37:47.838 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:38:42 elapsed:4:08:50 postfix:- (2341257:tqdm_logging.py:145)
05:37:58.047 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:39:00 elapsed:4:09:00 postfix:- (2341257:tqdm_logging.py:145)
05:38:08.243 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:38:21 elapsed:4:09:10 postfix:- (2341257:tqdm_logging.py:145)
05:38:18.437 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:38:20 elapsed:4:09:20 postfix:- (2341257:tqdm_logging.py:145)
05:38:28.632 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:37:58 elapsed:4:09:30 postfix:- (2341257:tqdm_logging.py:145)
05:38:38.833 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:37:54 elapsed:4:09:41 postfix:- (2341257:tqdm_logging.py:145)
Step 12100: grad_norm=0.1277, loss=0.0036, param_norm=1380.5413
05:38:49.081 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:37:29 elapsed:4:09:51 postfix:- (2341257:tqdm_logging.py:145)
05:38:59.286 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:38:16 elapsed:4:10:01 postfix:- (2341257:tqdm_logging.py:145)
05:39:09.481 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:37:22 elapsed:4:10:11 postfix:- (2341257:tqdm_logging.py:145)
05:39:19.679 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:37:21 elapsed:4:10:22 postfix:- (2341257:tqdm_logging.py:145)
05:39:29.874 [I] Progress on: 12.1kit/30.0kit rate:1.1s/it remaining:5:37:05 elapsed:4:10:32 postfix:- (2341257:tqdm_logging.py:145)
05:39:40.072 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:36:56 elapsed:4:10:42 postfix:- (2341257:tqdm_logging.py:145)
05:39:50.269 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:36:42 elapsed:4:10:52 postfix:- (2341257:tqdm_logging.py:145)
05:40:00.468 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:36:30 elapsed:4:11:02 postfix:- (2341257:tqdm_logging.py:145)
05:40:10.676 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:36:37 elapsed:4:11:12 postfix:- (2341257:tqdm_logging.py:145)
05:40:20.876 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:36:27 elapsed:4:11:23 postfix:- (2341257:tqdm_logging.py:145)
05:40:31.072 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:36:10 elapsed:4:11:33 postfix:- (2341257:tqdm_logging.py:145)
Step 12200: grad_norm=0.1187, loss=0.0035, param_norm=1380.5449
05:40:41.316 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:35:57 elapsed:4:11:43 postfix:- (2341257:tqdm_logging.py:145)
05:40:51.738 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:36:32 elapsed:4:11:54 postfix:- (2341257:tqdm_logging.py:145)
05:41:01.938 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:35:44 elapsed:4:12:04 postfix:- (2341257:tqdm_logging.py:145)
05:41:12.135 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:35:34 elapsed:4:12:14 postfix:- (2341257:tqdm_logging.py:145)
05:41:22.336 [I] Progress on: 12.2kit/30.0kit rate:1.1s/it remaining:5:35:37 elapsed:4:12:24 postfix:- (2341257:tqdm_logging.py:145)
05:41:32.530 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:34:58 elapsed:4:12:34 postfix:- (2341257:tqdm_logging.py:145)
05:41:42.738 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:34:48 elapsed:4:12:45 postfix:- (2341257:tqdm_logging.py:145)
05:41:52.942 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:35:20 elapsed:4:12:55 postfix:- (2341257:tqdm_logging.py:145)
05:42:03.133 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:34:30 elapsed:4:13:05 postfix:- (2341257:tqdm_logging.py:145)
05:42:13.341 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:34:36 elapsed:4:13:15 postfix:- (2341257:tqdm_logging.py:145)
05:42:23.539 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:34:17 elapsed:4:13:25 postfix:- (2341257:tqdm_logging.py:145)
Step 12300: grad_norm=0.1371, loss=0.0038, param_norm=1380.5492
05:42:33.783 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:33:50 elapsed:4:13:36 postfix:- (2341257:tqdm_logging.py:145)
05:42:43.980 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:33:58 elapsed:4:13:46 postfix:- (2341257:tqdm_logging.py:145)
05:42:54.178 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:33:44 elapsed:4:13:56 postfix:- (2341257:tqdm_logging.py:145)
05:43:04.372 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:33:28 elapsed:4:14:06 postfix:- (2341257:tqdm_logging.py:145)
05:43:14.569 [I] Progress on: 12.3kit/30.0kit rate:1.1s/it remaining:5:33:27 elapsed:4:14:16 postfix:- (2341257:tqdm_logging.py:145)
05:43:24.771 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:33:13 elapsed:4:14:27 postfix:- (2341257:tqdm_logging.py:145)
05:43:34.965 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:32:56 elapsed:4:14:37 postfix:- (2341257:tqdm_logging.py:145)
05:43:45.175 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:33:30 elapsed:4:14:47 postfix:- (2341257:tqdm_logging.py:145)
05:43:55.369 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:32:36 elapsed:4:14:57 postfix:- (2341257:tqdm_logging.py:145)
05:44:05.567 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:32:32 elapsed:4:15:07 postfix:- (2341257:tqdm_logging.py:145)
05:44:15.766 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:32:39 elapsed:4:15:18 postfix:- (2341257:tqdm_logging.py:145)
Step 12400: grad_norm=0.1128, loss=0.0035, param_norm=1380.5537
05:44:26.018 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:32:04 elapsed:4:15:28 postfix:- (2341257:tqdm_logging.py:145)
05:44:36.213 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:32:05 elapsed:4:15:38 postfix:- (2341257:tqdm_logging.py:145)
05:44:46.425 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:32:06 elapsed:4:15:48 postfix:- (2341257:tqdm_logging.py:145)
05:44:56.621 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:31:37 elapsed:4:15:58 postfix:- (2341257:tqdm_logging.py:145)
05:45:06.815 [I] Progress on: 12.4kit/30.0kit rate:1.1s/it remaining:5:31:27 elapsed:4:16:09 postfix:- (2341257:tqdm_logging.py:145)
05:45:17.011 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:31:28 elapsed:4:16:19 postfix:- (2341257:tqdm_logging.py:145)
05:45:27.205 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:31:09 elapsed:4:16:29 postfix:- (2341257:tqdm_logging.py:145)
05:45:37.400 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:30:58 elapsed:4:16:39 postfix:- (2341257:tqdm_logging.py:145)
05:45:47.605 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:31:14 elapsed:4:16:49 postfix:- (2341257:tqdm_logging.py:145)
05:45:57.800 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:30:39 elapsed:4:17:00 postfix:- (2341257:tqdm_logging.py:145)
05:46:08.005 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:30:51 elapsed:4:17:10 postfix:- (2341257:tqdm_logging.py:145)
Step 12500: grad_norm=0.1214, loss=0.0035, param_norm=1380.5577
05:46:18.250 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:30:05 elapsed:4:17:20 postfix:- (2341257:tqdm_logging.py:145)
05:46:28.445 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:30:07 elapsed:4:17:30 postfix:- (2341257:tqdm_logging.py:145)
05:46:38.639 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:29:56 elapsed:4:17:40 postfix:- (2341257:tqdm_logging.py:145)
05:46:48.837 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:29:51 elapsed:4:17:51 postfix:- (2341257:tqdm_logging.py:145)
05:46:59.033 [I] Progress on: 12.5kit/30.0kit rate:1.1s/it remaining:5:29:44 elapsed:4:18:01 postfix:- (2341257:tqdm_logging.py:145)
05:47:09.240 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:29:47 elapsed:4:18:11 postfix:- (2341257:tqdm_logging.py:145)
05:47:19.442 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:29:56 elapsed:4:18:21 postfix:- (2341257:tqdm_logging.py:145)
05:47:29.648 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:29:10 elapsed:4:18:31 postfix:- (2341257:tqdm_logging.py:145)
05:47:39.845 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:28:57 elapsed:4:18:42 postfix:- (2341257:tqdm_logging.py:145)
05:47:50.039 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:28:48 elapsed:4:18:52 postfix:- (2341257:tqdm_logging.py:145)
05:48:00.234 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:28:33 elapsed:4:19:02 postfix:- (2341257:tqdm_logging.py:145)
Step 12600: grad_norm=0.1138, loss=0.0034, param_norm=1380.5616
05:48:10.478 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:28:07 elapsed:4:19:12 postfix:- (2341257:tqdm_logging.py:145)
05:48:20.671 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:28:16 elapsed:4:19:22 postfix:- (2341257:tqdm_logging.py:145)
05:48:30.866 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:28:07 elapsed:4:19:33 postfix:- (2341257:tqdm_logging.py:145)
05:48:41.276 [I] Progress on: 12.6kit/30.0kit rate:1.2s/it remaining:5:37:11 elapsed:4:19:43 postfix:- (2341257:tqdm_logging.py:145)
05:48:51.479 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:28:10 elapsed:4:19:53 postfix:- (2341257:tqdm_logging.py:145)
05:49:01.674 [I] Progress on: 12.6kit/30.0kit rate:1.1s/it remaining:5:27:36 elapsed:4:20:03 postfix:- (2341257:tqdm_logging.py:145)
05:49:11.869 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:27:28 elapsed:4:20:14 postfix:- (2341257:tqdm_logging.py:145)
05:49:22.070 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:27:17 elapsed:4:20:24 postfix:- (2341257:tqdm_logging.py:145)
05:49:32.265 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:27:04 elapsed:4:20:34 postfix:- (2341257:tqdm_logging.py:145)
05:49:42.466 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:27:16 elapsed:4:20:44 postfix:- (2341257:tqdm_logging.py:145)
05:49:52.671 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:26:53 elapsed:4:20:54 postfix:- (2341257:tqdm_logging.py:145)
Step 12700: grad_norm=0.1263, loss=0.0037, param_norm=1380.5656
05:50:02.912 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:25:48 elapsed:4:21:05 postfix:- (2341257:tqdm_logging.py:145)
05:50:13.119 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:26:29 elapsed:4:21:15 postfix:- (2341257:tqdm_logging.py:145)
05:50:23.313 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:26:10 elapsed:4:21:25 postfix:- (2341257:tqdm_logging.py:145)
05:50:33.507 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:26:02 elapsed:4:21:35 postfix:- (2341257:tqdm_logging.py:145)
05:50:43.714 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:26:08 elapsed:4:21:46 postfix:- (2341257:tqdm_logging.py:145)
05:50:53.911 [I] Progress on: 12.7kit/30.0kit rate:1.1s/it remaining:5:25:50 elapsed:4:21:56 postfix:- (2341257:tqdm_logging.py:145)
05:51:04.106 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:25:32 elapsed:4:22:06 postfix:- (2341257:tqdm_logging.py:145)
05:51:14.303 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:25:27 elapsed:4:22:16 postfix:- (2341257:tqdm_logging.py:145)
05:51:24.498 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:25:12 elapsed:4:22:26 postfix:- (2341257:tqdm_logging.py:145)
05:51:34.702 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:25:25 elapsed:4:22:37 postfix:- (2341257:tqdm_logging.py:145)
05:51:44.899 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:24:51 elapsed:4:22:47 postfix:- (2341257:tqdm_logging.py:145)
Step 12800: grad_norm=0.1196, loss=0.0036, param_norm=1380.5693
05:51:55.144 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:23:56 elapsed:4:22:57 postfix:- (2341257:tqdm_logging.py:145)
05:52:05.340 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:24:27 elapsed:4:23:07 postfix:- (2341257:tqdm_logging.py:145)
05:52:15.549 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:25:07 elapsed:4:23:17 postfix:- (2341257:tqdm_logging.py:145)
05:52:26.014 [I] Progress on: 12.8kit/30.0kit rate:1.2s/it remaining:5:47:21 elapsed:4:23:28 postfix:- (2341257:tqdm_logging.py:145)
05:52:36.068 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:24:19 elapsed:4:23:38 postfix:- (2341257:tqdm_logging.py:145)
05:52:46.262 [I] Progress on: 12.8kit/30.0kit rate:1.1s/it remaining:5:23:48 elapsed:4:23:48 postfix:- (2341257:tqdm_logging.py:145)
05:52:56.467 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:23:53 elapsed:4:23:58 postfix:- (2341257:tqdm_logging.py:145)
05:53:06.665 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:23:50 elapsed:4:24:08 postfix:- (2341257:tqdm_logging.py:145)
05:53:16.861 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:23:21 elapsed:4:24:19 postfix:- (2341257:tqdm_logging.py:145)
05:53:27.066 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:23:22 elapsed:4:24:29 postfix:- (2341257:tqdm_logging.py:145)
05:53:37.264 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:23:18 elapsed:4:24:39 postfix:- (2341257:tqdm_logging.py:145)
Step 12900: grad_norm=0.1093, loss=0.0034, param_norm=1380.5731
05:53:47.624 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:22:54 elapsed:4:24:49 postfix:- (2341257:tqdm_logging.py:145)
05:53:57.703 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:22:35 elapsed:4:25:00 postfix:- (2341257:tqdm_logging.py:145)
05:54:07.899 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:22:29 elapsed:4:25:10 postfix:- (2341257:tqdm_logging.py:145)
05:54:18.094 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:22:17 elapsed:4:25:20 postfix:- (2341257:tqdm_logging.py:145)
05:54:28.294 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:22:12 elapsed:4:25:30 postfix:- (2341257:tqdm_logging.py:145)
05:54:38.502 [I] Progress on: 12.9kit/30.0kit rate:1.1s/it remaining:5:22:10 elapsed:4:25:40 postfix:- (2341257:tqdm_logging.py:145)
05:54:48.696 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:21:44 elapsed:4:25:51 postfix:- (2341257:tqdm_logging.py:145)
05:54:58.897 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:21:54 elapsed:4:26:01 postfix:- (2341257:tqdm_logging.py:145)
05:55:09.100 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:21:31 elapsed:4:26:11 postfix:- (2341257:tqdm_logging.py:145)
05:55:19.295 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:21:18 elapsed:4:26:21 postfix:- (2341257:tqdm_logging.py:145)
05:55:29.499 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:21:07 elapsed:4:26:31 postfix:- (2341257:tqdm_logging.py:145)
05:55:39.696 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:21:07 elapsed:4:26:42 postfix:- (2341257:tqdm_logging.py:145)
Step 13000: grad_norm=0.1218, loss=0.0034, param_norm=1380.5769
05:55:41.026 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
05:55:41.026 [I] [process=0] Saving checkpoint at step 13000                                      (2341257:checkpoint_manager.py:1408)
05:55:41.026 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000. (2341257:async_checkpointer.py:439)
05:55:41.038 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48 (2341257:atomicity.py:144)
05:55:41.043 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/assets.orbax-checkpoint-tmp-49 (2341257:atomicity.py:144)
05:55:41.043 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/params.orbax-checkpoint-tmp-50 (2341257:atomicity.py:144)
05:55:41.043 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/train_state.orbax-checkpoint-tmp-51 (2341257:atomicity.py:144)
05:55:41.062 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
05:56:16.787 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
05:56:16.788 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
05:56:16.916 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/params.orbax-checkpoint-tmp-50/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
05:57:21.979 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
05:57:21.979 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 71.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:57:21.997 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 106.3 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:57:22.001 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
05:57:22.002 [I] Finished blocking save in 100.98 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000. (2341257:async_checkpointer.py:548)
05:57:22.006 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
05:57:22.007 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
05:57:22.007 [I] Deleting Checkpoint[step=12000 | time=2025-10-31 21:36:46.715075+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
05:57:22.007 [I] [process=0][thread=MainThread][step=13000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
05:57:22.007 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
05:57:22.008 [I] {'step': 13000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761947741.0261586, 'wait_for_prev_duration_secs': 0.0001704692840576172, 'checkpointer_blocking_start_time': 1761947741.0265744, 'checkpointer_blocking_duration_secs': 100.98031973838806, 'get_old_steps_start_time': 1761947842.0069125, 'get_old_steps_duration_secs': 0.0002772808074951172, 'checkpoint_manager_blocking_start_time': 1761947741.026072, 'checkpoint_manager_blocking_duration_secs': 100.98217582702637} (2341257:standard_logger.py:34)
05:57:22.009 [I] Progress on: 13.0kit/30.0kit rate:31.5s/it remaining:148:40:52 elapsed:4:28:24 postfix:- (2341257:tqdm_logging.py:145)
05:57:22.025 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 70.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:57:22.052 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/train_state.orbax-checkpoint-tmp-51/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
05:57:32.076 [I] Progress on: 13.0kit/30.0kit rate:2.4s/it remaining:11:07:24 elapsed:4:28:34 postfix:- (2341257:tqdm_logging.py:145)
05:57:33.747 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 95.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
05:57:33.747 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
05:57:33.748 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/assets.orbax-checkpoint-tmp-49 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/assets (2341257:atomicity.py:289)
05:57:33.753 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
05:57:33.818 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/train_state.orbax-checkpoint-tmp-51 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/train_state (2341257:atomicity.py:289)
05:57:33.825 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
05:57:33.886 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/params.orbax-checkpoint-tmp-50 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/params (2341257:atomicity.py:289)
05:57:33.887 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000 (2341257:atomicity.py:289)
05:57:33.891 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000`. (2341257:atomicity.py:573)
05:57:33.891 [I] Finished asynchronous save (blocking + background) in 112.86 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000 (2341257:async_checkpointer.py:412)
05:57:33.891 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
05:57:33.891 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
05:57:33.891 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
05:57:34.513 [I] Deleted step 12000.                                                              (2341257:deleter.py:114)
05:57:34.513 [I] [process=0][thread=save_finalize][step=13000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
05:57:34.513 [I] [process=0][thread=save_finalize][step=13000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
05:57:42.304 [I] Progress on: 13.0kit/30.0kit rate:1.2s/it remaining:5:34:54 elapsed:4:28:44 postfix:- (2341257:tqdm_logging.py:145)
05:57:52.516 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:21:18 elapsed:4:28:54 postfix:- (2341257:tqdm_logging.py:145)
05:58:02.711 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:20:17 elapsed:4:29:05 postfix:- (2341257:tqdm_logging.py:145)
05:58:12.910 [I] Progress on: 13.0kit/30.0kit rate:1.1s/it remaining:5:19:56 elapsed:4:29:15 postfix:- (2341257:tqdm_logging.py:145)
05:58:23.320 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:23:09 elapsed:4:29:25 postfix:- (2341257:tqdm_logging.py:145)
05:58:33.515 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:19:55 elapsed:4:29:35 postfix:- (2341257:tqdm_logging.py:145)
05:58:43.711 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:19:34 elapsed:4:29:46 postfix:- (2341257:tqdm_logging.py:145)
05:58:53.909 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:19:25 elapsed:4:29:56 postfix:- (2341257:tqdm_logging.py:145)
05:59:04.106 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:19:19 elapsed:4:30:06 postfix:- (2341257:tqdm_logging.py:145)
05:59:14.303 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:19:11 elapsed:4:30:16 postfix:- (2341257:tqdm_logging.py:145)
Step 13100: grad_norm=0.1172, loss=0.0037, param_norm=1380.5806
05:59:24.548 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:18:48 elapsed:4:30:26 postfix:- (2341257:tqdm_logging.py:145)
05:59:34.743 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:18:44 elapsed:4:30:37 postfix:- (2341257:tqdm_logging.py:145)
05:59:44.939 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:18:32 elapsed:4:30:47 postfix:- (2341257:tqdm_logging.py:145)
05:59:55.136 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:18:24 elapsed:4:30:57 postfix:- (2341257:tqdm_logging.py:145)
06:00:05.333 [I] Progress on: 13.1kit/30.0kit rate:1.1s/it remaining:5:18:10 elapsed:4:31:07 postfix:- (2341257:tqdm_logging.py:145)
06:00:15.529 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:18:03 elapsed:4:31:17 postfix:- (2341257:tqdm_logging.py:145)
06:00:25.727 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:17:54 elapsed:4:31:28 postfix:- (2341257:tqdm_logging.py:145)
06:00:35.924 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:17:46 elapsed:4:31:38 postfix:- (2341257:tqdm_logging.py:145)
06:00:46.126 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:17:39 elapsed:4:31:48 postfix:- (2341257:tqdm_logging.py:145)
06:00:56.332 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:17:31 elapsed:4:31:58 postfix:- (2341257:tqdm_logging.py:145)
06:01:06.529 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:17:17 elapsed:4:32:08 postfix:- (2341257:tqdm_logging.py:145)
Step 13200: grad_norm=0.1600, loss=0.0035, param_norm=1380.5850
06:01:16.771 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:16:55 elapsed:4:32:19 postfix:- (2341257:tqdm_logging.py:145)
06:01:26.967 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:16:53 elapsed:4:32:29 postfix:- (2341257:tqdm_logging.py:145)
06:01:37.163 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:16:41 elapsed:4:32:39 postfix:- (2341257:tqdm_logging.py:145)
06:01:47.377 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:17:49 elapsed:4:32:49 postfix:- (2341257:tqdm_logging.py:145)
06:01:57.565 [I] Progress on: 13.2kit/30.0kit rate:1.1s/it remaining:5:16:24 elapsed:4:32:59 postfix:- (2341257:tqdm_logging.py:145)
06:02:07.760 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:16:07 elapsed:4:33:10 postfix:- (2341257:tqdm_logging.py:145)
06:02:17.961 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:16:11 elapsed:4:33:20 postfix:- (2341257:tqdm_logging.py:145)
06:02:28.158 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:15:57 elapsed:4:33:30 postfix:- (2341257:tqdm_logging.py:145)
06:02:38.367 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:15:56 elapsed:4:33:40 postfix:- (2341257:tqdm_logging.py:145)
06:02:48.562 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:15:29 elapsed:4:33:50 postfix:- (2341257:tqdm_logging.py:145)
06:02:58.763 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:15:43 elapsed:4:34:01 postfix:- (2341257:tqdm_logging.py:145)
Step 13300: grad_norm=0.1241, loss=0.0034, param_norm=1380.5884
06:03:09.007 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:15:03 elapsed:4:34:11 postfix:- (2341257:tqdm_logging.py:145)
06:03:19.204 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:15:04 elapsed:4:34:21 postfix:- (2341257:tqdm_logging.py:145)
06:03:29.402 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:14:54 elapsed:4:34:31 postfix:- (2341257:tqdm_logging.py:145)
06:03:39.599 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:14:42 elapsed:4:34:41 postfix:- (2341257:tqdm_logging.py:145)
06:03:49.797 [I] Progress on: 13.3kit/30.0kit rate:1.1s/it remaining:5:14:36 elapsed:4:34:52 postfix:- (2341257:tqdm_logging.py:145)
06:03:59.993 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:14:19 elapsed:4:35:02 postfix:- (2341257:tqdm_logging.py:145)
06:04:10.193 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:14:23 elapsed:4:35:12 postfix:- (2341257:tqdm_logging.py:145)
06:04:20.391 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:14:03 elapsed:4:35:22 postfix:- (2341257:tqdm_logging.py:145)
06:04:30.592 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:13:52 elapsed:4:35:32 postfix:- (2341257:tqdm_logging.py:145)
06:04:40.798 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:13:51 elapsed:4:35:43 postfix:- (2341257:tqdm_logging.py:145)
06:04:50.995 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:13:31 elapsed:4:35:53 postfix:- (2341257:tqdm_logging.py:145)
Step 13400: grad_norm=0.1146, loss=0.0034, param_norm=1380.5922
06:05:01.239 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:13:08 elapsed:4:36:03 postfix:- (2341257:tqdm_logging.py:145)
06:05:11.436 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:13:12 elapsed:4:36:13 postfix:- (2341257:tqdm_logging.py:145)
06:05:21.633 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:13:03 elapsed:4:36:23 postfix:- (2341257:tqdm_logging.py:145)
06:05:31.830 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:12:49 elapsed:4:36:34 postfix:- (2341257:tqdm_logging.py:145)
06:05:42.027 [I] Progress on: 13.4kit/30.0kit rate:1.1s/it remaining:5:12:40 elapsed:4:36:44 postfix:- (2341257:tqdm_logging.py:145)
06:05:52.232 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:12:49 elapsed:4:36:54 postfix:- (2341257:tqdm_logging.py:145)
06:06:02.432 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:12:37 elapsed:4:37:04 postfix:- (2341257:tqdm_logging.py:145)
06:06:12.632 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:12:16 elapsed:4:37:14 postfix:- (2341257:tqdm_logging.py:145)
06:06:23.072 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:14:43 elapsed:4:37:25 postfix:- (2341257:tqdm_logging.py:145)
06:06:33.241 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:10:18 elapsed:4:37:35 postfix:- (2341257:tqdm_logging.py:145)
06:06:43.479 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:14:01 elapsed:4:37:45 postfix:- (2341257:tqdm_logging.py:145)
Step 13500: grad_norm=0.1171, loss=0.0034, param_norm=1380.5956
06:06:53.659 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:08:28 elapsed:4:37:55 postfix:- (2341257:tqdm_logging.py:145)
06:07:03.886 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:12:20 elapsed:4:38:06 postfix:- (2341257:tqdm_logging.py:145)
06:07:14.056 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:09:35 elapsed:4:38:16 postfix:- (2341257:tqdm_logging.py:145)
06:07:24.295 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:13:21 elapsed:4:38:26 postfix:- (2341257:tqdm_logging.py:145)
06:07:34.447 [I] Progress on: 13.5kit/30.0kit rate:1.1s/it remaining:5:08:48 elapsed:4:38:36 postfix:- (2341257:tqdm_logging.py:145)
06:07:44.675 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:11:42 elapsed:4:38:46 postfix:- (2341257:tqdm_logging.py:145)
06:07:54.845 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:08:57 elapsed:4:38:57 postfix:- (2341257:tqdm_logging.py:145)
06:08:05.087 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:12:53 elapsed:4:39:07 postfix:- (2341257:tqdm_logging.py:145)
06:08:15.236 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:08:06 elapsed:4:39:17 postfix:- (2341257:tqdm_logging.py:145)
06:08:25.474 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:11:34 elapsed:4:39:27 postfix:- (2341257:tqdm_logging.py:145)
06:08:35.644 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:08:17 elapsed:4:39:37 postfix:- (2341257:tqdm_logging.py:145)
Step 13600: grad_norm=0.1237, loss=0.0037, param_norm=1380.5990
06:08:45.908 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:10:43 elapsed:4:39:48 postfix:- (2341257:tqdm_logging.py:145)
06:08:56.069 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:07:25 elapsed:4:39:58 postfix:- (2341257:tqdm_logging.py:145)
06:09:06.304 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:10:23 elapsed:4:40:08 postfix:- (2341257:tqdm_logging.py:145)
06:09:16.472 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:07:33 elapsed:4:40:18 postfix:- (2341257:tqdm_logging.py:145)
06:09:26.712 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:11:18 elapsed:4:40:29 postfix:- (2341257:tqdm_logging.py:145)
06:09:36.873 [I] Progress on: 13.6kit/30.0kit rate:1.1s/it remaining:5:07:05 elapsed:4:40:39 postfix:- (2341257:tqdm_logging.py:145)
06:09:47.101 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:09:42 elapsed:4:40:49 postfix:- (2341257:tqdm_logging.py:145)
06:09:57.272 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:07:00 elapsed:4:40:59 postfix:- (2341257:tqdm_logging.py:145)
06:10:07.519 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:10:44 elapsed:4:41:09 postfix:- (2341257:tqdm_logging.py:145)
06:10:17.671 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:06:05 elapsed:4:41:19 postfix:- (2341257:tqdm_logging.py:145)
06:10:27.899 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:09:00 elapsed:4:41:30 postfix:- (2341257:tqdm_logging.py:145)
Step 13700: grad_norm=0.1130, loss=0.0032, param_norm=1380.6027
06:10:38.090 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:04:10 elapsed:4:41:40 postfix:- (2341257:tqdm_logging.py:145)
06:10:48.329 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:09:55 elapsed:4:41:50 postfix:- (2341257:tqdm_logging.py:145)
06:10:58.481 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:05:24 elapsed:4:42:00 postfix:- (2341257:tqdm_logging.py:145)
06:11:08.709 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:08:18 elapsed:4:42:11 postfix:- (2341257:tqdm_logging.py:145)
06:11:18.878 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:05:36 elapsed:4:42:21 postfix:- (2341257:tqdm_logging.py:145)
06:11:29.118 [I] Progress on: 13.7kit/30.0kit rate:1.1s/it remaining:5:09:14 elapsed:4:42:31 postfix:- (2341257:tqdm_logging.py:145)
06:11:39.270 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:04:44 elapsed:4:42:41 postfix:- (2341257:tqdm_logging.py:145)
06:11:49.497 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:07:33 elapsed:4:42:51 postfix:- (2341257:tqdm_logging.py:145)
06:11:59.675 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:04:53 elapsed:4:43:01 postfix:- (2341257:tqdm_logging.py:145)
06:12:09.915 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:08:34 elapsed:4:43:12 postfix:- (2341257:tqdm_logging.py:145)
06:12:20.066 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:04:02 elapsed:4:43:22 postfix:- (2341257:tqdm_logging.py:145)
Step 13800: grad_norm=0.1392, loss=0.0037, param_norm=1380.6056
06:12:30.333 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:04:34 elapsed:4:43:32 postfix:- (2341257:tqdm_logging.py:145)
06:12:40.506 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:04:17 elapsed:4:43:42 postfix:- (2341257:tqdm_logging.py:145)
06:12:50.745 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:07:56 elapsed:4:43:53 postfix:- (2341257:tqdm_logging.py:145)
06:13:00.901 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:03:36 elapsed:4:44:03 postfix:- (2341257:tqdm_logging.py:145)
06:13:11.142 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:07:10 elapsed:4:44:13 postfix:- (2341257:tqdm_logging.py:145)
06:13:21.310 [I] Progress on: 13.8kit/30.0kit rate:1.1s/it remaining:5:03:35 elapsed:4:44:23 postfix:- (2341257:tqdm_logging.py:145)
06:13:31.549 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:07:11 elapsed:4:44:33 postfix:- (2341257:tqdm_logging.py:145)
06:13:41.703 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:02:44 elapsed:4:44:44 postfix:- (2341257:tqdm_logging.py:145)
06:13:51.932 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:05:39 elapsed:4:44:54 postfix:- (2341257:tqdm_logging.py:145)
06:14:02.112 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:03:39 elapsed:4:45:04 postfix:- (2341257:tqdm_logging.py:145)
06:14:12.329 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:04:46 elapsed:4:45:14 postfix:- (2341257:tqdm_logging.py:145)
Step 13900: grad_norm=0.1118, loss=0.0034, param_norm=1380.6095
06:14:22.929 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:03:27 elapsed:4:45:25 postfix:- (2341257:tqdm_logging.py:145)
06:14:33.009 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:02:35 elapsed:4:45:35 postfix:- (2341257:tqdm_logging.py:145)
06:14:43.247 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:05:59 elapsed:4:45:45 postfix:- (2341257:tqdm_logging.py:145)
06:14:53.401 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:01:34 elapsed:4:45:55 postfix:- (2341257:tqdm_logging.py:145)
06:15:03.639 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:05:18 elapsed:4:46:05 postfix:- (2341257:tqdm_logging.py:145)
06:15:13.804 [I] Progress on: 13.9kit/30.0kit rate:1.1s/it remaining:5:01:37 elapsed:4:46:16 postfix:- (2341257:tqdm_logging.py:145)
06:15:24.178 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:06:23 elapsed:4:46:26 postfix:- (2341257:tqdm_logging.py:145)
06:15:34.329 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:00:53 elapsed:4:46:36 postfix:- (2341257:tqdm_logging.py:145)
06:15:44.557 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:03:50 elapsed:4:46:46 postfix:- (2341257:tqdm_logging.py:145)
06:15:54.735 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:01:28 elapsed:4:46:57 postfix:- (2341257:tqdm_logging.py:145)
06:16:04.982 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:04:46 elapsed:4:47:07 postfix:- (2341257:tqdm_logging.py:145)
06:16:15.135 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:00:12 elapsed:4:47:17 postfix:- (2341257:tqdm_logging.py:145)
Step 14000: grad_norm=0.1180, loss=0.0033, param_norm=1380.6128
06:16:16.496 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
06:16:16.496 [I] [process=0] Saving checkpoint at step 14000                                      (2341257:checkpoint_manager.py:1408)
06:16:16.496 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000. (2341257:async_checkpointer.py:439)
06:16:16.505 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52 (2341257:atomicity.py:144)
06:16:16.512 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/assets.orbax-checkpoint-tmp-53 (2341257:atomicity.py:144)
06:16:16.512 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/train_state.orbax-checkpoint-tmp-55 (2341257:atomicity.py:144)
06:16:16.512 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/params.orbax-checkpoint-tmp-54 (2341257:atomicity.py:144)
06:16:16.527 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
06:16:52.440 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
06:16:52.441 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
06:16:52.544 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/params.orbax-checkpoint-tmp-54/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
06:17:57.281 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
06:17:57.282 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 71.1 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:17:57.306 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 106.5 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:17:57.310 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
06:17:57.311 [I] Finished blocking save in 100.81 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000. (2341257:async_checkpointer.py:548)
06:17:57.311 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
06:17:57.312 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
06:17:57.312 [I] Deleting Checkpoint[step=13000 | time=2025-10-31 21:57:22.006899+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
06:17:57.313 [I] [process=0][thread=MainThread][step=14000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
06:17:57.318 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
06:17:57.318 [I] {'step': 14000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761948976.4961936, 'wait_for_prev_duration_secs': 0.00017762184143066406, 'checkpointer_blocking_start_time': 1761948976.4966314, 'checkpointer_blocking_duration_secs': 100.81513786315918, 'get_old_steps_start_time': 1761949077.3117929, 'get_old_steps_duration_secs': 0.0020301342010498047, 'checkpoint_manager_blocking_start_time': 1761948976.4960988, 'checkpoint_manager_blocking_duration_secs': 100.82222652435303} (2341257:standard_logger.py:34)
06:17:57.319 [I] Progress on: 14.0kit/30.0kit rate:31.4s/it remaining:139:44:20 elapsed:4:48:59 postfix:- (2341257:tqdm_logging.py:145)
06:17:57.331 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 71.1 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:17:57.360 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/train_state.orbax-checkpoint-tmp-55/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
06:18:07.377 [I] Progress on: 14.0kit/30.0kit rate:2.4s/it remaining:10:26:41 elapsed:4:49:09 postfix:- (2341257:tqdm_logging.py:145)
06:18:10.571 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 94.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:18:10.571 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
06:18:10.572 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/assets.orbax-checkpoint-tmp-53 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/assets (2341257:atomicity.py:289)
06:18:10.577 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
06:18:10.686 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/train_state.orbax-checkpoint-tmp-55 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/train_state (2341257:atomicity.py:289)
06:18:10.690 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
06:18:10.754 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/params.orbax-checkpoint-tmp-54 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/params (2341257:atomicity.py:289)
06:18:10.755 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000 (2341257:atomicity.py:289)
06:18:10.759 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000`. (2341257:atomicity.py:573)
06:18:10.759 [I] Finished asynchronous save (blocking + background) in 114.26 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000 (2341257:async_checkpointer.py:412)
06:18:10.759 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
06:18:10.760 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
06:18:10.760 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
06:18:11.268 [I] Deleted step 13000.                                                              (2341257:deleter.py:114)
06:18:11.268 [I] [process=0][thread=save_finalize][step=14000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
06:18:11.268 [I] [process=0][thread=save_finalize][step=14000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
06:18:17.654 [I] Progress on: 14.0kit/30.0kit rate:1.2s/it remaining:5:18:31 elapsed:4:49:19 postfix:- (2341257:tqdm_logging.py:145)
06:18:27.821 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:00:24 elapsed:4:49:30 postfix:- (2341257:tqdm_logging.py:145)
06:18:38.065 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:03:34 elapsed:4:49:40 postfix:- (2341257:tqdm_logging.py:145)
06:18:48.233 [I] Progress on: 14.0kit/30.0kit rate:1.1s/it remaining:5:00:14 elapsed:4:49:50 postfix:- (2341257:tqdm_logging.py:145)
06:18:58.482 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:5:03:34 elapsed:4:50:00 postfix:- (2341257:tqdm_logging.py:145)
06:19:08.634 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:4:58:59 elapsed:4:50:10 postfix:- (2341257:tqdm_logging.py:145)
06:19:18.859 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:5:01:38 elapsed:4:50:21 postfix:- (2341257:tqdm_logging.py:145)
06:19:29.029 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:4:59:09 elapsed:4:50:31 postfix:- (2341257:tqdm_logging.py:145)
06:19:39.283 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:5:03:16 elapsed:4:50:41 postfix:- (2341257:tqdm_logging.py:145)
06:19:49.435 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:4:58:22 elapsed:4:50:51 postfix:- (2341257:tqdm_logging.py:145)
Step 14100: grad_norm=0.1090, loss=0.0031, param_norm=1380.6160
06:19:59.714 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:5:01:01 elapsed:4:51:02 postfix:- (2341257:tqdm_logging.py:145)
06:20:09.884 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:4:58:24 elapsed:4:51:12 postfix:- (2341257:tqdm_logging.py:145)
06:20:20.125 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:5:02:00 elapsed:4:51:22 postfix:- (2341257:tqdm_logging.py:145)
06:20:30.275 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:4:57:38 elapsed:4:51:32 postfix:- (2341257:tqdm_logging.py:145)
06:20:40.502 [I] Progress on: 14.1kit/30.0kit rate:1.1s/it remaining:5:00:24 elapsed:4:51:42 postfix:- (2341257:tqdm_logging.py:145)
06:20:50.672 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:57:50 elapsed:4:51:52 postfix:- (2341257:tqdm_logging.py:145)
06:21:00.910 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:5:01:18 elapsed:4:52:03 postfix:- (2341257:tqdm_logging.py:145)
06:21:11.065 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:57:01 elapsed:4:52:13 postfix:- (2341257:tqdm_logging.py:145)
06:21:21.290 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:59:42 elapsed:4:52:23 postfix:- (2341257:tqdm_logging.py:145)
06:21:31.469 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:57:12 elapsed:4:52:33 postfix:- (2341257:tqdm_logging.py:145)
06:21:41.707 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:5:00:35 elapsed:4:52:44 postfix:- (2341257:tqdm_logging.py:145)
Step 14200: grad_norm=0.1143, loss=0.0033, param_norm=1380.6190
06:21:51.917 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:56:19 elapsed:4:52:54 postfix:- (2341257:tqdm_logging.py:145)
06:22:02.143 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:58:59 elapsed:4:53:04 postfix:- (2341257:tqdm_logging.py:145)
06:22:12.313 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:56:25 elapsed:4:53:14 postfix:- (2341257:tqdm_logging.py:145)
06:22:22.551 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:59:57 elapsed:4:53:24 postfix:- (2341257:tqdm_logging.py:145)
06:22:32.705 [I] Progress on: 14.2kit/30.0kit rate:1.1s/it remaining:4:55:40 elapsed:4:53:35 postfix:- (2341257:tqdm_logging.py:145)
06:22:42.932 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:58:23 elapsed:4:53:45 postfix:- (2341257:tqdm_logging.py:145)
06:22:53.102 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:55:49 elapsed:4:53:55 postfix:- (2341257:tqdm_logging.py:145)
06:23:03.339 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:59:16 elapsed:4:54:05 postfix:- (2341257:tqdm_logging.py:145)
06:23:13.498 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:55:01 elapsed:4:54:15 postfix:- (2341257:tqdm_logging.py:145)
06:23:23.733 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:57:54 elapsed:4:54:26 postfix:- (2341257:tqdm_logging.py:145)
06:23:33.903 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:55:05 elapsed:4:54:36 postfix:- (2341257:tqdm_logging.py:145)
Step 14300: grad_norm=0.1234, loss=0.0035, param_norm=1380.6222
06:23:44.196 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:58:29 elapsed:4:54:46 postfix:- (2341257:tqdm_logging.py:145)
06:23:54.618 [I] Progress on: 14.3kit/30.0kit rate:1.2s/it remaining:5:04:35 elapsed:4:54:56 postfix:- (2341257:tqdm_logging.py:145)
06:24:04.786 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:54:50 elapsed:4:55:07 postfix:- (2341257:tqdm_logging.py:145)
06:24:15.023 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:58:01 elapsed:4:55:17 postfix:- (2341257:tqdm_logging.py:145)
06:24:25.176 [I] Progress on: 14.3kit/30.0kit rate:1.1s/it remaining:4:53:48 elapsed:4:55:27 postfix:- (2341257:tqdm_logging.py:145)
06:24:35.403 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:56:27 elapsed:4:55:37 postfix:- (2341257:tqdm_logging.py:145)
06:24:45.575 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:53:55 elapsed:4:55:47 postfix:- (2341257:tqdm_logging.py:145)
06:24:55.813 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:57:21 elapsed:4:55:58 postfix:- (2341257:tqdm_logging.py:145)
06:25:05.970 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:53:25 elapsed:4:56:08 postfix:- (2341257:tqdm_logging.py:145)
06:25:16.193 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:55:47 elapsed:4:56:18 postfix:- (2341257:tqdm_logging.py:145)
06:25:26.363 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:53:14 elapsed:4:56:28 postfix:- (2341257:tqdm_logging.py:145)
Step 14400: grad_norm=0.1085, loss=0.0032, param_norm=1380.6256
06:25:36.626 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:56:03 elapsed:4:56:38 postfix:- (2341257:tqdm_logging.py:145)
06:25:46.779 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:52:25 elapsed:4:56:49 postfix:- (2341257:tqdm_logging.py:145)
06:25:57.005 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:55:04 elapsed:4:56:59 postfix:- (2341257:tqdm_logging.py:145)
06:26:07.175 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:52:29 elapsed:4:57:09 postfix:- (2341257:tqdm_logging.py:145)
06:26:17.413 [I] Progress on: 14.4kit/30.0kit rate:1.1s/it remaining:4:56:00 elapsed:4:57:19 postfix:- (2341257:tqdm_logging.py:145)
06:26:27.567 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:51:47 elapsed:4:57:29 postfix:- (2341257:tqdm_logging.py:145)
06:26:37.793 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:54:24 elapsed:4:57:40 postfix:- (2341257:tqdm_logging.py:145)
06:26:47.964 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:51:55 elapsed:4:57:50 postfix:- (2341257:tqdm_logging.py:145)
06:26:58.207 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:55:22 elapsed:4:58:00 postfix:- (2341257:tqdm_logging.py:145)
06:27:08.366 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:51:22 elapsed:4:58:10 postfix:- (2341257:tqdm_logging.py:145)
06:27:18.590 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:53:43 elapsed:4:58:20 postfix:- (2341257:tqdm_logging.py:145)
Step 14500: grad_norm=0.1159, loss=0.0032, param_norm=1380.6287
06:27:28.803 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:50:33 elapsed:4:58:31 postfix:- (2341257:tqdm_logging.py:145)
06:27:39.052 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:54:43 elapsed:4:58:41 postfix:- (2341257:tqdm_logging.py:145)
06:27:49.205 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:50:22 elapsed:4:58:51 postfix:- (2341257:tqdm_logging.py:145)
06:27:59.432 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:53:07 elapsed:4:59:01 postfix:- (2341257:tqdm_logging.py:145)
06:28:09.601 [I] Progress on: 14.5kit/30.0kit rate:1.1s/it remaining:4:50:27 elapsed:4:59:11 postfix:- (2341257:tqdm_logging.py:145)
06:28:19.838 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:53:58 elapsed:4:59:22 postfix:- (2341257:tqdm_logging.py:145)
06:28:30.004 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:49:47 elapsed:4:59:32 postfix:- (2341257:tqdm_logging.py:145)
06:28:40.238 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:52:47 elapsed:4:59:42 postfix:- (2341257:tqdm_logging.py:145)
06:28:50.403 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:49:38 elapsed:4:59:52 postfix:- (2341257:tqdm_logging.py:145)
06:29:00.647 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:53:10 elapsed:5:00:02 postfix:- (2341257:tqdm_logging.py:145)
06:29:10.801 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:48:54 elapsed:5:00:13 postfix:- (2341257:tqdm_logging.py:145)
Step 14600: grad_norm=0.1079, loss=0.0031, param_norm=1380.6316
06:29:21.054 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:50:34 elapsed:5:00:23 postfix:- (2341257:tqdm_logging.py:145)
06:29:31.223 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:49:04 elapsed:5:00:33 postfix:- (2341257:tqdm_logging.py:145)
06:29:41.461 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:52:37 elapsed:5:00:43 postfix:- (2341257:tqdm_logging.py:145)
06:29:51.611 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:48:20 elapsed:5:00:53 postfix:- (2341257:tqdm_logging.py:145)
06:30:01.840 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:51:05 elapsed:5:01:04 postfix:- (2341257:tqdm_logging.py:145)
06:30:12.004 [I] Progress on: 14.6kit/30.0kit rate:1.1s/it remaining:4:48:20 elapsed:5:01:14 postfix:- (2341257:tqdm_logging.py:145)
06:30:22.241 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:51:50 elapsed:5:01:24 postfix:- (2341257:tqdm_logging.py:145)
06:30:32.406 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:48:32 elapsed:5:01:34 postfix:- (2341257:tqdm_logging.py:145)
06:30:42.634 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:50:31 elapsed:5:01:44 postfix:- (2341257:tqdm_logging.py:145)
06:30:52.802 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:47:46 elapsed:5:01:55 postfix:- (2341257:tqdm_logging.py:145)
06:31:03.046 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:51:45 elapsed:5:02:05 postfix:- (2341257:tqdm_logging.py:145)
Step 14700: grad_norm=0.1133, loss=0.0031, param_norm=1380.6346
06:31:13.230 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:45:46 elapsed:5:02:15 postfix:- (2341257:tqdm_logging.py:145)
06:31:23.467 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:50:05 elapsed:5:02:25 postfix:- (2341257:tqdm_logging.py:145)
06:31:33.637 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:46:59 elapsed:5:02:35 postfix:- (2341257:tqdm_logging.py:145)
06:31:43.877 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:50:49 elapsed:5:02:46 postfix:- (2341257:tqdm_logging.py:145)
06:31:54.300 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:52:20 elapsed:5:02:56 postfix:- (2341257:tqdm_logging.py:145)
06:32:04.468 [I] Progress on: 14.7kit/30.0kit rate:1.1s/it remaining:4:46:37 elapsed:5:03:06 postfix:- (2341257:tqdm_logging.py:145)
06:32:14.706 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:50:00 elapsed:5:03:17 postfix:- (2341257:tqdm_logging.py:145)
06:32:24.882 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:46:49 elapsed:5:03:27 postfix:- (2341257:tqdm_logging.py:145)
06:32:35.108 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:48:22 elapsed:5:03:37 postfix:- (2341257:tqdm_logging.py:145)
06:32:45.278 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:45:55 elapsed:5:03:47 postfix:- (2341257:tqdm_logging.py:145)
06:32:55.517 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:49:22 elapsed:5:03:57 postfix:- (2341257:tqdm_logging.py:145)
Step 14800: grad_norm=0.1115, loss=0.0031, param_norm=1380.6376
06:33:05.741 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:46:03 elapsed:5:04:08 postfix:- (2341257:tqdm_logging.py:145)
06:33:15.986 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:48:40 elapsed:5:04:18 postfix:- (2341257:tqdm_logging.py:145)
06:33:26.143 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:45:15 elapsed:5:04:28 postfix:- (2341257:tqdm_logging.py:145)
06:33:36.386 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:48:51 elapsed:5:04:38 postfix:- (2341257:tqdm_logging.py:145)
06:33:46.546 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:44:32 elapsed:5:04:48 postfix:- (2341257:tqdm_logging.py:145)
06:33:56.774 [I] Progress on: 14.8kit/30.0kit rate:1.1s/it remaining:4:47:06 elapsed:5:04:59 postfix:- (2341257:tqdm_logging.py:145)
06:34:06.943 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:44:36 elapsed:5:05:09 postfix:- (2341257:tqdm_logging.py:145)
06:34:17.195 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:48:03 elapsed:5:05:19 postfix:- (2341257:tqdm_logging.py:145)
06:34:27.347 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:43:50 elapsed:5:05:29 postfix:- (2341257:tqdm_logging.py:145)
06:34:37.572 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:46:24 elapsed:5:05:39 postfix:- (2341257:tqdm_logging.py:145)
06:34:47.741 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:44:01 elapsed:5:05:50 postfix:- (2341257:tqdm_logging.py:145)
Step 14900: grad_norm=0.1392, loss=0.0036, param_norm=1380.6407
06:34:58.117 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:43:38 elapsed:5:06:00 postfix:- (2341257:tqdm_logging.py:145)
06:35:08.199 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:43:03 elapsed:5:06:10 postfix:- (2341257:tqdm_logging.py:145)
06:35:18.427 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:46:00 elapsed:5:06:20 postfix:- (2341257:tqdm_logging.py:145)
06:35:28.604 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:43:22 elapsed:5:06:30 postfix:- (2341257:tqdm_logging.py:145)
06:35:38.837 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:46:20 elapsed:5:06:41 postfix:- (2341257:tqdm_logging.py:145)
06:35:49.004 [I] Progress on: 14.9kit/30.0kit rate:1.1s/it remaining:4:42:49 elapsed:5:06:51 postfix:- (2341257:tqdm_logging.py:145)
06:35:59.227 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:44:56 elapsed:5:07:01 postfix:- (2341257:tqdm_logging.py:145)
06:36:09.400 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:42:39 elapsed:5:07:11 postfix:- (2341257:tqdm_logging.py:145)
06:36:19.638 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:45:56 elapsed:5:07:21 postfix:- (2341257:tqdm_logging.py:145)
06:36:29.804 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:42:39 elapsed:5:07:32 postfix:- (2341257:tqdm_logging.py:145)
06:36:40.040 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:44:32 elapsed:5:07:42 postfix:- (2341257:tqdm_logging.py:145)
06:36:50.210 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:41:49 elapsed:5:07:52 postfix:- (2341257:tqdm_logging.py:145)
Step 15000: grad_norm=0.1127, loss=0.0033, param_norm=1380.6437
06:36:51.590 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
06:36:51.591 [I] [process=0] Saving checkpoint at step 15000                                      (2341257:checkpoint_manager.py:1408)
06:36:51.591 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000. (2341257:async_checkpointer.py:439)
06:36:51.600 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56 (2341257:atomicity.py:144)
06:36:51.605 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/params.orbax-checkpoint-tmp-58 (2341257:atomicity.py:144)
06:36:51.605 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/train_state.orbax-checkpoint-tmp-59 (2341257:atomicity.py:144)
06:36:51.605 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/assets.orbax-checkpoint-tmp-57 (2341257:atomicity.py:144)
06:36:51.625 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
06:37:31.061 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
06:37:31.079 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
06:37:31.176 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/params.orbax-checkpoint-tmp-58/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
06:38:35.917 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
06:38:35.917 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 68.7 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:38:35.930 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 102.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:38:35.937 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
06:38:35.938 [I] Finished blocking save in 104.35 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000. (2341257:async_checkpointer.py:548)
06:38:36.219 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
06:38:36.224 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
06:38:36.224 [I] Deleting Checkpoint[step=14000 | time=2025-10-31 22:17:57.311775+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
06:38:36.224 [I] [process=0][thread=MainThread][step=15000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
06:38:36.225 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
06:38:36.226 [I] {'step': 15000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761950211.5908992, 'wait_for_prev_duration_secs': 0.00017380714416503906, 'checkpointer_blocking_start_time': 1761950211.5913136, 'checkpointer_blocking_duration_secs': 104.62806487083435, 'get_old_steps_start_time': 1761950316.2193916, 'get_old_steps_duration_secs': 0.005511283874511719, 'checkpoint_manager_blocking_start_time': 1761950211.5908122, 'checkpoint_manager_blocking_duration_secs': 104.63591694831848} (2341257:standard_logger.py:34)
06:38:36.227 [I] Progress on: 15.0kit/30.0kit rate:32.6s/it remaining:135:48:00 elapsed:5:09:38 postfix:- (2341257:tqdm_logging.py:145)
06:38:36.230 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 68.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:38:36.268 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/train_state.orbax-checkpoint-tmp-59/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
06:38:46.278 [I] Progress on: 15.0kit/30.0kit rate:2.4s/it remaining:9:58:50 elapsed:5:09:48 postfix:- (2341257:tqdm_logging.py:145)
06:38:49.758 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 90.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:38:49.758 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
06:38:49.759 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/assets.orbax-checkpoint-tmp-57 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/assets (2341257:atomicity.py:289)
06:38:49.764 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
06:38:49.806 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/train_state.orbax-checkpoint-tmp-59 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/train_state (2341257:atomicity.py:289)
06:38:49.813 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
06:38:49.876 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/params.orbax-checkpoint-tmp-58 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/params (2341257:atomicity.py:289)
06:38:49.877 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000 (2341257:atomicity.py:289)
06:38:49.882 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000`. (2341257:atomicity.py:573)
06:38:49.882 [I] Finished asynchronous save (blocking + background) in 118.29 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000 (2341257:async_checkpointer.py:412)
06:38:49.882 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
06:38:49.882 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
06:38:49.882 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
06:38:50.440 [I] Deleted step 14000.                                                              (2341257:deleter.py:114)
06:38:50.440 [I] [process=0][thread=save_finalize][step=15000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
06:38:50.440 [I] [process=0][thread=save_finalize][step=15000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
06:38:56.533 [I] Progress on: 15.0kit/30.0kit rate:1.2s/it remaining:4:57:22 elapsed:5:09:58 postfix:- (2341257:tqdm_logging.py:145)
06:39:06.718 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:42:01 elapsed:5:10:09 postfix:- (2341257:tqdm_logging.py:145)
06:39:16.959 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:44:55 elapsed:5:10:19 postfix:- (2341257:tqdm_logging.py:145)
06:39:27.113 [I] Progress on: 15.0kit/30.0kit rate:1.1s/it remaining:4:40:30 elapsed:5:10:29 postfix:- (2341257:tqdm_logging.py:145)
06:39:37.340 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:43:14 elapsed:5:10:39 postfix:- (2341257:tqdm_logging.py:145)
06:39:47.509 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:40:40 elapsed:5:10:49 postfix:- (2341257:tqdm_logging.py:145)
06:39:57.749 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:44:08 elapsed:5:11:00 postfix:- (2341257:tqdm_logging.py:145)
06:40:07.904 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:39:53 elapsed:5:11:10 postfix:- (2341257:tqdm_logging.py:145)
06:40:18.127 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:42:25 elapsed:5:11:20 postfix:- (2341257:tqdm_logging.py:145)
06:40:28.297 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:40:02 elapsed:5:11:30 postfix:- (2341257:tqdm_logging.py:145)
Step 15100: grad_norm=0.1100, loss=0.0033, param_norm=1380.6465
06:40:38.605 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:43:25 elapsed:5:11:40 postfix:- (2341257:tqdm_logging.py:145)
06:40:48.758 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:39:14 elapsed:5:11:51 postfix:- (2341257:tqdm_logging.py:145)
06:40:58.988 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:41:48 elapsed:5:12:01 postfix:- (2341257:tqdm_logging.py:145)
06:41:09.166 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:39:20 elapsed:5:12:11 postfix:- (2341257:tqdm_logging.py:145)
06:41:19.406 [I] Progress on: 15.1kit/30.0kit rate:1.1s/it remaining:4:42:43 elapsed:5:12:21 postfix:- (2341257:tqdm_logging.py:145)
06:41:29.558 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:38:32 elapsed:5:12:31 postfix:- (2341257:tqdm_logging.py:145)
06:41:39.997 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:39:53 elapsed:5:12:42 postfix:- (2341257:tqdm_logging.py:145)
06:41:50.239 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:42:22 elapsed:5:12:52 postfix:- (2341257:tqdm_logging.py:145)
06:42:00.392 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:38:04 elapsed:5:13:02 postfix:- (2341257:tqdm_logging.py:145)
06:42:10.624 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:40:45 elapsed:5:13:12 postfix:- (2341257:tqdm_logging.py:145)
06:42:20.797 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:38:17 elapsed:5:13:23 postfix:- (2341257:tqdm_logging.py:145)
Step 15200: grad_norm=0.1099, loss=0.0030, param_norm=1380.6495
06:42:31.049 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:40:27 elapsed:5:13:33 postfix:- (2341257:tqdm_logging.py:145)
06:42:41.212 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:37:44 elapsed:5:13:43 postfix:- (2341257:tqdm_logging.py:145)
06:42:51.441 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:40:27 elapsed:5:13:53 postfix:- (2341257:tqdm_logging.py:145)
06:43:01.605 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:37:29 elapsed:5:14:03 postfix:- (2341257:tqdm_logging.py:145)
06:43:11.833 [I] Progress on: 15.2kit/30.0kit rate:1.1s/it remaining:4:39:57 elapsed:5:14:14 postfix:- (2341257:tqdm_logging.py:145)
06:43:22.010 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:37:19 elapsed:5:14:24 postfix:- (2341257:tqdm_logging.py:145)
06:43:32.239 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:39:43 elapsed:5:14:34 postfix:- (2341257:tqdm_logging.py:145)
06:43:42.412 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:36:51 elapsed:5:14:44 postfix:- (2341257:tqdm_logging.py:145)
06:43:52.640 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:39:18 elapsed:5:14:54 postfix:- (2341257:tqdm_logging.py:145)
06:44:02.803 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:36:21 elapsed:5:15:05 postfix:- (2341257:tqdm_logging.py:145)
06:44:13.041 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:39:05 elapsed:5:15:15 postfix:- (2341257:tqdm_logging.py:145)
Step 15300: grad_norm=0.1072, loss=0.0031, param_norm=1380.6521
06:44:23.230 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:35:36 elapsed:5:15:25 postfix:- (2341257:tqdm_logging.py:145)
06:44:33.458 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:38:35 elapsed:5:15:35 postfix:- (2341257:tqdm_logging.py:145)
06:44:43.627 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:35:58 elapsed:5:15:45 postfix:- (2341257:tqdm_logging.py:145)
06:44:53.877 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:38:48 elapsed:5:15:56 postfix:- (2341257:tqdm_logging.py:145)
06:45:04.041 [I] Progress on: 15.3kit/30.0kit rate:1.1s/it remaining:4:35:22 elapsed:5:16:06 postfix:- (2341257:tqdm_logging.py:145)
06:45:14.282 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:38:24 elapsed:5:16:16 postfix:- (2341257:tqdm_logging.py:145)
06:45:24.446 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:35:00 elapsed:5:16:26 postfix:- (2341257:tqdm_logging.py:145)
06:45:34.673 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:37:30 elapsed:5:16:36 postfix:- (2341257:tqdm_logging.py:145)
06:45:44.847 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:35:03 elapsed:5:16:47 postfix:- (2341257:tqdm_logging.py:145)
06:45:55.073 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:37:14 elapsed:5:16:57 postfix:- (2341257:tqdm_logging.py:145)
06:46:05.252 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:34:53 elapsed:5:17:07 postfix:- (2341257:tqdm_logging.py:145)
Step 15400: grad_norm=0.1125, loss=0.0033, param_norm=1380.6550
06:46:15.499 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:36:09 elapsed:5:17:17 postfix:- (2341257:tqdm_logging.py:145)
06:46:25.676 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:34:10 elapsed:5:17:27 postfix:- (2341257:tqdm_logging.py:145)
06:46:35.902 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:36:29 elapsed:5:17:38 postfix:- (2341257:tqdm_logging.py:145)
06:46:46.081 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:34:06 elapsed:5:17:48 postfix:- (2341257:tqdm_logging.py:145)
06:46:56.306 [I] Progress on: 15.4kit/30.0kit rate:1.1s/it remaining:4:36:05 elapsed:5:17:58 postfix:- (2341257:tqdm_logging.py:145)
06:47:06.472 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:33:26 elapsed:5:18:08 postfix:- (2341257:tqdm_logging.py:145)
06:47:16.697 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:35:48 elapsed:5:18:19 postfix:- (2341257:tqdm_logging.py:145)
06:47:26.875 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:33:22 elapsed:5:18:29 postfix:- (2341257:tqdm_logging.py:145)
06:47:37.116 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:35:48 elapsed:5:18:39 postfix:- (2341257:tqdm_logging.py:145)
06:47:47.298 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:33:33 elapsed:5:18:49 postfix:- (2341257:tqdm_logging.py:145)
06:47:57.523 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:35:12 elapsed:5:18:59 postfix:- (2341257:tqdm_logging.py:145)
Step 15500: grad_norm=0.1025, loss=0.0028, param_norm=1380.6578
06:48:07.723 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:31:54 elapsed:5:19:10 postfix:- (2341257:tqdm_logging.py:145)
06:48:17.958 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:34:55 elapsed:5:19:20 postfix:- (2341257:tqdm_logging.py:145)
06:48:28.127 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:32:19 elapsed:5:19:30 postfix:- (2341257:tqdm_logging.py:145)
06:48:38.364 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:34:40 elapsed:5:19:40 postfix:- (2341257:tqdm_logging.py:145)
06:48:48.529 [I] Progress on: 15.5kit/30.0kit rate:1.1s/it remaining:4:31:40 elapsed:5:19:50 postfix:- (2341257:tqdm_logging.py:145)
06:48:58.756 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:34:07 elapsed:5:20:01 postfix:- (2341257:tqdm_logging.py:145)
06:49:08.934 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:31:51 elapsed:5:20:11 postfix:- (2341257:tqdm_logging.py:145)
06:49:19.160 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:33:46 elapsed:5:20:21 postfix:- (2341257:tqdm_logging.py:145)
06:49:29.712 [I] Progress on: 15.6kit/30.0kit rate:1.2s/it remaining:4:59:20 elapsed:5:20:32 postfix:- (2341257:tqdm_logging.py:145)
06:49:39.757 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:32:38 elapsed:5:20:42 postfix:- (2341257:tqdm_logging.py:145)
06:49:49.954 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:32:03 elapsed:5:20:52 postfix:- (2341257:tqdm_logging.py:145)
Step 15600: grad_norm=0.1151, loss=0.0032, param_norm=1380.6603
06:50:00.198 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:31:33 elapsed:5:21:02 postfix:- (2341257:tqdm_logging.py:145)
06:50:10.393 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:31:35 elapsed:5:21:12 postfix:- (2341257:tqdm_logging.py:145)
06:50:20.592 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:31:37 elapsed:5:21:22 postfix:- (2341257:tqdm_logging.py:145)
06:50:30.798 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:32:10 elapsed:5:21:33 postfix:- (2341257:tqdm_logging.py:145)
06:50:40.994 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:31:09 elapsed:5:21:43 postfix:- (2341257:tqdm_logging.py:145)
06:50:51.192 [I] Progress on: 15.6kit/30.0kit rate:1.1s/it remaining:4:31:01 elapsed:5:21:53 postfix:- (2341257:tqdm_logging.py:145)
06:51:01.388 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:30:46 elapsed:5:22:03 postfix:- (2341257:tqdm_logging.py:145)
06:51:11.597 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:31:32 elapsed:5:22:13 postfix:- (2341257:tqdm_logging.py:145)
06:51:21.792 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:30:27 elapsed:5:22:24 postfix:- (2341257:tqdm_logging.py:145)
06:51:31.989 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:30:18 elapsed:5:22:34 postfix:- (2341257:tqdm_logging.py:145)
06:51:42.186 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:30:12 elapsed:5:22:44 postfix:- (2341257:tqdm_logging.py:145)
Step 15700: grad_norm=0.1187, loss=0.0033, param_norm=1380.6631
06:51:52.432 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:29:11 elapsed:5:22:54 postfix:- (2341257:tqdm_logging.py:145)
06:52:02.630 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:29:45 elapsed:5:23:04 postfix:- (2341257:tqdm_logging.py:145)
06:52:12.828 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:29:35 elapsed:5:23:15 postfix:- (2341257:tqdm_logging.py:145)
06:52:23.023 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:29:23 elapsed:5:23:25 postfix:- (2341257:tqdm_logging.py:145)
06:52:33.219 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:29:13 elapsed:5:23:35 postfix:- (2341257:tqdm_logging.py:145)
06:52:43.414 [I] Progress on: 15.7kit/30.0kit rate:1.1s/it remaining:4:29:05 elapsed:5:23:45 postfix:- (2341257:tqdm_logging.py:145)
06:52:53.620 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:29:07 elapsed:5:23:55 postfix:- (2341257:tqdm_logging.py:145)
06:53:03.827 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:29:21 elapsed:5:24:06 postfix:- (2341257:tqdm_logging.py:145)
06:53:14.023 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:28:31 elapsed:5:24:16 postfix:- (2341257:tqdm_logging.py:145)
06:53:24.218 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:28:20 elapsed:5:24:26 postfix:- (2341257:tqdm_logging.py:145)
06:53:34.426 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:28:26 elapsed:5:24:36 postfix:- (2341257:tqdm_logging.py:145)
Step 15800: grad_norm=0.1097, loss=0.0032, param_norm=1380.6656
06:53:44.659 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:26:31 elapsed:5:24:46 postfix:- (2341257:tqdm_logging.py:145)
06:53:54.854 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:27:47 elapsed:5:24:57 postfix:- (2341257:tqdm_logging.py:145)
06:54:05.051 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:27:43 elapsed:5:25:07 postfix:- (2341257:tqdm_logging.py:145)
06:54:15.248 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:27:32 elapsed:5:25:17 postfix:- (2341257:tqdm_logging.py:145)
06:54:25.445 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:27:25 elapsed:5:25:27 postfix:- (2341257:tqdm_logging.py:145)
06:54:35.642 [I] Progress on: 15.8kit/30.0kit rate:1.1s/it remaining:4:27:14 elapsed:5:25:37 postfix:- (2341257:tqdm_logging.py:145)
06:54:45.839 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:27:00 elapsed:5:25:48 postfix:- (2341257:tqdm_logging.py:145)
06:54:56.048 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:27:25 elapsed:5:25:58 postfix:- (2341257:tqdm_logging.py:145)
06:55:06.244 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:26:42 elapsed:5:26:08 postfix:- (2341257:tqdm_logging.py:145)
06:55:16.441 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:26:31 elapsed:5:26:18 postfix:- (2341257:tqdm_logging.py:145)
06:55:26.638 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:26:22 elapsed:5:26:28 postfix:- (2341257:tqdm_logging.py:145)
Step 15900: grad_norm=0.1027, loss=0.0027, param_norm=1380.6682
06:55:37.020 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:26:57 elapsed:5:26:39 postfix:- (2341257:tqdm_logging.py:145)
06:55:47.082 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:26:00 elapsed:5:26:49 postfix:- (2341257:tqdm_logging.py:145)
06:55:57.290 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:26:06 elapsed:5:26:59 postfix:- (2341257:tqdm_logging.py:145)
06:56:07.486 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:25:40 elapsed:5:27:09 postfix:- (2341257:tqdm_logging.py:145)
06:56:17.697 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:26:30 elapsed:5:27:20 postfix:- (2341257:tqdm_logging.py:145)
06:56:27.895 [I] Progress on: 15.9kit/30.0kit rate:1.1s/it remaining:4:25:28 elapsed:5:27:30 postfix:- (2341257:tqdm_logging.py:145)
06:56:38.093 [I] Progress on: 16.0kit/30.0kit rate:1.1s/it remaining:4:25:10 elapsed:5:27:40 postfix:- (2341257:tqdm_logging.py:145)
06:56:48.289 [I] Progress on: 16.0kit/30.0kit rate:1.1s/it remaining:4:24:59 elapsed:5:27:50 postfix:- (2341257:tqdm_logging.py:145)
06:56:58.486 [I] Progress on: 16.0kit/30.0kit rate:1.1s/it remaining:4:24:49 elapsed:5:28:00 postfix:- (2341257:tqdm_logging.py:145)
06:57:08.686 [I] Progress on: 16.0kit/30.0kit rate:1.1s/it remaining:4:24:46 elapsed:5:28:11 postfix:- (2341257:tqdm_logging.py:145)
06:57:19.096 [I] Progress on: 16.0kit/30.0kit rate:1.1s/it remaining:4:25:34 elapsed:5:28:21 postfix:- (2341257:tqdm_logging.py:145)
06:57:29.493 [I] Progress on: 16.0kit/30.0kit rate:1.2s/it remaining:4:29:02 elapsed:5:28:31 postfix:- (2341257:tqdm_logging.py:145)
Step 16000: grad_norm=0.1011, loss=0.0028, param_norm=1380.6707
06:57:30.819 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
06:57:30.820 [I] [process=0] Saving checkpoint at step 16000                                      (2341257:checkpoint_manager.py:1408)
06:57:30.820 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000. (2341257:async_checkpointer.py:439)
06:57:30.827 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60 (2341257:atomicity.py:144)
06:57:30.835 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/assets.orbax-checkpoint-tmp-61 (2341257:atomicity.py:144)
06:57:30.836 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/params.orbax-checkpoint-tmp-62 (2341257:atomicity.py:144)
06:57:30.836 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/train_state.orbax-checkpoint-tmp-63 (2341257:atomicity.py:144)
06:57:30.845 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
06:58:01.555 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
06:58:01.557 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
06:58:01.661 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/params.orbax-checkpoint-tmp-62/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
06:59:05.557 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
06:59:05.557 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 75.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:59:05.574 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 113.3 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:59:05.578 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
06:59:05.582 [I] Finished blocking save in 94.76 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000. (2341257:async_checkpointer.py:548)
06:59:05.582 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
06:59:05.583 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
06:59:05.583 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
06:59:05.583 [I] [process=0][thread=MainThread][step=16000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
06:59:05.583 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
06:59:05.583 [I] {'step': 16000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761951450.8197618, 'wait_for_prev_duration_secs': 0.00016927719116210938, 'checkpointer_blocking_start_time': 1761951450.8201969, 'checkpointer_blocking_duration_secs': 94.76245141029358, 'get_old_steps_start_time': 1761951545.582661, 'get_old_steps_duration_secs': 0.0006036758422851562, 'checkpoint_manager_blocking_start_time': 1761951450.8196673, 'checkpoint_manager_blocking_duration_secs': 94.7641236782074} (2341257:standard_logger.py:34)
06:59:05.584 [I] Progress on: 16.0kit/30.0kit rate:29.6s/it remaining:115:14:12 elapsed:5:30:07 postfix:- (2341257:tqdm_logging.py:145)
06:59:05.595 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 75.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:59:05.623 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/train_state.orbax-checkpoint-tmp-63/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
06:59:16.085 [I] Progress on: 16.0kit/30.0kit rate:2.3s/it remaining:8:56:35 elapsed:5:30:18 postfix:- (2341257:tqdm_logging.py:145)
06:59:18.602 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 99.6 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
06:59:18.602 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
06:59:18.603 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/assets.orbax-checkpoint-tmp-61 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/assets (2341257:atomicity.py:289)
06:59:18.608 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
06:59:18.706 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/train_state.orbax-checkpoint-tmp-63 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/train_state (2341257:atomicity.py:289)
06:59:18.710 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
06:59:18.775 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/params.orbax-checkpoint-tmp-62 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/params (2341257:atomicity.py:289)
06:59:18.776 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000 (2341257:atomicity.py:289)
06:59:18.780 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000`. (2341257:atomicity.py:573)
06:59:18.780 [I] Finished asynchronous save (blocking + background) in 107.96 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000 (2341257:async_checkpointer.py:412)
06:59:18.780 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
06:59:18.781 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
06:59:18.781 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
06:59:18.781 [I] [process=0][thread=save_finalize][step=16000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
06:59:18.781 [I] [process=0][thread=save_finalize][step=16000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
06:59:26.325 [I] Progress on: 16.0kit/30.0kit rate:1.2s/it remaining:4:36:05 elapsed:5:30:28 postfix:- (2341257:tqdm_logging.py:145)
06:59:36.550 [I] Progress on: 16.0kit/30.0kit rate:1.1s/it remaining:4:24:49 elapsed:5:30:38 postfix:- (2341257:tqdm_logging.py:145)
06:59:46.747 [I] Progress on: 16.0kit/30.0kit rate:1.1s/it remaining:4:23:44 elapsed:5:30:49 postfix:- (2341257:tqdm_logging.py:145)
06:59:56.942 [I] Progress on: 16.0kit/30.0kit rate:1.1s/it remaining:4:23:24 elapsed:5:30:59 postfix:- (2341257:tqdm_logging.py:145)
07:00:07.142 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:23:26 elapsed:5:31:09 postfix:- (2341257:tqdm_logging.py:145)
07:00:17.462 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:23:23 elapsed:5:31:19 postfix:- (2341257:tqdm_logging.py:145)
07:00:27.656 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:22:55 elapsed:5:31:29 postfix:- (2341257:tqdm_logging.py:145)
07:00:37.852 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:22:50 elapsed:5:31:40 postfix:- (2341257:tqdm_logging.py:145)
07:00:48.047 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:22:38 elapsed:5:31:50 postfix:- (2341257:tqdm_logging.py:145)
07:00:58.244 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:22:29 elapsed:5:32:00 postfix:- (2341257:tqdm_logging.py:145)
Step 16100: grad_norm=0.1064, loss=0.0029, param_norm=1380.6731
07:01:08.479 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:22:09 elapsed:5:32:10 postfix:- (2341257:tqdm_logging.py:145)
07:01:18.675 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:22:03 elapsed:5:32:20 postfix:- (2341257:tqdm_logging.py:145)
07:01:28.873 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:22:00 elapsed:5:32:31 postfix:- (2341257:tqdm_logging.py:145)
07:01:39.069 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:21:53 elapsed:5:32:41 postfix:- (2341257:tqdm_logging.py:145)
07:01:49.279 [I] Progress on: 16.1kit/30.0kit rate:1.1s/it remaining:4:21:59 elapsed:5:32:51 postfix:- (2341257:tqdm_logging.py:145)
07:01:59.475 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:21:23 elapsed:5:33:01 postfix:- (2341257:tqdm_logging.py:145)
07:02:09.673 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:21:16 elapsed:5:33:11 postfix:- (2341257:tqdm_logging.py:145)
07:02:19.869 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:21:03 elapsed:5:33:22 postfix:- (2341257:tqdm_logging.py:145)
07:02:30.075 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:21:00 elapsed:5:33:32 postfix:- (2341257:tqdm_logging.py:145)
07:02:40.272 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:20:44 elapsed:5:33:42 postfix:- (2341257:tqdm_logging.py:145)
07:02:50.469 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:20:34 elapsed:5:33:52 postfix:- (2341257:tqdm_logging.py:145)
Step 16200: grad_norm=0.1073, loss=0.0030, param_norm=1380.6755
07:03:00.707 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:20:18 elapsed:5:34:03 postfix:- (2341257:tqdm_logging.py:145)
07:03:10.905 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:20:20 elapsed:5:34:13 postfix:- (2341257:tqdm_logging.py:145)
07:03:21.112 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:20:48 elapsed:5:34:23 postfix:- (2341257:tqdm_logging.py:145)
07:03:31.319 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:20:13 elapsed:5:34:33 postfix:- (2341257:tqdm_logging.py:145)
07:03:41.526 [I] Progress on: 16.2kit/30.0kit rate:1.1s/it remaining:4:20:19 elapsed:5:34:43 postfix:- (2341257:tqdm_logging.py:145)
07:03:51.721 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:19:32 elapsed:5:34:54 postfix:- (2341257:tqdm_logging.py:145)
07:04:01.918 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:19:22 elapsed:5:35:04 postfix:- (2341257:tqdm_logging.py:145)
07:04:12.116 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:19:19 elapsed:5:35:14 postfix:- (2341257:tqdm_logging.py:145)
07:04:22.323 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:19:07 elapsed:5:35:24 postfix:- (2341257:tqdm_logging.py:145)
07:04:32.520 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:18:55 elapsed:5:35:34 postfix:- (2341257:tqdm_logging.py:145)
07:04:42.717 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:18:43 elapsed:5:35:45 postfix:- (2341257:tqdm_logging.py:145)
Step 16300: grad_norm=0.0990, loss=0.0028, param_norm=1380.6781
07:04:52.953 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:18:21 elapsed:5:35:55 postfix:- (2341257:tqdm_logging.py:145)
07:05:03.148 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:18:19 elapsed:5:36:05 postfix:- (2341257:tqdm_logging.py:145)
07:05:13.359 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:18:40 elapsed:5:36:15 postfix:- (2341257:tqdm_logging.py:145)
07:05:23.554 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:18:03 elapsed:5:36:25 postfix:- (2341257:tqdm_logging.py:145)
07:05:33.750 [I] Progress on: 16.3kit/30.0kit rate:1.1s/it remaining:4:17:51 elapsed:5:36:36 postfix:- (2341257:tqdm_logging.py:145)
07:05:43.946 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:17:40 elapsed:5:36:46 postfix:- (2341257:tqdm_logging.py:145)
07:05:54.154 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:17:31 elapsed:5:36:56 postfix:- (2341257:tqdm_logging.py:145)
07:06:04.350 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:17:17 elapsed:5:37:06 postfix:- (2341257:tqdm_logging.py:145)
07:06:14.549 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:17:16 elapsed:5:37:16 postfix:- (2341257:tqdm_logging.py:145)
07:06:24.746 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:17:03 elapsed:5:37:27 postfix:- (2341257:tqdm_logging.py:145)
07:06:34.953 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:16:51 elapsed:5:37:37 postfix:- (2341257:tqdm_logging.py:145)
Step 16400: grad_norm=0.1027, loss=0.0029, param_norm=1380.6805
07:06:45.187 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:16:23 elapsed:5:37:47 postfix:- (2341257:tqdm_logging.py:145)
07:06:55.383 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:16:30 elapsed:5:37:57 postfix:- (2341257:tqdm_logging.py:145)
07:07:05.789 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:17:59 elapsed:5:38:08 postfix:- (2341257:tqdm_logging.py:145)
07:07:15.984 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:16:10 elapsed:5:38:18 postfix:- (2341257:tqdm_logging.py:145)
07:07:26.179 [I] Progress on: 16.4kit/30.0kit rate:1.1s/it remaining:4:15:59 elapsed:5:38:28 postfix:- (2341257:tqdm_logging.py:145)
07:07:36.387 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:16:06 elapsed:5:38:38 postfix:- (2341257:tqdm_logging.py:145)
07:07:46.595 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:16:26 elapsed:5:38:48 postfix:- (2341257:tqdm_logging.py:145)
07:07:56.791 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:15:29 elapsed:5:38:59 postfix:- (2341257:tqdm_logging.py:145)
07:08:06.988 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:15:14 elapsed:5:39:09 postfix:- (2341257:tqdm_logging.py:145)
07:08:17.184 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:15:04 elapsed:5:39:19 postfix:- (2341257:tqdm_logging.py:145)
07:08:27.380 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:14:59 elapsed:5:39:29 postfix:- (2341257:tqdm_logging.py:145)
Step 16500: grad_norm=0.0966, loss=0.0029, param_norm=1380.6827
07:08:37.617 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:14:25 elapsed:5:39:39 postfix:- (2341257:tqdm_logging.py:145)
07:08:47.812 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:14:39 elapsed:5:39:50 postfix:- (2341257:tqdm_logging.py:145)
07:08:58.019 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:14:35 elapsed:5:40:00 postfix:- (2341257:tqdm_logging.py:145)
07:09:08.215 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:14:16 elapsed:5:40:10 postfix:- (2341257:tqdm_logging.py:145)
07:09:18.422 [I] Progress on: 16.5kit/30.0kit rate:1.1s/it remaining:4:14:06 elapsed:5:40:20 postfix:- (2341257:tqdm_logging.py:145)
07:09:28.619 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:13:54 elapsed:5:40:30 postfix:- (2341257:tqdm_logging.py:145)
07:09:38.816 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:13:44 elapsed:5:40:41 postfix:- (2341257:tqdm_logging.py:145)
07:09:49.010 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:13:32 elapsed:5:40:51 postfix:- (2341257:tqdm_logging.py:145)
07:09:59.214 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:13:28 elapsed:5:41:01 postfix:- (2341257:tqdm_logging.py:145)
07:10:09.409 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:13:13 elapsed:5:41:11 postfix:- (2341257:tqdm_logging.py:145)
07:10:19.603 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:13:02 elapsed:5:41:21 postfix:- (2341257:tqdm_logging.py:145)
Step 16600: grad_norm=0.1046, loss=0.0030, param_norm=1380.6849
07:10:29.839 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:12:26 elapsed:5:41:32 postfix:- (2341257:tqdm_logging.py:145)
07:10:40.036 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:12:44 elapsed:5:41:42 postfix:- (2341257:tqdm_logging.py:145)
07:10:50.238 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:13:01 elapsed:5:41:52 postfix:- (2341257:tqdm_logging.py:145)
07:11:00.441 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:12:28 elapsed:5:42:02 postfix:- (2341257:tqdm_logging.py:145)
07:11:10.638 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:12:17 elapsed:5:42:12 postfix:- (2341257:tqdm_logging.py:145)
07:11:20.835 [I] Progress on: 16.6kit/30.0kit rate:1.1s/it remaining:4:12:07 elapsed:5:42:23 postfix:- (2341257:tqdm_logging.py:145)
07:11:31.036 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:12:06 elapsed:5:42:33 postfix:- (2341257:tqdm_logging.py:145)
07:11:41.236 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:12:01 elapsed:5:42:43 postfix:- (2341257:tqdm_logging.py:145)
07:11:51.439 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:11:37 elapsed:5:42:53 postfix:- (2341257:tqdm_logging.py:145)
07:12:01.636 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:11:25 elapsed:5:43:03 postfix:- (2341257:tqdm_logging.py:145)
07:12:11.845 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:11:46 elapsed:5:43:14 postfix:- (2341257:tqdm_logging.py:145)
Step 16700: grad_norm=0.0987, loss=0.0026, param_norm=1380.6871
07:12:22.088 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:10:49 elapsed:5:43:24 postfix:- (2341257:tqdm_logging.py:145)
07:12:32.283 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:10:50 elapsed:5:43:34 postfix:- (2341257:tqdm_logging.py:145)
07:12:42.480 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:10:44 elapsed:5:43:44 postfix:- (2341257:tqdm_logging.py:145)
07:12:52.687 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:10:41 elapsed:5:43:55 postfix:- (2341257:tqdm_logging.py:145)
07:13:02.882 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:10:23 elapsed:5:44:05 postfix:- (2341257:tqdm_logging.py:145)
07:13:13.079 [I] Progress on: 16.7kit/30.0kit rate:1.1s/it remaining:4:10:16 elapsed:5:44:15 postfix:- (2341257:tqdm_logging.py:145)
07:13:23.288 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:10:24 elapsed:5:44:25 postfix:- (2341257:tqdm_logging.py:145)
07:13:33.482 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:09:54 elapsed:5:44:35 postfix:- (2341257:tqdm_logging.py:145)
07:13:43.680 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:09:42 elapsed:5:44:46 postfix:- (2341257:tqdm_logging.py:145)
07:13:53.888 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:10:16 elapsed:5:44:56 postfix:- (2341257:tqdm_logging.py:145)
07:14:04.084 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:09:20 elapsed:5:45:06 postfix:- (2341257:tqdm_logging.py:145)
Step 16800: grad_norm=0.1008, loss=0.0029, param_norm=1380.6893
07:14:14.323 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:08:03 elapsed:5:45:16 postfix:- (2341257:tqdm_logging.py:145)
07:14:24.521 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:09:02 elapsed:5:45:26 postfix:- (2341257:tqdm_logging.py:145)
07:14:34.717 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:08:54 elapsed:5:45:37 postfix:- (2341257:tqdm_logging.py:145)
07:14:44.913 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:08:44 elapsed:5:45:47 postfix:- (2341257:tqdm_logging.py:145)
07:14:55.125 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:09:14 elapsed:5:45:57 postfix:- (2341257:tqdm_logging.py:145)
07:15:05.543 [I] Progress on: 16.8kit/30.0kit rate:1.1s/it remaining:4:08:09 elapsed:5:46:07 postfix:- (2341257:tqdm_logging.py:145)
07:15:15.771 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:09:30 elapsed:5:46:18 postfix:- (2341257:tqdm_logging.py:145)
07:15:25.934 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:06:48 elapsed:5:46:28 postfix:- (2341257:tqdm_logging.py:145)
07:15:36.176 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:09:18 elapsed:5:46:38 postfix:- (2341257:tqdm_logging.py:145)
07:15:46.339 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:06:03 elapsed:5:46:48 postfix:- (2341257:tqdm_logging.py:145)
07:15:56.568 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:08:45 elapsed:5:46:58 postfix:- (2341257:tqdm_logging.py:145)
Step 16900: grad_norm=0.1059, loss=0.0031, param_norm=1380.6915
07:16:06.930 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:09:01 elapsed:5:47:09 postfix:- (2341257:tqdm_logging.py:145)
07:16:16.996 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:08:12 elapsed:5:47:19 postfix:- (2341257:tqdm_logging.py:145)
07:16:27.173 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:06:32 elapsed:5:47:29 postfix:- (2341257:tqdm_logging.py:145)
07:16:37.400 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:08:01 elapsed:5:47:39 postfix:- (2341257:tqdm_logging.py:145)
07:16:47.570 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:05:32 elapsed:5:47:49 postfix:- (2341257:tqdm_logging.py:145)
07:16:57.797 [I] Progress on: 16.9kit/30.0kit rate:1.1s/it remaining:4:07:36 elapsed:5:48:00 postfix:- (2341257:tqdm_logging.py:145)
07:17:07.962 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:05:05 elapsed:5:48:10 postfix:- (2341257:tqdm_logging.py:145)
07:17:18.201 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:07:37 elapsed:5:48:20 postfix:- (2341257:tqdm_logging.py:145)
07:17:28.367 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:04:48 elapsed:5:48:30 postfix:- (2341257:tqdm_logging.py:145)
07:17:38.595 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:07:00 elapsed:5:48:40 postfix:- (2341257:tqdm_logging.py:145)
07:17:48.761 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:04:26 elapsed:5:48:51 postfix:- (2341257:tqdm_logging.py:145)
07:17:58.991 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:06:45 elapsed:5:49:01 postfix:- (2341257:tqdm_logging.py:145)
Step 17000: grad_norm=0.1009, loss=0.0027, param_norm=1380.6937
07:18:00.292 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
07:18:00.292 [I] [process=0] Saving checkpoint at step 17000                                      (2341257:checkpoint_manager.py:1408)
07:18:00.292 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000. (2341257:async_checkpointer.py:439)
07:18:00.302 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64 (2341257:atomicity.py:144)
07:18:00.309 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/params.orbax-checkpoint-tmp-66 (2341257:atomicity.py:144)
07:18:00.309 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/assets.orbax-checkpoint-tmp-65 (2341257:atomicity.py:144)
07:18:00.309 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/train_state.orbax-checkpoint-tmp-67 (2341257:atomicity.py:144)
07:18:00.323 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
07:18:02.674 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
07:18:02.676 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
07:18:02.696 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/params.orbax-checkpoint-tmp-66/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
07:19:03.430 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
07:19:03.431 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 113.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:19:03.449 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 170.0 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:19:03.452 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
07:19:03.452 [I] Finished blocking save in 63.16 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000. (2341257:async_checkpointer.py:548)
07:19:03.453 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:19:03.453 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:19:03.457 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:19:03.458 [I] Deleting Checkpoint[step=16000 | time=2025-10-31 22:59:05.582651+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
07:19:03.458 [I] [process=0][thread=MainThread][step=17000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
07:19:03.459 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
07:19:03.459 [I] {'step': 17000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761952680.2922263, 'wait_for_prev_duration_secs': 0.00017786026000976562, 'checkpointer_blocking_start_time': 1761952680.2926939, 'checkpointer_blocking_duration_secs': 63.16058349609375, 'get_old_steps_start_time': 1761952743.45329, 'get_old_steps_duration_secs': 0.005318403244018555, 'checkpoint_manager_blocking_start_time': 1761952680.292123, 'checkpoint_manager_blocking_duration_secs': 63.16736960411072} (2341257:standard_logger.py:34)
07:19:03.459 [I] Progress on: 17.0kit/30.0kit rate:20.1s/it remaining:72:42:49 elapsed:5:50:05 postfix:- (2341257:tqdm_logging.py:145)
07:19:03.466 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 113.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:19:03.500 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/train_state.orbax-checkpoint-tmp-67/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
07:19:14.068 [I] Progress on: 17.0kit/30.0kit rate:1.9s/it remaining:6:57:13 elapsed:5:50:16 postfix:- (2341257:tqdm_logging.py:145)
07:19:16.068 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 141.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:19:16.068 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
07:19:16.070 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/assets.orbax-checkpoint-tmp-65 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/assets (2341257:atomicity.py:289)
07:19:16.074 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
07:19:16.178 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/train_state.orbax-checkpoint-tmp-67 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/train_state (2341257:atomicity.py:289)
07:19:16.182 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
07:19:16.247 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/params.orbax-checkpoint-tmp-66 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/params (2341257:atomicity.py:289)
07:19:16.248 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000 (2341257:atomicity.py:289)
07:19:16.252 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000`. (2341257:atomicity.py:573)
07:19:16.252 [I] Finished asynchronous save (blocking + background) in 75.96 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000 (2341257:async_checkpointer.py:412)
07:19:16.252 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
07:19:16.252 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
07:19:16.253 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
07:19:16.649 [I] Deleted step 16000.                                                              (2341257:deleter.py:114)
07:19:16.649 [I] [process=0][thread=save_finalize][step=17000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
07:19:16.649 [I] [process=0][thread=save_finalize][step=17000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
07:19:24.276 [I] Progress on: 17.0kit/30.0kit rate:1.2s/it remaining:4:11:45 elapsed:5:50:26 postfix:- (2341257:tqdm_logging.py:145)
07:19:34.524 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:06:40 elapsed:5:50:36 postfix:- (2341257:tqdm_logging.py:145)
07:19:44.690 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:03:36 elapsed:5:50:47 postfix:- (2341257:tqdm_logging.py:145)
07:19:54.915 [I] Progress on: 17.0kit/30.0kit rate:1.1s/it remaining:4:05:32 elapsed:5:50:57 postfix:- (2341257:tqdm_logging.py:145)
07:20:05.093 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:03:24 elapsed:5:51:07 postfix:- (2341257:tqdm_logging.py:145)
07:20:15.330 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:05:57 elapsed:5:51:17 postfix:- (2341257:tqdm_logging.py:145)
07:20:25.488 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:02:50 elapsed:5:51:27 postfix:- (2341257:tqdm_logging.py:145)
07:20:35.713 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:04:53 elapsed:5:51:38 postfix:- (2341257:tqdm_logging.py:145)
07:20:45.884 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:02:37 elapsed:5:51:48 postfix:- (2341257:tqdm_logging.py:145)
07:20:56.114 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:04:59 elapsed:5:51:58 postfix:- (2341257:tqdm_logging.py:145)
Step 17100: grad_norm=0.1049, loss=0.0029, param_norm=1380.6956
07:21:06.306 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:02:10 elapsed:5:52:08 postfix:- (2341257:tqdm_logging.py:145)
07:21:16.527 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:04:02 elapsed:5:52:18 postfix:- (2341257:tqdm_logging.py:145)
07:21:26.698 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:02:00 elapsed:5:52:29 postfix:- (2341257:tqdm_logging.py:145)
07:21:36.926 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:04:08 elapsed:5:52:39 postfix:- (2341257:tqdm_logging.py:145)
07:21:47.243 [I] Progress on: 17.1kit/30.0kit rate:1.1s/it remaining:4:02:56 elapsed:5:52:49 postfix:- (2341257:tqdm_logging.py:145)
07:21:57.467 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:03:36 elapsed:5:52:59 postfix:- (2341257:tqdm_logging.py:145)
07:22:07.635 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:01:21 elapsed:5:53:09 postfix:- (2341257:tqdm_logging.py:145)
07:22:17.877 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:03:35 elapsed:5:53:20 postfix:- (2341257:tqdm_logging.py:145)
07:22:28.054 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:01:06 elapsed:5:53:30 postfix:- (2341257:tqdm_logging.py:145)
07:22:38.286 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:03:08 elapsed:5:53:40 postfix:- (2341257:tqdm_logging.py:145)
07:22:48.466 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:00:41 elapsed:5:53:50 postfix:- (2341257:tqdm_logging.py:145)
Step 17200: grad_norm=0.0928, loss=0.0024, param_norm=1380.6978
07:22:58.735 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:03:27 elapsed:5:54:01 postfix:- (2341257:tqdm_logging.py:145)
07:23:08.887 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:00:15 elapsed:5:54:11 postfix:- (2341257:tqdm_logging.py:145)
07:23:19.112 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:02:13 elapsed:5:54:21 postfix:- (2341257:tqdm_logging.py:145)
07:23:29.294 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:00:08 elapsed:5:54:31 postfix:- (2341257:tqdm_logging.py:145)
07:23:39.530 [I] Progress on: 17.2kit/30.0kit rate:1.1s/it remaining:4:02:08 elapsed:5:54:41 postfix:- (2341257:tqdm_logging.py:145)
07:23:49.698 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:3:59:30 elapsed:5:54:52 postfix:- (2341257:tqdm_logging.py:145)
07:24:00.135 [I] Progress on: 17.3kit/30.0kit rate:1.2s/it remaining:4:07:23 elapsed:5:55:02 postfix:- (2341257:tqdm_logging.py:145)
07:24:10.364 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:4:02:01 elapsed:5:55:12 postfix:- (2341257:tqdm_logging.py:145)
07:24:20.539 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:3:59:21 elapsed:5:55:22 postfix:- (2341257:tqdm_logging.py:145)
07:24:30.763 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:4:00:59 elapsed:5:55:33 postfix:- (2341257:tqdm_logging.py:145)
07:24:40.931 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:3:58:41 elapsed:5:55:43 postfix:- (2341257:tqdm_logging.py:145)
Step 17300: grad_norm=0.1022, loss=0.0027, param_norm=1380.6997
07:24:51.238 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:4:01:33 elapsed:5:55:53 postfix:- (2341257:tqdm_logging.py:145)
07:25:01.399 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:3:58:27 elapsed:5:56:03 postfix:- (2341257:tqdm_logging.py:145)
07:25:11.638 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:4:00:55 elapsed:5:56:13 postfix:- (2341257:tqdm_logging.py:145)
07:25:21.809 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:3:58:04 elapsed:5:56:24 postfix:- (2341257:tqdm_logging.py:145)
07:25:32.038 [I] Progress on: 17.3kit/30.0kit rate:1.1s/it remaining:4:00:14 elapsed:5:56:34 postfix:- (2341257:tqdm_logging.py:145)
07:25:42.204 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:57:31 elapsed:5:56:44 postfix:- (2341257:tqdm_logging.py:145)
07:25:52.431 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:59:45 elapsed:5:56:54 postfix:- (2341257:tqdm_logging.py:145)
07:26:02.600 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:57:24 elapsed:5:57:04 postfix:- (2341257:tqdm_logging.py:145)
07:26:12.829 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:59:33 elapsed:5:57:15 postfix:- (2341257:tqdm_logging.py:145)
07:26:23.009 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:57:06 elapsed:5:57:25 postfix:- (2341257:tqdm_logging.py:145)
07:26:33.234 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:58:50 elapsed:5:57:35 postfix:- (2341257:tqdm_logging.py:145)
Step 17400: grad_norm=0.0949, loss=0.0026, param_norm=1380.7019
07:26:43.467 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:56:55 elapsed:5:57:45 postfix:- (2341257:tqdm_logging.py:145)
07:26:53.692 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:58:44 elapsed:5:57:56 postfix:- (2341257:tqdm_logging.py:145)
07:27:03.874 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:56:29 elapsed:5:58:06 postfix:- (2341257:tqdm_logging.py:145)
07:27:14.102 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:58:17 elapsed:5:58:16 postfix:- (2341257:tqdm_logging.py:145)
07:27:24.272 [I] Progress on: 17.4kit/30.0kit rate:1.1s/it remaining:3:56:01 elapsed:5:58:26 postfix:- (2341257:tqdm_logging.py:145)
07:27:34.500 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:58:14 elapsed:5:58:36 postfix:- (2341257:tqdm_logging.py:145)
07:27:44.662 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:55:36 elapsed:5:58:46 postfix:- (2341257:tqdm_logging.py:145)
07:27:54.896 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:57:36 elapsed:5:58:57 postfix:- (2341257:tqdm_logging.py:145)
07:28:05.066 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:55:24 elapsed:5:59:07 postfix:- (2341257:tqdm_logging.py:145)
07:28:15.293 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:57:34 elapsed:5:59:17 postfix:- (2341257:tqdm_logging.py:145)
07:28:25.468 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:55:01 elapsed:5:59:27 postfix:- (2341257:tqdm_logging.py:145)
Step 17500: grad_norm=0.1025, loss=0.0028, param_norm=1380.7034
07:28:35.744 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:56:44 elapsed:5:59:38 postfix:- (2341257:tqdm_logging.py:145)
07:28:45.918 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:54:58 elapsed:5:59:48 postfix:- (2341257:tqdm_logging.py:145)
07:28:56.147 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:56:53 elapsed:5:59:58 postfix:- (2341257:tqdm_logging.py:145)
07:29:06.324 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:54:25 elapsed:6:00:08 postfix:- (2341257:tqdm_logging.py:145)
07:29:16.561 [I] Progress on: 17.5kit/30.0kit rate:1.1s/it remaining:3:56:25 elapsed:6:00:18 postfix:- (2341257:tqdm_logging.py:145)
07:29:26.727 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:54:03 elapsed:6:00:29 postfix:- (2341257:tqdm_logging.py:145)
07:29:36.957 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:56:11 elapsed:6:00:39 postfix:- (2341257:tqdm_logging.py:145)
07:29:47.122 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:53:40 elapsed:6:00:49 postfix:- (2341257:tqdm_logging.py:145)
07:29:57.346 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:55:29 elapsed:6:00:59 postfix:- (2341257:tqdm_logging.py:145)
07:30:07.517 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:53:30 elapsed:6:01:09 postfix:- (2341257:tqdm_logging.py:145)
07:30:17.753 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:55:24 elapsed:6:01:20 postfix:- (2341257:tqdm_logging.py:145)
Step 17600: grad_norm=0.0967, loss=0.0027, param_norm=1380.7054
07:30:27.982 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:52:53 elapsed:6:01:30 postfix:- (2341257:tqdm_logging.py:145)
07:30:38.220 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:55:07 elapsed:6:01:40 postfix:- (2341257:tqdm_logging.py:145)
07:30:48.397 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:52:43 elapsed:6:01:50 postfix:- (2341257:tqdm_logging.py:145)
07:30:58.625 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:54:41 elapsed:6:02:00 postfix:- (2341257:tqdm_logging.py:145)
07:31:08.792 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:52:19 elapsed:6:02:11 postfix:- (2341257:tqdm_logging.py:145)
07:31:19.015 [I] Progress on: 17.6kit/30.0kit rate:1.1s/it remaining:3:54:13 elapsed:6:02:21 postfix:- (2341257:tqdm_logging.py:145)
07:31:29.181 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:51:55 elapsed:6:02:31 postfix:- (2341257:tqdm_logging.py:145)
07:31:39.412 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:54:03 elapsed:6:02:41 postfix:- (2341257:tqdm_logging.py:145)
07:31:49.585 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:51:39 elapsed:6:02:51 postfix:- (2341257:tqdm_logging.py:145)
07:32:00.016 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:55:06 elapsed:6:03:02 postfix:- (2341257:tqdm_logging.py:145)
07:32:10.249 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:53:48 elapsed:6:03:12 postfix:- (2341257:tqdm_logging.py:145)
Step 17700: grad_norm=0.0954, loss=0.0026, param_norm=1380.7075
07:32:20.439 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:49:41 elapsed:6:03:22 postfix:- (2341257:tqdm_logging.py:145)
07:32:30.663 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:52:54 elapsed:6:03:32 postfix:- (2341257:tqdm_logging.py:145)
07:32:40.832 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:50:49 elapsed:6:03:43 postfix:- (2341257:tqdm_logging.py:145)
07:32:51.060 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:52:53 elapsed:6:03:53 postfix:- (2341257:tqdm_logging.py:145)
07:33:01.237 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:50:31 elapsed:6:04:03 postfix:- (2341257:tqdm_logging.py:145)
07:33:11.462 [I] Progress on: 17.7kit/30.0kit rate:1.1s/it remaining:3:52:18 elapsed:6:04:13 postfix:- (2341257:tqdm_logging.py:145)
07:33:21.631 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:50:08 elapsed:6:04:23 postfix:- (2341257:tqdm_logging.py:145)
07:33:31.857 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:52:06 elapsed:6:04:34 postfix:- (2341257:tqdm_logging.py:145)
07:33:42.031 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:49:46 elapsed:6:04:44 postfix:- (2341257:tqdm_logging.py:145)
07:33:52.255 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:51:36 elapsed:6:04:54 postfix:- (2341257:tqdm_logging.py:145)
07:34:02.425 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:49:26 elapsed:6:05:04 postfix:- (2341257:tqdm_logging.py:145)
Step 17800: grad_norm=0.0941, loss=0.0026, param_norm=1380.7094
07:34:12.679 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:49:15 elapsed:6:05:14 postfix:- (2341257:tqdm_logging.py:145)
07:34:22.843 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:49:00 elapsed:6:05:25 postfix:- (2341257:tqdm_logging.py:145)
07:34:33.070 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:51:03 elapsed:6:05:35 postfix:- (2341257:tqdm_logging.py:145)
07:34:43.239 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:48:47 elapsed:6:05:45 postfix:- (2341257:tqdm_logging.py:145)
07:34:53.469 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:50:52 elapsed:6:05:55 postfix:- (2341257:tqdm_logging.py:145)
07:35:03.632 [I] Progress on: 17.8kit/30.0kit rate:1.1s/it remaining:3:48:20 elapsed:6:06:05 postfix:- (2341257:tqdm_logging.py:145)
07:35:13.856 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:50:13 elapsed:6:06:16 postfix:- (2341257:tqdm_logging.py:145)
07:35:24.036 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:48:24 elapsed:6:06:26 postfix:- (2341257:tqdm_logging.py:145)
07:35:34.264 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:50:10 elapsed:6:06:36 postfix:- (2341257:tqdm_logging.py:145)
07:35:44.428 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:47:43 elapsed:6:06:46 postfix:- (2341257:tqdm_logging.py:145)
07:35:54.662 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:49:32 elapsed:6:06:56 postfix:- (2341257:tqdm_logging.py:145)
Step 17900: grad_norm=0.0989, loss=0.0028, param_norm=1380.7114
07:36:05.019 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:49:25 elapsed:6:07:07 postfix:- (2341257:tqdm_logging.py:145)
07:36:15.098 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:49:34 elapsed:6:07:17 postfix:- (2341257:tqdm_logging.py:145)
07:36:25.263 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:47:03 elapsed:6:07:27 postfix:- (2341257:tqdm_logging.py:145)
07:36:35.492 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:49:12 elapsed:6:07:37 postfix:- (2341257:tqdm_logging.py:145)
07:36:45.662 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:46:43 elapsed:6:07:47 postfix:- (2341257:tqdm_logging.py:145)
07:36:55.886 [I] Progress on: 17.9kit/30.0kit rate:1.1s/it remaining:3:48:39 elapsed:6:07:58 postfix:- (2341257:tqdm_logging.py:145)
07:37:06.055 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:46:26 elapsed:6:08:08 postfix:- (2341257:tqdm_logging.py:145)
07:37:16.279 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:48:17 elapsed:6:08:18 postfix:- (2341257:tqdm_logging.py:145)
07:37:26.445 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:46:01 elapsed:6:08:28 postfix:- (2341257:tqdm_logging.py:145)
07:37:36.673 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:48:05 elapsed:6:08:38 postfix:- (2341257:tqdm_logging.py:145)
07:37:46.838 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:45:43 elapsed:6:08:49 postfix:- (2341257:tqdm_logging.py:145)
07:37:57.060 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:47:23 elapsed:6:08:59 postfix:- (2341257:tqdm_logging.py:145)
Step 18000: grad_norm=0.0975, loss=0.0027, param_norm=1380.7131
07:37:58.374 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
07:37:58.374 [I] [process=0] Saving checkpoint at step 18000                                      (2341257:checkpoint_manager.py:1408)
07:37:58.375 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000. (2341257:async_checkpointer.py:439)
07:37:58.416 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68 (2341257:atomicity.py:144)
07:37:58.420 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/params.orbax-checkpoint-tmp-70 (2341257:atomicity.py:144)
07:37:58.420 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/train_state.orbax-checkpoint-tmp-71 (2341257:atomicity.py:144)
07:37:58.421 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/assets.orbax-checkpoint-tmp-69 (2341257:atomicity.py:144)
07:37:58.441 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
07:38:11.157 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
07:38:11.159 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
07:38:11.299 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/params.orbax-checkpoint-tmp-70/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
07:39:14.397 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
07:39:14.397 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 94.3 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:39:14.414 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 141.3 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:39:14.417 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
07:39:14.418 [I] Finished blocking save in 76.04 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000. (2341257:async_checkpointer.py:548)
07:39:14.421 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:39:14.422 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:39:14.422 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:39:14.422 [I] Deleting Checkpoint[step=17000 | time=2025-10-31 23:19:03.453280+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
07:39:14.423 [I] [process=0][thread=MainThread][step=18000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
07:39:14.423 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
07:39:14.424 [I] {'step': 18000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761953878.3746152, 'wait_for_prev_duration_secs': 0.00017452239990234375, 'checkpointer_blocking_start_time': 1761953878.3750403, 'checkpointer_blocking_duration_secs': 76.0466718673706, 'get_old_steps_start_time': 1761953954.4217257, 'get_old_steps_duration_secs': 0.001359701156616211, 'checkpoint_manager_blocking_start_time': 1761953878.374521, 'checkpoint_manager_blocking_duration_secs': 76.04945397377014} (2341257:standard_logger.py:34)
07:39:14.424 [I] Progress on: 18.0kit/30.0kit rate:24.0s/it remaining:80:00:36 elapsed:6:10:16 postfix:- (2341257:tqdm_logging.py:145)
07:39:14.456 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 94.2 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:39:14.489 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/train_state.orbax-checkpoint-tmp-71/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
07:39:25.281 [I] Progress on: 18.0kit/30.0kit rate:2.1s/it remaining:6:57:36 elapsed:6:10:27 postfix:- (2341257:tqdm_logging.py:145)
07:39:27.811 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 120.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:39:27.811 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
07:39:27.813 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/assets.orbax-checkpoint-tmp-69 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/assets (2341257:atomicity.py:289)
07:39:27.817 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
07:39:27.921 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/train_state.orbax-checkpoint-tmp-71 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/train_state (2341257:atomicity.py:289)
07:39:27.925 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
07:39:27.987 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/params.orbax-checkpoint-tmp-70 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68/params (2341257:atomicity.py:289)
07:39:27.988 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000.orbax-checkpoint-tmp-68 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000 (2341257:atomicity.py:289)
07:39:27.992 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000`. (2341257:atomicity.py:573)
07:39:27.992 [I] Finished asynchronous save (blocking + background) in 89.62 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/18000 (2341257:async_checkpointer.py:412)
07:39:27.992 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
07:39:27.992 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
07:39:27.992 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
07:39:28.379 [I] Deleted step 17000.                                                              (2341257:deleter.py:114)
07:39:28.379 [I] [process=0][thread=save_finalize][step=18000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
07:39:28.379 [I] [process=0][thread=save_finalize][step=18000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
07:39:35.487 [I] Progress on: 18.0kit/30.0kit rate:1.2s/it remaining:3:53:34 elapsed:6:10:37 postfix:- (2341257:tqdm_logging.py:145)
07:39:45.739 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:48:14 elapsed:6:10:48 postfix:- (2341257:tqdm_logging.py:145)
07:39:55.916 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:45:01 elapsed:6:10:58 postfix:- (2341257:tqdm_logging.py:145)
07:40:06.143 [I] Progress on: 18.0kit/30.0kit rate:1.1s/it remaining:3:46:45 elapsed:6:11:08 postfix:- (2341257:tqdm_logging.py:145)
07:40:16.310 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:44:30 elapsed:6:11:18 postfix:- (2341257:tqdm_logging.py:145)
07:40:26.540 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:46:22 elapsed:6:11:28 postfix:- (2341257:tqdm_logging.py:145)
07:40:36.712 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:44:10 elapsed:6:11:39 postfix:- (2341257:tqdm_logging.py:145)
07:40:46.949 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:46:22 elapsed:6:11:49 postfix:- (2341257:tqdm_logging.py:145)
07:40:57.116 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:43:51 elapsed:6:11:59 postfix:- (2341257:tqdm_logging.py:145)
07:41:07.343 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:45:45 elapsed:6:12:09 postfix:- (2341257:tqdm_logging.py:145)
Step 18100: grad_norm=0.0963, loss=0.0025, param_norm=1380.7148
07:41:17.782 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:46:26 elapsed:6:12:20 postfix:- (2341257:tqdm_logging.py:145)
07:41:27.952 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:43:22 elapsed:6:12:30 postfix:- (2341257:tqdm_logging.py:145)
07:41:38.177 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:45:12 elapsed:6:12:40 postfix:- (2341257:tqdm_logging.py:145)
07:41:48.344 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:43:01 elapsed:6:12:50 postfix:- (2341257:tqdm_logging.py:145)
07:41:58.581 [I] Progress on: 18.1kit/30.0kit rate:1.1s/it remaining:3:44:55 elapsed:6:13:00 postfix:- (2341257:tqdm_logging.py:145)
07:42:08.747 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:42:34 elapsed:6:13:11 postfix:- (2341257:tqdm_logging.py:145)
07:42:18.974 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:44:38 elapsed:6:13:21 postfix:- (2341257:tqdm_logging.py:145)
07:42:29.150 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:42:25 elapsed:6:13:31 postfix:- (2341257:tqdm_logging.py:145)
07:42:39.375 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:44:07 elapsed:6:13:41 postfix:- (2341257:tqdm_logging.py:145)
07:42:49.552 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:42:16 elapsed:6:13:51 postfix:- (2341257:tqdm_logging.py:145)
07:42:59.777 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:43:48 elapsed:6:14:02 postfix:- (2341257:tqdm_logging.py:145)
Step 18200: grad_norm=0.0939, loss=0.0024, param_norm=1380.7167
07:43:09.999 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:41:37 elapsed:6:14:12 postfix:- (2341257:tqdm_logging.py:145)
07:43:20.224 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:43:28 elapsed:6:14:22 postfix:- (2341257:tqdm_logging.py:145)
07:43:30.393 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:41:22 elapsed:6:14:32 postfix:- (2341257:tqdm_logging.py:145)
07:43:40.730 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:44:25 elapsed:6:14:43 postfix:- (2341257:tqdm_logging.py:145)
07:43:50.897 [I] Progress on: 18.2kit/30.0kit rate:1.1s/it remaining:3:41:01 elapsed:6:14:53 postfix:- (2341257:tqdm_logging.py:145)
07:44:01.122 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:42:48 elapsed:6:15:03 postfix:- (2341257:tqdm_logging.py:145)
07:44:11.300 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:41:06 elapsed:6:15:13 postfix:- (2341257:tqdm_logging.py:145)
07:44:21.525 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:42:29 elapsed:6:15:23 postfix:- (2341257:tqdm_logging.py:145)
07:44:31.702 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:40:45 elapsed:6:15:34 postfix:- (2341257:tqdm_logging.py:145)
07:44:41.927 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:42:02 elapsed:6:15:44 postfix:- (2341257:tqdm_logging.py:145)
07:44:52.095 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:39:54 elapsed:6:15:54 postfix:- (2341257:tqdm_logging.py:145)
Step 18300: grad_norm=0.1046, loss=0.0029, param_norm=1380.7184
07:45:02.373 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:41:47 elapsed:6:16:04 postfix:- (2341257:tqdm_logging.py:145)
07:45:12.552 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:39:41 elapsed:6:16:14 postfix:- (2341257:tqdm_logging.py:145)
07:45:22.777 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:41:26 elapsed:6:16:25 postfix:- (2341257:tqdm_logging.py:145)
07:45:32.943 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:39:13 elapsed:6:16:35 postfix:- (2341257:tqdm_logging.py:145)
07:45:43.181 [I] Progress on: 18.3kit/30.0kit rate:1.1s/it remaining:3:41:20 elapsed:6:16:45 postfix:- (2341257:tqdm_logging.py:145)
07:45:53.348 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:38:53 elapsed:6:16:55 postfix:- (2341257:tqdm_logging.py:145)
07:46:03.572 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:40:42 elapsed:6:17:05 postfix:- (2341257:tqdm_logging.py:145)
07:46:13.752 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:38:40 elapsed:6:17:16 postfix:- (2341257:tqdm_logging.py:145)
07:46:23.975 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:40:20 elapsed:6:17:26 postfix:- (2341257:tqdm_logging.py:145)
07:46:34.146 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:38:24 elapsed:6:17:36 postfix:- (2341257:tqdm_logging.py:145)
07:46:44.378 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:40:06 elapsed:6:17:46 postfix:- (2341257:tqdm_logging.py:145)
Step 18400: grad_norm=0.0928, loss=0.0025, param_norm=1380.7196
07:46:54.600 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:37:51 elapsed:6:17:56 postfix:- (2341257:tqdm_logging.py:145)
07:47:04.826 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:39:46 elapsed:6:18:07 postfix:- (2341257:tqdm_logging.py:145)
07:47:14.990 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:37:30 elapsed:6:18:17 postfix:- (2341257:tqdm_logging.py:145)
07:47:25.230 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:39:35 elapsed:6:18:27 postfix:- (2341257:tqdm_logging.py:145)
07:47:35.397 [I] Progress on: 18.4kit/30.0kit rate:1.1s/it remaining:3:37:15 elapsed:6:18:37 postfix:- (2341257:tqdm_logging.py:145)
07:47:45.621 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:39:02 elapsed:6:18:47 postfix:- (2341257:tqdm_logging.py:145)
07:47:55.790 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:36:56 elapsed:6:18:58 postfix:- (2341257:tqdm_logging.py:145)
07:48:06.023 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:38:48 elapsed:6:19:08 postfix:- (2341257:tqdm_logging.py:145)
07:48:16.189 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:36:31 elapsed:6:19:18 postfix:- (2341257:tqdm_logging.py:145)
07:48:26.423 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:38:42 elapsed:6:19:28 postfix:- (2341257:tqdm_logging.py:145)
07:48:36.589 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:36:12 elapsed:6:19:38 postfix:- (2341257:tqdm_logging.py:145)
Step 18500: grad_norm=0.1013, loss=0.0030, param_norm=1380.7214
07:48:46.882 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:38:49 elapsed:6:19:49 postfix:- (2341257:tqdm_logging.py:145)
07:48:57.032 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:35:48 elapsed:6:19:59 postfix:- (2341257:tqdm_logging.py:145)
07:49:07.240 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:36:43 elapsed:6:20:09 postfix:- (2341257:tqdm_logging.py:145)
07:49:17.657 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:37:02 elapsed:6:20:19 postfix:- (2341257:tqdm_logging.py:145)
07:49:27.857 [I] Progress on: 18.5kit/30.0kit rate:1.1s/it remaining:3:36:27 elapsed:6:20:30 postfix:- (2341257:tqdm_logging.py:145)
07:49:38.054 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:36:14 elapsed:6:20:40 postfix:- (2341257:tqdm_logging.py:145)
07:49:48.251 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:36:00 elapsed:6:20:50 postfix:- (2341257:tqdm_logging.py:145)
07:49:58.448 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:35:51 elapsed:6:21:00 postfix:- (2341257:tqdm_logging.py:145)
07:50:08.647 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:35:46 elapsed:6:21:10 postfix:- (2341257:tqdm_logging.py:145)
07:50:18.841 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:35:31 elapsed:6:21:21 postfix:- (2341257:tqdm_logging.py:145)
07:50:29.037 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:35:18 elapsed:6:21:31 postfix:- (2341257:tqdm_logging.py:145)
Step 18600: grad_norm=0.0946, loss=0.0024, param_norm=1380.7231
07:50:39.280 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:34:44 elapsed:6:21:41 postfix:- (2341257:tqdm_logging.py:145)
07:50:49.477 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:35:00 elapsed:6:21:51 postfix:- (2341257:tqdm_logging.py:145)
07:50:59.673 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:34:52 elapsed:6:22:01 postfix:- (2341257:tqdm_logging.py:145)
07:51:09.869 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:34:40 elapsed:6:22:12 postfix:- (2341257:tqdm_logging.py:145)
07:51:20.079 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:34:48 elapsed:6:22:22 postfix:- (2341257:tqdm_logging.py:145)
07:51:30.274 [I] Progress on: 18.6kit/30.0kit rate:1.1s/it remaining:3:34:19 elapsed:6:22:32 postfix:- (2341257:tqdm_logging.py:145)
07:51:40.470 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:34:09 elapsed:6:22:42 postfix:- (2341257:tqdm_logging.py:145)
07:51:50.666 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:33:57 elapsed:6:22:52 postfix:- (2341257:tqdm_logging.py:145)
07:52:00.876 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:34:08 elapsed:6:23:03 postfix:- (2341257:tqdm_logging.py:145)
07:52:11.071 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:33:41 elapsed:6:23:13 postfix:- (2341257:tqdm_logging.py:145)
07:52:21.283 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:33:39 elapsed:6:23:23 postfix:- (2341257:tqdm_logging.py:145)
Step 18700: grad_norm=0.0965, loss=0.0027, param_norm=1380.7246
07:52:31.522 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:32:42 elapsed:6:23:33 postfix:- (2341257:tqdm_logging.py:145)
07:52:41.772 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:35:59 elapsed:6:23:44 postfix:- (2341257:tqdm_logging.py:145)
07:52:51.918 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:32:57 elapsed:6:23:54 postfix:- (2341257:tqdm_logging.py:145)
07:53:02.114 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:32:49 elapsed:6:24:04 postfix:- (2341257:tqdm_logging.py:145)
07:53:12.310 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:32:36 elapsed:6:24:14 postfix:- (2341257:tqdm_logging.py:145)
07:53:22.506 [I] Progress on: 18.7kit/30.0kit rate:1.1s/it remaining:3:32:27 elapsed:6:24:24 postfix:- (2341257:tqdm_logging.py:145)
07:53:32.700 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:32:14 elapsed:6:24:35 postfix:- (2341257:tqdm_logging.py:145)
07:53:42.906 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:32:05 elapsed:6:24:45 postfix:- (2341257:tqdm_logging.py:145)
07:53:53.101 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:31:58 elapsed:6:24:55 postfix:- (2341257:tqdm_logging.py:145)
07:54:03.298 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:31:48 elapsed:6:25:05 postfix:- (2341257:tqdm_logging.py:145)
07:54:13.492 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:31:32 elapsed:6:25:15 postfix:- (2341257:tqdm_logging.py:145)
Step 18800: grad_norm=0.0983, loss=0.0025, param_norm=1380.7262
07:54:23.733 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:30:30 elapsed:6:25:26 postfix:- (2341257:tqdm_logging.py:145)
07:54:33.928 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:31:14 elapsed:6:25:36 postfix:- (2341257:tqdm_logging.py:145)
07:54:44.122 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:31:01 elapsed:6:25:46 postfix:- (2341257:tqdm_logging.py:145)
07:54:54.324 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:30:59 elapsed:6:25:56 postfix:- (2341257:tqdm_logging.py:145)
07:55:04.525 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:30:47 elapsed:6:26:06 postfix:- (2341257:tqdm_logging.py:145)
07:55:14.733 [I] Progress on: 18.8kit/30.0kit rate:1.1s/it remaining:3:30:57 elapsed:6:26:17 postfix:- (2341257:tqdm_logging.py:145)
07:55:24.929 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:30:23 elapsed:6:26:27 postfix:- (2341257:tqdm_logging.py:145)
07:55:35.123 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:30:12 elapsed:6:26:37 postfix:- (2341257:tqdm_logging.py:145)
07:55:45.331 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:30:09 elapsed:6:26:47 postfix:- (2341257:tqdm_logging.py:145)
07:55:55.528 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:29:53 elapsed:6:26:57 postfix:- (2341257:tqdm_logging.py:145)
07:56:05.723 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:29:40 elapsed:6:27:08 postfix:- (2341257:tqdm_logging.py:145)
Step 18900: grad_norm=0.0920, loss=0.0024, param_norm=1380.7274
07:56:16.096 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:29:35 elapsed:6:27:18 postfix:- (2341257:tqdm_logging.py:145)
07:56:26.159 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:29:20 elapsed:6:27:28 postfix:- (2341257:tqdm_logging.py:145)
07:56:36.355 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:29:13 elapsed:6:27:38 postfix:- (2341257:tqdm_logging.py:145)
07:56:46.555 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:29:01 elapsed:6:27:48 postfix:- (2341257:tqdm_logging.py:145)
07:56:56.779 [I] Progress on: 18.9kit/30.0kit rate:1.1s/it remaining:3:29:57 elapsed:6:27:59 postfix:- (2341257:tqdm_logging.py:145)
07:57:07.183 [I] Progress on: 18.9kit/30.0kit rate:1.2s/it remaining:3:34:01 elapsed:6:28:09 postfix:- (2341257:tqdm_logging.py:145)
07:57:17.408 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:29:46 elapsed:6:28:19 postfix:- (2341257:tqdm_logging.py:145)
07:57:27.575 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:27:23 elapsed:6:28:29 postfix:- (2341257:tqdm_logging.py:145)
07:57:37.805 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:29:15 elapsed:6:28:40 postfix:- (2341257:tqdm_logging.py:145)
07:57:47.976 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:27:09 elapsed:6:28:50 postfix:- (2341257:tqdm_logging.py:145)
07:57:58.212 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:29:20 elapsed:6:29:00 postfix:- (2341257:tqdm_logging.py:145)
07:58:08.378 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:26:43 elapsed:6:29:10 postfix:- (2341257:tqdm_logging.py:145)
Step 19000: grad_norm=0.0987, loss=0.0026, param_norm=1380.7288
07:58:09.739 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
07:58:09.739 [I] [process=0] Saving checkpoint at step 19000                                      (2341257:checkpoint_manager.py:1408)
07:58:09.739 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000. (2341257:async_checkpointer.py:439)
07:58:09.748 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72 (2341257:atomicity.py:144)
07:58:09.754 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/params.orbax-checkpoint-tmp-74 (2341257:atomicity.py:144)
07:58:09.754 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/train_state.orbax-checkpoint-tmp-75 (2341257:atomicity.py:144)
07:58:09.754 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/assets.orbax-checkpoint-tmp-73 (2341257:atomicity.py:144)
07:58:09.775 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
07:58:19.490 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
07:58:19.492 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
07:58:19.582 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/params.orbax-checkpoint-tmp-74/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
07:59:22.049 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
07:59:22.049 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 99.1 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:59:22.060 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 148.5 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:59:22.077 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
07:59:22.078 [I] Finished blocking save in 72.34 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000. (2341257:async_checkpointer.py:548)
07:59:22.080 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:59:22.080 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:59:22.080 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
07:59:22.081 [I] Deleting Checkpoint[step=18000 | time=2025-10-31 23:39:14.421716+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
07:59:22.081 [I] [process=0][thread=MainThread][step=19000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
07:59:22.081 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
07:59:22.081 [I] {'step': 19000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761955089.739084, 'wait_for_prev_duration_secs': 0.00019121170043945312, 'checkpointer_blocking_start_time': 1761955089.7395313, 'checkpointer_blocking_duration_secs': 72.34081387519836, 'get_old_steps_start_time': 1761955162.0803614, 'get_old_steps_duration_secs': 0.0009393692016601562, 'checkpoint_manager_blocking_start_time': 1761955089.7389824, 'checkpoint_manager_blocking_duration_secs': 72.34282875061035} (2341257:standard_logger.py:34)
07:59:22.084 [I] Progress on: 19.0kit/30.0kit rate:22.9s/it remaining:69:58:07 elapsed:6:30:24 postfix:- (2341257:tqdm_logging.py:145)
07:59:22.105 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 99.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:59:22.131 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/train_state.orbax-checkpoint-tmp-75/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
07:59:32.137 [I] Progress on: 19.0kit/30.0kit rate:2.0s/it remaining:6:07:27 elapsed:6:30:34 postfix:- (2341257:tqdm_logging.py:145)
07:59:35.687 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 124.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
07:59:35.687 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
07:59:35.689 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/assets.orbax-checkpoint-tmp-73 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/assets (2341257:atomicity.py:289)
07:59:35.693 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
07:59:35.798 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/train_state.orbax-checkpoint-tmp-75 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/train_state (2341257:atomicity.py:289)
07:59:35.802 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
07:59:35.867 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/params.orbax-checkpoint-tmp-74 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72/params (2341257:atomicity.py:289)
07:59:35.869 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000.orbax-checkpoint-tmp-72 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000 (2341257:atomicity.py:289)
07:59:35.873 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000`. (2341257:atomicity.py:573)
07:59:35.873 [I] Finished asynchronous save (blocking + background) in 86.13 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/19000 (2341257:async_checkpointer.py:412)
07:59:35.873 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
07:59:35.873 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
07:59:35.874 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
07:59:36.268 [I] Deleted step 18000.                                                              (2341257:deleter.py:114)
07:59:36.268 [I] [process=0][thread=save_finalize][step=19000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
07:59:36.268 [I] [process=0][thread=save_finalize][step=19000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
07:59:42.396 [I] Progress on: 19.0kit/30.0kit rate:1.2s/it remaining:3:35:23 elapsed:6:30:44 postfix:- (2341257:tqdm_logging.py:145)
07:59:52.606 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:27:16 elapsed:6:30:54 postfix:- (2341257:tqdm_logging.py:145)
08:00:02.849 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:28:14 elapsed:6:31:05 postfix:- (2341257:tqdm_logging.py:145)
08:00:13.010 [I] Progress on: 19.0kit/30.0kit rate:1.1s/it remaining:3:25:48 elapsed:6:31:15 postfix:- (2341257:tqdm_logging.py:145)
08:00:23.241 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:27:47 elapsed:6:31:25 postfix:- (2341257:tqdm_logging.py:145)
08:00:33.408 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:25:33 elapsed:6:31:35 postfix:- (2341257:tqdm_logging.py:145)
08:00:43.640 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:27:18 elapsed:6:31:45 postfix:- (2341257:tqdm_logging.py:145)
08:00:53.810 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:25:27 elapsed:6:31:56 postfix:- (2341257:tqdm_logging.py:145)
08:01:04.039 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:27:07 elapsed:6:32:06 postfix:- (2341257:tqdm_logging.py:145)
08:01:14.215 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:25:09 elapsed:6:32:16 postfix:- (2341257:tqdm_logging.py:145)
Step 19100: grad_norm=0.0997, loss=0.0026, param_norm=1380.7302
08:01:24.507 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:26:47 elapsed:6:32:26 postfix:- (2341257:tqdm_logging.py:145)
08:01:34.673 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:24:33 elapsed:6:32:36 postfix:- (2341257:tqdm_logging.py:145)
08:01:44.899 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:26:15 elapsed:6:32:47 postfix:- (2341257:tqdm_logging.py:145)
08:01:55.079 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:24:21 elapsed:6:32:57 postfix:- (2341257:tqdm_logging.py:145)
08:02:05.306 [I] Progress on: 19.1kit/30.0kit rate:1.1s/it remaining:3:25:54 elapsed:6:33:07 postfix:- (2341257:tqdm_logging.py:145)
08:02:15.474 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:23:54 elapsed:6:33:17 postfix:- (2341257:tqdm_logging.py:145)
08:02:25.709 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:25:42 elapsed:6:33:28 postfix:- (2341257:tqdm_logging.py:145)
08:02:35.876 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:23:30 elapsed:6:33:38 postfix:- (2341257:tqdm_logging.py:145)
08:02:46.101 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:25:11 elapsed:6:33:48 postfix:- (2341257:tqdm_logging.py:145)
08:02:56.272 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:23:14 elapsed:6:33:58 postfix:- (2341257:tqdm_logging.py:145)
08:03:06.497 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:24:50 elapsed:6:34:08 postfix:- (2341257:tqdm_logging.py:145)
Step 19200: grad_norm=0.0886, loss=0.0023, param_norm=1380.7317
08:03:16.719 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:22:47 elapsed:6:34:19 postfix:- (2341257:tqdm_logging.py:145)
08:03:26.945 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:24:32 elapsed:6:34:29 postfix:- (2341257:tqdm_logging.py:145)
08:03:37.111 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:22:30 elapsed:6:34:39 postfix:- (2341257:tqdm_logging.py:145)
08:03:47.337 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:24:09 elapsed:6:34:49 postfix:- (2341257:tqdm_logging.py:145)
08:03:57.507 [I] Progress on: 19.2kit/30.0kit rate:1.1s/it remaining:3:22:22 elapsed:6:34:59 postfix:- (2341257:tqdm_logging.py:145)
08:04:07.743 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:23:54 elapsed:6:35:10 postfix:- (2341257:tqdm_logging.py:145)
08:04:17.924 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:22:04 elapsed:6:35:20 postfix:- (2341257:tqdm_logging.py:145)
08:04:28.151 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:23:31 elapsed:6:35:30 postfix:- (2341257:tqdm_logging.py:145)
08:04:38.315 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:21:29 elapsed:6:35:40 postfix:- (2341257:tqdm_logging.py:145)
08:04:48.550 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:23:08 elapsed:6:35:50 postfix:- (2341257:tqdm_logging.py:145)
08:04:58.728 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:21:14 elapsed:6:36:01 postfix:- (2341257:tqdm_logging.py:145)
Step 19300: grad_norm=0.0855, loss=0.0022, param_norm=1380.7332
08:05:09.006 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:22:45 elapsed:6:36:11 postfix:- (2341257:tqdm_logging.py:145)
08:05:19.171 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:20:47 elapsed:6:36:21 postfix:- (2341257:tqdm_logging.py:145)
08:05:29.410 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:22:55 elapsed:6:36:31 postfix:- (2341257:tqdm_logging.py:145)
08:05:39.575 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:20:29 elapsed:6:36:41 postfix:- (2341257:tqdm_logging.py:145)
08:05:49.812 [I] Progress on: 19.3kit/30.0kit rate:1.1s/it remaining:3:22:39 elapsed:6:36:52 postfix:- (2341257:tqdm_logging.py:145)
08:05:59.979 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:20:09 elapsed:6:37:02 postfix:- (2341257:tqdm_logging.py:145)
08:06:10.304 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:21:54 elapsed:6:37:12 postfix:- (2341257:tqdm_logging.py:145)
08:06:20.689 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:22:30 elapsed:6:37:23 postfix:- (2341257:tqdm_logging.py:145)
08:06:30.889 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:20:42 elapsed:6:37:33 postfix:- (2341257:tqdm_logging.py:145)
08:06:41.098 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:20:59 elapsed:6:37:43 postfix:- (2341257:tqdm_logging.py:145)
08:06:51.293 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:20:10 elapsed:6:37:53 postfix:- (2341257:tqdm_logging.py:145)
Step 19400: grad_norm=0.0956, loss=0.0023, param_norm=1380.7345
08:07:01.530 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:19:47 elapsed:6:38:03 postfix:- (2341257:tqdm_logging.py:145)
08:07:11.727 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:19:55 elapsed:6:38:14 postfix:- (2341257:tqdm_logging.py:145)
08:07:21.921 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:19:40 elapsed:6:38:24 postfix:- (2341257:tqdm_logging.py:145)
08:07:32.123 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:19:39 elapsed:6:38:34 postfix:- (2341257:tqdm_logging.py:145)
08:07:42.319 [I] Progress on: 19.4kit/30.0kit rate:1.1s/it remaining:3:19:22 elapsed:6:38:44 postfix:- (2341257:tqdm_logging.py:145)
08:07:52.523 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:19:12 elapsed:6:38:54 postfix:- (2341257:tqdm_logging.py:145)
08:08:02.723 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:19:12 elapsed:6:39:05 postfix:- (2341257:tqdm_logging.py:145)
08:08:12.927 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:18:50 elapsed:6:39:15 postfix:- (2341257:tqdm_logging.py:145)
08:08:23.127 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:18:45 elapsed:6:39:25 postfix:- (2341257:tqdm_logging.py:145)
08:08:33.320 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:18:28 elapsed:6:39:35 postfix:- (2341257:tqdm_logging.py:145)
08:08:43.522 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:18:36 elapsed:6:39:45 postfix:- (2341257:tqdm_logging.py:145)
Step 19500: grad_norm=0.0958, loss=0.0027, param_norm=1380.7360
08:08:53.761 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:17:47 elapsed:6:39:56 postfix:- (2341257:tqdm_logging.py:145)
08:09:03.956 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:17:58 elapsed:6:40:06 postfix:- (2341257:tqdm_logging.py:145)
08:09:14.153 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:17:47 elapsed:6:40:16 postfix:- (2341257:tqdm_logging.py:145)
08:09:24.353 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:17:42 elapsed:6:40:26 postfix:- (2341257:tqdm_logging.py:145)
08:09:34.557 [I] Progress on: 19.5kit/30.0kit rate:1.1s/it remaining:3:17:34 elapsed:6:40:36 postfix:- (2341257:tqdm_logging.py:145)
08:09:44.756 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:17:26 elapsed:6:40:47 postfix:- (2341257:tqdm_logging.py:145)
08:09:54.951 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:17:07 elapsed:6:40:57 postfix:- (2341257:tqdm_logging.py:145)
08:10:05.161 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:17:02 elapsed:6:41:07 postfix:- (2341257:tqdm_logging.py:145)
08:10:15.358 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:16:47 elapsed:6:41:17 postfix:- (2341257:tqdm_logging.py:145)
08:10:25.554 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:16:38 elapsed:6:41:27 postfix:- (2341257:tqdm_logging.py:145)
08:10:35.758 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:16:33 elapsed:6:41:38 postfix:- (2341257:tqdm_logging.py:145)
Step 19600: grad_norm=0.0894, loss=0.0025, param_norm=1380.7371
08:10:45.990 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:15:43 elapsed:6:41:48 postfix:- (2341257:tqdm_logging.py:145)
08:10:56.186 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:16:04 elapsed:6:41:58 postfix:- (2341257:tqdm_logging.py:145)
08:11:06.396 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:16:27 elapsed:6:42:08 postfix:- (2341257:tqdm_logging.py:145)
08:11:16.590 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:15:18 elapsed:6:42:18 postfix:- (2341257:tqdm_logging.py:145)
08:11:26.786 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:15:34 elapsed:6:42:29 postfix:- (2341257:tqdm_logging.py:145)
08:11:36.986 [I] Progress on: 19.6kit/30.0kit rate:1.1s/it remaining:3:15:31 elapsed:6:42:39 postfix:- (2341257:tqdm_logging.py:145)
08:11:47.195 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:15:27 elapsed:6:42:49 postfix:- (2341257:tqdm_logging.py:145)
08:11:57.403 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:15:31 elapsed:6:42:59 postfix:- (2341257:tqdm_logging.py:145)
08:12:07.599 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:14:55 elapsed:6:43:09 postfix:- (2341257:tqdm_logging.py:145)
08:12:17.797 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:14:47 elapsed:6:43:20 postfix:- (2341257:tqdm_logging.py:145)
08:12:27.995 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:14:37 elapsed:6:43:30 postfix:- (2341257:tqdm_logging.py:145)
Step 19700: grad_norm=0.0917, loss=0.0024, param_norm=1380.7383
08:12:38.231 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:13:49 elapsed:6:43:40 postfix:- (2341257:tqdm_logging.py:145)
08:12:48.427 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:14:15 elapsed:6:43:50 postfix:- (2341257:tqdm_logging.py:145)
08:12:58.625 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:14:06 elapsed:6:44:00 postfix:- (2341257:tqdm_logging.py:145)
08:13:08.820 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:13:50 elapsed:6:44:11 postfix:- (2341257:tqdm_logging.py:145)
08:13:19.027 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:13:50 elapsed:6:44:21 postfix:- (2341257:tqdm_logging.py:145)
08:13:29.235 [I] Progress on: 19.7kit/30.0kit rate:1.1s/it remaining:3:13:35 elapsed:6:44:31 postfix:- (2341257:tqdm_logging.py:145)
08:13:39.431 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:13:25 elapsed:6:44:41 postfix:- (2341257:tqdm_logging.py:145)
08:13:49.642 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:13:16 elapsed:6:44:51 postfix:- (2341257:tqdm_logging.py:145)
08:13:59.867 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:13:15 elapsed:6:45:02 postfix:- (2341257:tqdm_logging.py:145)
08:14:10.073 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:12:52 elapsed:6:45:12 postfix:- (2341257:tqdm_logging.py:145)
08:14:20.591 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:14:16 elapsed:6:45:22 postfix:- (2341257:tqdm_logging.py:145)
Step 19800: grad_norm=0.0876, loss=0.0026, param_norm=1380.7396
08:14:30.826 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:11:41 elapsed:6:45:33 postfix:- (2341257:tqdm_logging.py:145)
08:14:41.023 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:12:21 elapsed:6:45:43 postfix:- (2341257:tqdm_logging.py:145)
08:14:51.227 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:12:19 elapsed:6:45:53 postfix:- (2341257:tqdm_logging.py:145)
08:15:01.423 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:12:02 elapsed:6:46:03 postfix:- (2341257:tqdm_logging.py:145)
08:15:11.621 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:11:50 elapsed:6:46:13 postfix:- (2341257:tqdm_logging.py:145)
08:15:21.818 [I] Progress on: 19.8kit/30.0kit rate:1.1s/it remaining:3:11:43 elapsed:6:46:24 postfix:- (2341257:tqdm_logging.py:145)
08:15:32.019 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:11:35 elapsed:6:46:34 postfix:- (2341257:tqdm_logging.py:145)
08:15:42.221 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:11:29 elapsed:6:46:44 postfix:- (2341257:tqdm_logging.py:145)
08:15:52.426 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:11:31 elapsed:6:46:54 postfix:- (2341257:tqdm_logging.py:145)
08:16:02.622 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:11:00 elapsed:6:47:04 postfix:- (2341257:tqdm_logging.py:145)
08:16:12.820 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:10:54 elapsed:6:47:15 postfix:- (2341257:tqdm_logging.py:145)
Step 19900: grad_norm=0.0949, loss=0.0026, param_norm=1380.7410
08:16:23.197 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:10:50 elapsed:6:47:25 postfix:- (2341257:tqdm_logging.py:145)
08:16:33.261 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:10:28 elapsed:6:47:35 postfix:- (2341257:tqdm_logging.py:145)
08:16:43.458 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:10:20 elapsed:6:47:45 postfix:- (2341257:tqdm_logging.py:145)
08:16:53.654 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:10:10 elapsed:6:47:55 postfix:- (2341257:tqdm_logging.py:145)
08:17:03.850 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:09:59 elapsed:6:48:06 postfix:- (2341257:tqdm_logging.py:145)
08:17:14.052 [I] Progress on: 19.9kit/30.0kit rate:1.1s/it remaining:3:09:53 elapsed:6:48:16 postfix:- (2341257:tqdm_logging.py:145)
08:17:24.252 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:09:41 elapsed:6:48:26 postfix:- (2341257:tqdm_logging.py:145)
08:17:34.453 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:09:34 elapsed:6:48:36 postfix:- (2341257:tqdm_logging.py:145)
08:17:44.662 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:09:39 elapsed:6:48:46 postfix:- (2341257:tqdm_logging.py:145)
08:17:54.870 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:09:45 elapsed:6:48:57 postfix:- (2341257:tqdm_logging.py:145)
08:18:05.065 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:08:59 elapsed:6:49:07 postfix:- (2341257:tqdm_logging.py:145)
08:18:15.271 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:08:57 elapsed:6:49:17 postfix:- (2341257:tqdm_logging.py:145)
Step 20000: grad_norm=0.0913, loss=0.0024, param_norm=1380.7424
08:18:16.601 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
08:18:16.601 [I] [process=0] Saving checkpoint at step 20000                                      (2341257:checkpoint_manager.py:1408)
08:18:16.601 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000. (2341257:async_checkpointer.py:439)
08:18:16.610 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76 (2341257:atomicity.py:144)
08:18:16.618 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/assets.orbax-checkpoint-tmp-77 (2341257:atomicity.py:144)
08:18:16.618 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/params.orbax-checkpoint-tmp-78 (2341257:atomicity.py:144)
08:18:16.619 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/train_state.orbax-checkpoint-tmp-79 (2341257:atomicity.py:144)
08:18:16.631 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
08:18:36.995 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
08:18:36.997 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
08:18:37.104 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/params.orbax-checkpoint-tmp-78/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
08:19:40.314 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
08:19:40.314 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 85.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:19:40.333 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 128.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:19:40.339 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
08:19:40.339 [I] Finished blocking save in 83.74 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000. (2341257:async_checkpointer.py:548)
08:19:40.340 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:19:40.340 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:19:40.340 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:19:40.340 [I] Deleting Checkpoint[step=19000 | time=2025-10-31 23:59:22.080350+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
08:19:40.340 [I] [process=0][thread=MainThread][step=20000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
08:19:40.342 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
08:19:40.344 [I] {'step': 20000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761956296.6011374, 'wait_for_prev_duration_secs': 0.0001571178436279297, 'checkpointer_blocking_start_time': 1761956296.6015446, 'checkpointer_blocking_duration_secs': 83.73883891105652, 'get_old_steps_start_time': 1761956380.3403955, 'get_old_steps_duration_secs': 0.0003883838653564453, 'checkpoint_manager_blocking_start_time': 1761956296.6010401, 'checkpoint_manager_blocking_duration_secs': 83.74380445480347} (2341257:standard_logger.py:34)
08:19:40.345 [I] Progress on: 20.0kit/30.0kit rate:26.3s/it remaining:73:05:30 elapsed:6:50:42 postfix:- (2341257:tqdm_logging.py:145)
08:19:40.359 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 85.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:19:40.390 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/train_state.orbax-checkpoint-tmp-79/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
08:19:50.418 [I] Progress on: 20.0kit/30.0kit rate:2.2s/it remaining:5:58:02 elapsed:6:50:52 postfix:- (2341257:tqdm_logging.py:145)
08:19:53.741 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 110.5 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:19:53.741 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
08:19:53.742 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/assets.orbax-checkpoint-tmp-77 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/assets (2341257:atomicity.py:289)
08:19:53.747 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
08:19:53.860 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/train_state.orbax-checkpoint-tmp-79 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/train_state (2341257:atomicity.py:289)
08:19:53.863 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
08:19:53.971 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/params.orbax-checkpoint-tmp-78 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76/params (2341257:atomicity.py:289)
08:19:53.972 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000.orbax-checkpoint-tmp-76 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000 (2341257:atomicity.py:289)
08:19:53.976 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000`. (2341257:atomicity.py:573)
08:19:53.976 [I] Finished asynchronous save (blocking + background) in 97.37 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/20000 (2341257:async_checkpointer.py:412)
08:19:53.976 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
08:19:53.976 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
08:19:53.976 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
08:19:54.401 [I] Deleted step 19000.                                                              (2341257:deleter.py:114)
08:19:54.401 [I] [process=0][thread=save_finalize][step=20000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
08:19:54.401 [I] [process=0][thread=save_finalize][step=20000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
08:20:00.659 [I] Progress on: 20.0kit/30.0kit rate:1.2s/it remaining:3:16:21 elapsed:6:51:02 postfix:- (2341257:tqdm_logging.py:145)
08:20:10.858 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:08:40 elapsed:6:51:13 postfix:- (2341257:tqdm_logging.py:145)
08:20:21.052 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:08:05 elapsed:6:51:23 postfix:- (2341257:tqdm_logging.py:145)
08:20:31.255 [I] Progress on: 20.0kit/30.0kit rate:1.1s/it remaining:3:07:56 elapsed:6:51:33 postfix:- (2341257:tqdm_logging.py:145)
08:20:41.452 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:07:48 elapsed:6:51:43 postfix:- (2341257:tqdm_logging.py:145)
08:20:51.653 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:07:41 elapsed:6:51:53 postfix:- (2341257:tqdm_logging.py:145)
08:21:01.853 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:07:35 elapsed:6:52:04 postfix:- (2341257:tqdm_logging.py:145)
08:21:12.050 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:07:15 elapsed:6:52:14 postfix:- (2341257:tqdm_logging.py:145)
08:21:22.260 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:07:20 elapsed:6:52:24 postfix:- (2341257:tqdm_logging.py:145)
08:21:32.457 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:06:55 elapsed:6:52:34 postfix:- (2341257:tqdm_logging.py:145)
Step 20100: grad_norm=0.0904, loss=0.0026, param_norm=1380.7434
08:21:42.688 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:06:37 elapsed:6:52:45 postfix:- (2341257:tqdm_logging.py:145)
08:21:52.887 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:06:38 elapsed:6:52:55 postfix:- (2341257:tqdm_logging.py:145)
08:22:03.087 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:06:30 elapsed:6:53:05 postfix:- (2341257:tqdm_logging.py:145)
08:22:13.284 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:06:15 elapsed:6:53:15 postfix:- (2341257:tqdm_logging.py:145)
08:22:23.484 [I] Progress on: 20.1kit/30.0kit rate:1.1s/it remaining:3:06:06 elapsed:6:53:25 postfix:- (2341257:tqdm_logging.py:145)
08:22:33.691 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:05:56 elapsed:6:53:36 postfix:- (2341257:tqdm_logging.py:145)
08:22:43.888 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:05:43 elapsed:6:53:46 postfix:- (2341257:tqdm_logging.py:145)
08:22:54.084 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:05:35 elapsed:6:53:56 postfix:- (2341257:tqdm_logging.py:145)
08:23:04.292 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:05:53 elapsed:6:54:06 postfix:- (2341257:tqdm_logging.py:145)
08:23:14.503 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:05:28 elapsed:6:54:16 postfix:- (2341257:tqdm_logging.py:145)
08:23:24.698 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:05:05 elapsed:6:54:27 postfix:- (2341257:tqdm_logging.py:145)
Step 20200: grad_norm=0.0885, loss=0.0024, param_norm=1380.7446
08:23:35.296 [I] Progress on: 20.2kit/30.0kit rate:1.2s/it remaining:3:22:45 elapsed:6:54:37 postfix:- (2341257:tqdm_logging.py:145)
08:23:45.356 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:05:12 elapsed:6:54:47 postfix:- (2341257:tqdm_logging.py:145)
08:23:55.551 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:04:31 elapsed:6:54:57 postfix:- (2341257:tqdm_logging.py:145)
08:24:05.749 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:04:21 elapsed:6:55:08 postfix:- (2341257:tqdm_logging.py:145)
08:24:15.961 [I] Progress on: 20.2kit/30.0kit rate:1.1s/it remaining:3:04:31 elapsed:6:55:18 postfix:- (2341257:tqdm_logging.py:145)
08:24:26.157 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:04:02 elapsed:6:55:28 postfix:- (2341257:tqdm_logging.py:145)
08:24:36.353 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:03:52 elapsed:6:55:38 postfix:- (2341257:tqdm_logging.py:145)
08:24:46.550 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:03:47 elapsed:6:55:48 postfix:- (2341257:tqdm_logging.py:145)
08:24:56.760 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:03:48 elapsed:6:55:59 postfix:- (2341257:tqdm_logging.py:145)
08:25:06.963 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:03:37 elapsed:6:56:09 postfix:- (2341257:tqdm_logging.py:145)
08:25:17.154 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:03:03 elapsed:6:56:19 postfix:- (2341257:tqdm_logging.py:145)
Step 20300: grad_norm=0.0875, loss=0.0024, param_norm=1380.7457
08:25:27.410 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:03:07 elapsed:6:56:29 postfix:- (2341257:tqdm_logging.py:145)
08:25:37.603 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:02:45 elapsed:6:56:39 postfix:- (2341257:tqdm_logging.py:145)
08:25:47.799 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:02:38 elapsed:6:56:50 postfix:- (2341257:tqdm_logging.py:145)
08:25:57.996 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:02:29 elapsed:6:57:00 postfix:- (2341257:tqdm_logging.py:145)
08:26:08.192 [I] Progress on: 20.3kit/30.0kit rate:1.1s/it remaining:3:02:20 elapsed:6:57:10 postfix:- (2341257:tqdm_logging.py:145)
08:26:18.390 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:02:09 elapsed:6:57:20 postfix:- (2341257:tqdm_logging.py:145)
08:26:28.589 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:01:58 elapsed:6:57:30 postfix:- (2341257:tqdm_logging.py:145)
08:26:38.797 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:02:21 elapsed:6:57:41 postfix:- (2341257:tqdm_logging.py:145)
08:26:48.997 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:01:49 elapsed:6:57:51 postfix:- (2341257:tqdm_logging.py:145)
08:26:59.190 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:01:30 elapsed:6:58:01 postfix:- (2341257:tqdm_logging.py:145)
08:27:09.386 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:01:18 elapsed:6:58:11 postfix:- (2341257:tqdm_logging.py:145)
Step 20400: grad_norm=0.0844, loss=0.0021, param_norm=1380.7467
08:27:19.623 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:00:57 elapsed:6:58:21 postfix:- (2341257:tqdm_logging.py:145)
08:27:29.823 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:01:07 elapsed:6:58:32 postfix:- (2341257:tqdm_logging.py:145)
08:27:40.023 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:00:53 elapsed:6:58:42 postfix:- (2341257:tqdm_logging.py:145)
08:27:50.219 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:00:38 elapsed:6:58:52 postfix:- (2341257:tqdm_logging.py:145)
08:28:00.425 [I] Progress on: 20.4kit/30.0kit rate:1.1s/it remaining:3:00:34 elapsed:6:59:02 postfix:- (2341257:tqdm_logging.py:145)
08:28:10.621 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:3:00:19 elapsed:6:59:12 postfix:- (2341257:tqdm_logging.py:145)
08:28:20.818 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:3:00:05 elapsed:6:59:23 postfix:- (2341257:tqdm_logging.py:145)
08:28:31.019 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:3:00:08 elapsed:6:59:33 postfix:- (2341257:tqdm_logging.py:145)
08:28:41.333 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:3:00:17 elapsed:6:59:43 postfix:- (2341257:tqdm_logging.py:145)
08:28:51.534 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:2:59:55 elapsed:6:59:53 postfix:- (2341257:tqdm_logging.py:145)
08:29:01.724 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:2:59:25 elapsed:7:00:04 postfix:- (2341257:tqdm_logging.py:145)
Step 20500: grad_norm=0.0884, loss=0.0023, param_norm=1380.7478
08:29:11.974 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:2:59:02 elapsed:7:00:14 postfix:- (2341257:tqdm_logging.py:145)
08:29:22.171 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:2:59:09 elapsed:7:00:24 postfix:- (2341257:tqdm_logging.py:145)
08:29:32.408 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:2:58:29 elapsed:7:00:34 postfix:- (2341257:tqdm_logging.py:145)
08:29:42.605 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:2:58:44 elapsed:7:00:44 postfix:- (2341257:tqdm_logging.py:145)
08:29:52.802 [I] Progress on: 20.5kit/30.0kit rate:1.1s/it remaining:2:58:34 elapsed:7:00:55 postfix:- (2341257:tqdm_logging.py:145)
08:30:02.999 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:58:23 elapsed:7:01:05 postfix:- (2341257:tqdm_logging.py:145)
08:30:13.197 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:58:10 elapsed:7:01:15 postfix:- (2341257:tqdm_logging.py:145)
08:30:23.394 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:58:07 elapsed:7:01:25 postfix:- (2341257:tqdm_logging.py:145)
08:30:33.590 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:57:55 elapsed:7:01:35 postfix:- (2341257:tqdm_logging.py:145)
08:30:43.785 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:57:43 elapsed:7:01:46 postfix:- (2341257:tqdm_logging.py:145)
08:30:53.984 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:57:37 elapsed:7:01:56 postfix:- (2341257:tqdm_logging.py:145)
Step 20600: grad_norm=0.0786, loss=0.0021, param_norm=1380.7490
08:31:04.237 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:57:21 elapsed:7:02:06 postfix:- (2341257:tqdm_logging.py:145)
08:31:14.430 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:57:13 elapsed:7:02:16 postfix:- (2341257:tqdm_logging.py:145)
08:31:24.625 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:57:01 elapsed:7:02:26 postfix:- (2341257:tqdm_logging.py:145)
08:31:35.069 [I] Progress on: 20.6kit/30.0kit rate:1.2s/it remaining:3:01:37 elapsed:7:02:37 postfix:- (2341257:tqdm_logging.py:145)
08:31:45.233 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:56:02 elapsed:7:02:47 postfix:- (2341257:tqdm_logging.py:145)
08:31:55.484 [I] Progress on: 20.6kit/30.0kit rate:1.1s/it remaining:2:58:06 elapsed:7:02:57 postfix:- (2341257:tqdm_logging.py:145)
08:32:05.652 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:55:37 elapsed:7:03:07 postfix:- (2341257:tqdm_logging.py:145)
08:32:15.883 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:57:03 elapsed:7:03:18 postfix:- (2341257:tqdm_logging.py:145)
08:32:26.057 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:55:21 elapsed:7:03:28 postfix:- (2341257:tqdm_logging.py:145)
08:32:36.283 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:56:40 elapsed:7:03:38 postfix:- (2341257:tqdm_logging.py:145)
08:32:46.449 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:54:52 elapsed:7:03:48 postfix:- (2341257:tqdm_logging.py:145)
Step 20700: grad_norm=0.0884, loss=0.0024, param_norm=1380.7500
08:32:56.734 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:56:26 elapsed:7:03:59 postfix:- (2341257:tqdm_logging.py:145)
08:33:06.899 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:54:33 elapsed:7:04:09 postfix:- (2341257:tqdm_logging.py:145)
08:33:17.139 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:56:21 elapsed:7:04:19 postfix:- (2341257:tqdm_logging.py:145)
08:33:27.307 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:54:19 elapsed:7:04:29 postfix:- (2341257:tqdm_logging.py:145)
08:33:37.543 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:55:42 elapsed:7:04:39 postfix:- (2341257:tqdm_logging.py:145)
08:33:47.710 [I] Progress on: 20.7kit/30.0kit rate:1.1s/it remaining:2:53:54 elapsed:7:04:50 postfix:- (2341257:tqdm_logging.py:145)
08:33:57.948 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:55:23 elapsed:7:05:00 postfix:- (2341257:tqdm_logging.py:145)
08:34:08.114 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:53:32 elapsed:7:05:10 postfix:- (2341257:tqdm_logging.py:145)
08:34:18.342 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:55:03 elapsed:7:05:20 postfix:- (2341257:tqdm_logging.py:145)
08:34:28.520 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:53:16 elapsed:7:05:30 postfix:- (2341257:tqdm_logging.py:145)
08:34:38.745 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:54:40 elapsed:7:05:41 postfix:- (2341257:tqdm_logging.py:145)
Step 20800: grad_norm=0.0890, loss=0.0024, param_norm=1380.7509
08:34:48.979 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:53:02 elapsed:7:05:51 postfix:- (2341257:tqdm_logging.py:145)
08:34:59.205 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:54:17 elapsed:7:06:01 postfix:- (2341257:tqdm_logging.py:145)
08:35:09.370 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:52:31 elapsed:7:06:11 postfix:- (2341257:tqdm_logging.py:145)
08:35:19.597 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:53:58 elapsed:7:06:21 postfix:- (2341257:tqdm_logging.py:145)
08:35:29.777 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:52:37 elapsed:7:06:32 postfix:- (2341257:tqdm_logging.py:145)
08:35:40.017 [I] Progress on: 20.8kit/30.0kit rate:1.1s/it remaining:2:53:48 elapsed:7:06:42 postfix:- (2341257:tqdm_logging.py:145)
08:35:50.183 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:51:50 elapsed:7:06:52 postfix:- (2341257:tqdm_logging.py:145)
08:36:00.411 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:53:19 elapsed:7:07:02 postfix:- (2341257:tqdm_logging.py:145)
08:36:10.591 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:51:58 elapsed:7:07:12 postfix:- (2341257:tqdm_logging.py:145)
08:36:20.818 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:53:00 elapsed:7:07:23 postfix:- (2341257:tqdm_logging.py:145)
08:36:30.983 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:51:10 elapsed:7:07:33 postfix:- (2341257:tqdm_logging.py:145)
Step 20900: grad_norm=0.0868, loss=0.0022, param_norm=1380.7518
08:36:41.367 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:51:01 elapsed:7:07:43 postfix:- (2341257:tqdm_logging.py:145)
08:36:51.432 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:50:48 elapsed:7:07:53 postfix:- (2341257:tqdm_logging.py:145)
08:37:01.663 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:52:19 elapsed:7:08:03 postfix:- (2341257:tqdm_logging.py:145)
08:37:11.841 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:50:44 elapsed:7:08:14 postfix:- (2341257:tqdm_logging.py:145)
08:37:22.078 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:51:59 elapsed:7:08:24 postfix:- (2341257:tqdm_logging.py:145)
08:37:32.257 [I] Progress on: 20.9kit/30.0kit rate:1.1s/it remaining:2:50:41 elapsed:7:08:34 postfix:- (2341257:tqdm_logging.py:145)
08:37:42.483 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:51:38 elapsed:7:08:44 postfix:- (2341257:tqdm_logging.py:145)
08:37:52.650 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:49:49 elapsed:7:08:54 postfix:- (2341257:tqdm_logging.py:145)
08:38:02.875 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:51:11 elapsed:7:09:05 postfix:- (2341257:tqdm_logging.py:145)
08:38:13.043 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:49:31 elapsed:7:09:15 postfix:- (2341257:tqdm_logging.py:145)
08:38:23.278 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:50:55 elapsed:7:09:25 postfix:- (2341257:tqdm_logging.py:145)
08:38:33.444 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:49:06 elapsed:7:09:35 postfix:- (2341257:tqdm_logging.py:145)
Step 21000: grad_norm=0.0820, loss=0.0021, param_norm=1380.7531
08:38:34.813 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
08:38:34.813 [I] [process=0] Saving checkpoint at step 21000                                      (2341257:checkpoint_manager.py:1408)
08:38:34.813 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000. (2341257:async_checkpointer.py:439)
08:38:34.823 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80 (2341257:atomicity.py:144)
08:38:34.828 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/params.orbax-checkpoint-tmp-82 (2341257:atomicity.py:144)
08:38:34.828 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/assets.orbax-checkpoint-tmp-81 (2341257:atomicity.py:144)
08:38:34.828 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/train_state.orbax-checkpoint-tmp-83 (2341257:atomicity.py:144)
08:38:34.848 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
08:38:37.113 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
08:38:37.114 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
08:38:37.135 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/params.orbax-checkpoint-tmp-82/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
08:39:20.078 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
08:39:20.078 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 158.3 MiB/s (total bytes: 7.0 GiB) (time elapsed: 45 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:39:20.096 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 237.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: 45 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:39:20.099 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
08:39:20.099 [I] Finished blocking save in 45.29 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000. (2341257:async_checkpointer.py:548)
08:39:20.099 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:39:20.099 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:39:20.099 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:39:20.099 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:39:20.100 [I] [process=0][thread=MainThread][step=21000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
08:39:20.100 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
08:39:20.100 [I] {'step': 21000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761957514.813241, 'wait_for_prev_duration_secs': 0.0002014636993408203, 'checkpointer_blocking_start_time': 1761957514.8137002, 'checkpointer_blocking_duration_secs': 45.28600764274597, 'get_old_steps_start_time': 1761957560.0997207, 'get_old_steps_duration_secs': 0.000263214111328125, 'checkpoint_manager_blocking_start_time': 1761957514.8131456, 'checkpoint_manager_blocking_duration_secs': 45.287224769592285} (2341257:standard_logger.py:34)
08:39:20.100 [I] Progress on: 21.0kit/30.0kit rate:14.8s/it remaining:36:57:40 elapsed:7:10:22 postfix:- (2341257:tqdm_logging.py:145)
08:39:20.116 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/train_state.orbax-checkpoint-tmp-83/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
08:39:25.787 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 140.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: 50 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:39:30.162 [I] Progress on: 21.0kit/30.0kit rate:1.7s/it remaining:4:11:30 elapsed:7:10:32 postfix:- (2341257:tqdm_logging.py:145)
08:39:34.072 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 181.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: 59 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:39:34.072 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
08:39:34.073 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/assets.orbax-checkpoint-tmp-81 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/assets (2341257:atomicity.py:289)
08:39:34.078 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
08:39:34.157 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/train_state.orbax-checkpoint-tmp-83 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/train_state (2341257:atomicity.py:289)
08:39:34.161 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
08:39:34.217 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/params.orbax-checkpoint-tmp-82 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80/params (2341257:atomicity.py:289)
08:39:34.219 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000.orbax-checkpoint-tmp-80 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000 (2341257:atomicity.py:289)
08:39:34.248 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000`. (2341257:atomicity.py:573)
08:39:34.248 [I] Finished asynchronous save (blocking + background) in 59.44 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/21000 (2341257:async_checkpointer.py:412)
08:39:34.248 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
08:39:34.249 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
08:39:34.249 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
08:39:34.249 [I] [process=0][thread=save_finalize][step=21000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
08:39:34.249 [I] [process=0][thread=save_finalize][step=21000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
08:39:40.420 [I] Progress on: 21.0kit/30.0kit rate:1.2s/it remaining:2:54:13 elapsed:7:10:42 postfix:- (2341257:tqdm_logging.py:145)
08:39:50.624 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:49:20 elapsed:7:10:52 postfix:- (2341257:tqdm_logging.py:145)
08:40:00.866 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:50:08 elapsed:7:11:03 postfix:- (2341257:tqdm_logging.py:145)
08:40:11.041 [I] Progress on: 21.0kit/30.0kit rate:1.1s/it remaining:2:48:21 elapsed:7:11:13 postfix:- (2341257:tqdm_logging.py:145)
08:40:21.462 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:49:22 elapsed:7:11:23 postfix:- (2341257:tqdm_logging.py:145)
08:40:31.693 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:49:37 elapsed:7:11:34 postfix:- (2341257:tqdm_logging.py:145)
08:40:41.864 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:47:49 elapsed:7:11:44 postfix:- (2341257:tqdm_logging.py:145)
08:40:52.108 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:49:32 elapsed:7:11:54 postfix:- (2341257:tqdm_logging.py:145)
08:41:02.276 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:47:27 elapsed:7:12:04 postfix:- (2341257:tqdm_logging.py:145)
08:41:12.502 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:48:50 elapsed:7:12:14 postfix:- (2341257:tqdm_logging.py:145)
Step 21100: grad_norm=0.0834, loss=0.0022, param_norm=1380.7539
08:41:22.705 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:47:07 elapsed:7:12:25 postfix:- (2341257:tqdm_logging.py:145)
08:41:32.929 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:48:25 elapsed:7:12:35 postfix:- (2341257:tqdm_logging.py:145)
08:41:43.097 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:46:46 elapsed:7:12:45 postfix:- (2341257:tqdm_logging.py:145)
08:41:53.328 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:48:09 elapsed:7:12:55 postfix:- (2341257:tqdm_logging.py:145)
08:42:03.508 [I] Progress on: 21.1kit/30.0kit rate:1.1s/it remaining:2:46:46 elapsed:7:13:05 postfix:- (2341257:tqdm_logging.py:145)
08:42:13.735 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:47:49 elapsed:7:13:16 postfix:- (2341257:tqdm_logging.py:145)
08:42:23.901 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:46:03 elapsed:7:13:26 postfix:- (2341257:tqdm_logging.py:145)
08:42:34.128 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:47:24 elapsed:7:13:36 postfix:- (2341257:tqdm_logging.py:145)
08:42:44.305 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:46:03 elapsed:7:13:46 postfix:- (2341257:tqdm_logging.py:145)
08:42:54.531 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:47:07 elapsed:7:13:56 postfix:- (2341257:tqdm_logging.py:145)
08:43:04.698 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:45:24 elapsed:7:14:07 postfix:- (2341257:tqdm_logging.py:145)
Step 21200: grad_norm=0.0805, loss=0.0020, param_norm=1380.7548
08:43:14.947 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:46:34 elapsed:7:14:17 postfix:- (2341257:tqdm_logging.py:145)
08:43:25.114 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:45:04 elapsed:7:14:27 postfix:- (2341257:tqdm_logging.py:145)
08:43:35.363 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:46:41 elapsed:7:14:37 postfix:- (2341257:tqdm_logging.py:145)
08:43:45.539 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:44:56 elapsed:7:14:47 postfix:- (2341257:tqdm_logging.py:145)
08:43:55.777 [I] Progress on: 21.2kit/30.0kit rate:1.1s/it remaining:2:46:10 elapsed:7:14:58 postfix:- (2341257:tqdm_logging.py:145)
08:44:05.944 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:44:25 elapsed:7:15:08 postfix:- (2341257:tqdm_logging.py:145)
08:44:16.170 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:45:45 elapsed:7:15:18 postfix:- (2341257:tqdm_logging.py:145)
08:44:26.339 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:44:06 elapsed:7:15:28 postfix:- (2341257:tqdm_logging.py:145)
08:44:36.568 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:45:30 elapsed:7:15:38 postfix:- (2341257:tqdm_logging.py:145)
08:44:46.734 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:43:45 elapsed:7:15:49 postfix:- (2341257:tqdm_logging.py:145)
08:44:56.965 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:45:06 elapsed:7:15:59 postfix:- (2341257:tqdm_logging.py:145)
Step 21300: grad_norm=0.0836, loss=0.0021, param_norm=1380.7556
08:45:07.149 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:43:07 elapsed:7:16:09 postfix:- (2341257:tqdm_logging.py:145)
08:45:17.391 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:44:50 elapsed:7:16:19 postfix:- (2341257:tqdm_logging.py:145)
08:45:27.575 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:43:28 elapsed:7:16:29 postfix:- (2341257:tqdm_logging.py:145)
08:45:37.802 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:44:27 elapsed:7:16:40 postfix:- (2341257:tqdm_logging.py:145)
08:45:47.967 [I] Progress on: 21.3kit/30.0kit rate:1.1s/it remaining:2:42:44 elapsed:7:16:50 postfix:- (2341257:tqdm_logging.py:145)
08:45:58.192 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:44:00 elapsed:7:17:00 postfix:- (2341257:tqdm_logging.py:145)
08:46:08.374 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:42:36 elapsed:7:17:10 postfix:- (2341257:tqdm_logging.py:145)
08:46:18.597 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:43:38 elapsed:7:17:20 postfix:- (2341257:tqdm_logging.py:145)
08:46:28.768 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:42:06 elapsed:7:17:31 postfix:- (2341257:tqdm_logging.py:145)
08:46:38.992 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:43:24 elapsed:7:17:41 postfix:- (2341257:tqdm_logging.py:145)
08:46:49.164 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:41:43 elapsed:7:17:51 postfix:- (2341257:tqdm_logging.py:145)
Step 21400: grad_norm=0.0904, loss=0.0022, param_norm=1380.7566
08:46:59.415 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:42:40 elapsed:7:18:01 postfix:- (2341257:tqdm_logging.py:145)
08:47:09.583 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:41:23 elapsed:7:18:11 postfix:- (2341257:tqdm_logging.py:145)
08:47:19.806 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:42:35 elapsed:7:18:22 postfix:- (2341257:tqdm_logging.py:145)
08:47:29.976 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:41:05 elapsed:7:18:32 postfix:- (2341257:tqdm_logging.py:145)
08:47:40.202 [I] Progress on: 21.4kit/30.0kit rate:1.1s/it remaining:2:42:20 elapsed:7:18:42 postfix:- (2341257:tqdm_logging.py:145)
08:47:50.369 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:40:42 elapsed:7:18:52 postfix:- (2341257:tqdm_logging.py:145)
08:48:00.595 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:41:39 elapsed:7:19:02 postfix:- (2341257:tqdm_logging.py:145)
08:48:10.773 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:40:29 elapsed:7:19:13 postfix:- (2341257:tqdm_logging.py:145)
08:48:21.197 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:41:23 elapsed:7:19:23 postfix:- (2341257:tqdm_logging.py:145)
08:48:31.396 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:40:45 elapsed:7:19:33 postfix:- (2341257:tqdm_logging.py:145)
08:48:41.593 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:40:34 elapsed:7:19:43 postfix:- (2341257:tqdm_logging.py:145)
Step 21500: grad_norm=0.0836, loss=0.0022, param_norm=1380.7574
08:48:51.835 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:40:11 elapsed:7:19:54 postfix:- (2341257:tqdm_logging.py:145)
08:49:02.033 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:40:14 elapsed:7:20:04 postfix:- (2341257:tqdm_logging.py:145)
08:49:12.230 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:40:04 elapsed:7:20:14 postfix:- (2341257:tqdm_logging.py:145)
08:49:22.426 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:39:53 elapsed:7:20:24 postfix:- (2341257:tqdm_logging.py:145)
08:49:32.622 [I] Progress on: 21.5kit/30.0kit rate:1.1s/it remaining:2:39:41 elapsed:7:20:34 postfix:- (2341257:tqdm_logging.py:145)
08:49:42.836 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:39:35 elapsed:7:20:45 postfix:- (2341257:tqdm_logging.py:145)
08:49:53.034 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:39:27 elapsed:7:20:55 postfix:- (2341257:tqdm_logging.py:145)
08:50:03.230 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:39:12 elapsed:7:21:05 postfix:- (2341257:tqdm_logging.py:145)
08:50:13.426 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:39:00 elapsed:7:21:15 postfix:- (2341257:tqdm_logging.py:145)
08:50:23.623 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:38:53 elapsed:7:21:25 postfix:- (2341257:tqdm_logging.py:145)
08:50:33.819 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:38:40 elapsed:7:21:36 postfix:- (2341257:tqdm_logging.py:145)
Step 21600: grad_norm=0.0883, loss=0.0022, param_norm=1380.7581
08:50:44.057 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:38:09 elapsed:7:21:46 postfix:- (2341257:tqdm_logging.py:145)
08:50:54.255 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:38:20 elapsed:7:21:56 postfix:- (2341257:tqdm_logging.py:145)
08:51:04.567 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:38:17 elapsed:7:22:06 postfix:- (2341257:tqdm_logging.py:145)
08:51:14.763 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:37:59 elapsed:7:22:17 postfix:- (2341257:tqdm_logging.py:145)
08:51:24.959 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:37:49 elapsed:7:22:27 postfix:- (2341257:tqdm_logging.py:145)
08:51:35.156 [I] Progress on: 21.6kit/30.0kit rate:1.1s/it remaining:2:37:40 elapsed:7:22:37 postfix:- (2341257:tqdm_logging.py:145)
08:51:45.354 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:37:30 elapsed:7:22:47 postfix:- (2341257:tqdm_logging.py:145)
08:51:55.551 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:37:22 elapsed:7:22:57 postfix:- (2341257:tqdm_logging.py:145)
08:52:05.748 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:37:09 elapsed:7:23:08 postfix:- (2341257:tqdm_logging.py:145)
08:52:15.945 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:36:59 elapsed:7:23:18 postfix:- (2341257:tqdm_logging.py:145)
08:52:26.146 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:36:57 elapsed:7:23:28 postfix:- (2341257:tqdm_logging.py:145)
Step 21700: grad_norm=0.0750, loss=0.0021, param_norm=1380.7587
08:52:36.392 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:36:10 elapsed:7:23:38 postfix:- (2341257:tqdm_logging.py:145)
08:52:46.588 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:36:26 elapsed:7:23:48 postfix:- (2341257:tqdm_logging.py:145)
08:52:56.797 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:36:40 elapsed:7:23:59 postfix:- (2341257:tqdm_logging.py:145)
08:53:06.993 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:36:12 elapsed:7:24:09 postfix:- (2341257:tqdm_logging.py:145)
08:53:17.189 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:35:57 elapsed:7:24:19 postfix:- (2341257:tqdm_logging.py:145)
08:53:27.384 [I] Progress on: 21.7kit/30.0kit rate:1.1s/it remaining:2:35:46 elapsed:7:24:29 postfix:- (2341257:tqdm_logging.py:145)
08:53:37.582 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:35:29 elapsed:7:24:39 postfix:- (2341257:tqdm_logging.py:145)
08:53:47.779 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:35:25 elapsed:7:24:50 postfix:- (2341257:tqdm_logging.py:145)
08:53:57.977 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:35:22 elapsed:7:25:00 postfix:- (2341257:tqdm_logging.py:145)
08:54:08.197 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:35:32 elapsed:7:25:10 postfix:- (2341257:tqdm_logging.py:145)
08:54:18.395 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:35:02 elapsed:7:25:20 postfix:- (2341257:tqdm_logging.py:145)
Step 21800: grad_norm=0.0821, loss=0.0021, param_norm=1380.7596
08:54:28.631 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:33:56 elapsed:7:25:30 postfix:- (2341257:tqdm_logging.py:145)
08:54:38.833 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:34:35 elapsed:7:25:41 postfix:- (2341257:tqdm_logging.py:145)
08:54:49.029 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:34:25 elapsed:7:25:51 postfix:- (2341257:tqdm_logging.py:145)
08:54:59.228 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:34:21 elapsed:7:26:01 postfix:- (2341257:tqdm_logging.py:145)
08:55:09.438 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:34:38 elapsed:7:26:11 postfix:- (2341257:tqdm_logging.py:145)
08:55:19.631 [I] Progress on: 21.8kit/30.0kit rate:1.1s/it remaining:2:34:06 elapsed:7:26:21 postfix:- (2341257:tqdm_logging.py:145)
08:55:29.827 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:33:48 elapsed:7:26:32 postfix:- (2341257:tqdm_logging.py:145)
08:55:40.038 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:33:55 elapsed:7:26:42 postfix:- (2341257:tqdm_logging.py:145)
08:55:50.234 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:33:26 elapsed:7:26:52 postfix:- (2341257:tqdm_logging.py:145)
08:56:00.431 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:33:18 elapsed:7:27:02 postfix:- (2341257:tqdm_logging.py:145)
08:56:10.988 [I] Progress on: 21.9kit/30.0kit rate:1.2s/it remaining:2:47:45 elapsed:7:27:13 postfix:- (2341257:tqdm_logging.py:145)
Step 21900: grad_norm=0.0811, loss=0.0020, param_norm=1380.7605
08:56:21.206 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:33:16 elapsed:7:27:23 postfix:- (2341257:tqdm_logging.py:145)
08:56:31.285 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:32:53 elapsed:7:27:33 postfix:- (2341257:tqdm_logging.py:145)
08:56:41.493 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:32:53 elapsed:7:27:43 postfix:- (2341257:tqdm_logging.py:145)
08:56:51.690 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:32:26 elapsed:7:27:54 postfix:- (2341257:tqdm_logging.py:145)
08:57:01.887 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:32:13 elapsed:7:28:04 postfix:- (2341257:tqdm_logging.py:145)
08:57:12.086 [I] Progress on: 21.9kit/30.0kit rate:1.1s/it remaining:2:32:07 elapsed:7:28:14 postfix:- (2341257:tqdm_logging.py:145)
08:57:22.283 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:31:55 elapsed:7:28:24 postfix:- (2341257:tqdm_logging.py:145)
08:57:32.487 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:31:50 elapsed:7:28:34 postfix:- (2341257:tqdm_logging.py:145)
08:57:42.682 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:31:31 elapsed:7:28:45 postfix:- (2341257:tqdm_logging.py:145)
08:57:52.879 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:31:24 elapsed:7:28:55 postfix:- (2341257:tqdm_logging.py:145)
08:58:03.074 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:31:11 elapsed:7:29:05 postfix:- (2341257:tqdm_logging.py:145)
08:58:13.285 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:31:07 elapsed:7:29:15 postfix:- (2341257:tqdm_logging.py:145)
Step 22000: grad_norm=0.0825, loss=0.0022, param_norm=1380.7611
08:58:14.617 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
08:58:14.617 [I] [process=0] Saving checkpoint at step 22000                                      (2341257:checkpoint_manager.py:1408)
08:58:14.618 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000. (2341257:async_checkpointer.py:439)
08:58:14.626 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84 (2341257:atomicity.py:144)
08:58:14.631 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/params.orbax-checkpoint-tmp-86 (2341257:atomicity.py:144)
08:58:14.631 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/train_state.orbax-checkpoint-tmp-87 (2341257:atomicity.py:144)
08:58:14.631 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/assets.orbax-checkpoint-tmp-85 (2341257:atomicity.py:144)
08:58:14.650 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
08:58:16.936 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
08:58:16.937 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
08:58:16.956 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/params.orbax-checkpoint-tmp-86/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
08:58:54.701 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
08:58:54.702 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 178.7 MiB/s (total bytes: 7.0 GiB) (time elapsed: 40 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:58:54.711 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 267.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: 40 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:58:54.725 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
08:58:54.725 [I] Finished blocking save in 40.11 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000. (2341257:async_checkpointer.py:548)
08:58:54.726 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:58:54.726 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:58:54.726 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:58:54.726 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
08:58:54.726 [I] Deleting Checkpoint[step=21000 | time=2025-11-01 00:39:20.099711+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
08:58:54.727 [I] [process=0][thread=MainThread][step=22000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
08:58:54.728 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
08:58:54.728 [I] {'step': 22000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761958694.6175327, 'wait_for_prev_duration_secs': 0.00017404556274414062, 'checkpointer_blocking_start_time': 1761958694.617967, 'checkpointer_blocking_duration_secs': 40.1085364818573, 'get_old_steps_start_time': 1761958734.7265213, 'get_old_steps_duration_secs': 0.0011661052703857422, 'checkpoint_manager_blocking_start_time': 1761958694.617439, 'checkpoint_manager_blocking_duration_secs': 40.11105251312256} (2341257:standard_logger.py:34)
08:58:54.729 [I] Progress on: 22.0kit/30.0kit rate:13.2s/it remaining:29:23:19 elapsed:7:29:57 postfix:- (2341257:tqdm_logging.py:145)
08:58:54.752 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/train_state.orbax-checkpoint-tmp-87/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
08:58:56.795 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 169.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: 42 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:59:04.812 [I] Progress on: 22.0kit/30.0kit rate:1.6s/it remaining:3:35:56 elapsed:7:30:07 postfix:- (2341257:tqdm_logging.py:145)
08:59:07.807 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 201.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: 53 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
08:59:07.808 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
08:59:07.809 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/assets.orbax-checkpoint-tmp-85 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/assets (2341257:atomicity.py:289)
08:59:07.815 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
08:59:07.883 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/train_state.orbax-checkpoint-tmp-87 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/train_state (2341257:atomicity.py:289)
08:59:07.887 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
08:59:07.952 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/params.orbax-checkpoint-tmp-86 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84/params (2341257:atomicity.py:289)
08:59:07.953 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000.orbax-checkpoint-tmp-84 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000 (2341257:atomicity.py:289)
08:59:07.958 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000`. (2341257:atomicity.py:573)
08:59:07.958 [I] Finished asynchronous save (blocking + background) in 53.34 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/22000 (2341257:async_checkpointer.py:412)
08:59:07.958 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
08:59:07.958 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
08:59:07.958 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
08:59:08.317 [I] Deleted step 21000.                                                              (2341257:deleter.py:114)
08:59:08.317 [I] [process=0][thread=save_finalize][step=22000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
08:59:08.317 [I] [process=0][thread=save_finalize][step=22000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
08:59:15.047 [I] Progress on: 22.0kit/30.0kit rate:1.2s/it remaining:2:33:43 elapsed:7:30:17 postfix:- (2341257:tqdm_logging.py:145)
08:59:25.249 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:30:49 elapsed:7:30:27 postfix:- (2341257:tqdm_logging.py:145)
08:59:35.444 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:30:21 elapsed:7:30:37 postfix:- (2341257:tqdm_logging.py:145)
08:59:45.646 [I] Progress on: 22.0kit/30.0kit rate:1.1s/it remaining:2:30:08 elapsed:7:30:47 postfix:- (2341257:tqdm_logging.py:145)
08:59:55.844 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:30:02 elapsed:7:30:58 postfix:- (2341257:tqdm_logging.py:145)
09:00:06.043 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:29:49 elapsed:7:31:08 postfix:- (2341257:tqdm_logging.py:145)
09:00:16.247 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:29:48 elapsed:7:31:18 postfix:- (2341257:tqdm_logging.py:145)
09:00:26.440 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:29:27 elapsed:7:31:28 postfix:- (2341257:tqdm_logging.py:145)
09:00:36.651 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:29:30 elapsed:7:31:38 postfix:- (2341257:tqdm_logging.py:145)
09:00:46.846 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:29:06 elapsed:7:31:49 postfix:- (2341257:tqdm_logging.py:145)
Step 22100: grad_norm=0.0878, loss=0.0021, param_norm=1380.7620
09:00:57.091 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:29:01 elapsed:7:31:59 postfix:- (2341257:tqdm_logging.py:145)
09:01:07.286 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:28:47 elapsed:7:32:09 postfix:- (2341257:tqdm_logging.py:145)
09:01:17.484 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:28:41 elapsed:7:32:19 postfix:- (2341257:tqdm_logging.py:145)
09:01:27.681 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:28:26 elapsed:7:32:30 postfix:- (2341257:tqdm_logging.py:145)
09:01:37.878 [I] Progress on: 22.1kit/30.0kit rate:1.1s/it remaining:2:28:19 elapsed:7:32:40 postfix:- (2341257:tqdm_logging.py:145)
09:01:48.073 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:28:06 elapsed:7:32:50 postfix:- (2341257:tqdm_logging.py:145)
09:01:58.284 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:28:04 elapsed:7:33:00 postfix:- (2341257:tqdm_logging.py:145)
09:02:08.479 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:27:47 elapsed:7:33:10 postfix:- (2341257:tqdm_logging.py:145)
09:02:18.676 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:27:39 elapsed:7:33:20 postfix:- (2341257:tqdm_logging.py:145)
09:02:28.875 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:27:23 elapsed:7:33:31 postfix:- (2341257:tqdm_logging.py:145)
09:02:39.084 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:27:24 elapsed:7:33:41 postfix:- (2341257:tqdm_logging.py:145)
Step 22200: grad_norm=0.0817, loss=0.0021, param_norm=1380.7628
09:02:49.320 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:27:00 elapsed:7:33:51 postfix:- (2341257:tqdm_logging.py:145)
09:02:59.530 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:27:00 elapsed:7:34:01 postfix:- (2341257:tqdm_logging.py:145)
09:03:09.727 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:26:50 elapsed:7:34:12 postfix:- (2341257:tqdm_logging.py:145)
09:03:19.929 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:26:42 elapsed:7:34:22 postfix:- (2341257:tqdm_logging.py:145)
09:03:30.128 [I] Progress on: 22.2kit/30.0kit rate:1.1s/it remaining:2:26:31 elapsed:7:34:32 postfix:- (2341257:tqdm_logging.py:145)
09:03:40.327 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:26:19 elapsed:7:34:42 postfix:- (2341257:tqdm_logging.py:145)
09:03:50.523 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:26:03 elapsed:7:34:52 postfix:- (2341257:tqdm_logging.py:145)
09:04:00.722 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:25:59 elapsed:7:35:03 postfix:- (2341257:tqdm_logging.py:145)
09:04:10.917 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:25:43 elapsed:7:35:13 postfix:- (2341257:tqdm_logging.py:145)
09:04:21.125 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:25:40 elapsed:7:35:23 postfix:- (2341257:tqdm_logging.py:145)
09:04:31.321 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:25:24 elapsed:7:35:33 postfix:- (2341257:tqdm_logging.py:145)
Step 22300: grad_norm=0.0850, loss=0.0024, param_norm=1380.7634
09:04:41.573 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:25:13 elapsed:7:35:43 postfix:- (2341257:tqdm_logging.py:145)
09:04:51.985 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:26:31 elapsed:7:35:54 postfix:- (2341257:tqdm_logging.py:145)
09:05:02.212 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:25:41 elapsed:7:36:04 postfix:- (2341257:tqdm_logging.py:145)
09:05:12.378 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:24:05 elapsed:7:36:14 postfix:- (2341257:tqdm_logging.py:145)
09:05:22.615 [I] Progress on: 22.3kit/30.0kit rate:1.1s/it remaining:2:25:35 elapsed:7:36:24 postfix:- (2341257:tqdm_logging.py:145)
09:05:32.783 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:23:49 elapsed:7:36:35 postfix:- (2341257:tqdm_logging.py:145)
09:05:43.009 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:24:57 elapsed:7:36:45 postfix:- (2341257:tqdm_logging.py:145)
09:05:53.187 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:23:43 elapsed:7:36:55 postfix:- (2341257:tqdm_logging.py:145)
09:06:03.411 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:24:30 elapsed:7:37:05 postfix:- (2341257:tqdm_logging.py:145)
09:06:13.579 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:23:04 elapsed:7:37:15 postfix:- (2341257:tqdm_logging.py:145)
09:06:23.808 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:24:12 elapsed:7:37:26 postfix:- (2341257:tqdm_logging.py:145)
Step 22400: grad_norm=0.0717, loss=0.0019, param_norm=1380.7644
09:06:34.037 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:22:41 elapsed:7:37:36 postfix:- (2341257:tqdm_logging.py:145)
09:06:44.261 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:23:52 elapsed:7:37:46 postfix:- (2341257:tqdm_logging.py:145)
09:06:54.429 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:22:19 elapsed:7:37:56 postfix:- (2341257:tqdm_logging.py:145)
09:07:04.659 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:23:36 elapsed:7:38:06 postfix:- (2341257:tqdm_logging.py:145)
09:07:14.829 [I] Progress on: 22.4kit/30.0kit rate:1.1s/it remaining:2:22:10 elapsed:7:38:17 postfix:- (2341257:tqdm_logging.py:145)
09:07:25.062 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:23:09 elapsed:7:38:27 postfix:- (2341257:tqdm_logging.py:145)
09:07:35.231 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:21:42 elapsed:7:38:37 postfix:- (2341257:tqdm_logging.py:145)
09:07:45.458 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:22:53 elapsed:7:38:47 postfix:- (2341257:tqdm_logging.py:145)
09:07:55.628 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:21:29 elapsed:7:38:57 postfix:- (2341257:tqdm_logging.py:145)
09:08:05.861 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:22:28 elapsed:7:39:08 postfix:- (2341257:tqdm_logging.py:145)
09:08:16.041 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:21:05 elapsed:7:39:18 postfix:- (2341257:tqdm_logging.py:145)
Step 22500: grad_norm=0.0819, loss=0.0023, param_norm=1380.7650
09:08:26.341 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:22:18 elapsed:7:39:28 postfix:- (2341257:tqdm_logging.py:145)
09:08:36.507 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:20:44 elapsed:7:39:38 postfix:- (2341257:tqdm_logging.py:145)
09:08:46.740 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:21:45 elapsed:7:39:49 postfix:- (2341257:tqdm_logging.py:145)
09:08:56.908 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:20:22 elapsed:7:39:59 postfix:- (2341257:tqdm_logging.py:145)
09:09:07.136 [I] Progress on: 22.5kit/30.0kit rate:1.1s/it remaining:2:21:31 elapsed:7:40:09 postfix:- (2341257:tqdm_logging.py:145)
09:09:17.314 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:20:15 elapsed:7:40:19 postfix:- (2341257:tqdm_logging.py:145)
09:09:27.537 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:21:05 elapsed:7:40:29 postfix:- (2341257:tqdm_logging.py:145)
09:09:37.705 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:19:40 elapsed:7:40:40 postfix:- (2341257:tqdm_logging.py:145)
09:09:47.932 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:20:49 elapsed:7:40:50 postfix:- (2341257:tqdm_logging.py:145)
09:09:58.099 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:19:21 elapsed:7:41:00 postfix:- (2341257:tqdm_logging.py:145)
09:10:08.324 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:20:25 elapsed:7:41:10 postfix:- (2341257:tqdm_logging.py:145)
Step 22600: grad_norm=0.0803, loss=0.0021, param_norm=1380.7656
09:10:18.546 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:18:57 elapsed:7:41:20 postfix:- (2341257:tqdm_logging.py:145)
09:10:28.772 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:20:09 elapsed:7:41:31 postfix:- (2341257:tqdm_logging.py:145)
09:10:38.950 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:18:48 elapsed:7:41:41 postfix:- (2341257:tqdm_logging.py:145)
09:10:49.175 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:19:44 elapsed:7:41:51 postfix:- (2341257:tqdm_logging.py:145)
09:10:59.341 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:18:18 elapsed:7:42:01 postfix:- (2341257:tqdm_logging.py:145)
09:11:09.569 [I] Progress on: 22.6kit/30.0kit rate:1.1s/it remaining:2:19:29 elapsed:7:42:11 postfix:- (2341257:tqdm_logging.py:145)
09:11:19.746 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:18:01 elapsed:7:42:22 postfix:- (2341257:tqdm_logging.py:145)
09:11:29.971 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:19:01 elapsed:7:42:32 postfix:- (2341257:tqdm_logging.py:145)
09:11:40.139 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:17:38 elapsed:7:42:42 postfix:- (2341257:tqdm_logging.py:145)
09:11:50.364 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:18:45 elapsed:7:42:52 postfix:- (2341257:tqdm_logging.py:145)
09:12:00.533 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:17:23 elapsed:7:43:02 postfix:- (2341257:tqdm_logging.py:145)
Step 22700: grad_norm=0.0766, loss=0.0020, param_norm=1380.7662
09:12:10.814 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:18:23 elapsed:7:43:13 postfix:- (2341257:tqdm_logging.py:145)
09:12:20.982 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:16:59 elapsed:7:43:23 postfix:- (2341257:tqdm_logging.py:145)
09:12:31.209 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:18:10 elapsed:7:43:33 postfix:- (2341257:tqdm_logging.py:145)
09:12:41.373 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:16:36 elapsed:7:43:43 postfix:- (2341257:tqdm_logging.py:145)
09:12:51.918 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:18:12 elapsed:7:43:54 postfix:- (2341257:tqdm_logging.py:145)
09:13:02.298 [I] Progress on: 22.7kit/30.0kit rate:1.1s/it remaining:2:18:47 elapsed:7:44:04 postfix:- (2341257:tqdm_logging.py:145)
09:13:12.464 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:16:11 elapsed:7:44:14 postfix:- (2341257:tqdm_logging.py:145)
09:13:22.689 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:17:08 elapsed:7:44:25 postfix:- (2341257:tqdm_logging.py:145)
09:13:32.865 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:15:54 elapsed:7:44:35 postfix:- (2341257:tqdm_logging.py:145)
09:13:43.093 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:16:56 elapsed:7:44:45 postfix:- (2341257:tqdm_logging.py:145)
09:13:53.260 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:15:28 elapsed:7:44:55 postfix:- (2341257:tqdm_logging.py:145)
Step 22800: grad_norm=0.0797, loss=0.0020, param_norm=1380.7668
09:14:03.515 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:15:16 elapsed:7:45:05 postfix:- (2341257:tqdm_logging.py:145)
09:14:13.692 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:15:15 elapsed:7:45:16 postfix:- (2341257:tqdm_logging.py:145)
09:14:23.928 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:16:15 elapsed:7:45:26 postfix:- (2341257:tqdm_logging.py:145)
09:14:34.097 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:14:50 elapsed:7:45:36 postfix:- (2341257:tqdm_logging.py:145)
09:14:44.321 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:15:48 elapsed:7:45:46 postfix:- (2341257:tqdm_logging.py:145)
09:14:54.495 [I] Progress on: 22.8kit/30.0kit rate:1.1s/it remaining:2:14:32 elapsed:7:45:56 postfix:- (2341257:tqdm_logging.py:145)
09:15:04.727 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:15:43 elapsed:7:46:07 postfix:- (2341257:tqdm_logging.py:145)
09:15:14.890 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:14:02 elapsed:7:46:17 postfix:- (2341257:tqdm_logging.py:145)
09:15:25.125 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:15:09 elapsed:7:46:27 postfix:- (2341257:tqdm_logging.py:145)
09:15:35.294 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:13:50 elapsed:7:46:37 postfix:- (2341257:tqdm_logging.py:145)
09:15:45.525 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:14:57 elapsed:7:46:47 postfix:- (2341257:tqdm_logging.py:145)
Step 22900: grad_norm=0.0705, loss=0.0019, param_norm=1380.7675
09:15:55.881 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:14:50 elapsed:7:46:58 postfix:- (2341257:tqdm_logging.py:145)
09:16:05.961 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:14:36 elapsed:7:47:08 postfix:- (2341257:tqdm_logging.py:145)
09:16:16.128 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:13:04 elapsed:7:47:18 postfix:- (2341257:tqdm_logging.py:145)
09:16:26.356 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:14:10 elapsed:7:47:28 postfix:- (2341257:tqdm_logging.py:145)
09:16:36.527 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:12:49 elapsed:7:47:38 postfix:- (2341257:tqdm_logging.py:145)
09:16:46.759 [I] Progress on: 22.9kit/30.0kit rate:1.1s/it remaining:2:13:49 elapsed:7:47:49 postfix:- (2341257:tqdm_logging.py:145)
09:16:56.927 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:12:24 elapsed:7:47:59 postfix:- (2341257:tqdm_logging.py:145)
09:17:07.163 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:13:41 elapsed:7:48:09 postfix:- (2341257:tqdm_logging.py:145)
09:17:17.329 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:12:02 elapsed:7:48:19 postfix:- (2341257:tqdm_logging.py:145)
09:17:27.556 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:13:06 elapsed:7:48:29 postfix:- (2341257:tqdm_logging.py:145)
09:17:37.724 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:11:43 elapsed:7:48:40 postfix:- (2341257:tqdm_logging.py:145)
09:17:47.960 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:12:50 elapsed:7:48:50 postfix:- (2341257:tqdm_logging.py:145)
Step 23000: grad_norm=0.0783, loss=0.0020, param_norm=1380.7681
09:17:49.260 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
09:17:49.261 [I] [process=0] Saving checkpoint at step 23000                                      (2341257:checkpoint_manager.py:1408)
09:17:49.261 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000. (2341257:async_checkpointer.py:439)
09:17:49.269 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88 (2341257:atomicity.py:144)
09:17:49.274 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/params.orbax-checkpoint-tmp-90 (2341257:atomicity.py:144)
09:17:49.276 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/assets.orbax-checkpoint-tmp-89 (2341257:atomicity.py:144)
09:17:49.276 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/train_state.orbax-checkpoint-tmp-91 (2341257:atomicity.py:144)
09:17:49.289 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
09:17:51.458 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
09:17:51.459 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
09:17:51.479 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/params.orbax-checkpoint-tmp-90/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
09:18:21.541 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
09:18:21.541 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 222.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: 32 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:18:21.559 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 332.4 MiB/s (total bytes: 10.5 GiB) (time elapsed: 32 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:18:21.562 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
09:18:21.562 [I] Finished blocking save in 32.30 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000. (2341257:async_checkpointer.py:548)
09:18:21.563 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:18:21.563 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:18:21.563 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:18:21.563 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:18:21.563 [I] Deleting Checkpoint[step=22000 | time=2025-11-01 00:58:54.726508+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
09:18:21.563 [I] [process=0][thread=MainThread][step=23000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
09:18:21.564 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
09:18:21.564 [I] {'step': 23000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761959869.2606564, 'wait_for_prev_duration_secs': 0.0001628398895263672, 'checkpointer_blocking_start_time': 1761959869.261082, 'checkpointer_blocking_duration_secs': 32.3021674156189, 'get_old_steps_start_time': 1761959901.5632644, 'get_old_steps_duration_secs': 0.0003604888916015625, 'checkpoint_manager_blocking_start_time': 1761959869.2605631, 'checkpoint_manager_blocking_duration_secs': 32.30352973937988} (2341257:standard_logger.py:34)
09:18:21.564 [I] Progress on: 23.0kit/30.0kit rate:10.9s/it remaining:21:08:56 elapsed:7:49:23 postfix:- (2341257:tqdm_logging.py:145)
09:18:21.591 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/train_state.orbax-checkpoint-tmp-91/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
09:18:26.577 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 192.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: 37 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:18:31.644 [I] Progress on: 23.0kit/30.0kit rate:1.5s/it remaining:2:58:26 elapsed:7:49:33 postfix:- (2341257:tqdm_logging.py:145)
09:18:36.106 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 229.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: 46 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:18:36.106 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
09:18:36.108 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/assets.orbax-checkpoint-tmp-89 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/assets (2341257:atomicity.py:289)
09:18:36.114 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
09:18:36.228 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/train_state.orbax-checkpoint-tmp-91 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/train_state (2341257:atomicity.py:289)
09:18:36.232 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
09:18:36.249 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/params.orbax-checkpoint-tmp-90 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88/params (2341257:atomicity.py:289)
09:18:36.250 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000.orbax-checkpoint-tmp-88 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000 (2341257:atomicity.py:289)
09:18:36.254 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000`. (2341257:atomicity.py:573)
09:18:36.254 [I] Finished asynchronous save (blocking + background) in 46.99 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/23000 (2341257:async_checkpointer.py:412)
09:18:36.254 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
09:18:36.254 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
09:18:36.254 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
09:18:36.699 [I] Deleted step 22000.                                                              (2341257:deleter.py:114)
09:18:36.700 [I] [process=0][thread=save_finalize][step=23000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
09:18:36.700 [I] [process=0][thread=save_finalize][step=23000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
09:18:41.821 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:13:08 elapsed:7:49:44 postfix:- (2341257:tqdm_logging.py:145)
09:18:52.051 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:12:19 elapsed:7:49:54 postfix:- (2341257:tqdm_logging.py:145)
09:19:02.223 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:10:52 elapsed:7:50:04 postfix:- (2341257:tqdm_logging.py:145)
09:19:12.453 [I] Progress on: 23.0kit/30.0kit rate:1.1s/it remaining:2:11:54 elapsed:7:50:14 postfix:- (2341257:tqdm_logging.py:145)
09:19:22.632 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:10:43 elapsed:7:50:24 postfix:- (2341257:tqdm_logging.py:145)
09:19:32.855 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:11:30 elapsed:7:50:35 postfix:- (2341257:tqdm_logging.py:145)
09:19:43.022 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:10:09 elapsed:7:50:45 postfix:- (2341257:tqdm_logging.py:145)
09:19:53.256 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:11:19 elapsed:7:50:55 postfix:- (2341257:tqdm_logging.py:145)
09:20:03.426 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:09:52 elapsed:7:51:05 postfix:- (2341257:tqdm_logging.py:145)
09:20:13.664 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:11:10 elapsed:7:51:15 postfix:- (2341257:tqdm_logging.py:145)
Step 23100: grad_norm=0.0760, loss=0.0020, param_norm=1380.7689
09:20:23.849 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:09:23 elapsed:7:51:26 postfix:- (2341257:tqdm_logging.py:145)
09:20:34.073 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:10:28 elapsed:7:51:36 postfix:- (2341257:tqdm_logging.py:145)
09:20:44.240 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:09:08 elapsed:7:51:46 postfix:- (2341257:tqdm_logging.py:145)
09:20:54.468 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:10:16 elapsed:7:51:56 postfix:- (2341257:tqdm_logging.py:145)
09:21:04.633 [I] Progress on: 23.1kit/30.0kit rate:1.1s/it remaining:2:08:49 elapsed:7:52:06 postfix:- (2341257:tqdm_logging.py:145)
09:21:14.844 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:09:17 elapsed:7:52:17 postfix:- (2341257:tqdm_logging.py:145)
09:21:25.285 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:10:04 elapsed:7:52:27 postfix:- (2341257:tqdm_logging.py:145)
09:21:35.459 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:08:23 elapsed:7:52:37 postfix:- (2341257:tqdm_logging.py:145)
09:21:45.682 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:09:16 elapsed:7:52:48 postfix:- (2341257:tqdm_logging.py:145)
09:21:55.856 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:08:02 elapsed:7:52:58 postfix:- (2341257:tqdm_logging.py:145)
09:22:06.096 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:09:06 elapsed:7:53:08 postfix:- (2341257:tqdm_logging.py:145)
Step 23200: grad_norm=0.0751, loss=0.0022, param_norm=1380.7692
09:22:16.309 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:07:35 elapsed:7:53:18 postfix:- (2341257:tqdm_logging.py:145)
09:22:26.535 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:08:38 elapsed:7:53:28 postfix:- (2341257:tqdm_logging.py:145)
09:22:36.701 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:07:14 elapsed:7:53:39 postfix:- (2341257:tqdm_logging.py:145)
09:22:46.930 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:08:23 elapsed:7:53:49 postfix:- (2341257:tqdm_logging.py:145)
09:22:57.095 [I] Progress on: 23.2kit/30.0kit rate:1.1s/it remaining:2:06:54 elapsed:7:53:59 postfix:- (2341257:tqdm_logging.py:145)
09:23:07.319 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:07:54 elapsed:7:54:09 postfix:- (2341257:tqdm_logging.py:145)
09:23:17.488 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:06:33 elapsed:7:54:19 postfix:- (2341257:tqdm_logging.py:145)
09:23:27.722 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:07:45 elapsed:7:54:30 postfix:- (2341257:tqdm_logging.py:145)
09:23:37.896 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:06:17 elapsed:7:54:40 postfix:- (2341257:tqdm_logging.py:145)
09:23:48.121 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:07:15 elapsed:7:54:50 postfix:- (2341257:tqdm_logging.py:145)
09:23:58.289 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:05:58 elapsed:7:55:00 postfix:- (2341257:tqdm_logging.py:145)
Step 23300: grad_norm=0.0752, loss=0.0020, param_norm=1380.7700
09:24:08.571 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:07:00 elapsed:7:55:10 postfix:- (2341257:tqdm_logging.py:145)
09:24:18.735 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:05:36 elapsed:7:55:21 postfix:- (2341257:tqdm_logging.py:145)
09:24:28.965 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:06:42 elapsed:7:55:31 postfix:- (2341257:tqdm_logging.py:145)
09:24:39.130 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:05:18 elapsed:7:55:41 postfix:- (2341257:tqdm_logging.py:145)
09:24:49.367 [I] Progress on: 23.3kit/30.0kit rate:1.1s/it remaining:2:06:31 elapsed:7:55:51 postfix:- (2341257:tqdm_logging.py:145)
09:24:59.528 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:04:55 elapsed:7:56:01 postfix:- (2341257:tqdm_logging.py:145)
09:25:09.752 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:05:52 elapsed:7:56:12 postfix:- (2341257:tqdm_logging.py:145)
09:25:19.929 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:04:41 elapsed:7:56:22 postfix:- (2341257:tqdm_logging.py:145)
09:25:30.159 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:05:41 elapsed:7:56:32 postfix:- (2341257:tqdm_logging.py:145)
09:25:40.322 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:04:09 elapsed:7:56:42 postfix:- (2341257:tqdm_logging.py:145)
09:25:50.550 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:05:15 elapsed:7:56:52 postfix:- (2341257:tqdm_logging.py:145)
Step 23400: grad_norm=0.0735, loss=0.0019, param_norm=1380.7704
09:26:00.794 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:04:08 elapsed:7:57:03 postfix:- (2341257:tqdm_logging.py:145)
09:26:11.023 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:04:59 elapsed:7:57:13 postfix:- (2341257:tqdm_logging.py:145)
09:26:21.188 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:03:33 elapsed:7:57:23 postfix:- (2341257:tqdm_logging.py:145)
09:26:31.422 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:04:34 elapsed:7:57:33 postfix:- (2341257:tqdm_logging.py:145)
09:26:41.592 [I] Progress on: 23.4kit/30.0kit rate:1.1s/it remaining:2:03:16 elapsed:7:57:43 postfix:- (2341257:tqdm_logging.py:145)
09:26:51.821 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:04:17 elapsed:7:57:54 postfix:- (2341257:tqdm_logging.py:145)
09:27:02.006 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:03:06 elapsed:7:58:04 postfix:- (2341257:tqdm_logging.py:145)
09:27:12.231 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:03:51 elapsed:7:58:14 postfix:- (2341257:tqdm_logging.py:145)
09:27:22.401 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:02:35 elapsed:7:58:24 postfix:- (2341257:tqdm_logging.py:145)
09:27:32.629 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:03:36 elapsed:7:58:34 postfix:- (2341257:tqdm_logging.py:145)
09:27:42.795 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:02:13 elapsed:7:58:45 postfix:- (2341257:tqdm_logging.py:145)
Step 23500: grad_norm=0.0745, loss=0.0019, param_norm=1380.7712
09:27:53.076 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:03:11 elapsed:7:58:55 postfix:- (2341257:tqdm_logging.py:145)
09:28:03.244 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:01:55 elapsed:7:59:05 postfix:- (2341257:tqdm_logging.py:145)
09:28:13.471 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:02:55 elapsed:7:59:15 postfix:- (2341257:tqdm_logging.py:145)
09:28:23.638 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:01:37 elapsed:7:59:25 postfix:- (2341257:tqdm_logging.py:145)
09:28:33.861 [I] Progress on: 23.5kit/30.0kit rate:1.1s/it remaining:2:02:27 elapsed:7:59:36 postfix:- (2341257:tqdm_logging.py:145)
09:28:44.040 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:01:20 elapsed:7:59:46 postfix:- (2341257:tqdm_logging.py:145)
09:28:54.268 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:02:15 elapsed:7:59:56 postfix:- (2341257:tqdm_logging.py:145)
09:29:04.434 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:00:55 elapsed:8:00:06 postfix:- (2341257:tqdm_logging.py:145)
09:29:14.859 [I] Progress on: 23.6kit/30.0kit rate:1.2s/it remaining:2:04:43 elapsed:8:00:17 postfix:- (2341257:tqdm_logging.py:145)
09:29:25.051 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:01:09 elapsed:8:00:27 postfix:- (2341257:tqdm_logging.py:145)
09:29:35.251 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:01:00 elapsed:8:00:37 postfix:- (2341257:tqdm_logging.py:145)
Step 23600: grad_norm=0.0732, loss=0.0020, param_norm=1380.7719
09:29:45.484 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:00:24 elapsed:8:00:47 postfix:- (2341257:tqdm_logging.py:145)
09:29:55.685 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:00:39 elapsed:8:00:58 postfix:- (2341257:tqdm_logging.py:145)
09:30:05.878 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:00:19 elapsed:8:01:08 postfix:- (2341257:tqdm_logging.py:145)
09:30:16.077 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:00:17 elapsed:8:01:18 postfix:- (2341257:tqdm_logging.py:145)
09:30:26.271 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:1:59:57 elapsed:8:01:28 postfix:- (2341257:tqdm_logging.py:145)
09:30:36.472 [I] Progress on: 23.6kit/30.0kit rate:1.1s/it remaining:2:00:02 elapsed:8:01:38 postfix:- (2341257:tqdm_logging.py:145)
09:30:46.678 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:2:00:00 elapsed:8:01:48 postfix:- (2341257:tqdm_logging.py:145)
09:30:56.879 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:59:38 elapsed:8:01:59 postfix:- (2341257:tqdm_logging.py:145)
09:31:07.074 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:59:21 elapsed:8:02:09 postfix:- (2341257:tqdm_logging.py:145)
09:31:17.274 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:59:19 elapsed:8:02:19 postfix:- (2341257:tqdm_logging.py:145)
09:31:27.476 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:59:15 elapsed:8:02:29 postfix:- (2341257:tqdm_logging.py:145)
Step 23700: grad_norm=0.0752, loss=0.0020, param_norm=1380.7722
09:31:37.720 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:58:41 elapsed:8:02:40 postfix:- (2341257:tqdm_logging.py:145)
09:31:47.913 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:58:40 elapsed:8:02:50 postfix:- (2341257:tqdm_logging.py:145)
09:31:58.113 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:58:34 elapsed:8:03:00 postfix:- (2341257:tqdm_logging.py:145)
09:32:08.308 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:58:19 elapsed:8:03:10 postfix:- (2341257:tqdm_logging.py:145)
09:32:18.508 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:58:17 elapsed:8:03:20 postfix:- (2341257:tqdm_logging.py:145)
09:32:28.704 [I] Progress on: 23.7kit/30.0kit rate:1.1s/it remaining:1:58:01 elapsed:8:03:31 postfix:- (2341257:tqdm_logging.py:145)
09:32:38.904 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:57:56 elapsed:8:03:41 postfix:- (2341257:tqdm_logging.py:145)
09:32:49.111 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:57:55 elapsed:8:03:51 postfix:- (2341257:tqdm_logging.py:145)
09:32:59.310 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:57:36 elapsed:8:04:01 postfix:- (2341257:tqdm_logging.py:145)
09:33:09.504 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:57:18 elapsed:8:04:11 postfix:- (2341257:tqdm_logging.py:145)
09:33:19.705 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:57:14 elapsed:8:04:22 postfix:- (2341257:tqdm_logging.py:145)
Step 23800: grad_norm=0.0758, loss=0.0019, param_norm=1380.7726
09:33:29.942 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:56:31 elapsed:8:04:32 postfix:- (2341257:tqdm_logging.py:145)
09:33:40.143 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:56:55 elapsed:8:04:42 postfix:- (2341257:tqdm_logging.py:145)
09:33:50.337 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:56:40 elapsed:8:04:52 postfix:- (2341257:tqdm_logging.py:145)
09:34:00.538 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:56:35 elapsed:8:05:02 postfix:- (2341257:tqdm_logging.py:145)
09:34:11.006 [I] Progress on: 23.8kit/30.0kit rate:1.2s/it remaining:2:04:38 elapsed:8:05:13 postfix:- (2341257:tqdm_logging.py:145)
09:34:21.048 [I] Progress on: 23.8kit/30.0kit rate:1.1s/it remaining:1:56:17 elapsed:8:05:23 postfix:- (2341257:tqdm_logging.py:145)
09:34:31.253 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:55:58 elapsed:8:05:33 postfix:- (2341257:tqdm_logging.py:145)
09:34:41.455 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:55:57 elapsed:8:05:43 postfix:- (2341257:tqdm_logging.py:145)
09:34:51.648 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:55:38 elapsed:8:05:53 postfix:- (2341257:tqdm_logging.py:145)
09:35:01.846 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:55:32 elapsed:8:06:04 postfix:- (2341257:tqdm_logging.py:145)
09:35:12.052 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:55:23 elapsed:8:06:14 postfix:- (2341257:tqdm_logging.py:145)
Step 23900: grad_norm=0.0761, loss=0.0021, param_norm=1380.7731
09:35:22.421 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:55:10 elapsed:8:06:24 postfix:- (2341257:tqdm_logging.py:145)
09:35:32.484 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:54:53 elapsed:8:06:34 postfix:- (2341257:tqdm_logging.py:145)
09:35:42.684 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:54:53 elapsed:8:06:45 postfix:- (2341257:tqdm_logging.py:145)
09:35:52.878 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:54:35 elapsed:8:06:55 postfix:- (2341257:tqdm_logging.py:145)
09:36:03.077 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:54:30 elapsed:8:07:05 postfix:- (2341257:tqdm_logging.py:145)
09:36:13.271 [I] Progress on: 23.9kit/30.0kit rate:1.1s/it remaining:1:54:15 elapsed:8:07:15 postfix:- (2341257:tqdm_logging.py:145)
09:36:23.472 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:54:13 elapsed:8:07:25 postfix:- (2341257:tqdm_logging.py:145)
09:36:33.676 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:54:12 elapsed:8:07:35 postfix:- (2341257:tqdm_logging.py:145)
09:36:43.877 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:53:51 elapsed:8:07:46 postfix:- (2341257:tqdm_logging.py:145)
09:36:54.072 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:53:35 elapsed:8:07:56 postfix:- (2341257:tqdm_logging.py:145)
09:37:04.271 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:53:29 elapsed:8:08:06 postfix:- (2341257:tqdm_logging.py:145)
09:37:14.691 [I] Progress on: 24.0kit/30.0kit rate:1.2s/it remaining:1:55:02 elapsed:8:08:17 postfix:- (2341257:tqdm_logging.py:145)
Step 24000: grad_norm=0.0645, loss=0.0016, param_norm=1380.7734
09:37:16.019 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
09:37:16.019 [I] [process=0] Saving checkpoint at step 24000                                      (2341257:checkpoint_manager.py:1408)
09:37:16.019 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000. (2341257:async_checkpointer.py:439)
09:37:16.028 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92 (2341257:atomicity.py:144)
09:37:16.033 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/params.orbax-checkpoint-tmp-94 (2341257:atomicity.py:144)
09:37:16.033 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/train_state.orbax-checkpoint-tmp-95 (2341257:atomicity.py:144)
09:37:16.033 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/assets.orbax-checkpoint-tmp-93 (2341257:atomicity.py:144)
09:37:16.047 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
09:37:18.284 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
09:37:18.286 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
09:37:18.306 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/params.orbax-checkpoint-tmp-94/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
09:37:21.827 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
09:37:21.827 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.2 GiB/s (total bytes: 7.0 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:37:21.845 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.8 GiB/s (total bytes: 10.5 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:37:21.849 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
09:37:21.849 [I] Finished blocking save in 5.83 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000. (2341257:async_checkpointer.py:548)
09:37:21.851 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:37:21.851 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:37:21.851 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:37:21.851 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:37:21.851 [I] Deleting Checkpoint[step=23000 | time=2025-11-01 01:18:21.563253+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
09:37:21.851 [I] [process=0][thread=MainThread][step=24000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
09:37:21.852 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
09:37:21.852 [I] {'step': 24000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761961036.0193136, 'wait_for_prev_duration_secs': 0.0001537799835205078, 'checkpointer_blocking_start_time': 1761961036.019706, 'checkpointer_blocking_duration_secs': 5.831369400024414, 'get_old_steps_start_time': 1761961041.8510892, 'get_old_steps_duration_secs': 0.0007343292236328125, 'checkpoint_manager_blocking_start_time': 1761961036.0192242, 'checkpoint_manager_blocking_duration_secs': 5.833104848861694} (2341257:standard_logger.py:34)
09:37:21.883 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/train_state.orbax-checkpoint-tmp-95/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
09:37:26.335 [I] Progress on: 24.0kit/30.0kit rate:2.1s/it remaining:3:29:39 elapsed:8:08:28 postfix:- (2341257:tqdm_logging.py:145)
09:37:34.444 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 388.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: 18 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:37:36.400 [I] Progress on: 24.0kit/30.0kit rate:1.2s/it remaining:1:56:34 elapsed:8:08:38 postfix:- (2341257:tqdm_logging.py:145)
09:37:46.606 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:53:10 elapsed:8:08:48 postfix:- (2341257:tqdm_logging.py:145)
09:37:49.584 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 319.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: 33 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:37:49.585 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
09:37:49.586 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/assets.orbax-checkpoint-tmp-93 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/assets (2341257:atomicity.py:289)
09:37:49.590 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
09:37:49.724 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/train_state.orbax-checkpoint-tmp-95 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/train_state (2341257:atomicity.py:289)
09:37:49.729 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
09:37:49.746 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/params.orbax-checkpoint-tmp-94 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92/params (2341257:atomicity.py:289)
09:37:49.747 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000.orbax-checkpoint-tmp-92 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000 (2341257:atomicity.py:289)
09:37:49.752 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000`. (2341257:atomicity.py:573)
09:37:49.752 [I] Finished asynchronous save (blocking + background) in 33.73 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/24000 (2341257:async_checkpointer.py:412)
09:37:49.752 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
09:37:49.752 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
09:37:49.752 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
09:37:50.147 [I] Deleted step 23000.                                                              (2341257:deleter.py:114)
09:37:50.147 [I] [process=0][thread=save_finalize][step=24000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
09:37:50.147 [I] [process=0][thread=save_finalize][step=24000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
09:37:56.803 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:52:42 elapsed:8:08:59 postfix:- (2341257:tqdm_logging.py:145)
09:38:07.008 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:52:41 elapsed:8:09:09 postfix:- (2341257:tqdm_logging.py:145)
09:38:17.205 [I] Progress on: 24.0kit/30.0kit rate:1.1s/it remaining:1:52:19 elapsed:8:09:19 postfix:- (2341257:tqdm_logging.py:145)
09:38:27.401 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:52:09 elapsed:8:09:29 postfix:- (2341257:tqdm_logging.py:145)
09:38:37.608 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:52:15 elapsed:8:09:39 postfix:- (2341257:tqdm_logging.py:145)
09:38:47.805 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:51:54 elapsed:8:09:50 postfix:- (2341257:tqdm_logging.py:145)
09:38:58.002 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:51:42 elapsed:8:10:00 postfix:- (2341257:tqdm_logging.py:145)
09:39:08.210 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:51:44 elapsed:8:10:10 postfix:- (2341257:tqdm_logging.py:145)
Step 24100: grad_norm=0.0728, loss=0.0020, param_norm=1380.7742
09:39:18.443 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:50:53 elapsed:8:10:20 postfix:- (2341257:tqdm_logging.py:145)
09:39:28.641 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:51:09 elapsed:8:10:30 postfix:- (2341257:tqdm_logging.py:145)
09:39:38.851 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:51:06 elapsed:8:10:41 postfix:- (2341257:tqdm_logging.py:145)
09:39:49.047 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:50:52 elapsed:8:10:51 postfix:- (2341257:tqdm_logging.py:145)
09:39:59.243 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:50:39 elapsed:8:11:01 postfix:- (2341257:tqdm_logging.py:145)
09:40:09.441 [I] Progress on: 24.1kit/30.0kit rate:1.1s/it remaining:1:50:30 elapsed:8:11:11 postfix:- (2341257:tqdm_logging.py:145)
09:40:19.638 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:50:19 elapsed:8:11:21 postfix:- (2341257:tqdm_logging.py:145)
09:40:29.835 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:50:09 elapsed:8:11:32 postfix:- (2341257:tqdm_logging.py:145)
09:40:40.042 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:50:09 elapsed:8:11:42 postfix:- (2341257:tqdm_logging.py:145)
09:40:50.238 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:49:48 elapsed:8:11:52 postfix:- (2341257:tqdm_logging.py:145)
09:41:00.433 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:49:37 elapsed:8:12:02 postfix:- (2341257:tqdm_logging.py:145)
Step 24200: grad_norm=0.0736, loss=0.0020, param_norm=1380.7743
09:41:10.685 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:49:10 elapsed:8:12:13 postfix:- (2341257:tqdm_logging.py:145)
09:41:20.881 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:49:18 elapsed:8:12:23 postfix:- (2341257:tqdm_logging.py:145)
09:41:31.078 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:49:08 elapsed:8:12:33 postfix:- (2341257:tqdm_logging.py:145)
09:41:41.275 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:48:57 elapsed:8:12:43 postfix:- (2341257:tqdm_logging.py:145)
09:41:51.471 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:48:48 elapsed:8:12:53 postfix:- (2341257:tqdm_logging.py:145)
09:42:01.668 [I] Progress on: 24.2kit/30.0kit rate:1.1s/it remaining:1:48:36 elapsed:8:13:03 postfix:- (2341257:tqdm_logging.py:145)
09:42:11.867 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:48:31 elapsed:8:13:14 postfix:- (2341257:tqdm_logging.py:145)
09:42:22.073 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:48:22 elapsed:8:13:24 postfix:- (2341257:tqdm_logging.py:145)
09:42:32.271 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:48:09 elapsed:8:13:34 postfix:- (2341257:tqdm_logging.py:145)
09:42:42.476 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:48:13 elapsed:8:13:44 postfix:- (2341257:tqdm_logging.py:145)
09:42:52.673 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:47:47 elapsed:8:13:54 postfix:- (2341257:tqdm_logging.py:145)
Step 24300: grad_norm=0.0656, loss=0.0018, param_norm=1380.7747
09:43:03.053 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:47:38 elapsed:8:14:05 postfix:- (2341257:tqdm_logging.py:145)
09:43:13.124 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:47:27 elapsed:8:14:15 postfix:- (2341257:tqdm_logging.py:145)
09:43:23.337 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:47:30 elapsed:8:14:25 postfix:- (2341257:tqdm_logging.py:145)
09:43:33.531 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:47:02 elapsed:8:14:35 postfix:- (2341257:tqdm_logging.py:145)
09:43:43.753 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:47:17 elapsed:8:14:46 postfix:- (2341257:tqdm_logging.py:145)
09:43:53.950 [I] Progress on: 24.3kit/30.0kit rate:1.1s/it remaining:1:46:47 elapsed:8:14:56 postfix:- (2341257:tqdm_logging.py:145)
09:44:04.147 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:46:35 elapsed:8:15:06 postfix:- (2341257:tqdm_logging.py:145)
09:44:14.354 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:46:31 elapsed:8:15:16 postfix:- (2341257:tqdm_logging.py:145)
09:44:24.550 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:46:16 elapsed:8:15:26 postfix:- (2341257:tqdm_logging.py:145)
09:44:34.745 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:46:02 elapsed:8:15:37 postfix:- (2341257:tqdm_logging.py:145)
09:44:44.943 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:45:54 elapsed:8:15:47 postfix:- (2341257:tqdm_logging.py:145)
09:44:55.141 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:45:44 elapsed:8:15:57 postfix:- (2341257:tqdm_logging.py:145)
Step 24400: grad_norm=0.0697, loss=0.0017, param_norm=1380.7753
09:45:05.377 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:45:31 elapsed:8:16:07 postfix:- (2341257:tqdm_logging.py:145)
09:45:15.962 [I] Progress on: 24.4kit/30.0kit rate:1.2s/it remaining:1:56:12 elapsed:8:16:18 postfix:- (2341257:tqdm_logging.py:145)
09:45:26.008 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:45:26 elapsed:8:16:28 postfix:- (2341257:tqdm_logging.py:145)
09:45:36.203 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:45:02 elapsed:8:16:38 postfix:- (2341257:tqdm_logging.py:145)
09:45:46.401 [I] Progress on: 24.4kit/30.0kit rate:1.1s/it remaining:1:44:53 elapsed:8:16:48 postfix:- (2341257:tqdm_logging.py:145)
09:45:56.601 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:44:43 elapsed:8:16:58 postfix:- (2341257:tqdm_logging.py:145)
09:46:06.798 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:44:32 elapsed:8:17:09 postfix:- (2341257:tqdm_logging.py:145)
09:46:17.007 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:44:27 elapsed:8:17:19 postfix:- (2341257:tqdm_logging.py:145)
09:46:27.206 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:44:14 elapsed:8:17:29 postfix:- (2341257:tqdm_logging.py:145)
09:46:37.401 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:44:02 elapsed:8:17:39 postfix:- (2341257:tqdm_logging.py:145)
09:46:47.602 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:43:58 elapsed:8:17:49 postfix:- (2341257:tqdm_logging.py:145)
Step 24500: grad_norm=0.0735, loss=0.0019, param_norm=1380.7759
09:46:57.837 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:43:39 elapsed:8:18:00 postfix:- (2341257:tqdm_logging.py:145)
09:47:08.034 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:43:32 elapsed:8:18:10 postfix:- (2341257:tqdm_logging.py:145)
09:47:18.232 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:43:22 elapsed:8:18:20 postfix:- (2341257:tqdm_logging.py:145)
09:47:28.435 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:43:13 elapsed:8:18:30 postfix:- (2341257:tqdm_logging.py:145)
09:47:38.632 [I] Progress on: 24.5kit/30.0kit rate:1.1s/it remaining:1:43:01 elapsed:8:18:40 postfix:- (2341257:tqdm_logging.py:145)
09:47:48.833 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:42:51 elapsed:8:18:51 postfix:- (2341257:tqdm_logging.py:145)
09:47:59.035 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:42:48 elapsed:8:19:01 postfix:- (2341257:tqdm_logging.py:145)
09:48:09.231 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:42:30 elapsed:8:19:11 postfix:- (2341257:tqdm_logging.py:145)
09:48:19.432 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:42:21 elapsed:8:19:21 postfix:- (2341257:tqdm_logging.py:145)
09:48:29.632 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:42:13 elapsed:8:19:31 postfix:- (2341257:tqdm_logging.py:145)
09:48:39.850 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:42:05 elapsed:8:19:42 postfix:- (2341257:tqdm_logging.py:145)
Step 24600: grad_norm=0.0718, loss=0.0020, param_norm=1380.7764
09:48:50.080 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:41:42 elapsed:8:19:52 postfix:- (2341257:tqdm_logging.py:145)
09:49:00.278 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:41:39 elapsed:8:20:02 postfix:- (2341257:tqdm_logging.py:145)
09:49:10.477 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:41:34 elapsed:8:20:12 postfix:- (2341257:tqdm_logging.py:145)
09:49:20.671 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:41:18 elapsed:8:20:22 postfix:- (2341257:tqdm_logging.py:145)
09:49:30.868 [I] Progress on: 24.6kit/30.0kit rate:1.1s/it remaining:1:41:08 elapsed:8:20:33 postfix:- (2341257:tqdm_logging.py:145)
09:49:41.069 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:41:01 elapsed:8:20:43 postfix:- (2341257:tqdm_logging.py:145)
09:49:51.263 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:40:47 elapsed:8:20:53 postfix:- (2341257:tqdm_logging.py:145)
09:50:01.475 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:40:42 elapsed:8:21:03 postfix:- (2341257:tqdm_logging.py:145)
09:50:11.672 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:40:31 elapsed:8:21:13 postfix:- (2341257:tqdm_logging.py:145)
09:50:21.867 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:40:16 elapsed:8:21:24 postfix:- (2341257:tqdm_logging.py:145)
09:50:32.071 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:40:19 elapsed:8:21:34 postfix:- (2341257:tqdm_logging.py:145)
Step 24700: grad_norm=0.0727, loss=0.0019, param_norm=1380.7767
09:50:42.312 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:39:54 elapsed:8:21:44 postfix:- (2341257:tqdm_logging.py:145)
09:50:52.505 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:39:47 elapsed:8:21:54 postfix:- (2341257:tqdm_logging.py:145)
09:51:02.700 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:39:37 elapsed:8:22:05 postfix:- (2341257:tqdm_logging.py:145)
09:51:12.900 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:39:31 elapsed:8:22:15 postfix:- (2341257:tqdm_logging.py:145)
09:51:23.107 [I] Progress on: 24.7kit/30.0kit rate:1.1s/it remaining:1:39:29 elapsed:8:22:25 postfix:- (2341257:tqdm_logging.py:145)
09:51:33.304 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:39:06 elapsed:8:22:35 postfix:- (2341257:tqdm_logging.py:145)
09:51:43.502 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:38:57 elapsed:8:22:45 postfix:- (2341257:tqdm_logging.py:145)
09:51:53.703 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:38:47 elapsed:8:22:56 postfix:- (2341257:tqdm_logging.py:145)
09:52:03.899 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:38:35 elapsed:8:23:06 postfix:- (2341257:tqdm_logging.py:145)
09:52:14.108 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:38:37 elapsed:8:23:16 postfix:- (2341257:tqdm_logging.py:145)
09:52:24.303 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:38:16 elapsed:8:23:26 postfix:- (2341257:tqdm_logging.py:145)
Step 24800: grad_norm=0.0701, loss=0.0020, param_norm=1380.7770
09:52:34.542 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:37:56 elapsed:8:23:36 postfix:- (2341257:tqdm_logging.py:145)
09:52:44.741 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:37:56 elapsed:8:23:47 postfix:- (2341257:tqdm_logging.py:145)
09:52:54.937 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:37:46 elapsed:8:23:57 postfix:- (2341257:tqdm_logging.py:145)
09:53:05.134 [I] Progress on: 24.8kit/30.0kit rate:1.1s/it remaining:1:37:36 elapsed:8:24:07 postfix:- (2341257:tqdm_logging.py:145)
09:53:15.538 [I] Progress on: 24.8kit/30.0kit rate:1.2s/it remaining:1:39:13 elapsed:8:24:17 postfix:- (2341257:tqdm_logging.py:145)
09:53:25.735 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:37:19 elapsed:8:24:28 postfix:- (2341257:tqdm_logging.py:145)
09:53:35.931 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:37:04 elapsed:8:24:38 postfix:- (2341257:tqdm_logging.py:145)
09:53:46.133 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:36:58 elapsed:8:24:48 postfix:- (2341257:tqdm_logging.py:145)
09:53:56.337 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:36:44 elapsed:8:24:58 postfix:- (2341257:tqdm_logging.py:145)
09:54:06.535 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:36:35 elapsed:8:25:08 postfix:- (2341257:tqdm_logging.py:145)
09:54:16.738 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:36:30 elapsed:8:25:19 postfix:- (2341257:tqdm_logging.py:145)
Step 24900: grad_norm=0.0738, loss=0.0018, param_norm=1380.7775
09:54:26.972 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:35:58 elapsed:8:25:29 postfix:- (2341257:tqdm_logging.py:145)
09:54:37.168 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:36:01 elapsed:8:25:39 postfix:- (2341257:tqdm_logging.py:145)
09:54:47.365 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:35:50 elapsed:8:25:49 postfix:- (2341257:tqdm_logging.py:145)
09:54:57.561 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:35:42 elapsed:8:25:59 postfix:- (2341257:tqdm_logging.py:145)
09:55:07.771 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:35:36 elapsed:8:26:10 postfix:- (2341257:tqdm_logging.py:145)
09:55:18.099 [I] Progress on: 24.9kit/30.0kit rate:1.1s/it remaining:1:35:46 elapsed:8:26:20 postfix:- (2341257:tqdm_logging.py:145)
09:55:28.305 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:35:24 elapsed:8:26:30 postfix:- (2341257:tqdm_logging.py:145)
09:55:38.504 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:35:03 elapsed:8:26:40 postfix:- (2341257:tqdm_logging.py:145)
09:55:48.702 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:34:52 elapsed:8:26:51 postfix:- (2341257:tqdm_logging.py:145)
09:55:58.897 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:34:40 elapsed:8:27:01 postfix:- (2341257:tqdm_logging.py:145)
09:56:09.106 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:34:42 elapsed:8:27:11 postfix:- (2341257:tqdm_logging.py:145)
Step 25000: grad_norm=0.0694, loss=0.0019, param_norm=1380.7780
09:56:17.234 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
09:56:17.234 [I] [process=0] Saving checkpoint at step 25000                                      (2341257:checkpoint_manager.py:1408)
09:56:17.235 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000. (2341257:async_checkpointer.py:439)
09:56:17.244 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96 (2341257:atomicity.py:144)
09:56:17.248 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/params.orbax-checkpoint-tmp-98 (2341257:atomicity.py:144)
09:56:17.248 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/assets.orbax-checkpoint-tmp-97 (2341257:atomicity.py:144)
09:56:17.248 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/train_state.orbax-checkpoint-tmp-99 (2341257:atomicity.py:144)
09:56:17.262 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
09:56:19.490 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
09:56:19.492 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
09:56:19.513 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/params.orbax-checkpoint-tmp-98/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
09:56:23.087 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
09:56:23.087 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.2 GiB/s (total bytes: 7.0 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:56:23.093 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.8 GiB/s (total bytes: 10.5 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:56:23.107 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
09:56:23.108 [I] Finished blocking save in 5.87 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000. (2341257:async_checkpointer.py:548)
09:56:23.110 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:56:23.110 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:56:23.111 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:56:23.111 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
09:56:23.111 [I] Deleting Checkpoint[step=24000 | time=2025-11-01 01:37:21.851079+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
09:56:23.112 [I] [process=0][thread=MainThread][step=25000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
09:56:23.112 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
09:56:23.112 [I] {'step': 25000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761962177.2344425, 'wait_for_prev_duration_secs': 0.00016045570373535156, 'checkpointer_blocking_start_time': 1761962177.2348402, 'checkpointer_blocking_duration_secs': 5.87521767616272, 'get_old_steps_start_time': 1761962183.1100712, 'get_old_steps_duration_secs': 0.0018994808197021484, 'checkpoint_manager_blocking_start_time': 1761962177.2343524, 'checkpoint_manager_blocking_duration_secs': 5.87839937210083} (2341257:standard_logger.py:34)
09:56:23.113 [I] Progress on: 25.0kit/30.0kit rate:3.0s/it remaining:4:06:16 elapsed:8:27:25 postfix:- (2341257:tqdm_logging.py:145)
09:56:23.129 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/train_state.orbax-checkpoint-tmp-99/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
09:56:33.252 [I] Progress on: 25.0kit/30.0kit rate:1.4s/it remaining:1:52:28 elapsed:8:27:35 postfix:- (2341257:tqdm_logging.py:145)
09:56:34.520 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 414.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: 17 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:56:37.113 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 540.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: 19 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
09:56:37.113 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
09:56:37.115 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/assets.orbax-checkpoint-tmp-97 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/assets (2341257:atomicity.py:289)
09:56:37.120 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
09:56:37.224 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/train_state.orbax-checkpoint-tmp-99 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/train_state (2341257:atomicity.py:289)
09:56:37.228 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
09:56:37.246 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/params.orbax-checkpoint-tmp-98 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96/params (2341257:atomicity.py:289)
09:56:37.248 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000.orbax-checkpoint-tmp-96 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000 (2341257:atomicity.py:289)
09:56:37.252 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000`. (2341257:atomicity.py:573)
09:56:37.253 [I] Finished asynchronous save (blocking + background) in 20.02 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/25000 (2341257:async_checkpointer.py:412)
09:56:37.253 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
09:56:37.253 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
09:56:37.253 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
09:56:37.676 [I] Deleted step 24000.                                                              (2341257:deleter.py:114)
09:56:37.676 [I] [process=0][thread=save_finalize][step=25000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
09:56:37.676 [I] [process=0][thread=save_finalize][step=25000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
09:56:43.438 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:34:45 elapsed:8:27:45 postfix:- (2341257:tqdm_logging.py:145)
09:56:53.637 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:33:56 elapsed:8:27:55 postfix:- (2341257:tqdm_logging.py:145)
09:57:03.833 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:33:44 elapsed:8:28:06 postfix:- (2341257:tqdm_logging.py:145)
09:57:14.029 [I] Progress on: 25.0kit/30.0kit rate:1.1s/it remaining:1:33:32 elapsed:8:28:16 postfix:- (2341257:tqdm_logging.py:145)
09:57:24.235 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:33:25 elapsed:8:28:26 postfix:- (2341257:tqdm_logging.py:145)
09:57:34.432 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:33:14 elapsed:8:28:36 postfix:- (2341257:tqdm_logging.py:145)
09:57:44.633 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:33:07 elapsed:8:28:46 postfix:- (2341257:tqdm_logging.py:145)
09:57:54.837 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:32:54 elapsed:8:28:57 postfix:- (2341257:tqdm_logging.py:145)
09:58:05.034 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:32:42 elapsed:8:29:07 postfix:- (2341257:tqdm_logging.py:145)
09:58:15.229 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:32:31 elapsed:8:29:17 postfix:- (2341257:tqdm_logging.py:145)
Step 25100: grad_norm=0.0665, loss=0.0018, param_norm=1380.7782
09:58:25.468 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:32:18 elapsed:8:29:27 postfix:- (2341257:tqdm_logging.py:145)
09:58:35.667 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:32:12 elapsed:8:29:37 postfix:- (2341257:tqdm_logging.py:145)
09:58:45.863 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:32:00 elapsed:8:29:48 postfix:- (2341257:tqdm_logging.py:145)
09:58:56.074 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:32:07 elapsed:8:29:58 postfix:- (2341257:tqdm_logging.py:145)
09:59:06.269 [I] Progress on: 25.1kit/30.0kit rate:1.1s/it remaining:1:31:41 elapsed:8:30:08 postfix:- (2341257:tqdm_logging.py:145)
09:59:16.466 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:31:30 elapsed:8:30:18 postfix:- (2341257:tqdm_logging.py:145)
09:59:26.664 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:31:21 elapsed:8:30:28 postfix:- (2341257:tqdm_logging.py:145)
09:59:36.869 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:31:13 elapsed:8:30:39 postfix:- (2341257:tqdm_logging.py:145)
09:59:47.066 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:31:01 elapsed:8:30:49 postfix:- (2341257:tqdm_logging.py:145)
09:59:57.263 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:30:51 elapsed:8:30:59 postfix:- (2341257:tqdm_logging.py:145)
10:00:07.471 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:30:41 elapsed:8:31:09 postfix:- (2341257:tqdm_logging.py:145)
Step 25200: grad_norm=0.0677, loss=0.0017, param_norm=1380.7786
10:00:17.709 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:30:25 elapsed:8:31:20 postfix:- (2341257:tqdm_logging.py:145)
10:00:27.907 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:30:19 elapsed:8:31:30 postfix:- (2341257:tqdm_logging.py:145)
10:00:38.102 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:30:09 elapsed:8:31:40 postfix:- (2341257:tqdm_logging.py:145)
10:00:48.300 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:30:01 elapsed:8:31:50 postfix:- (2341257:tqdm_logging.py:145)
10:00:58.497 [I] Progress on: 25.2kit/30.0kit rate:1.1s/it remaining:1:29:49 elapsed:8:32:00 postfix:- (2341257:tqdm_logging.py:145)
10:01:08.695 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:29:40 elapsed:8:32:11 postfix:- (2341257:tqdm_logging.py:145)
10:01:19.092 [I] Progress on: 25.3kit/30.0kit rate:1.2s/it remaining:1:31:34 elapsed:8:32:21 postfix:- (2341257:tqdm_logging.py:145)
10:01:29.319 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:29:49 elapsed:8:32:31 postfix:- (2341257:tqdm_logging.py:145)
10:01:39.488 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:28:45 elapsed:8:32:41 postfix:- (2341257:tqdm_logging.py:145)
10:01:49.834 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:29:16 elapsed:8:32:52 postfix:- (2341257:tqdm_logging.py:145)
10:02:00.000 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:28:22 elapsed:8:33:02 postfix:- (2341257:tqdm_logging.py:145)
Step 25300: grad_norm=0.0662, loss=0.0018, param_norm=1380.7791
10:02:10.246 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:28:49 elapsed:8:33:12 postfix:- (2341257:tqdm_logging.py:145)
10:02:20.413 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:28:03 elapsed:8:33:22 postfix:- (2341257:tqdm_logging.py:145)
10:02:30.648 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:28:42 elapsed:8:33:32 postfix:- (2341257:tqdm_logging.py:145)
10:02:40.816 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:27:44 elapsed:8:33:43 postfix:- (2341257:tqdm_logging.py:145)
10:02:51.041 [I] Progress on: 25.3kit/30.0kit rate:1.1s/it remaining:1:28:20 elapsed:8:33:53 postfix:- (2341257:tqdm_logging.py:145)
10:03:01.222 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:27:26 elapsed:8:34:03 postfix:- (2341257:tqdm_logging.py:145)
10:03:11.447 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:28:01 elapsed:8:34:13 postfix:- (2341257:tqdm_logging.py:145)
10:03:21.621 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:27:07 elapsed:8:34:23 postfix:- (2341257:tqdm_logging.py:145)
10:03:31.847 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:27:39 elapsed:8:34:34 postfix:- (2341257:tqdm_logging.py:145)
10:03:42.019 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:26:45 elapsed:8:34:44 postfix:- (2341257:tqdm_logging.py:145)
10:03:52.243 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:27:19 elapsed:8:34:54 postfix:- (2341257:tqdm_logging.py:145)
Step 25400: grad_norm=0.0647, loss=0.0017, param_norm=1380.7793
10:04:02.435 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:26:05 elapsed:8:35:04 postfix:- (2341257:tqdm_logging.py:145)
10:04:12.660 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:26:57 elapsed:8:35:14 postfix:- (2341257:tqdm_logging.py:145)
10:04:22.828 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:26:02 elapsed:8:35:25 postfix:- (2341257:tqdm_logging.py:145)
10:04:33.054 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:26:38 elapsed:8:35:35 postfix:- (2341257:tqdm_logging.py:145)
10:04:43.222 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:25:42 elapsed:8:35:45 postfix:- (2341257:tqdm_logging.py:145)
10:04:53.448 [I] Progress on: 25.4kit/30.0kit rate:1.1s/it remaining:1:26:19 elapsed:8:35:55 postfix:- (2341257:tqdm_logging.py:145)
10:05:03.616 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:25:22 elapsed:8:36:05 postfix:- (2341257:tqdm_logging.py:145)
10:05:13.842 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:25:57 elapsed:8:36:16 postfix:- (2341257:tqdm_logging.py:145)
10:05:24.018 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:25:02 elapsed:8:36:26 postfix:- (2341257:tqdm_logging.py:145)
10:05:34.244 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:25:37 elapsed:8:36:36 postfix:- (2341257:tqdm_logging.py:145)
10:05:44.413 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:24:41 elapsed:8:36:46 postfix:- (2341257:tqdm_logging.py:145)
Step 25500: grad_norm=0.0637, loss=0.0017, param_norm=1380.7797
10:05:54.663 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:24:50 elapsed:8:36:56 postfix:- (2341257:tqdm_logging.py:145)
10:06:04.831 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:24:19 elapsed:8:37:07 postfix:- (2341257:tqdm_logging.py:145)
10:06:15.056 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:24:55 elapsed:8:37:17 postfix:- (2341257:tqdm_logging.py:145)
10:06:25.225 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:24:01 elapsed:8:37:27 postfix:- (2341257:tqdm_logging.py:145)
10:06:35.450 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:24:34 elapsed:8:37:37 postfix:- (2341257:tqdm_logging.py:145)
10:06:45.619 [I] Progress on: 25.5kit/30.0kit rate:1.1s/it remaining:1:23:39 elapsed:8:37:47 postfix:- (2341257:tqdm_logging.py:145)
10:06:55.844 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:24:15 elapsed:8:37:58 postfix:- (2341257:tqdm_logging.py:145)
10:07:06.011 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:23:19 elapsed:8:38:08 postfix:- (2341257:tqdm_logging.py:145)
10:07:16.241 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:23:54 elapsed:8:38:18 postfix:- (2341257:tqdm_logging.py:145)
10:07:26.421 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:23:06 elapsed:8:38:28 postfix:- (2341257:tqdm_logging.py:145)
10:07:36.648 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:23:34 elapsed:8:38:38 postfix:- (2341257:tqdm_logging.py:145)
Step 25600: grad_norm=0.0595, loss=0.0015, param_norm=1380.7800
10:07:46.839 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:22:05 elapsed:8:38:49 postfix:- (2341257:tqdm_logging.py:145)
10:07:57.066 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:23:13 elapsed:8:38:59 postfix:- (2341257:tqdm_logging.py:145)
10:08:07.233 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:22:18 elapsed:8:39:09 postfix:- (2341257:tqdm_logging.py:145)
10:08:17.458 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:22:52 elapsed:8:39:19 postfix:- (2341257:tqdm_logging.py:145)
10:08:27.625 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:21:57 elapsed:8:39:29 postfix:- (2341257:tqdm_logging.py:145)
10:08:37.851 [I] Progress on: 25.6kit/30.0kit rate:1.1s/it remaining:1:22:32 elapsed:8:39:40 postfix:- (2341257:tqdm_logging.py:145)
10:08:48.018 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:21:37 elapsed:8:39:50 postfix:- (2341257:tqdm_logging.py:145)
10:08:58.245 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:22:12 elapsed:8:40:00 postfix:- (2341257:tqdm_logging.py:145)
10:09:08.411 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:21:17 elapsed:8:40:10 postfix:- (2341257:tqdm_logging.py:145)
10:09:18.824 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:22:16 elapsed:8:40:21 postfix:- (2341257:tqdm_logging.py:145)
10:09:29.051 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:21:45 elapsed:8:40:31 postfix:- (2341257:tqdm_logging.py:145)
Step 25700: grad_norm=0.0693, loss=0.0019, param_norm=1380.7803
10:09:39.284 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:20:48 elapsed:8:40:41 postfix:- (2341257:tqdm_logging.py:145)
10:09:49.511 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:21:21 elapsed:8:40:51 postfix:- (2341257:tqdm_logging.py:145)
10:09:59.678 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:20:27 elapsed:8:41:01 postfix:- (2341257:tqdm_logging.py:145)
10:10:09.916 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:21:09 elapsed:8:41:12 postfix:- (2341257:tqdm_logging.py:145)
10:10:20.082 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:20:06 elapsed:8:41:22 postfix:- (2341257:tqdm_logging.py:145)
10:10:30.316 [I] Progress on: 25.7kit/30.0kit rate:1.1s/it remaining:1:20:43 elapsed:8:41:32 postfix:- (2341257:tqdm_logging.py:145)
10:10:40.484 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:19:46 elapsed:8:41:42 postfix:- (2341257:tqdm_logging.py:145)
10:10:50.709 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:20:19 elapsed:8:41:53 postfix:- (2341257:tqdm_logging.py:145)
10:11:00.880 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:19:27 elapsed:8:42:03 postfix:- (2341257:tqdm_logging.py:145)
10:11:11.110 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:20:04 elapsed:8:42:13 postfix:- (2341257:tqdm_logging.py:145)
10:11:21.280 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:19:11 elapsed:8:42:23 postfix:- (2341257:tqdm_logging.py:145)
Step 25800: grad_norm=0.0664, loss=0.0017, param_norm=1380.7806
10:11:31.665 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:18:57 elapsed:8:42:33 postfix:- (2341257:tqdm_logging.py:145)
10:11:41.732 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:18:46 elapsed:8:42:44 postfix:- (2341257:tqdm_logging.py:145)
10:11:51.956 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:19:18 elapsed:8:42:54 postfix:- (2341257:tqdm_logging.py:145)
10:12:02.125 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:18:26 elapsed:8:43:04 postfix:- (2341257:tqdm_logging.py:145)
10:12:12.351 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:18:57 elapsed:8:43:14 postfix:- (2341257:tqdm_logging.py:145)
10:12:22.519 [I] Progress on: 25.8kit/30.0kit rate:1.1s/it remaining:1:18:05 elapsed:8:43:24 postfix:- (2341257:tqdm_logging.py:145)
10:12:32.744 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:18:36 elapsed:8:43:35 postfix:- (2341257:tqdm_logging.py:145)
10:12:42.915 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:17:47 elapsed:8:43:45 postfix:- (2341257:tqdm_logging.py:145)
10:12:53.139 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:18:17 elapsed:8:43:55 postfix:- (2341257:tqdm_logging.py:145)
10:13:03.312 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:17:25 elapsed:8:44:05 postfix:- (2341257:tqdm_logging.py:145)
10:13:13.542 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:17:59 elapsed:8:44:15 postfix:- (2341257:tqdm_logging.py:145)
10:13:23.718 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:17:05 elapsed:8:44:26 postfix:- (2341257:tqdm_logging.py:145)
Step 25900: grad_norm=0.0667, loss=0.0018, param_norm=1380.7809
10:13:34.000 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:17:35 elapsed:8:44:36 postfix:- (2341257:tqdm_logging.py:145)
10:13:44.170 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:16:43 elapsed:8:44:46 postfix:- (2341257:tqdm_logging.py:145)
10:13:54.395 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:17:15 elapsed:8:44:56 postfix:- (2341257:tqdm_logging.py:145)
10:14:04.563 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:16:23 elapsed:8:45:06 postfix:- (2341257:tqdm_logging.py:145)
10:14:14.789 [I] Progress on: 25.9kit/30.0kit rate:1.1s/it remaining:1:16:54 elapsed:8:45:17 postfix:- (2341257:tqdm_logging.py:145)
10:14:24.969 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:16:12 elapsed:8:45:27 postfix:- (2341257:tqdm_logging.py:145)
10:14:35.201 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:16:42 elapsed:8:45:37 postfix:- (2341257:tqdm_logging.py:145)
10:14:45.360 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:15:41 elapsed:8:45:47 postfix:- (2341257:tqdm_logging.py:145)
10:14:55.587 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:16:15 elapsed:8:45:57 postfix:- (2341257:tqdm_logging.py:145)
10:15:05.752 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:15:22 elapsed:8:46:08 postfix:- (2341257:tqdm_logging.py:145)
10:15:15.979 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:15:53 elapsed:8:46:18 postfix:- (2341257:tqdm_logging.py:145)
Step 26000: grad_norm=0.0649, loss=0.0017, param_norm=1380.7812
10:15:18.443 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
10:15:18.443 [I] [process=0] Saving checkpoint at step 26000                                      (2341257:checkpoint_manager.py:1408)
10:15:18.444 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000. (2341257:async_checkpointer.py:439)
10:15:18.451 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100 (2341257:atomicity.py:144)
10:15:18.458 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/params.orbax-checkpoint-tmp-102 (2341257:atomicity.py:144)
10:15:18.458 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/train_state.orbax-checkpoint-tmp-103 (2341257:atomicity.py:144)
10:15:18.459 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/assets.orbax-checkpoint-tmp-101 (2341257:atomicity.py:144)
10:15:18.470 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
10:15:20.751 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
10:15:20.753 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
10:15:21.132 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/params.orbax-checkpoint-tmp-102/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
10:15:24.261 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
10:15:24.262 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.2 GiB/s (total bytes: 7.0 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:15:24.275 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.8 GiB/s (total bytes: 10.5 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:15:24.282 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
10:15:24.282 [I] Finished blocking save in 5.84 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000. (2341257:async_checkpointer.py:548)
10:15:24.283 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:15:24.283 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:15:24.284 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:15:24.284 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:15:24.284 [I] Preserving Checkpoint[step=25000 | time=2025-11-01 01:56:23.110061+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:15:24.285 [I] [process=0][thread=MainThread][step=26000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
10:15:24.285 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
10:15:24.285 [I] {'step': 26000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761963318.4433181, 'wait_for_prev_duration_secs': 0.00018739700317382812, 'checkpointer_blocking_start_time': 1761963318.4438171, 'checkpointer_blocking_duration_secs': 5.839893579483032, 'get_old_steps_start_time': 1761963324.283723, 'get_old_steps_duration_secs': 0.0013227462768554688, 'checkpoint_manager_blocking_start_time': 1761963318.4432254, 'checkpoint_manager_blocking_duration_secs': 5.842625141143799} (2341257:standard_logger.py:34)
10:15:24.327 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/train_state.orbax-checkpoint-tmp-103/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
10:15:26.447 [I] Progress on: 26.0kit/30.0kit rate:2.0s/it remaining:2:13:40 elapsed:8:46:28 postfix:- (2341257:tqdm_logging.py:145)
10:15:37.251 [I] Progress on: 26.0kit/30.0kit rate:1.2s/it remaining:1:20:04 elapsed:8:46:39 postfix:- (2341257:tqdm_logging.py:145)
10:15:38.284 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 361.1 MiB/s (total bytes: 7.0 GiB) (time elapsed: 19 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:15:42.352 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 449.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: 23 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:15:42.352 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
10:15:42.353 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/assets.orbax-checkpoint-tmp-101 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/assets (2341257:atomicity.py:289)
10:15:42.359 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
10:15:42.466 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/train_state.orbax-checkpoint-tmp-103 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/train_state (2341257:atomicity.py:289)
10:15:42.470 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
10:15:42.497 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/params.orbax-checkpoint-tmp-102 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100/params (2341257:atomicity.py:289)
10:15:42.499 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000.orbax-checkpoint-tmp-100 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000 (2341257:atomicity.py:289)
10:15:42.503 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000`. (2341257:atomicity.py:573)
10:15:42.503 [I] Finished asynchronous save (blocking + background) in 24.06 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/26000 (2341257:async_checkpointer.py:412)
10:15:42.504 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
10:15:42.504 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
10:15:42.504 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
10:15:42.504 [I] [process=0][thread=save_finalize][step=26000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
10:15:42.504 [I] [process=0][thread=save_finalize][step=26000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
10:15:47.475 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:15:39 elapsed:8:46:49 postfix:- (2341257:tqdm_logging.py:145)
10:15:57.651 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:14:40 elapsed:8:46:59 postfix:- (2341257:tqdm_logging.py:145)
10:16:07.876 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:15:07 elapsed:8:47:10 postfix:- (2341257:tqdm_logging.py:145)
10:16:18.052 [I] Progress on: 26.0kit/30.0kit rate:1.1s/it remaining:1:14:25 elapsed:8:47:20 postfix:- (2341257:tqdm_logging.py:145)
10:16:28.277 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:14:46 elapsed:8:47:30 postfix:- (2341257:tqdm_logging.py:145)
10:16:38.446 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:13:56 elapsed:8:47:40 postfix:- (2341257:tqdm_logging.py:145)
10:16:48.684 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:14:38 elapsed:8:47:51 postfix:- (2341257:tqdm_logging.py:145)
10:16:58.851 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:13:36 elapsed:8:48:01 postfix:- (2341257:tqdm_logging.py:145)
10:17:09.078 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:14:07 elapsed:8:48:11 postfix:- (2341257:tqdm_logging.py:145)
Step 26100: grad_norm=0.0601, loss=0.0016, param_norm=1380.7815
10:17:19.652 [I] Progress on: 26.1kit/30.0kit rate:1.2s/it remaining:1:20:10 elapsed:8:48:21 postfix:- (2341257:tqdm_logging.py:145)
10:17:29.708 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:13:33 elapsed:8:48:32 postfix:- (2341257:tqdm_logging.py:145)
10:17:39.905 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:13:16 elapsed:8:48:42 postfix:- (2341257:tqdm_logging.py:145)
10:17:50.102 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:13:05 elapsed:8:48:52 postfix:- (2341257:tqdm_logging.py:145)
10:18:00.300 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:12:58 elapsed:8:49:02 postfix:- (2341257:tqdm_logging.py:145)
10:18:10.495 [I] Progress on: 26.1kit/30.0kit rate:1.1s/it remaining:1:12:45 elapsed:8:49:12 postfix:- (2341257:tqdm_logging.py:145)
10:18:20.691 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:12:34 elapsed:8:49:23 postfix:- (2341257:tqdm_logging.py:145)
10:18:30.901 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:12:27 elapsed:8:49:33 postfix:- (2341257:tqdm_logging.py:145)
10:18:41.099 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:12:15 elapsed:8:49:43 postfix:- (2341257:tqdm_logging.py:145)
10:18:51.296 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:12:04 elapsed:8:49:53 postfix:- (2341257:tqdm_logging.py:145)
10:19:01.492 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:11:54 elapsed:8:50:03 postfix:- (2341257:tqdm_logging.py:145)
Step 26200: grad_norm=0.0687, loss=0.0018, param_norm=1380.7819
10:19:11.869 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:11:45 elapsed:8:50:14 postfix:- (2341257:tqdm_logging.py:145)
10:19:21.934 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:11:31 elapsed:8:50:24 postfix:- (2341257:tqdm_logging.py:145)
10:19:32.132 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:11:24 elapsed:8:50:34 postfix:- (2341257:tqdm_logging.py:145)
10:19:42.329 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:11:14 elapsed:8:50:44 postfix:- (2341257:tqdm_logging.py:145)
10:19:52.527 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:11:05 elapsed:8:50:54 postfix:- (2341257:tqdm_logging.py:145)
10:20:02.727 [I] Progress on: 26.2kit/30.0kit rate:1.1s/it remaining:1:10:56 elapsed:8:51:05 postfix:- (2341257:tqdm_logging.py:145)
10:20:12.925 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:10:41 elapsed:8:51:15 postfix:- (2341257:tqdm_logging.py:145)
10:20:23.185 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:10:31 elapsed:8:51:25 postfix:- (2341257:tqdm_logging.py:145)
10:20:33.383 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:10:22 elapsed:8:51:35 postfix:- (2341257:tqdm_logging.py:145)
10:20:43.583 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:10:14 elapsed:8:51:45 postfix:- (2341257:tqdm_logging.py:145)
10:20:53.777 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:10:02 elapsed:8:51:56 postfix:- (2341257:tqdm_logging.py:145)
10:21:03.974 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:09:52 elapsed:8:52:06 postfix:- (2341257:tqdm_logging.py:145)
Step 26300: grad_norm=0.0625, loss=0.0017, param_norm=1380.7821
10:21:14.211 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:09:40 elapsed:8:52:16 postfix:- (2341257:tqdm_logging.py:145)
10:21:24.407 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:09:30 elapsed:8:52:26 postfix:- (2341257:tqdm_logging.py:145)
10:21:34.603 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:09:20 elapsed:8:52:36 postfix:- (2341257:tqdm_logging.py:145)
10:21:44.801 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:09:12 elapsed:8:52:47 postfix:- (2341257:tqdm_logging.py:145)
10:21:54.997 [I] Progress on: 26.3kit/30.0kit rate:1.1s/it remaining:1:09:01 elapsed:8:52:57 postfix:- (2341257:tqdm_logging.py:145)
10:22:05.195 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:08:51 elapsed:8:53:07 postfix:- (2341257:tqdm_logging.py:145)
10:22:15.393 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:08:39 elapsed:8:53:17 postfix:- (2341257:tqdm_logging.py:145)
10:22:25.593 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:08:34 elapsed:8:53:27 postfix:- (2341257:tqdm_logging.py:145)
10:22:35.790 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:08:19 elapsed:8:53:38 postfix:- (2341257:tqdm_logging.py:145)
10:22:45.997 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:08:15 elapsed:8:53:48 postfix:- (2341257:tqdm_logging.py:145)
10:22:56.194 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:08:00 elapsed:8:53:58 postfix:- (2341257:tqdm_logging.py:145)
Step 26400: grad_norm=0.0695, loss=0.0019, param_norm=1380.7825
10:23:06.432 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:07:48 elapsed:8:54:08 postfix:- (2341257:tqdm_logging.py:145)
10:23:16.628 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:07:39 elapsed:8:54:18 postfix:- (2341257:tqdm_logging.py:145)
10:23:26.824 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:07:28 elapsed:8:54:29 postfix:- (2341257:tqdm_logging.py:145)
10:23:37.025 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:07:22 elapsed:8:54:39 postfix:- (2341257:tqdm_logging.py:145)
10:23:47.231 [I] Progress on: 26.4kit/30.0kit rate:1.1s/it remaining:1:07:09 elapsed:8:54:49 postfix:- (2341257:tqdm_logging.py:145)
10:23:57.428 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:06:59 elapsed:8:54:59 postfix:- (2341257:tqdm_logging.py:145)
10:24:07.624 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:06:47 elapsed:8:55:09 postfix:- (2341257:tqdm_logging.py:145)
10:24:17.822 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:06:37 elapsed:8:55:20 postfix:- (2341257:tqdm_logging.py:145)
10:24:28.032 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:06:33 elapsed:8:55:30 postfix:- (2341257:tqdm_logging.py:145)
10:24:38.230 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:06:18 elapsed:8:55:40 postfix:- (2341257:tqdm_logging.py:145)
10:24:48.427 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:06:06 elapsed:8:55:50 postfix:- (2341257:tqdm_logging.py:145)
Step 26500: grad_norm=0.0599, loss=0.0016, param_norm=1380.7825
10:24:58.661 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:05:54 elapsed:8:56:00 postfix:- (2341257:tqdm_logging.py:145)
10:25:08.858 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:05:47 elapsed:8:56:11 postfix:- (2341257:tqdm_logging.py:145)
10:25:19.298 [I] Progress on: 26.5kit/30.0kit rate:1.2s/it remaining:1:07:19 elapsed:8:56:21 postfix:- (2341257:tqdm_logging.py:145)
10:25:29.465 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:05:11 elapsed:8:56:31 postfix:- (2341257:tqdm_logging.py:145)
10:25:39.693 [I] Progress on: 26.5kit/30.0kit rate:1.1s/it remaining:1:05:35 elapsed:8:56:42 postfix:- (2341257:tqdm_logging.py:145)
10:25:49.858 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:04:47 elapsed:8:56:52 postfix:- (2341257:tqdm_logging.py:145)
10:26:00.091 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:05:20 elapsed:8:57:02 postfix:- (2341257:tqdm_logging.py:145)
10:26:10.252 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:04:26 elapsed:8:57:12 postfix:- (2341257:tqdm_logging.py:145)
10:26:20.491 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:04:54 elapsed:8:57:22 postfix:- (2341257:tqdm_logging.py:145)
10:26:30.656 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:04:05 elapsed:8:57:32 postfix:- (2341257:tqdm_logging.py:145)
10:26:40.896 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:04:36 elapsed:8:57:43 postfix:- (2341257:tqdm_logging.py:145)
Step 26600: grad_norm=0.0717, loss=0.0020, param_norm=1380.7828
10:26:51.129 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:03:57 elapsed:8:57:53 postfix:- (2341257:tqdm_logging.py:145)
10:27:01.357 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:04:15 elapsed:8:58:03 postfix:- (2341257:tqdm_logging.py:145)
10:27:11.521 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:03:25 elapsed:8:58:13 postfix:- (2341257:tqdm_logging.py:145)
10:27:21.751 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:03:53 elapsed:8:58:24 postfix:- (2341257:tqdm_logging.py:145)
10:27:31.917 [I] Progress on: 26.6kit/30.0kit rate:1.1s/it remaining:1:03:06 elapsed:8:58:34 postfix:- (2341257:tqdm_logging.py:145)
10:27:42.144 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:03:31 elapsed:8:58:44 postfix:- (2341257:tqdm_logging.py:145)
10:27:52.310 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:02:44 elapsed:8:58:54 postfix:- (2341257:tqdm_logging.py:145)
10:28:02.539 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:03:12 elapsed:8:59:04 postfix:- (2341257:tqdm_logging.py:145)
10:28:12.729 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:02:31 elapsed:8:59:15 postfix:- (2341257:tqdm_logging.py:145)
10:28:22.957 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:02:52 elapsed:8:59:25 postfix:- (2341257:tqdm_logging.py:145)
10:28:33.148 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:02:11 elapsed:8:59:35 postfix:- (2341257:tqdm_logging.py:145)
Step 26700: grad_norm=0.0635, loss=0.0017, param_norm=1380.7831
10:28:43.429 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:02:29 elapsed:8:59:45 postfix:- (2341257:tqdm_logging.py:145)
10:28:53.595 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:01:44 elapsed:8:59:55 postfix:- (2341257:tqdm_logging.py:145)
10:29:03.823 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:02:11 elapsed:9:00:06 postfix:- (2341257:tqdm_logging.py:145)
10:29:13.988 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:01:24 elapsed:9:00:16 postfix:- (2341257:tqdm_logging.py:145)
10:29:24.216 [I] Progress on: 26.7kit/30.0kit rate:1.1s/it remaining:1:01:50 elapsed:9:00:26 postfix:- (2341257:tqdm_logging.py:145)
10:29:34.382 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:01:04 elapsed:9:00:36 postfix:- (2341257:tqdm_logging.py:145)
10:29:44.614 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:01:33 elapsed:9:00:46 postfix:- (2341257:tqdm_logging.py:145)
10:29:54.776 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:00:43 elapsed:9:00:57 postfix:- (2341257:tqdm_logging.py:145)
10:30:05.006 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:01:10 elapsed:9:01:07 postfix:- (2341257:tqdm_logging.py:145)
10:30:15.191 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:00:29 elapsed:9:01:17 postfix:- (2341257:tqdm_logging.py:145)
10:30:25.420 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:00:49 elapsed:9:01:27 postfix:- (2341257:tqdm_logging.py:145)
Step 26800: grad_norm=0.0660, loss=0.0018, param_norm=1380.7834
10:30:35.642 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:00:02 elapsed:9:01:37 postfix:- (2341257:tqdm_logging.py:145)
10:30:45.873 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:00:30 elapsed:9:01:48 postfix:- (2341257:tqdm_logging.py:145)
10:30:56.040 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:59:42 elapsed:9:01:58 postfix:- (2341257:tqdm_logging.py:145)
10:31:06.273 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:1:00:08 elapsed:9:02:08 postfix:- (2341257:tqdm_logging.py:145)
10:31:16.439 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:59:22 elapsed:9:02:18 postfix:- (2341257:tqdm_logging.py:145)
10:31:26.672 [I] Progress on: 26.8kit/30.0kit rate:1.1s/it remaining:59:48 elapsed:9:02:28 postfix:- (2341257:tqdm_logging.py:145)
10:31:36.841 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:59:03 elapsed:9:02:39 postfix:- (2341257:tqdm_logging.py:145)
10:31:47.073 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:59:26 elapsed:9:02:49 postfix:- (2341257:tqdm_logging.py:145)
10:31:57.243 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:58:44 elapsed:9:02:59 postfix:- (2341257:tqdm_logging.py:145)
10:32:07.470 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:59:06 elapsed:9:03:09 postfix:- (2341257:tqdm_logging.py:145)
10:32:17.649 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:58:23 elapsed:9:03:19 postfix:- (2341257:tqdm_logging.py:145)
Step 26900: grad_norm=0.0585, loss=0.0015, param_norm=1380.7839
10:32:27.935 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:58:45 elapsed:9:03:30 postfix:- (2341257:tqdm_logging.py:145)
10:32:38.110 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:58:02 elapsed:9:03:40 postfix:- (2341257:tqdm_logging.py:145)
10:32:48.337 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:58:24 elapsed:9:03:50 postfix:- (2341257:tqdm_logging.py:145)
10:32:58.515 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:57:46 elapsed:9:04:00 postfix:- (2341257:tqdm_logging.py:145)
10:33:08.743 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:58:04 elapsed:9:04:11 postfix:- (2341257:tqdm_logging.py:145)
10:33:19.124 [I] Progress on: 26.9kit/30.0kit rate:1.1s/it remaining:58:08 elapsed:9:04:21 postfix:- (2341257:tqdm_logging.py:145)
10:33:29.321 [I] Progress on: 27.0kit/30.0kit rate:1.1s/it remaining:57:29 elapsed:9:04:31 postfix:- (2341257:tqdm_logging.py:145)
10:33:39.522 [I] Progress on: 27.0kit/30.0kit rate:1.1s/it remaining:57:18 elapsed:9:04:41 postfix:- (2341257:tqdm_logging.py:145)
10:33:49.724 [I] Progress on: 27.0kit/30.0kit rate:1.1s/it remaining:57:09 elapsed:9:04:52 postfix:- (2341257:tqdm_logging.py:145)
10:33:59.922 [I] Progress on: 27.0kit/30.0kit rate:1.1s/it remaining:56:57 elapsed:9:05:02 postfix:- (2341257:tqdm_logging.py:145)
10:34:10.119 [I] Progress on: 27.0kit/30.0kit rate:1.1s/it remaining:56:47 elapsed:9:05:12 postfix:- (2341257:tqdm_logging.py:145)
Step 27000: grad_norm=0.0656, loss=0.0018, param_norm=1380.7842
10:34:19.398 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
10:34:19.398 [I] [process=0] Saving checkpoint at step 27000                                      (2341257:checkpoint_manager.py:1408)
10:34:19.399 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000. (2341257:async_checkpointer.py:439)
10:34:19.407 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104 (2341257:atomicity.py:144)
10:34:19.412 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/params.orbax-checkpoint-tmp-106 (2341257:atomicity.py:144)
10:34:19.414 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/train_state.orbax-checkpoint-tmp-107 (2341257:atomicity.py:144)
10:34:19.414 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/assets.orbax-checkpoint-tmp-105 (2341257:atomicity.py:144)
10:34:19.426 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
10:34:21.701 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
10:34:21.702 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
10:34:21.719 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/params.orbax-checkpoint-tmp-106/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
10:34:25.230 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
10:34:25.230 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.2 GiB/s (total bytes: 7.0 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:34:25.249 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.8 GiB/s (total bytes: 10.5 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:34:25.251 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
10:34:25.251 [I] Finished blocking save in 5.85 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000. (2341257:async_checkpointer.py:548)
10:34:25.252 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:34:25.252 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:34:25.252 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:34:25.252 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:34:25.252 [I] Preserving Checkpoint[step=25000 | time=2025-11-01 01:56:23.110061+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:34:25.252 [I] Deleting Checkpoint[step=26000 | time=2025-11-01 02:15:24.283713+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
10:34:25.252 [I] [process=0][thread=MainThread][step=27000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
10:34:25.253 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
10:34:25.253 [I] {'step': 27000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761964459.398644, 'wait_for_prev_duration_secs': 0.00015497207641601562, 'checkpointer_blocking_start_time': 1761964459.3990226, 'checkpointer_blocking_duration_secs': 5.853122234344482, 'get_old_steps_start_time': 1761964465.2521577, 'get_old_steps_duration_secs': 0.0007293224334716797, 'checkpoint_manager_blocking_start_time': 1761964459.3985515, 'checkpoint_manager_blocking_duration_secs': 5.854903936386108} (2341257:standard_logger.py:34)
10:34:25.253 [I] Progress on: 27.0kit/30.0kit rate:3.0s/it remaining:2:27:29 elapsed:9:05:27 postfix:- (2341257:tqdm_logging.py:145)
10:34:25.280 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/train_state.orbax-checkpoint-tmp-107/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
10:34:38.268 [I] Progress on: 27.0kit/30.0kit rate:2.5s/it remaining:2:02:34 elapsed:9:05:40 postfix:- (2341257:tqdm_logging.py:145)
10:34:46.877 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 260.8 MiB/s (total bytes: 7.0 GiB) (time elapsed: 27 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:34:46.877 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 390.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: 27 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:34:46.878 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
10:34:46.879 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/assets.orbax-checkpoint-tmp-105 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/assets (2341257:atomicity.py:289)
10:34:46.883 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
10:34:46.902 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/train_state.orbax-checkpoint-tmp-107 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/train_state (2341257:atomicity.py:289)
10:34:46.906 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
10:34:46.922 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/params.orbax-checkpoint-tmp-106 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104/params (2341257:atomicity.py:289)
10:34:46.924 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000.orbax-checkpoint-tmp-104 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000 (2341257:atomicity.py:289)
10:34:46.928 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000`. (2341257:atomicity.py:573)
10:34:46.928 [I] Finished asynchronous save (blocking + background) in 27.53 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/27000 (2341257:async_checkpointer.py:412)
10:34:46.928 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
10:34:46.928 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
10:34:46.928 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
10:34:47.393 [I] Deleted step 26000.                                                              (2341257:deleter.py:114)
10:34:47.393 [I] [process=0][thread=save_finalize][step=27000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
10:34:47.393 [I] [process=0][thread=save_finalize][step=27000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
10:34:48.330 [I] Progress on: 27.0kit/30.0kit rate:1.2s/it remaining:58:48 elapsed:9:05:50 postfix:- (2341257:tqdm_logging.py:145)
10:34:58.526 [I] Progress on: 27.0kit/30.0kit rate:1.1s/it remaining:56:15 elapsed:9:06:00 postfix:- (2341257:tqdm_logging.py:145)
10:35:08.847 [I] Progress on: 27.0kit/30.0kit rate:1.1s/it remaining:56:24 elapsed:9:06:11 postfix:- (2341257:tqdm_logging.py:145)
10:35:19.041 [I] Progress on: 27.0kit/30.0kit rate:1.1s/it remaining:55:49 elapsed:9:06:21 postfix:- (2341257:tqdm_logging.py:145)
10:35:29.235 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:55:36 elapsed:9:06:31 postfix:- (2341257:tqdm_logging.py:145)
10:35:39.431 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:55:26 elapsed:9:06:41 postfix:- (2341257:tqdm_logging.py:145)
10:35:49.628 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:55:17 elapsed:9:06:51 postfix:- (2341257:tqdm_logging.py:145)
10:35:59.826 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:55:06 elapsed:9:07:02 postfix:- (2341257:tqdm_logging.py:145)
10:36:10.024 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:54:57 elapsed:9:07:12 postfix:- (2341257:tqdm_logging.py:145)
10:36:20.227 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:54:50 elapsed:9:07:22 postfix:- (2341257:tqdm_logging.py:145)
Step 27100: grad_norm=0.0590, loss=0.0015, param_norm=1380.7845
10:36:30.465 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:54:35 elapsed:9:07:32 postfix:- (2341257:tqdm_logging.py:145)
10:36:40.661 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:54:26 elapsed:9:07:42 postfix:- (2341257:tqdm_logging.py:145)
10:36:50.859 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:54:16 elapsed:9:07:53 postfix:- (2341257:tqdm_logging.py:145)
10:37:01.056 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:54:05 elapsed:9:08:03 postfix:- (2341257:tqdm_logging.py:145)
10:37:11.255 [I] Progress on: 27.1kit/30.0kit rate:1.1s/it remaining:53:56 elapsed:9:08:13 postfix:- (2341257:tqdm_logging.py:145)
10:37:21.454 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:53:46 elapsed:9:08:23 postfix:- (2341257:tqdm_logging.py:145)
10:37:31.651 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:53:35 elapsed:9:08:33 postfix:- (2341257:tqdm_logging.py:145)
10:37:41.860 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:53:32 elapsed:9:08:44 postfix:- (2341257:tqdm_logging.py:145)
10:37:52.056 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:53:14 elapsed:9:08:54 postfix:- (2341257:tqdm_logging.py:145)
10:38:02.264 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:53:05 elapsed:9:09:04 postfix:- (2341257:tqdm_logging.py:145)
10:38:12.461 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:52:54 elapsed:9:09:14 postfix:- (2341257:tqdm_logging.py:145)
Step 27200: grad_norm=0.0569, loss=0.0014, param_norm=1380.7845
10:38:22.701 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:52:42 elapsed:9:09:25 postfix:- (2341257:tqdm_logging.py:145)
10:38:32.897 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:52:31 elapsed:9:09:35 postfix:- (2341257:tqdm_logging.py:145)
10:38:43.095 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:52:23 elapsed:9:09:45 postfix:- (2341257:tqdm_logging.py:145)
10:38:53.713 [I] Progress on: 27.2kit/30.0kit rate:1.2s/it remaining:53:55 elapsed:9:09:56 postfix:- (2341257:tqdm_logging.py:145)
10:39:03.906 [I] Progress on: 27.2kit/30.0kit rate:1.1s/it remaining:52:06 elapsed:9:10:06 postfix:- (2341257:tqdm_logging.py:145)
10:39:14.102 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:51:52 elapsed:9:10:16 postfix:- (2341257:tqdm_logging.py:145)
10:39:24.314 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:51:45 elapsed:9:10:26 postfix:- (2341257:tqdm_logging.py:145)
10:39:34.512 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:51:33 elapsed:9:10:36 postfix:- (2341257:tqdm_logging.py:145)
10:39:44.709 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:51:22 elapsed:9:10:47 postfix:- (2341257:tqdm_logging.py:145)
10:39:54.905 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:51:12 elapsed:9:10:57 postfix:- (2341257:tqdm_logging.py:145)
10:40:05.101 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:51:02 elapsed:9:11:07 postfix:- (2341257:tqdm_logging.py:145)
Step 27300: grad_norm=0.0659, loss=0.0017, param_norm=1380.7848
10:40:15.336 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:50:48 elapsed:9:11:17 postfix:- (2341257:tqdm_logging.py:145)
10:40:25.531 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:50:41 elapsed:9:11:27 postfix:- (2341257:tqdm_logging.py:145)
10:40:35.740 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:50:35 elapsed:9:11:38 postfix:- (2341257:tqdm_logging.py:145)
10:40:45.936 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:50:21 elapsed:9:11:48 postfix:- (2341257:tqdm_logging.py:145)
10:40:56.134 [I] Progress on: 27.3kit/30.0kit rate:1.1s/it remaining:50:11 elapsed:9:11:58 postfix:- (2341257:tqdm_logging.py:145)
10:41:06.331 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:50:01 elapsed:9:12:08 postfix:- (2341257:tqdm_logging.py:145)
10:41:16.531 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:49:52 elapsed:9:12:18 postfix:- (2341257:tqdm_logging.py:145)
10:41:26.947 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:50:11 elapsed:9:12:29 postfix:- (2341257:tqdm_logging.py:145)
10:41:37.146 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:49:32 elapsed:9:12:39 postfix:- (2341257:tqdm_logging.py:145)
10:41:47.344 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:49:21 elapsed:9:12:49 postfix:- (2341257:tqdm_logging.py:145)
10:41:57.539 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:49:10 elapsed:9:12:59 postfix:- (2341257:tqdm_logging.py:145)
Step 27400: grad_norm=0.0594, loss=0.0016, param_norm=1380.7852
10:42:07.776 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:48:55 elapsed:9:13:10 postfix:- (2341257:tqdm_logging.py:145)
10:42:17.971 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:48:49 elapsed:9:13:20 postfix:- (2341257:tqdm_logging.py:145)
10:42:28.168 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:48:39 elapsed:9:13:30 postfix:- (2341257:tqdm_logging.py:145)
10:42:38.366 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:48:29 elapsed:9:13:40 postfix:- (2341257:tqdm_logging.py:145)
10:42:48.564 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:48:20 elapsed:9:13:50 postfix:- (2341257:tqdm_logging.py:145)
10:42:58.760 [I] Progress on: 27.4kit/30.0kit rate:1.1s/it remaining:48:09 elapsed:9:14:01 postfix:- (2341257:tqdm_logging.py:145)
10:43:08.957 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:47:59 elapsed:9:14:11 postfix:- (2341257:tqdm_logging.py:145)
10:43:19.155 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:47:50 elapsed:9:14:21 postfix:- (2341257:tqdm_logging.py:145)
10:43:29.350 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:47:38 elapsed:9:14:31 postfix:- (2341257:tqdm_logging.py:145)
10:43:39.559 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:47:28 elapsed:9:14:41 postfix:- (2341257:tqdm_logging.py:145)
10:43:49.757 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:47:18 elapsed:9:14:52 postfix:- (2341257:tqdm_logging.py:145)
Step 27500: grad_norm=0.0558, loss=0.0015, param_norm=1380.7852
10:43:59.992 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:47:00 elapsed:9:15:02 postfix:- (2341257:tqdm_logging.py:145)
10:44:10.193 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:46:58 elapsed:9:15:12 postfix:- (2341257:tqdm_logging.py:145)
10:44:20.393 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:46:47 elapsed:9:15:22 postfix:- (2341257:tqdm_logging.py:145)
10:44:30.588 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:46:36 elapsed:9:15:32 postfix:- (2341257:tqdm_logging.py:145)
10:44:40.786 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:46:27 elapsed:9:15:43 postfix:- (2341257:tqdm_logging.py:145)
10:44:50.992 [I] Progress on: 27.5kit/30.0kit rate:1.1s/it remaining:46:19 elapsed:9:15:53 postfix:- (2341257:tqdm_logging.py:145)
10:45:01.188 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:46:07 elapsed:9:16:03 postfix:- (2341257:tqdm_logging.py:145)
10:45:11.388 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:45:59 elapsed:9:16:13 postfix:- (2341257:tqdm_logging.py:145)
10:45:21.593 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:45:47 elapsed:9:16:23 postfix:- (2341257:tqdm_logging.py:145)
10:45:31.791 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:45:36 elapsed:9:16:34 postfix:- (2341257:tqdm_logging.py:145)
10:45:41.987 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:45:25 elapsed:9:16:44 postfix:- (2341257:tqdm_logging.py:145)
Step 27600: grad_norm=0.0555, loss=0.0015, param_norm=1380.7854
10:45:52.222 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:45:05 elapsed:9:16:54 postfix:- (2341257:tqdm_logging.py:145)
10:46:02.418 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:45:05 elapsed:9:17:04 postfix:- (2341257:tqdm_logging.py:145)
10:46:12.622 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:44:55 elapsed:9:17:14 postfix:- (2341257:tqdm_logging.py:145)
10:46:22.820 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:44:45 elapsed:9:17:25 postfix:- (2341257:tqdm_logging.py:145)
10:46:33.016 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:44:34 elapsed:9:17:35 postfix:- (2341257:tqdm_logging.py:145)
10:46:43.226 [I] Progress on: 27.6kit/30.0kit rate:1.1s/it remaining:44:25 elapsed:9:17:45 postfix:- (2341257:tqdm_logging.py:145)
10:46:53.422 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:44:14 elapsed:9:17:55 postfix:- (2341257:tqdm_logging.py:145)
10:47:03.620 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:44:04 elapsed:9:18:05 postfix:- (2341257:tqdm_logging.py:145)
10:47:13.821 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:43:56 elapsed:9:18:16 postfix:- (2341257:tqdm_logging.py:145)
10:47:24.018 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:43:44 elapsed:9:18:26 postfix:- (2341257:tqdm_logging.py:145)
10:47:34.228 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:43:38 elapsed:9:18:36 postfix:- (2341257:tqdm_logging.py:145)
Step 27700: grad_norm=0.0633, loss=0.0017, param_norm=1380.7858
10:47:44.463 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:43:10 elapsed:9:18:46 postfix:- (2341257:tqdm_logging.py:145)
10:47:54.661 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:43:12 elapsed:9:18:56 postfix:- (2341257:tqdm_logging.py:145)
10:48:04.859 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:43:03 elapsed:9:19:07 postfix:- (2341257:tqdm_logging.py:145)
10:48:15.057 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:42:53 elapsed:9:19:17 postfix:- (2341257:tqdm_logging.py:145)
10:48:25.254 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:42:43 elapsed:9:19:27 postfix:- (2341257:tqdm_logging.py:145)
10:48:35.452 [I] Progress on: 27.7kit/30.0kit rate:1.1s/it remaining:42:32 elapsed:9:19:37 postfix:- (2341257:tqdm_logging.py:145)
10:48:45.656 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:42:27 elapsed:9:19:47 postfix:- (2341257:tqdm_logging.py:145)
10:48:55.853 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:42:12 elapsed:9:19:58 postfix:- (2341257:tqdm_logging.py:145)
10:49:06.049 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:42:02 elapsed:9:20:08 postfix:- (2341257:tqdm_logging.py:145)
10:49:16.266 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:41:53 elapsed:9:20:18 postfix:- (2341257:tqdm_logging.py:145)
10:49:26.664 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:41:51 elapsed:9:20:28 postfix:- (2341257:tqdm_logging.py:145)
Step 27800: grad_norm=0.0587, loss=0.0016, param_norm=1380.7859
10:49:37.046 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:41:36 elapsed:9:20:39 postfix:- (2341257:tqdm_logging.py:145)
10:49:47.110 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:41:20 elapsed:9:20:49 postfix:- (2341257:tqdm_logging.py:145)
10:49:57.309 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:41:11 elapsed:9:20:59 postfix:- (2341257:tqdm_logging.py:145)
10:50:07.505 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:41:00 elapsed:9:21:09 postfix:- (2341257:tqdm_logging.py:145)
10:50:17.702 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:40:50 elapsed:9:21:20 postfix:- (2341257:tqdm_logging.py:145)
10:50:27.898 [I] Progress on: 27.8kit/30.0kit rate:1.1s/it remaining:40:40 elapsed:9:21:30 postfix:- (2341257:tqdm_logging.py:145)
10:50:38.108 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:40:34 elapsed:9:21:40 postfix:- (2341257:tqdm_logging.py:145)
10:50:48.303 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:40:20 elapsed:9:21:50 postfix:- (2341257:tqdm_logging.py:145)
10:50:58.499 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:40:09 elapsed:9:22:00 postfix:- (2341257:tqdm_logging.py:145)
10:51:08.696 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:40:00 elapsed:9:22:11 postfix:- (2341257:tqdm_logging.py:145)
10:51:18.892 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:39:49 elapsed:9:22:21 postfix:- (2341257:tqdm_logging.py:145)
10:51:29.087 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:39:39 elapsed:9:22:31 postfix:- (2341257:tqdm_logging.py:145)
Step 27900: grad_norm=0.0607, loss=0.0016, param_norm=1380.7860
10:51:39.321 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:39:27 elapsed:9:22:41 postfix:- (2341257:tqdm_logging.py:145)
10:51:49.520 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:39:19 elapsed:9:22:51 postfix:- (2341257:tqdm_logging.py:145)
10:51:59.724 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:39:08 elapsed:9:23:02 postfix:- (2341257:tqdm_logging.py:145)
10:52:09.922 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:38:58 elapsed:9:23:12 postfix:- (2341257:tqdm_logging.py:145)
10:52:20.118 [I] Progress on: 27.9kit/30.0kit rate:1.1s/it remaining:38:48 elapsed:9:23:22 postfix:- (2341257:tqdm_logging.py:145)
10:52:30.323 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:38:39 elapsed:9:23:32 postfix:- (2341257:tqdm_logging.py:145)
10:52:40.520 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:38:27 elapsed:9:23:42 postfix:- (2341257:tqdm_logging.py:145)
10:52:50.716 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:38:16 elapsed:9:23:53 postfix:- (2341257:tqdm_logging.py:145)
10:53:00.916 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:38:07 elapsed:9:24:03 postfix:- (2341257:tqdm_logging.py:145)
10:53:11.123 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:38:00 elapsed:9:24:13 postfix:- (2341257:tqdm_logging.py:145)
10:53:21.319 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:37:47 elapsed:9:24:23 postfix:- (2341257:tqdm_logging.py:145)
Step 28000: grad_norm=0.0624, loss=0.0018, param_norm=1380.7863
10:53:23.791 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
10:53:23.791 [I] [process=0] Saving checkpoint at step 28000                                      (2341257:checkpoint_manager.py:1408)
10:53:23.792 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000. (2341257:async_checkpointer.py:439)
10:53:23.801 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108 (2341257:atomicity.py:144)
10:53:23.806 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/params.orbax-checkpoint-tmp-110 (2341257:atomicity.py:144)
10:53:23.806 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/assets.orbax-checkpoint-tmp-109 (2341257:atomicity.py:144)
10:53:23.806 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/train_state.orbax-checkpoint-tmp-111 (2341257:atomicity.py:144)
10:53:23.826 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
10:53:26.079 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
10:53:26.081 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
10:53:26.125 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/params.orbax-checkpoint-tmp-110/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
10:53:29.660 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.2 GiB/s (total bytes: 7.0 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:53:29.662 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
10:53:29.668 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.8 GiB/s (total bytes: 10.5 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:53:29.681 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
10:53:29.681 [I] Finished blocking save in 5.89 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000. (2341257:async_checkpointer.py:548)
10:53:29.682 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:53:29.682 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:53:29.682 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:53:29.682 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:53:29.682 [I] Preserving Checkpoint[step=25000 | time=2025-11-01 01:56:23.110061+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
10:53:29.683 [I] Deleting Checkpoint[step=27000 | time=2025-11-01 02:34:25.252148+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
10:53:29.683 [I] [process=0][thread=MainThread][step=28000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
10:53:29.683 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
10:53:29.683 [I] {'step': 28000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761965603.7915921, 'wait_for_prev_duration_secs': 0.00019097328186035156, 'checkpointer_blocking_start_time': 1761965603.7920353, 'checkpointer_blocking_duration_secs': 5.890244007110596, 'get_old_steps_start_time': 1761965609.6822927, 'get_old_steps_duration_secs': 0.0009043216705322266, 'checkpoint_manager_blocking_start_time': 1761965603.7914948, 'checkpoint_manager_blocking_duration_secs': 5.89225172996521} (2341257:standard_logger.py:34)
10:53:29.723 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/train_state.orbax-checkpoint-tmp-111/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
10:53:31.818 [I] Progress on: 28.0kit/30.0kit rate:2.0s/it remaining:1:06:25 elapsed:9:24:34 postfix:- (2341257:tqdm_logging.py:145)
10:53:39.405 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 459.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: 15 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:53:42.568 [I] Progress on: 28.0kit/30.0kit rate:1.3s/it remaining:43:05 elapsed:9:24:44 postfix:- (2341257:tqdm_logging.py:145)
10:53:46.152 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 480.3 MiB/s (total bytes: 10.5 GiB) (time elapsed: 22 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
10:53:46.153 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
10:53:46.154 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/assets.orbax-checkpoint-tmp-109 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/assets (2341257:atomicity.py:289)
10:53:46.159 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
10:53:46.675 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/train_state.orbax-checkpoint-tmp-111 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/train_state (2341257:atomicity.py:289)
10:53:46.679 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
10:53:46.737 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/params.orbax-checkpoint-tmp-110 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108/params (2341257:atomicity.py:289)
10:53:46.738 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000.orbax-checkpoint-tmp-108 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000 (2341257:atomicity.py:289)
10:53:46.742 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000`. (2341257:atomicity.py:573)
10:53:46.742 [I] Finished asynchronous save (blocking + background) in 22.95 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/28000 (2341257:async_checkpointer.py:412)
10:53:46.742 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
10:53:46.743 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
10:53:46.743 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
10:53:47.327 [I] Deleted step 27000.                                                              (2341257:deleter.py:114)
10:53:47.327 [I] [process=0][thread=save_finalize][step=28000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
10:53:47.327 [I] [process=0][thread=save_finalize][step=28000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
10:53:52.764 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:37:34 elapsed:9:24:55 postfix:- (2341257:tqdm_logging.py:145)
10:54:02.957 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:37:14 elapsed:9:25:05 postfix:- (2341257:tqdm_logging.py:145)
10:54:13.151 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:37:03 elapsed:9:25:15 postfix:- (2341257:tqdm_logging.py:145)
10:54:23.359 [I] Progress on: 28.0kit/30.0kit rate:1.1s/it remaining:36:59 elapsed:9:25:25 postfix:- (2341257:tqdm_logging.py:145)
10:54:33.553 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:36:43 elapsed:9:25:35 postfix:- (2341257:tqdm_logging.py:145)
10:54:43.749 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:36:33 elapsed:9:25:46 postfix:- (2341257:tqdm_logging.py:145)
10:54:53.958 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:36:25 elapsed:9:25:56 postfix:- (2341257:tqdm_logging.py:145)
10:55:04.152 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:36:12 elapsed:9:26:06 postfix:- (2341257:tqdm_logging.py:145)
10:55:14.347 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:36:02 elapsed:9:26:16 postfix:- (2341257:tqdm_logging.py:145)
10:55:24.547 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:35:52 elapsed:9:26:26 postfix:- (2341257:tqdm_logging.py:145)
Step 28100: grad_norm=0.0590, loss=0.0015, param_norm=1380.7865
10:55:34.784 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:35:41 elapsed:9:26:37 postfix:- (2341257:tqdm_logging.py:145)
10:55:44.981 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:35:31 elapsed:9:26:47 postfix:- (2341257:tqdm_logging.py:145)
10:55:55.180 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:35:21 elapsed:9:26:57 postfix:- (2341257:tqdm_logging.py:145)
10:56:05.378 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:35:11 elapsed:9:27:07 postfix:- (2341257:tqdm_logging.py:145)
10:56:15.576 [I] Progress on: 28.1kit/30.0kit rate:1.1s/it remaining:35:01 elapsed:9:27:17 postfix:- (2341257:tqdm_logging.py:145)
10:56:25.772 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:34:51 elapsed:9:27:28 postfix:- (2341257:tqdm_logging.py:145)
10:56:35.969 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:34:41 elapsed:9:27:38 postfix:- (2341257:tqdm_logging.py:145)
10:56:46.164 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:34:29 elapsed:9:27:48 postfix:- (2341257:tqdm_logging.py:145)
10:56:56.501 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:34:26 elapsed:9:27:58 postfix:- (2341257:tqdm_logging.py:145)
10:57:06.697 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:34:11 elapsed:9:28:09 postfix:- (2341257:tqdm_logging.py:145)
10:57:16.903 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:34:02 elapsed:9:28:19 postfix:- (2341257:tqdm_logging.py:145)
Step 28200: grad_norm=0.0614, loss=0.0017, param_norm=1380.7869
10:57:27.346 [I] Progress on: 28.2kit/30.0kit rate:1.2s/it remaining:34:44 elapsed:9:28:29 postfix:- (2341257:tqdm_logging.py:145)
10:57:37.554 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:33:42 elapsed:9:28:39 postfix:- (2341257:tqdm_logging.py:145)
10:57:47.751 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:33:30 elapsed:9:28:50 postfix:- (2341257:tqdm_logging.py:145)
10:57:57.947 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:33:19 elapsed:9:29:00 postfix:- (2341257:tqdm_logging.py:145)
10:58:08.157 [I] Progress on: 28.2kit/30.0kit rate:1.1s/it remaining:33:11 elapsed:9:29:10 postfix:- (2341257:tqdm_logging.py:145)
10:58:18.355 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:32:59 elapsed:9:29:20 postfix:- (2341257:tqdm_logging.py:145)
10:58:28.551 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:32:48 elapsed:9:29:30 postfix:- (2341257:tqdm_logging.py:145)
10:58:38.750 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:32:39 elapsed:9:29:41 postfix:- (2341257:tqdm_logging.py:145)
10:58:48.948 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:32:29 elapsed:9:29:51 postfix:- (2341257:tqdm_logging.py:145)
10:58:59.148 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:32:18 elapsed:9:30:01 postfix:- (2341257:tqdm_logging.py:145)
10:59:09.348 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:32:08 elapsed:9:30:11 postfix:- (2341257:tqdm_logging.py:145)
Step 28300: grad_norm=0.0586, loss=0.0015, param_norm=1380.7869
10:59:19.584 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:31:56 elapsed:9:30:21 postfix:- (2341257:tqdm_logging.py:145)
10:59:29.782 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:31:47 elapsed:9:30:32 postfix:- (2341257:tqdm_logging.py:145)
10:59:39.992 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:31:40 elapsed:9:30:42 postfix:- (2341257:tqdm_logging.py:145)
10:59:50.190 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:31:28 elapsed:9:30:52 postfix:- (2341257:tqdm_logging.py:145)
11:00:00.388 [I] Progress on: 28.3kit/30.0kit rate:1.1s/it remaining:31:18 elapsed:9:31:02 postfix:- (2341257:tqdm_logging.py:145)
11:00:10.583 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:31:07 elapsed:9:31:12 postfix:- (2341257:tqdm_logging.py:145)
11:00:20.789 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:31:00 elapsed:9:31:23 postfix:- (2341257:tqdm_logging.py:145)
11:00:30.985 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:30:46 elapsed:9:31:33 postfix:- (2341257:tqdm_logging.py:145)
11:00:41.183 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:30:36 elapsed:9:31:43 postfix:- (2341257:tqdm_logging.py:145)
11:00:51.382 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:30:27 elapsed:9:31:53 postfix:- (2341257:tqdm_logging.py:145)
11:01:01.591 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:30:17 elapsed:9:32:03 postfix:- (2341257:tqdm_logging.py:145)
Step 28400: grad_norm=0.0692, loss=0.0019, param_norm=1380.7871
11:01:11.825 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:30:03 elapsed:9:32:14 postfix:- (2341257:tqdm_logging.py:145)
11:01:22.032 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:29:56 elapsed:9:32:24 postfix:- (2341257:tqdm_logging.py:145)
11:01:32.228 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:29:45 elapsed:9:32:34 postfix:- (2341257:tqdm_logging.py:145)
11:01:42.425 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:29:34 elapsed:9:32:44 postfix:- (2341257:tqdm_logging.py:145)
11:01:52.632 [I] Progress on: 28.4kit/30.0kit rate:1.1s/it remaining:29:26 elapsed:9:32:54 postfix:- (2341257:tqdm_logging.py:145)
11:02:02.829 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:29:15 elapsed:9:33:05 postfix:- (2341257:tqdm_logging.py:145)
11:02:13.025 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:29:04 elapsed:9:33:15 postfix:- (2341257:tqdm_logging.py:145)
11:02:23.222 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:28:54 elapsed:9:33:25 postfix:- (2341257:tqdm_logging.py:145)
11:02:33.418 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:28:44 elapsed:9:33:35 postfix:- (2341257:tqdm_logging.py:145)
11:02:43.617 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:28:34 elapsed:9:33:45 postfix:- (2341257:tqdm_logging.py:145)
11:02:53.815 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:28:24 elapsed:9:33:56 postfix:- (2341257:tqdm_logging.py:145)
Step 28500: grad_norm=0.0584, loss=0.0016, param_norm=1380.7875
11:03:04.058 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:28:11 elapsed:9:34:06 postfix:- (2341257:tqdm_logging.py:145)
11:03:14.255 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:28:03 elapsed:9:34:16 postfix:- (2341257:tqdm_logging.py:145)
11:03:24.453 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:27:53 elapsed:9:34:26 postfix:- (2341257:tqdm_logging.py:145)
11:03:34.651 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:27:43 elapsed:9:34:36 postfix:- (2341257:tqdm_logging.py:145)
11:03:44.845 [I] Progress on: 28.5kit/30.0kit rate:1.1s/it remaining:27:32 elapsed:9:34:47 postfix:- (2341257:tqdm_logging.py:145)
11:03:55.048 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:27:23 elapsed:9:34:57 postfix:- (2341257:tqdm_logging.py:145)
11:04:05.258 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:27:17 elapsed:9:35:07 postfix:- (2341257:tqdm_logging.py:145)
11:04:15.455 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:27:02 elapsed:9:35:17 postfix:- (2341257:tqdm_logging.py:145)
11:04:25.655 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:26:52 elapsed:9:35:27 postfix:- (2341257:tqdm_logging.py:145)
11:04:35.852 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:26:41 elapsed:9:35:38 postfix:- (2341257:tqdm_logging.py:145)
11:04:46.051 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:26:32 elapsed:9:35:48 postfix:- (2341257:tqdm_logging.py:145)
Step 28600: grad_norm=0.0604, loss=0.0017, param_norm=1380.7875
11:04:56.284 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:26:17 elapsed:9:35:58 postfix:- (2341257:tqdm_logging.py:145)
11:05:06.481 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:26:11 elapsed:9:36:08 postfix:- (2341257:tqdm_logging.py:145)
11:05:16.689 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:26:04 elapsed:9:36:19 postfix:- (2341257:tqdm_logging.py:145)
11:05:27.092 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:26:06 elapsed:9:36:29 postfix:- (2341257:tqdm_logging.py:145)
11:05:37.317 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:25:48 elapsed:9:36:39 postfix:- (2341257:tqdm_logging.py:145)
11:05:47.485 [I] Progress on: 28.6kit/30.0kit rate:1.1s/it remaining:25:23 elapsed:9:36:49 postfix:- (2341257:tqdm_logging.py:145)
11:05:57.710 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:25:26 elapsed:9:37:00 postfix:- (2341257:tqdm_logging.py:145)
11:06:07.877 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:25:03 elapsed:9:37:10 postfix:- (2341257:tqdm_logging.py:145)
11:06:18.103 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:25:06 elapsed:9:37:20 postfix:- (2341257:tqdm_logging.py:145)
11:06:28.272 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:24:43 elapsed:9:37:30 postfix:- (2341257:tqdm_logging.py:145)
11:06:38.498 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:24:46 elapsed:9:37:40 postfix:- (2341257:tqdm_logging.py:145)
Step 28700: grad_norm=0.0631, loss=0.0018, param_norm=1380.7878
11:06:48.683 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:24:11 elapsed:9:37:51 postfix:- (2341257:tqdm_logging.py:145)
11:06:58.906 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:24:25 elapsed:9:38:01 postfix:- (2341257:tqdm_logging.py:145)
11:07:09.075 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:24:02 elapsed:9:38:11 postfix:- (2341257:tqdm_logging.py:145)
11:07:19.301 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:24:05 elapsed:9:38:21 postfix:- (2341257:tqdm_logging.py:145)
11:07:29.468 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:23:42 elapsed:9:38:31 postfix:- (2341257:tqdm_logging.py:145)
11:07:39.695 [I] Progress on: 28.7kit/30.0kit rate:1.1s/it remaining:23:44 elapsed:9:38:42 postfix:- (2341257:tqdm_logging.py:145)
11:07:49.866 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:23:23 elapsed:9:38:52 postfix:- (2341257:tqdm_logging.py:145)
11:08:00.103 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:23:25 elapsed:9:39:02 postfix:- (2341257:tqdm_logging.py:145)
11:08:10.269 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:23:01 elapsed:9:39:12 postfix:- (2341257:tqdm_logging.py:145)
11:08:20.494 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:23:03 elapsed:9:39:22 postfix:- (2341257:tqdm_logging.py:145)
11:08:30.667 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:22:42 elapsed:9:39:32 postfix:- (2341257:tqdm_logging.py:145)
Step 28800: grad_norm=0.0573, loss=0.0015, param_norm=1380.7878
11:08:40.928 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:22:32 elapsed:9:39:43 postfix:- (2341257:tqdm_logging.py:145)
11:08:51.101 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:22:22 elapsed:9:39:53 postfix:- (2341257:tqdm_logging.py:145)
11:09:01.325 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:22:22 elapsed:9:40:03 postfix:- (2341257:tqdm_logging.py:145)
11:09:11.518 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:22:02 elapsed:9:40:13 postfix:- (2341257:tqdm_logging.py:145)
11:09:21.744 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:22:02 elapsed:9:40:24 postfix:- (2341257:tqdm_logging.py:145)
11:09:31.911 [I] Progress on: 28.8kit/30.0kit rate:1.1s/it remaining:21:40 elapsed:9:40:34 postfix:- (2341257:tqdm_logging.py:145)
11:09:42.138 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:21:42 elapsed:9:40:44 postfix:- (2341257:tqdm_logging.py:145)
11:09:52.318 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:21:21 elapsed:9:40:54 postfix:- (2341257:tqdm_logging.py:145)
11:10:02.542 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:21:21 elapsed:9:41:04 postfix:- (2341257:tqdm_logging.py:145)
11:10:12.710 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:20:59 elapsed:9:41:15 postfix:- (2341257:tqdm_logging.py:145)
11:10:22.935 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:21:00 elapsed:9:41:25 postfix:- (2341257:tqdm_logging.py:145)
Step 28900: grad_norm=0.0618, loss=0.0017, param_norm=1380.7881
11:10:33.290 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:20:51 elapsed:9:41:35 postfix:- (2341257:tqdm_logging.py:145)
11:10:43.349 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:20:39 elapsed:9:41:45 postfix:- (2341257:tqdm_logging.py:145)
11:10:53.516 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:20:19 elapsed:9:41:55 postfix:- (2341257:tqdm_logging.py:145)
11:11:03.741 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:20:19 elapsed:9:42:06 postfix:- (2341257:tqdm_logging.py:145)
11:11:13.909 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:19:58 elapsed:9:42:16 postfix:- (2341257:tqdm_logging.py:145)
11:11:24.134 [I] Progress on: 28.9kit/30.0kit rate:1.1s/it remaining:19:59 elapsed:9:42:26 postfix:- (2341257:tqdm_logging.py:145)
11:11:34.313 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:19:39 elapsed:9:42:36 postfix:- (2341257:tqdm_logging.py:145)
11:11:44.539 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:19:39 elapsed:9:42:46 postfix:- (2341257:tqdm_logging.py:145)
11:11:54.708 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:19:18 elapsed:9:42:57 postfix:- (2341257:tqdm_logging.py:145)
11:12:04.943 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:19:18 elapsed:9:43:07 postfix:- (2341257:tqdm_logging.py:145)
11:12:15.111 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:18:58 elapsed:9:43:17 postfix:- (2341257:tqdm_logging.py:145)
11:12:25.336 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:18:57 elapsed:9:43:27 postfix:- (2341257:tqdm_logging.py:145)
Step 29000: grad_norm=0.0632, loss=0.0018, param_norm=1380.7885
11:12:26.639 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
11:12:26.639 [I] [process=0] Saving checkpoint at step 29000                                      (2341257:checkpoint_manager.py:1408)
11:12:26.639 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000. (2341257:async_checkpointer.py:439)
11:12:26.648 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112 (2341257:atomicity.py:144)
11:12:26.654 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/params.orbax-checkpoint-tmp-114 (2341257:atomicity.py:144)
11:12:26.654 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/train_state.orbax-checkpoint-tmp-115 (2341257:atomicity.py:144)
11:12:26.654 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/assets.orbax-checkpoint-tmp-113 (2341257:atomicity.py:144)
11:12:26.673 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
11:12:28.938 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
11:12:28.940 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
11:12:28.958 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/params.orbax-checkpoint-tmp-114/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
11:12:32.524 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.2 GiB/s (total bytes: 7.0 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
11:12:32.525 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
11:12:32.527 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.8 GiB/s (total bytes: 10.5 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
11:12:32.545 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
11:12:32.546 [I] Finished blocking save in 5.91 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000. (2341257:async_checkpointer.py:548)
11:12:32.547 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:12:32.547 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:12:32.547 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:12:32.547 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:12:32.547 [I] Preserving Checkpoint[step=25000 | time=2025-11-01 01:56:23.110061+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:12:32.547 [I] Deleting Checkpoint[step=28000 | time=2025-11-01 02:53:29.682283+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
11:12:32.547 [I] [process=0][thread=MainThread][step=29000] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
11:12:32.548 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
11:12:32.548 [I] {'step': 29000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761966746.6391375, 'wait_for_prev_duration_secs': 0.00013589859008789062, 'checkpointer_blocking_start_time': 1761966746.6395025, 'checkpointer_blocking_duration_secs': 5.907815217971802, 'get_old_steps_start_time': 1761966752.5473306, 'get_old_steps_duration_secs': 0.0004980564117431641, 'checkpoint_manager_blocking_start_time': 1761966746.6390424, 'checkpoint_manager_blocking_duration_secs': 5.909703254699707} (2341257:standard_logger.py:34)
11:12:32.567 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/train_state.orbax-checkpoint-tmp-115/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
11:12:36.521 [I] Progress on: 29.0kit/30.0kit rate:1.9s/it remaining:32:11 elapsed:9:43:38 postfix:- (2341257:tqdm_logging.py:145)
11:12:47.776 [I] Progress on: 29.0kit/30.0kit rate:3.8s/it remaining:1:02:41 elapsed:9:43:50 postfix:- (2341257:tqdm_logging.py:145)
11:12:54.799 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 254.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: 28 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
11:12:54.799 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 381.3 MiB/s (total bytes: 10.5 GiB) (time elapsed: 28 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
11:12:54.799 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
11:12:54.800 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/assets.orbax-checkpoint-tmp-113 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/assets (2341257:atomicity.py:289)
11:12:54.806 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
11:12:54.823 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/train_state.orbax-checkpoint-tmp-115 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/train_state (2341257:atomicity.py:289)
11:12:54.827 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
11:12:54.843 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/params.orbax-checkpoint-tmp-114 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112/params (2341257:atomicity.py:289)
11:12:54.845 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000.orbax-checkpoint-tmp-112 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000 (2341257:atomicity.py:289)
11:12:54.849 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000`. (2341257:atomicity.py:573)
11:12:54.849 [I] Finished asynchronous save (blocking + background) in 28.21 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29000 (2341257:async_checkpointer.py:412)
11:12:54.849 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
11:12:54.849 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
11:12:54.849 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
11:12:55.308 [I] Deleted step 28000.                                                              (2341257:deleter.py:114)
11:12:55.308 [I] [process=0][thread=save_finalize][step=29000] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
11:12:55.308 [I] [process=0][thread=save_finalize][step=29000] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
11:12:57.837 [I] Progress on: 29.0kit/30.0kit rate:1.2s/it remaining:20:20 elapsed:9:44:00 postfix:- (2341257:tqdm_logging.py:145)
11:13:08.003 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:18:23 elapsed:9:44:10 postfix:- (2341257:tqdm_logging.py:145)
11:13:18.228 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:18:19 elapsed:9:44:20 postfix:- (2341257:tqdm_logging.py:145)
11:13:28.396 [I] Progress on: 29.0kit/30.0kit rate:1.1s/it remaining:17:59 elapsed:9:44:30 postfix:- (2341257:tqdm_logging.py:145)
11:13:38.822 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:18:08 elapsed:9:44:41 postfix:- (2341257:tqdm_logging.py:145)
11:13:49.017 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:17:44 elapsed:9:44:51 postfix:- (2341257:tqdm_logging.py:145)
11:13:59.215 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:17:33 elapsed:9:45:01 postfix:- (2341257:tqdm_logging.py:145)
11:14:09.412 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:17:23 elapsed:9:45:11 postfix:- (2341257:tqdm_logging.py:145)
11:14:19.609 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:17:13 elapsed:9:45:21 postfix:- (2341257:tqdm_logging.py:145)
11:14:29.817 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:17:03 elapsed:9:45:32 postfix:- (2341257:tqdm_logging.py:145)
Step 29100: grad_norm=0.0571, loss=0.0016, param_norm=1380.7885
11:14:40.055 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:16:51 elapsed:9:45:42 postfix:- (2341257:tqdm_logging.py:145)
11:14:50.251 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:16:42 elapsed:9:45:52 postfix:- (2341257:tqdm_logging.py:145)
11:15:00.447 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:16:32 elapsed:9:46:02 postfix:- (2341257:tqdm_logging.py:145)
11:15:10.642 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:16:22 elapsed:9:46:12 postfix:- (2341257:tqdm_logging.py:145)
11:15:20.845 [I] Progress on: 29.1kit/30.0kit rate:1.1s/it remaining:16:12 elapsed:9:46:23 postfix:- (2341257:tqdm_logging.py:145)
11:15:31.052 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:16:04 elapsed:9:46:33 postfix:- (2341257:tqdm_logging.py:145)
11:15:41.261 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:15:52 elapsed:9:46:43 postfix:- (2341257:tqdm_logging.py:145)
11:15:51.456 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:15:41 elapsed:9:46:53 postfix:- (2341257:tqdm_logging.py:145)
11:16:01.664 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:15:31 elapsed:9:47:03 postfix:- (2341257:tqdm_logging.py:145)
11:16:11.860 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:15:21 elapsed:9:47:14 postfix:- (2341257:tqdm_logging.py:145)
11:16:22.056 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:15:10 elapsed:9:47:24 postfix:- (2341257:tqdm_logging.py:145)
Step 29200: grad_norm=0.0605, loss=0.0017, param_norm=1380.7885
11:16:32.300 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:14:59 elapsed:9:47:34 postfix:- (2341257:tqdm_logging.py:145)
11:16:42.497 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:14:50 elapsed:9:47:44 postfix:- (2341257:tqdm_logging.py:145)
11:16:52.692 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:14:40 elapsed:9:47:55 postfix:- (2341257:tqdm_logging.py:145)
11:17:02.902 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:14:31 elapsed:9:48:05 postfix:- (2341257:tqdm_logging.py:145)
11:17:13.100 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:14:19 elapsed:9:48:15 postfix:- (2341257:tqdm_logging.py:145)
11:17:23.296 [I] Progress on: 29.2kit/30.0kit rate:1.1s/it remaining:14:09 elapsed:9:48:25 postfix:- (2341257:tqdm_logging.py:145)
11:17:33.491 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:13:59 elapsed:9:48:35 postfix:- (2341257:tqdm_logging.py:145)
11:17:43.698 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:13:50 elapsed:9:48:46 postfix:- (2341257:tqdm_logging.py:145)
11:17:53.894 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:13:39 elapsed:9:48:56 postfix:- (2341257:tqdm_logging.py:145)
11:18:04.088 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:13:28 elapsed:9:49:06 postfix:- (2341257:tqdm_logging.py:145)
11:18:14.402 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:13:26 elapsed:9:49:16 postfix:- (2341257:tqdm_logging.py:145)
Step 29300: grad_norm=0.0574, loss=0.0015, param_norm=1380.7887
11:18:24.639 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:13:06 elapsed:9:49:26 postfix:- (2341257:tqdm_logging.py:145)
11:18:34.844 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:12:58 elapsed:9:49:37 postfix:- (2341257:tqdm_logging.py:145)
11:18:45.046 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:12:48 elapsed:9:49:47 postfix:- (2341257:tqdm_logging.py:145)
11:18:55.245 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:12:38 elapsed:9:49:57 postfix:- (2341257:tqdm_logging.py:145)
11:19:05.440 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:12:27 elapsed:9:50:07 postfix:- (2341257:tqdm_logging.py:145)
11:19:15.650 [I] Progress on: 29.3kit/30.0kit rate:1.1s/it remaining:12:18 elapsed:9:50:17 postfix:- (2341257:tqdm_logging.py:145)
11:19:25.846 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:12:07 elapsed:9:50:28 postfix:- (2341257:tqdm_logging.py:145)
11:19:36.042 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:11:57 elapsed:9:50:38 postfix:- (2341257:tqdm_logging.py:145)
11:19:46.253 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:11:49 elapsed:9:50:48 postfix:- (2341257:tqdm_logging.py:145)
11:19:56.452 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:11:37 elapsed:9:50:58 postfix:- (2341257:tqdm_logging.py:145)
11:20:06.645 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:11:26 elapsed:9:51:08 postfix:- (2341257:tqdm_logging.py:145)
Step 29400: grad_norm=0.0573, loss=0.0016, param_norm=1380.7891
11:20:16.882 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:11:14 elapsed:9:51:19 postfix:- (2341257:tqdm_logging.py:145)
11:20:27.079 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:11:06 elapsed:9:51:29 postfix:- (2341257:tqdm_logging.py:145)
11:20:37.276 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:10:55 elapsed:9:51:39 postfix:- (2341257:tqdm_logging.py:145)
11:20:47.486 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:10:47 elapsed:9:51:49 postfix:- (2341257:tqdm_logging.py:145)
11:20:57.697 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:10:35 elapsed:9:52:00 postfix:- (2341257:tqdm_logging.py:145)
11:21:07.895 [I] Progress on: 29.4kit/30.0kit rate:1.1s/it remaining:10:25 elapsed:9:52:10 postfix:- (2341257:tqdm_logging.py:145)
11:21:18.090 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:10:15 elapsed:9:52:20 postfix:- (2341257:tqdm_logging.py:145)
11:21:28.287 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:10:05 elapsed:9:52:30 postfix:- (2341257:tqdm_logging.py:145)
11:21:38.687 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:09:58 elapsed:9:52:41 postfix:- (2341257:tqdm_logging.py:145)
11:21:48.885 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:09:44 elapsed:9:52:51 postfix:- (2341257:tqdm_logging.py:145)
11:21:59.082 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:09:34 elapsed:9:53:01 postfix:- (2341257:tqdm_logging.py:145)
Step 29500: grad_norm=0.0570, loss=0.0015, param_norm=1380.7891
11:22:09.315 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:09:21 elapsed:9:53:11 postfix:- (2341257:tqdm_logging.py:145)
11:22:19.511 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:09:13 elapsed:9:53:21 postfix:- (2341257:tqdm_logging.py:145)
11:22:29.707 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:09:03 elapsed:9:53:32 postfix:- (2341257:tqdm_logging.py:145)
11:22:39.916 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:08:53 elapsed:9:53:42 postfix:- (2341257:tqdm_logging.py:145)
11:22:50.113 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:08:43 elapsed:9:53:52 postfix:- (2341257:tqdm_logging.py:145)
11:23:00.311 [I] Progress on: 29.5kit/30.0kit rate:1.1s/it remaining:08:33 elapsed:9:54:02 postfix:- (2341257:tqdm_logging.py:145)
11:23:10.507 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:08:23 elapsed:9:54:12 postfix:- (2341257:tqdm_logging.py:145)
11:23:20.715 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:08:12 elapsed:9:54:23 postfix:- (2341257:tqdm_logging.py:145)
11:23:30.911 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:08:02 elapsed:9:54:33 postfix:- (2341257:tqdm_logging.py:145)
11:23:41.109 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:07:52 elapsed:9:54:43 postfix:- (2341257:tqdm_logging.py:145)
11:23:51.309 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:07:42 elapsed:9:54:53 postfix:- (2341257:tqdm_logging.py:145)
Step 29600: grad_norm=0.0533, loss=0.0014, param_norm=1380.7893
11:24:01.699 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:07:34 elapsed:9:55:04 postfix:- (2341257:tqdm_logging.py:145)
11:24:11.760 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:07:21 elapsed:9:55:14 postfix:- (2341257:tqdm_logging.py:145)
11:24:21.970 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:07:12 elapsed:9:55:24 postfix:- (2341257:tqdm_logging.py:145)
11:24:32.164 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:07:01 elapsed:9:55:34 postfix:- (2341257:tqdm_logging.py:145)
11:24:42.360 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:06:51 elapsed:9:55:44 postfix:- (2341257:tqdm_logging.py:145)
11:24:52.556 [I] Progress on: 29.6kit/30.0kit rate:1.1s/it remaining:06:41 elapsed:9:55:54 postfix:- (2341257:tqdm_logging.py:145)
11:25:02.764 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:06:30 elapsed:9:56:05 postfix:- (2341257:tqdm_logging.py:145)
11:25:12.960 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:06:20 elapsed:9:56:15 postfix:- (2341257:tqdm_logging.py:145)
11:25:23.158 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:06:10 elapsed:9:56:25 postfix:- (2341257:tqdm_logging.py:145)
11:25:33.356 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:06:00 elapsed:9:56:35 postfix:- (2341257:tqdm_logging.py:145)
11:25:43.553 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:05:50 elapsed:9:56:45 postfix:- (2341257:tqdm_logging.py:145)
11:25:53.766 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:05:40 elapsed:9:56:56 postfix:- (2341257:tqdm_logging.py:145)
Step 29700: grad_norm=0.0588, loss=0.0017, param_norm=1380.7897
11:26:04.001 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:05:29 elapsed:9:57:06 postfix:- (2341257:tqdm_logging.py:145)
11:26:14.200 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:05:19 elapsed:9:57:16 postfix:- (2341257:tqdm_logging.py:145)
11:26:24.398 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:05:09 elapsed:9:57:26 postfix:- (2341257:tqdm_logging.py:145)
11:26:34.595 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:04:59 elapsed:9:57:36 postfix:- (2341257:tqdm_logging.py:145)
11:26:44.791 [I] Progress on: 29.7kit/30.0kit rate:1.1s/it remaining:04:48 elapsed:9:57:47 postfix:- (2341257:tqdm_logging.py:145)
11:26:54.989 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:04:38 elapsed:9:57:57 postfix:- (2341257:tqdm_logging.py:145)
11:27:05.183 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:04:28 elapsed:9:58:07 postfix:- (2341257:tqdm_logging.py:145)
11:27:15.392 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:04:18 elapsed:9:58:17 postfix:- (2341257:tqdm_logging.py:145)
11:27:25.588 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:04:08 elapsed:9:58:27 postfix:- (2341257:tqdm_logging.py:145)
11:27:35.798 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:03:58 elapsed:9:58:38 postfix:- (2341257:tqdm_logging.py:145)
11:27:46.000 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:03:47 elapsed:9:58:48 postfix:- (2341257:tqdm_logging.py:145)
Step 29800: grad_norm=0.0556, loss=0.0016, param_norm=1380.7899
11:27:56.250 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:03:37 elapsed:9:58:58 postfix:- (2341257:tqdm_logging.py:145)
11:28:06.447 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:03:27 elapsed:9:59:08 postfix:- (2341257:tqdm_logging.py:145)
11:28:16.644 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:03:17 elapsed:9:59:18 postfix:- (2341257:tqdm_logging.py:145)
11:28:26.841 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:03:06 elapsed:9:59:29 postfix:- (2341257:tqdm_logging.py:145)
11:28:37.050 [I] Progress on: 29.8kit/30.0kit rate:1.1s/it remaining:02:56 elapsed:9:59:39 postfix:- (2341257:tqdm_logging.py:145)
11:28:47.246 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:02:46 elapsed:9:59:49 postfix:- (2341257:tqdm_logging.py:145)
11:28:57.442 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:02:36 elapsed:9:59:59 postfix:- (2341257:tqdm_logging.py:145)
11:29:07.641 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:02:26 elapsed:10:00:09 postfix:- (2341257:tqdm_logging.py:145)
11:29:17.842 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:02:16 elapsed:10:00:20 postfix:- (2341257:tqdm_logging.py:145)
11:29:28.047 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:02:05 elapsed:10:00:30 postfix:- (2341257:tqdm_logging.py:145)
11:29:38.445 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:01:55 elapsed:10:00:40 postfix:- (2341257:tqdm_logging.py:145)
Step 29900: grad_norm=0.0599, loss=0.0016, param_norm=1380.7899
11:29:48.733 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:01:46 elapsed:10:00:51 postfix:- (2341257:tqdm_logging.py:145)
11:29:58.900 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:01:34 elapsed:10:01:01 postfix:- (2341257:tqdm_logging.py:145)
11:30:09.126 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:01:25 elapsed:10:01:11 postfix:- (2341257:tqdm_logging.py:145)
11:30:19.294 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:01:14 elapsed:10:01:21 postfix:- (2341257:tqdm_logging.py:145)
11:30:29.520 [I] Progress on: 29.9kit/30.0kit rate:1.1s/it remaining:01:04 elapsed:10:01:31 postfix:- (2341257:tqdm_logging.py:145)
11:30:39.692 [I] Progress on: 30.0kit/30.0kit rate:1.1s/it remaining:00:54 elapsed:10:01:42 postfix:- (2341257:tqdm_logging.py:145)
11:30:49.928 [I] Progress on: 30.0kit/30.0kit rate:1.1s/it remaining:00:44 elapsed:10:01:52 postfix:- (2341257:tqdm_logging.py:145)
11:31:00.094 [I] Progress on: 30.0kit/30.0kit rate:1.1s/it remaining:00:33 elapsed:10:02:02 postfix:- (2341257:tqdm_logging.py:145)
11:31:10.328 [I] Progress on: 30.0kit/30.0kit rate:1.1s/it remaining:00:23 elapsed:10:02:12 postfix:- (2341257:tqdm_logging.py:145)
11:31:20.496 [I] Progress on: 30.0kit/30.0kit rate:1.1s/it remaining:00:13 elapsed:10:02:22 postfix:- (2341257:tqdm_logging.py:145)
11:31:30.723 [I] Progress on: 30.0kit/30.0kit rate:1.1s/it remaining:00:03 elapsed:10:02:33 postfix:- (2341257:tqdm_logging.py:145)
11:31:34.100 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2341257:checkpoint_manager.py:1987)
11:31:34.100 [I] [process=0] Saving checkpoint at step 29999                                      (2341257:checkpoint_manager.py:1408)
11:31:34.101 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999. (2341257:async_checkpointer.py:439)
11:31:34.109 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116 (2341257:atomicity.py:144)
11:31:34.115 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/assets.orbax-checkpoint-tmp-117 (2341257:atomicity.py:144)
11:31:34.115 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/params.orbax-checkpoint-tmp-118 (2341257:atomicity.py:144)
11:31:34.116 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/train_state.orbax-checkpoint-tmp-119 (2341257:atomicity.py:144)
11:31:34.127 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
11:31:36.518 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2341257:replica_slices.py:341)
11:31:36.520 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
11:31:36.540 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/params.orbax-checkpoint-tmp-118/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
11:31:39.908 [I] Array name: 'params.PaliGemma.llm.layers.mlp.gating_einsum.value', global shape: (18, 2, 2048, 16384), write shape: (18, 2, 2048, 16384), chosen chunk shape: (18, 2, 2048, 8192) (2341257:tensorstore_utils.py:408)
11:31:39.908 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.2 GiB/s (total bytes: 7.0 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
11:31:39.927 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.8 GiB/s (total bytes: 10.5 GiB) (time elapsed: 5 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
11:31:39.930 [I] [process=0][thread=async_save] Background save thread started.                   (2341257:async_checkpointer.py:77)
11:31:39.930 [I] Finished blocking save in 5.83 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999. (2341257:async_checkpointer.py:548)
11:31:39.931 [I] Preserving Checkpoint[step=5000 | time=2025-10-31 19:12:33.010919+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:31:39.931 [I] Preserving Checkpoint[step=10000 | time=2025-10-31 20:55:27.304972+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:31:39.931 [I] Preserving Checkpoint[step=15000 | time=2025-10-31 22:38:36.219381+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:31:39.931 [I] Preserving Checkpoint[step=20000 | time=2025-11-01 00:19:40.340386+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:31:39.931 [I] Preserving Checkpoint[step=25000 | time=2025-11-01 01:56:23.110061+00:00]: (Reason: on keep_period=5000). (2341257:checkpoint_manager.py:1949)
11:31:39.931 [I] Deleting Checkpoint[step=29000 | time=2025-11-01 03:12:32.547321+00:00]: (Reason: old checkpoint). (2341257:checkpoint_manager.py:1963)
11:31:39.932 [I] [process=0][thread=MainThread][step=29999] Starting CheckpointManager Save Finalize thread=save_finalize (2341257:checkpoint_manager.py:1453)
11:31:39.932 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2341257:async_checkpointer.py:258)
11:31:39.940 [I] {'step': 29999, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1761967894.1005723, 'wait_for_prev_duration_secs': 0.00021719932556152344, 'checkpointer_blocking_start_time': 1761967894.1010356, 'checkpointer_blocking_duration_secs': 5.83012318611145, 'get_old_steps_start_time': 1761967899.9311714, 'get_old_steps_duration_secs': 0.0008001327514648438, 'checkpoint_manager_blocking_start_time': 1761967894.1004803, 'checkpoint_manager_blocking_duration_secs': 5.839747190475464} (2341257:standard_logger.py:34)
11:31:39.940 [I] Progress on: 30.0kit/30.0kit rate:2.9s/it remaining:00:00 elapsed:10:02:42 postfix:- (2341257:tqdm_logging.py:145)
11:31:39.941 [I] Waiting for checkpoint manager to finish                                         (2341257:train.py:275)
11:31:39.941 [I] [process=0][thread=MainThread][step=29999][wait_until_finished] Waiting for Save Finalize thread (save_finalize) to complete. (2341257:checkpoint_manager.py:1998)
11:31:39.977 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/train_state.orbax-checkpoint-tmp-119/array_metadatas/process_0 (2341257:array_metadata_store.py:198)
11:31:48.429 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 500.1 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
11:31:56.705 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 475.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: 22 seconds) (per-host) (2341257:base_pytree_checkpoint_handler.py:114)
11:31:56.705 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2341257:async_checkpointer.py:87)
11:31:56.707 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/assets.orbax-checkpoint-tmp-117 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/assets (2341257:atomicity.py:289)
11:31:56.712 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
11:31:56.819 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/train_state.orbax-checkpoint-tmp-119 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/train_state (2341257:atomicity.py:289)
11:31:56.823 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2341257:array_metadata_store.py:362)
11:31:56.840 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/params.orbax-checkpoint-tmp-118 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116/params (2341257:atomicity.py:289)
11:31:56.841 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999.orbax-checkpoint-tmp-116 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999 (2341257:atomicity.py:289)
11:31:56.845 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999`. (2341257:atomicity.py:573)
11:31:56.845 [I] Finished asynchronous save (blocking + background) in 22.74 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/29999 (2341257:async_checkpointer.py:412)
11:31:56.845 [I] [process=0][thread=async_save] Background save thread done.                      (2341257:async_checkpointer.py:143)
11:31:56.845 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2341257:async_checkpointer.py:266)
11:31:56.846 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2341257:async_checkpointer.py:276)
11:31:57.384 [I] Deleted step 29000.                                                              (2341257:deleter.py:114)
11:31:57.384 [I] [process=0][thread=save_finalize][step=29999] CheckpointManager Save Finalize is syncing with other hosts... (2341257:checkpoint_manager.py:2095)
11:31:57.384 [I] [process=0][thread=save_finalize][step=29999] CheckpointManager Save Finalize is done on all hosts. (2341257:checkpoint_manager.py:2110)
11:31:57.385 [I] [process=0][thread=MainThread][step=29999][wait_until_finished] Done waiting for Save Finalize thread (save_finalize) running at step=29999. (2341257:checkpoint_manager.py:2010)
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mreal[0m at: [34mhttps://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/zdwzryu6[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20251101_012751-zdwzryu6/logs[0m
Sun Nov  2 02:09:33 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H800                    On  |   00000000:1B:00.0 Off |                    0 |
| N/A   23C    P0             69W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H800                    On  |   00000000:C3:00.0 Off |                    0 |
| N/A   30C    P0             69W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H800                    On  |   00000000:D1:00.0 Off |                    0 |
| N/A   62C    P0             82W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H800                    On  |   00000000:DF:00.0 Off |                    0 |
| N/A   44C    P0             73W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
0
warning: The `tool.uv.dev-dependencies` field (used in `packages/openpi-client/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
02:10:09.768 [I] Running on: dgx-30                                                               (3362456:train.py:196)
INFO:2025-11-02 02:10:10,926:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
02:10:10.926 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (3362456:xla_bridge.py:925)
INFO:2025-11-02 02:10:10,934:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
02:10:10.934 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (3362456:xla_bridge.py:925)
Traceback (most recent call last):
  File "/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/scripts/train.py", line 280, in <module>
    main(_config.cli())
  File "/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/scripts/train.py", line 208, in main
    mesh = sharding.make_mesh(config.fsdp_devices)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/src/openpi/training/sharding.py", line 19, in make_mesh
    raise ValueError(
ValueError: Number of devices 1 must be divisible by the number of FSDP devices 4.
Sun Nov  2 02:34:19 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H800                    On  |   00000000:1B:00.0 Off |                    0 |
| N/A   24C    P0             69W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H800                    On  |   00000000:43:00.0 Off |                    0 |
| N/A   27C    P0             69W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H800                    On  |   00000000:52:00.0 Off |                    0 |
| N/A   32C    P0             68W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H800                    On  |   00000000:61:00.0 Off |                    0 |
| N/A   31C    P0             69W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
0,1,2,3
warning: The `tool.uv.dev-dependencies` field (used in `packages/openpi-client/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
02:34:48.394 [I] Running on: dgx-46                                                               (105451:train.py:196)
INFO:2025-11-02 02:34:50,256:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
02:34:50.256 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (105451:xla_bridge.py:925)
INFO:2025-11-02 02:34:50,260:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
02:34:50.260 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (105451:xla_bridge.py:925)
02:34:51.545 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b599f490> (105451:base_pytree_checkpoint_handler.py:334)
02:34:51.545 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b599f490> (105451:base_pytree_checkpoint_handler.py:334)
02:34:51.545 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (105451:multihost.py:390)
02:34:51.545 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x15532bd37d90>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bd35d10>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bac36d0>}, handler_registry=None (105451:checkpoint_manager.py:620)
02:34:51.546 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x15532bd37d90>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (105451:composite_checkpoint_handler.py:234)
02:34:51.546 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bd35d10>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (105451:composite_checkpoint_handler.py:234)
02:34:51.546 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bac36d0>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (105451:composite_checkpoint_handler.py:234)
02:34:51.546 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532b970790>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (105451:composite_checkpoint_handler.py:234)
02:34:51.546 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x15532bd37d90>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x15532bd37d90>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bd35d10>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bd35d10>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bac36d0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bac36d0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532b970790>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532b970790>}). (105451:composite_checkpoint_handler.py:502)
02:34:51.547 [I] orbax-checkpoint version: 0.11.13                                                (105451:abstract_checkpointer.py:35)
02:34:51.547 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x15532bc48360> timeout: 7200 secs and primary_host=0 for async checkpoint writes (105451:async_checkpointer.py:170)
02:34:51.548 [I] Found 0 checkpoint steps in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (105451:checkpoint_manager.py:1701)
02:34:51.548 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=True), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, prevent_write_metrics=False), root_directory=/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x15533796ced0> (105451:checkpoint_manager.py:801)
wandb: Currently logged in as: heisen0928 (heisen0928-the-hong-kong-polytechnic-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/wandb/run-20251102_023452-vc06nglg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run real
wandb: ‚≠êÔ∏è View project at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi
wandb: üöÄ View run at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/vc06nglg
02:34:53.524 [I] Loaded norm stats from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/assets/pi0_base_piper/aloha_sweeping (105451:config.py:196)
02:34:53.525 [I] data_config: DataConfig(repo_id='aloha_sweeping', asset_id='aloha_sweeping', norm_stats={'state': NormStats(mean=array([ 0.47424394,  1.93239212, -1.21354711,  0.02150275,  0.90646011,
        0.49164048,  0.05461168]), std=array([0.17103249, 0.14320549, 0.25212812, 0.05638926, 0.14822352,
       0.11071946, 0.00993702]), q01=array([ 0.25117052,  1.69599698, -1.85752935, -0.0792199 ,  0.65580877,
        0.27204885,  0.0458824 ]), q99=array([ 0.82077601,  2.30108927, -0.91839277,  0.18234723,  1.21471596,
        0.7448781 ,  0.08129722])), 'actions': NormStats(mean=array([-0.0244057 , -0.00734879,  0.04024221,  0.0005264 , -0.03342618,
       -0.02444903,  0.03626091]), std=array([0.16685677, 0.14164105, 0.26111194, 0.04983826, 0.14566314,
       0.10277452, 0.03212533]), q01=array([-4.92804351e-01, -4.31920097e-01, -5.53970138e-01, -1.66209970e-01,
       -4.47979820e-01, -3.10425970e-01, -3.49400386e-05]), q99=array([0.26887509, 0.26059457, 0.77529773, 0.10606248, 0.26833984,
       0.21120921, 0.08889262]))}, repack_transforms=Group(inputs=[RepackTransform(structure={'images': {'cam_high': 'observation.images.cam_high', 'cam_right_wrist': 'observation.images.cam_right_wrist'}, 'state': 'observation.state', 'actions': 'action', 'prompt': 'prompt'})], outputs=()), data_transforms=Group(inputs=(PiperInputs(adapt_to_pi=False), DeltaActions(mask=(True, True, True, True, True, True, False))), outputs=(AbsoluteActions(mask=(True, True, True, True, True, True, False)), PiperOutputs(adapt_to_pi=False))), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizePrompt(tokenizer=<openpi.models.tokenizer.PaligemmaTokenizer object at 0x15532bd417d0>, discrete_state_input=False), PadStatesAndActions(model_action_dim=32)], outputs=()), use_quantile_norm=False, action_sequence_keys=('action',), prompt_from_task=True, rlds_data_dir=None, action_space=None, filter_dict_path=None) (105451:data_loader.py:243)
02:34:54.510 [I] local_batch_size: 32                                                             (105451:data_loader.py:324)
02:35:14.365 [I] Initialized data loader:
[0].images['base_0_rgb']: (32, 224, 224, 3)@float32
[0].images['left_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].images['right_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (32,)@bool
[0].image_masks['left_wrist_0_rgb']: (32,)@bool
[0].image_masks['right_wrist_0_rgb']: (32,)@bool
[0].state: (32, 32)@float32
[0].tokenized_prompt: (32, 48)@int32
[0].tokenized_prompt_mask: (32, 48)@bool
[1]: (32, 50, 32)@float32 (105451:train.py:227)
02:35:16.749 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.749 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['embedder']['input_embedding'].value of shape (257152, 2048) (1004.50 MiB) along axis 0 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value of shape (18, 8, 256, 2048) (144.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value of shape (18, 8, 256, 1024) (72.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value of shape (18, 2, 1, 2048, 256) (36.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.750 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value of shape (18, 2, 1, 1024, 256) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value of shape (18, 8, 2048, 256) (144.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value of shape (18, 8, 1024, 256) (72.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value of shape (18, 2, 2048, 16384) (2304.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['linear'].value of shape (18, 16384, 2048) (1152.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value of shape (18, 2, 1024, 4096) (288.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['linear'].value of shape (18, 4096, 1024) (144.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.751 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .params['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .params['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.752 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].mu['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.753 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.754 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .opt_state[1][0].nu['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .opt_state[1][0].nu['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.755 [I] Sharding .ema_params['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['embedder']['input_embedding'].value of shape (257152, 2048) (1004.50 MiB) along axis 0 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value of shape (18, 8, 256, 2048) (144.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value of shape (18, 8, 256, 1024) (72.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value of shape (18, 2, 1, 2048, 256) (36.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value of shape (18, 2, 1, 1024, 256) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value of shape (18, 8, 2048, 256) (144.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value of shape (18, 8, 1024, 256) (72.00 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value of shape (18, 2, 2048, 16384) (2304.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.756 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['linear'].value of shape (18, 16384, 2048) (1152.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value of shape (18, 2, 1024, 4096) (288.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['linear'].value of shape (18, 4096, 1024) (144.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (105451:sharding.py:89)
02:35:16.757 [I] Sharding .ema_params['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (105451:sharding.py:89)
02:35:16.764 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b599f490> (105451:base_pytree_checkpoint_handler.py:334)
02:35:16.786 [I] Restoring checkpoint from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (105451:checkpointer.py:298)
02:35:22.134 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 2.3 GiB/s (total bytes: 12.1 GiB) (time elapsed: 5 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:35:22.135 [I] Finished restoring checkpoint in 5.35 seconds from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (105451:checkpointer.py:309)
/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/.venv/lib/python3.11/site-packages/jax/_src/interpreters/mlir.py:1178: UserWarning: Some donated buffers were not usable: ShapedArray(float32[27,1152,4304]), ShapedArray(float32[27,4304,1152]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[27,16,72,1152]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[1152,2048]), ShapedArray(bfloat16[257152,2048]), ShapedArray(bfloat16[18,8,256,2048]), ShapedArray(bfloat16[18,8,256,1024]), ShapedArray(bfloat16[18,2,1,2048,256]), ShapedArray(bfloat16[18,2,1,1024,256]), ShapedArray(bfloat16[18,8,2048,256]), ShapedArray(bfloat16[18,8,1024,256]), ShapedArray(bfloat16[18,2,2048,16384]), ShapedArray(bfloat16[18,16384,2048]), ShapedArray(bfloat16[18,2,1024,4096]), ShapedArray(bfloat16[18,4096,1024]), ShapedArray(float32[2048,1024]), ShapedArray(float32[1024,1024]).
See an explanation at https://jax.readthedocs.io/en/latest/faq.html#buffer-donation.
  warnings.warn("Some donated buffers were not usable:"
02:35:34.636 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@float32
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@float32
['PaliGemma']['img']['head']['bias'].value: (2048,)@float32
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@float32
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@float32
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@bfloat16
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@bfloat16
['PaliGemma']['llm']['final_norm_1']['scale'].value: (1024,)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_a'].value: (18, 8, 256, 16)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value: (18, 8, 16, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value: (18, 8, 256, 32)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value: (18, 8, 32, 1024)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value: (18, 8, 256, 1024)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value: (18, 2, 1, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_b'].value: (18, 2, 1, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value: (18, 2, 1, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_b'].value: (18, 2, 1, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value: (18, 2, 1, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value: (18, 8, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_b'].value: (18, 8, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value: (18, 8, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value: (18, 8, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value: (18, 8, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value: (18, 2, 2048, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value: (18, 2, 16, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value: (18, 16384, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['linear_lora_b'].value: (18, 16, 2048)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value: (18, 2, 1024, 4096)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value: (18, 2, 1024, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value: (18, 2, 32, 4096)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear'].value: (18, 4096, 1024)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value: (18, 4096, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_b'].value: (18, 32, 1024)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['scale'].value: (18, 1024)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['scale'].value: (18, 1024)@bfloat16
['action_in_proj']['bias'].value: (1024,)@float32
['action_in_proj']['kernel'].value: (32, 1024)@float32
['action_out_proj']['bias'].value: (32,)@float32
['action_out_proj']['kernel'].value: (1024, 32)@float32
['action_time_mlp_in']['bias'].value: (1024,)@float32
['action_time_mlp_in']['kernel'].value: (2048, 1024)@float32
['action_time_mlp_out']['bias'].value: (1024,)@float32
['action_time_mlp_out']['kernel'].value: (1024, 1024)@float32
['state_proj']['bias'].value: (1024,)@float32
['state_proj']['kernel'].value: (32, 1024)@float32 (105451:train.py:238)
02:35:34.644 [I] Progress on: -/100000 rate:- remaining:? elapsed:00:00 postfix:-                 (105451:tqdm_logging.py:145)
Step 0: grad_norm=1.6388, loss=0.1104, param_norm=1379.7465
02:36:42.638 [I] Progress on: -/100000 rate:- remaining:? elapsed:01:07 postfix:-                 (105451:tqdm_logging.py:145)
02:36:53.001 [I] Progress on: 25.0it/100kit rate:2.3it/s remaining:12:14:52 elapsed:01:18 postfix:- (105451:tqdm_logging.py:145)
02:37:03.054 [I] Progress on: 48.0it/100kit rate:2.3it/s remaining:12:08:15 elapsed:01:28 postfix:- (105451:tqdm_logging.py:145)
02:37:13.113 [I] Progress on: 71.0it/100kit rate:2.3it/s remaining:12:08:37 elapsed:01:38 postfix:- (105451:tqdm_logging.py:145)
02:37:23.178 [I] Progress on: 94.0it/100kit rate:2.3it/s remaining:12:09:01 elapsed:01:48 postfix:- (105451:tqdm_logging.py:145)
Step 100: grad_norm=0.9840, loss=0.0748, param_norm=1379.7463
02:37:33.360 [I] Progress on: 117it/100kit rate:2.3it/s remaining:12:08:09 elapsed:01:58 postfix:- (105451:tqdm_logging.py:145)
02:37:43.424 [I] Progress on: 140it/100kit rate:2.3it/s remaining:12:07:46 elapsed:02:08 postfix:- (105451:tqdm_logging.py:145)
02:37:53.489 [I] Progress on: 163it/100kit rate:2.3it/s remaining:12:07:38 elapsed:02:18 postfix:- (105451:tqdm_logging.py:145)
02:38:03.553 [I] Progress on: 186it/100kit rate:2.3it/s remaining:12:07:36 elapsed:02:28 postfix:- (105451:tqdm_logging.py:145)
Step 200: grad_norm=0.5280, loss=0.0381, param_norm=1379.7466
02:38:13.657 [I] Progress on: 209it/100kit rate:2.3it/s remaining:12:07:16 elapsed:02:39 postfix:- (105451:tqdm_logging.py:145)
02:38:23.720 [I] Progress on: 232it/100kit rate:2.3it/s remaining:12:07:28 elapsed:02:49 postfix:- (105451:tqdm_logging.py:145)
02:38:33.784 [I] Progress on: 255it/100kit rate:2.3it/s remaining:12:07:09 elapsed:02:59 postfix:- (105451:tqdm_logging.py:145)
02:38:43.847 [I] Progress on: 278it/100kit rate:2.3it/s remaining:12:06:27 elapsed:03:09 postfix:- (105451:tqdm_logging.py:145)
Step 300: grad_norm=0.4388, loss=0.0297, param_norm=1379.7469
02:38:54.078 [I] Progress on: 300it/100kit rate:2.3it/s remaining:12:06:51 elapsed:03:19 postfix:- (105451:tqdm_logging.py:145)
02:39:04.451 [I] Progress on: 325it/100kit rate:2.3it/s remaining:12:06:35 elapsed:03:29 postfix:- (105451:tqdm_logging.py:145)
02:39:14.515 [I] Progress on: 348it/100kit rate:2.3it/s remaining:12:06:50 elapsed:03:39 postfix:- (105451:tqdm_logging.py:145)
02:39:24.580 [I] Progress on: 371it/100kit rate:2.3it/s remaining:12:06:53 elapsed:03:49 postfix:- (105451:tqdm_logging.py:145)
02:39:34.644 [I] Progress on: 394it/100kit rate:2.3it/s remaining:12:06:02 elapsed:03:59 postfix:- (105451:tqdm_logging.py:145)
Step 400: grad_norm=0.4176, loss=0.0262, param_norm=1379.7478
02:39:44.748 [I] Progress on: 417it/100kit rate:2.3it/s remaining:12:06:09 elapsed:04:10 postfix:- (105451:tqdm_logging.py:145)
02:39:55.017 [I] Progress on: 440it/100kit rate:2.3it/s remaining:12:06:14 elapsed:04:20 postfix:- (105451:tqdm_logging.py:145)
02:40:05.079 [I] Progress on: 463it/100kit rate:2.3it/s remaining:12:05:25 elapsed:04:30 postfix:- (105451:tqdm_logging.py:145)
02:40:15.144 [I] Progress on: 486it/100kit rate:2.3it/s remaining:12:05:28 elapsed:04:40 postfix:- (105451:tqdm_logging.py:145)
Step 500: grad_norm=0.3914, loss=0.0244, param_norm=1379.7496
02:40:25.247 [I] Progress on: 509it/100kit rate:2.3it/s remaining:12:04:23 elapsed:04:50 postfix:- (105451:tqdm_logging.py:145)
02:40:35.311 [I] Progress on: 532it/100kit rate:2.3it/s remaining:12:05:24 elapsed:05:00 postfix:- (105451:tqdm_logging.py:145)
02:40:45.376 [I] Progress on: 555it/100kit rate:2.3it/s remaining:12:05:20 elapsed:05:10 postfix:- (105451:tqdm_logging.py:145)
02:40:55.440 [I] Progress on: 578it/100kit rate:2.3it/s remaining:12:04:44 elapsed:05:20 postfix:- (105451:tqdm_logging.py:145)
Step 600: grad_norm=0.4475, loss=0.0242, param_norm=1379.7522
02:41:05.670 [I] Progress on: 600it/100kit rate:2.3it/s remaining:12:04:36 elapsed:05:31 postfix:- (105451:tqdm_logging.py:145)
02:41:15.752 [I] Progress on: 624it/100kit rate:2.3it/s remaining:12:06:12 elapsed:05:41 postfix:- (105451:tqdm_logging.py:145)
02:41:25.814 [I] Progress on: 647it/100kit rate:2.3it/s remaining:12:04:12 elapsed:05:51 postfix:- (105451:tqdm_logging.py:145)
02:41:35.877 [I] Progress on: 670it/100kit rate:2.3it/s remaining:12:04:15 elapsed:06:01 postfix:- (105451:tqdm_logging.py:145)
02:41:45.940 [I] Progress on: 693it/100kit rate:2.3it/s remaining:12:04:13 elapsed:06:11 postfix:- (105451:tqdm_logging.py:145)
Step 700: grad_norm=0.4282, loss=0.0229, param_norm=1379.7559
02:41:56.039 [I] Progress on: 716it/100kit rate:2.3it/s remaining:12:03:34 elapsed:06:21 postfix:- (105451:tqdm_logging.py:145)
02:42:06.102 [I] Progress on: 739it/100kit rate:2.3it/s remaining:12:03:58 elapsed:06:31 postfix:- (105451:tqdm_logging.py:145)
02:42:16.163 [I] Progress on: 762it/100kit rate:2.3it/s remaining:12:03:27 elapsed:06:41 postfix:- (105451:tqdm_logging.py:145)
02:42:26.225 [I] Progress on: 785it/100kit rate:2.3it/s remaining:12:03:31 elapsed:06:51 postfix:- (105451:tqdm_logging.py:145)
Step 800: grad_norm=0.3800, loss=0.0221, param_norm=1379.7609
02:42:36.326 [I] Progress on: 808it/100kit rate:2.3it/s remaining:12:02:25 elapsed:07:01 postfix:- (105451:tqdm_logging.py:145)
02:42:46.388 [I] Progress on: 831it/100kit rate:2.3it/s remaining:12:02:40 elapsed:07:11 postfix:- (105451:tqdm_logging.py:145)
02:42:56.692 [I] Progress on: 854it/100kit rate:2.3it/s remaining:12:12:56 elapsed:07:22 postfix:- (105451:tqdm_logging.py:145)
02:43:06.723 [I] Progress on: 877it/100kit rate:2.3it/s remaining:11:53:45 elapsed:07:32 postfix:- (105451:tqdm_logging.py:145)
02:43:16.815 [I] Progress on: 900it/100kit rate:2.3it/s remaining:12:11:27 elapsed:07:42 postfix:- (105451:tqdm_logging.py:145)
Step 900: grad_norm=0.3442, loss=0.0203, param_norm=1379.7675
02:43:26.885 [I] Progress on: 923it/100kit rate:2.3it/s remaining:12:02:19 elapsed:07:52 postfix:- (105451:tqdm_logging.py:145)
02:43:36.947 [I] Progress on: 946it/100kit rate:2.3it/s remaining:12:02:04 elapsed:08:02 postfix:- (105451:tqdm_logging.py:145)
02:43:47.014 [I] Progress on: 969it/100kit rate:2.3it/s remaining:12:04:08 elapsed:08:12 postfix:- (105451:tqdm_logging.py:145)
02:43:57.072 [I] Progress on: 992it/100kit rate:2.3it/s remaining:12:02:16 elapsed:08:22 postfix:- (105451:tqdm_logging.py:145)
Step 1000: grad_norm=0.3233, loss=0.0189, param_norm=1379.7748
02:44:01.206 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (105451:checkpoint_manager.py:1987)
02:44:01.206 [I] [process=0] Saving checkpoint at step 1000                                       (105451:checkpoint_manager.py:1408)
02:44:01.207 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (105451:async_checkpointer.py:439)
02:44:01.208 [I] Using ThreadSafeKeyValueSignalingClient                                          (105451:signaling_client.py:332)
02:44:01.219 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 (105451:atomicity.py:144)
02:44:01.224 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 (105451:atomicity.py:144)
02:44:01.224 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (105451:atomicity.py:144)
02:44:01.224 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (105451:atomicity.py:144)
02:44:01.225 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762022641221495990, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1762022641221495990, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (105451:checkpoint.py:186)
02:44:01.247 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (105451:replica_slices.py:341)
02:44:06.391 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (105451:replica_slices.py:341)
02:44:06.412 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2/array_metadatas/process_0 (105451:array_metadata_store.py:198)
02:44:08.761 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 948.8 MiB/s (total bytes: 7.0 GiB) (time elapsed: 7 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:44:08.773 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.4 GiB/s (total bytes: 10.5 GiB) (time elapsed: 7 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:44:08.789 [I] [process=0][thread=async_save] Background save thread started.                   (105451:async_checkpointer.py:77)
02:44:08.789 [I] Finished blocking save in 7.58 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (105451:async_checkpointer.py:548)
02:44:08.789 [I] [process=0][thread=MainThread][step=1000] Starting CheckpointManager Save Finalize thread=save_finalize (105451:checkpoint_manager.py:1453)
02:44:08.791 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (105451:async_checkpointer.py:258)
02:44:08.791 [I] {'step': 1000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762022641.2063491, 'wait_for_prev_duration_secs': 0.0001957416534423828, 'checkpointer_blocking_start_time': 1762022641.2068546, 'checkpointer_blocking_duration_secs': 7.58302903175354, 'get_old_steps_start_time': 1762022648.7899082, 'get_old_steps_duration_secs': 4.76837158203125e-06, 'checkpoint_manager_blocking_start_time': 1762022641.2062376, 'checkpoint_manager_blocking_duration_secs': 7.585331678390503} (105451:standard_logger.py:34)
02:44:08.792 [I] Progress on: 1.00kit/100kit rate:2.8s/it remaining:76:14:17 elapsed:08:34 postfix:- (105451:tqdm_logging.py:145)
02:44:08.841 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3/array_metadatas/process_0 (105451:array_metadata_store.py:198)
02:44:19.098 [I] Progress on: 1.02kit/100kit rate:2.3it/s remaining:12:02:04 elapsed:08:44 postfix:- (105451:tqdm_logging.py:145)
02:44:20.469 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 372.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: 19 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:44:23.175 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 488.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: 21 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:44:23.175 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (105451:async_checkpointer.py:87)
02:44:23.177 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762022641221495990, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (105451:checkpoint.py:226)
02:44:23.177 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets (105451:atomicity.py:289)
02:44:23.180 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'train_state': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762022641221495990, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (105451:checkpoint.py:245)
02:44:23.183 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (105451:array_metadata_store.py:362)
02:44:23.207 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state (105451:atomicity.py:289)
02:44:23.212 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (105451:array_metadata_store.py:362)
02:44:23.232 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params (105451:atomicity.py:289)
02:44:23.233 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (105451:atomicity.py:289)
02:44:23.237 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000`. (105451:atomicity.py:573)
02:44:23.238 [I] Finished asynchronous save (blocking + background) in 22.03 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (105451:async_checkpointer.py:412)
02:44:23.238 [I] [process=0][thread=async_save] Background save thread done.                      (105451:async_checkpointer.py:143)
02:44:23.238 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (105451:async_checkpointer.py:266)
02:44:23.238 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (105451:async_checkpointer.py:276)
02:44:23.238 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is syncing with other hosts... (105451:checkpoint_manager.py:2095)
02:44:23.238 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is done on all hosts. (105451:checkpoint_manager.py:2110)
02:44:29.149 [I] Progress on: 1.05kit/100kit rate:2.3it/s remaining:12:01:30 elapsed:08:54 postfix:- (105451:tqdm_logging.py:145)
02:44:39.212 [I] Progress on: 1.07kit/100kit rate:2.3it/s remaining:12:01:16 elapsed:09:04 postfix:- (105451:tqdm_logging.py:145)
02:44:49.274 [I] Progress on: 1.09kit/100kit rate:2.3it/s remaining:12:01:03 elapsed:09:14 postfix:- (105451:tqdm_logging.py:145)
Step 1100: grad_norm=0.2981, loss=0.0193, param_norm=1379.7837
02:44:59.376 [I] Progress on: 1.11kit/100kit rate:2.3it/s remaining:12:01:18 elapsed:09:24 postfix:- (105451:tqdm_logging.py:145)
02:45:09.437 [I] Progress on: 1.14kit/100kit rate:2.3it/s remaining:12:00:22 elapsed:09:34 postfix:- (105451:tqdm_logging.py:145)
02:45:19.499 [I] Progress on: 1.16kit/100kit rate:2.3it/s remaining:12:00:52 elapsed:09:44 postfix:- (105451:tqdm_logging.py:145)
02:45:29.560 [I] Progress on: 1.18kit/100kit rate:2.3it/s remaining:12:00:19 elapsed:09:54 postfix:- (105451:tqdm_logging.py:145)
Step 1200: grad_norm=0.2679, loss=0.0167, param_norm=1379.7930
02:45:39.660 [I] Progress on: 1.21kit/100kit rate:2.3it/s remaining:11:58:49 elapsed:10:05 postfix:- (105451:tqdm_logging.py:145)
02:45:49.721 [I] Progress on: 1.23kit/100kit rate:2.3it/s remaining:12:00:00 elapsed:10:15 postfix:- (105451:tqdm_logging.py:145)
02:45:59.783 [I] Progress on: 1.25kit/100kit rate:2.3it/s remaining:12:00:07 elapsed:10:25 postfix:- (105451:tqdm_logging.py:145)
02:46:10.048 [I] Progress on: 1.28kit/100kit rate:2.3it/s remaining:11:59:59 elapsed:10:35 postfix:- (105451:tqdm_logging.py:145)
02:46:20.111 [I] Progress on: 1.30kit/100kit rate:2.3it/s remaining:12:00:01 elapsed:10:45 postfix:- (105451:tqdm_logging.py:145)
Step 1300: grad_norm=0.2458, loss=0.0153, param_norm=1379.8015
02:46:30.211 [I] Progress on: 1.32kit/100kit rate:2.3it/s remaining:11:59:13 elapsed:10:55 postfix:- (105451:tqdm_logging.py:145)
02:46:40.275 [I] Progress on: 1.34kit/100kit rate:2.3it/s remaining:11:59:46 elapsed:11:05 postfix:- (105451:tqdm_logging.py:145)
02:46:50.336 [I] Progress on: 1.37kit/100kit rate:2.3it/s remaining:11:59:08 elapsed:11:15 postfix:- (105451:tqdm_logging.py:145)
02:47:00.397 [I] Progress on: 1.39kit/100kit rate:2.3it/s remaining:11:58:47 elapsed:11:25 postfix:- (105451:tqdm_logging.py:145)
Step 1400: grad_norm=0.3014, loss=0.0153, param_norm=1379.8105
02:47:10.496 [I] Progress on: 1.41kit/100kit rate:2.3it/s remaining:11:58:35 elapsed:11:35 postfix:- (105451:tqdm_logging.py:145)
02:47:20.557 [I] Progress on: 1.44kit/100kit rate:2.3it/s remaining:11:58:54 elapsed:11:45 postfix:- (105451:tqdm_logging.py:145)
02:47:30.616 [I] Progress on: 1.46kit/100kit rate:2.3it/s remaining:11:57:55 elapsed:11:55 postfix:- (105451:tqdm_logging.py:145)
02:47:40.679 [I] Progress on: 1.48kit/100kit rate:2.3it/s remaining:11:58:26 elapsed:12:06 postfix:- (105451:tqdm_logging.py:145)
Step 1500: grad_norm=0.2421, loss=0.0140, param_norm=1379.8198
02:47:50.927 [I] Progress on: 1.51kit/100kit rate:2.3it/s remaining:11:55:44 elapsed:12:16 postfix:- (105451:tqdm_logging.py:145)
02:48:00.986 [I] Progress on: 1.53kit/100kit rate:2.3it/s remaining:11:57:36 elapsed:12:26 postfix:- (105451:tqdm_logging.py:145)
02:48:11.048 [I] Progress on: 1.55kit/100kit rate:2.3it/s remaining:11:57:38 elapsed:12:36 postfix:- (105451:tqdm_logging.py:145)
02:48:21.110 [I] Progress on: 1.57kit/100kit rate:2.3it/s remaining:11:57:54 elapsed:12:46 postfix:- (105451:tqdm_logging.py:145)
02:48:31.170 [I] Progress on: 1.60kit/100kit rate:2.3it/s remaining:11:57:13 elapsed:12:56 postfix:- (105451:tqdm_logging.py:145)
Step 1600: grad_norm=0.3567, loss=0.0145, param_norm=1379.8286
02:48:41.271 [I] Progress on: 1.62kit/100kit rate:2.3it/s remaining:11:57:18 elapsed:13:06 postfix:- (105451:tqdm_logging.py:145)
02:48:51.332 [I] Progress on: 1.64kit/100kit rate:2.3it/s remaining:11:57:17 elapsed:13:16 postfix:- (105451:tqdm_logging.py:145)
02:49:01.394 [I] Progress on: 1.67kit/100kit rate:2.3it/s remaining:11:57:03 elapsed:13:26 postfix:- (105451:tqdm_logging.py:145)
02:49:11.661 [I] Progress on: 1.69kit/100kit rate:2.3it/s remaining:12:04:52 elapsed:13:37 postfix:- (105451:tqdm_logging.py:145)
Step 1700: grad_norm=0.2245, loss=0.0123, param_norm=1379.8373
02:49:21.761 [I] Progress on: 1.71kit/100kit rate:2.3it/s remaining:11:56:43 elapsed:13:47 postfix:- (105451:tqdm_logging.py:145)
02:49:31.823 [I] Progress on: 1.74kit/100kit rate:2.3it/s remaining:11:56:06 elapsed:13:57 postfix:- (105451:tqdm_logging.py:145)
02:49:41.885 [I] Progress on: 1.76kit/100kit rate:2.3it/s remaining:11:56:06 elapsed:14:07 postfix:- (105451:tqdm_logging.py:145)
02:49:51.945 [I] Progress on: 1.78kit/100kit rate:2.3it/s remaining:11:55:35 elapsed:14:17 postfix:- (105451:tqdm_logging.py:145)
Step 1800: grad_norm=0.2181, loss=0.0115, param_norm=1379.8466
02:50:02.046 [I] Progress on: 1.80kit/100kit rate:2.3it/s remaining:11:53:14 elapsed:14:27 postfix:- (105451:tqdm_logging.py:145)
02:50:12.106 [I] Progress on: 1.83kit/100kit rate:2.3it/s remaining:11:55:38 elapsed:14:37 postfix:- (105451:tqdm_logging.py:145)
02:50:22.167 [I] Progress on: 1.85kit/100kit rate:2.3it/s remaining:11:55:23 elapsed:14:47 postfix:- (105451:tqdm_logging.py:145)
02:50:32.228 [I] Progress on: 1.87kit/100kit rate:2.3it/s remaining:11:55:28 elapsed:14:57 postfix:- (105451:tqdm_logging.py:145)
02:50:42.292 [I] Progress on: 1.90kit/100kit rate:2.3it/s remaining:11:55:42 elapsed:15:07 postfix:- (105451:tqdm_logging.py:145)
Step 1900: grad_norm=0.2344, loss=0.0117, param_norm=1379.8551
02:50:52.390 [I] Progress on: 1.92kit/100kit rate:2.3it/s remaining:11:55:09 elapsed:15:17 postfix:- (105451:tqdm_logging.py:145)
02:51:02.451 [I] Progress on: 1.94kit/100kit rate:2.3it/s remaining:11:54:50 elapsed:15:27 postfix:- (105451:tqdm_logging.py:145)
02:51:12.512 [I] Progress on: 1.97kit/100kit rate:2.3it/s remaining:11:54:30 elapsed:15:37 postfix:- (105451:tqdm_logging.py:145)
02:51:22.575 [I] Progress on: 1.99kit/100kit rate:2.3it/s remaining:11:55:00 elapsed:15:47 postfix:- (105451:tqdm_logging.py:145)
Step 2000: grad_norm=0.2104, loss=0.0106, param_norm=1379.8644
02:51:28.020 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (105451:checkpoint_manager.py:1987)
02:51:28.020 [I] [process=0] Saving checkpoint at step 2000                                       (105451:checkpoint_manager.py:1408)
02:51:28.021 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (105451:async_checkpointer.py:439)
02:51:28.029 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 (105451:atomicity.py:144)
02:51:28.036 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 (105451:atomicity.py:144)
02:51:28.037 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 (105451:atomicity.py:144)
02:51:28.037 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 (105451:atomicity.py:144)
02:51:28.057 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (105451:replica_slices.py:341)
02:51:28.689 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (105451:replica_slices.py:341)
02:51:28.710 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6/array_metadatas/process_0 (105451:array_metadata_store.py:198)
02:51:30.668 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.6 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:51:30.682 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 4.0 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:51:30.684 [I] [process=0][thread=async_save] Background save thread started.                   (105451:async_checkpointer.py:77)
02:51:30.684 [I] Finished blocking save in 2.66 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (105451:async_checkpointer.py:548)
02:51:30.685 [I] Deleting Checkpoint[step=1000 | time=2025-11-01 18:44:08.789895+00:00]: (Reason: old checkpoint). (105451:checkpoint_manager.py:1963)
02:51:30.685 [I] [process=0][thread=MainThread][step=2000] Starting CheckpointManager Save Finalize thread=save_finalize (105451:checkpoint_manager.py:1453)
02:51:30.686 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (105451:async_checkpointer.py:258)
02:51:30.686 [I] {'step': 2000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762023088.0205822, 'wait_for_prev_duration_secs': 0.00016689300537109375, 'checkpointer_blocking_start_time': 1762023088.0210268, 'checkpointer_blocking_duration_secs': 2.664417028427124, 'get_old_steps_start_time': 1762023090.6854665, 'get_old_steps_duration_secs': 0.0003218650817871094, 'checkpoint_manager_blocking_start_time': 1762023088.0204668, 'checkpoint_manager_blocking_duration_secs': 2.6658685207366943} (105451:standard_logger.py:34)
02:51:30.708 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7/array_metadatas/process_0 (105451:array_metadata_store.py:198)
02:51:37.656 [I] Progress on: 2.00kit/100kit rate:2.2s/it remaining:58:37:18 elapsed:16:03 postfix:- (105451:tqdm_logging.py:145)
02:51:42.542 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 493.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:51:43.717 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 684.4 MiB/s (total bytes: 10.5 GiB) (time elapsed: 15 seconds) (per-host) (105451:base_pytree_checkpoint_handler.py:114)
02:51:43.717 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (105451:async_checkpointer.py:87)
02:51:43.718 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets (105451:atomicity.py:289)
02:51:43.723 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (105451:array_metadata_store.py:362)
02:51:43.747 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state (105451:atomicity.py:289)
02:51:43.750 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (105451:array_metadata_store.py:362)
02:51:43.844 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params (105451:atomicity.py:289)
02:51:43.846 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (105451:atomicity.py:289)
02:51:43.851 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000`. (105451:atomicity.py:573)
02:51:43.851 [I] Finished asynchronous save (blocking + background) in 15.83 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (105451:async_checkpointer.py:412)
02:51:43.851 [I] [process=0][thread=async_save] Background save thread done.                      (105451:async_checkpointer.py:143)
02:51:43.852 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (105451:async_checkpointer.py:266)
02:51:43.852 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (105451:async_checkpointer.py:276)
02:51:44.344 [I] Deleted step 1000.                                                               (105451:deleter.py:114)
02:51:44.345 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is syncing with other hosts... (105451:checkpoint_manager.py:2095)
02:51:44.345 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is done on all hosts. (105451:checkpoint_manager.py:2110)
02:51:47.998 [I] Progress on: 2.03kit/100kit rate:2.3it/s remaining:11:53:51 elapsed:16:13 postfix:- (105451:tqdm_logging.py:145)
02:51:58.057 [I] Progress on: 2.05kit/100kit rate:2.3it/s remaining:11:53:57 elapsed:16:23 postfix:- (105451:tqdm_logging.py:145)
02:52:08.118 [I] Progress on: 2.08kit/100kit rate:2.3it/s remaining:11:53:41 elapsed:16:33 postfix:- (105451:tqdm_logging.py:145)
02:52:18.179 [I] Progress on: 2.10kit/100kit rate:2.3it/s remaining:11:53:19 elapsed:16:43 postfix:- (105451:tqdm_logging.py:145)
Step 2100: grad_norm=0.2077, loss=0.0106, param_norm=1379.8728
02:52:28.485 [I] Progress on: 2.12kit/100kit rate:2.3it/s remaining:11:54:02 elapsed:16:53 postfix:- (105451:tqdm_logging.py:145)
02:52:38.545 [I] Progress on: 2.14kit/100kit rate:2.3it/s remaining:11:52:56 elapsed:17:03 postfix:- (105451:tqdm_logging.py:145)
02:52:48.606 [I] Progress on: 2.17kit/100kit rate:2.3it/s remaining:11:53:17 elapsed:17:13 postfix:- (105451:tqdm_logging.py:145)
02:52:58.668 [I] Progress on: 2.19kit/100kit rate:2.3it/s remaining:11:53:12 elapsed:17:24 postfix:- (105451:tqdm_logging.py:145)
Step 2200: grad_norm=0.3199, loss=0.0123, param_norm=1379.8813
02:53:08.766 [I] Progress on: 2.21kit/100kit rate:2.3it/s remaining:11:52:17 elapsed:17:34 postfix:- (105451:tqdm_logging.py:145)
02:53:18.826 [I] Progress on: 2.24kit/100kit rate:2.3it/s remaining:11:52:36 elapsed:17:44 postfix:- (105451:tqdm_logging.py:145)
02:53:28.886 [I] Progress on: 2.26kit/100kit rate:2.3it/s remaining:11:52:29 elapsed:17:54 postfix:- (105451:tqdm_logging.py:145)
02:53:38.948 [I] Progress on: 2.28kit/100kit rate:2.3it/s remaining:11:52:18 elapsed:18:04 postfix:- (105451:tqdm_logging.py:145)
Step 2300: grad_norm=0.1833, loss=0.0097, param_norm=1379.8901
02:53:49.046 [I] Progress on: 2.31kit/100kit rate:2.3it/s remaining:11:48:52 elapsed:18:14 postfix:- (105451:tqdm_logging.py:145)
02:53:59.108 [I] Progress on: 2.33kit/100kit rate:2.3it/s remaining:11:52:19 elapsed:18:24 postfix:- (105451:tqdm_logging.py:145)
02:54:09.168 [I] Progress on: 2.35kit/100kit rate:2.3it/s remaining:11:51:36 elapsed:18:34 postfix:- (105451:tqdm_logging.py:145)
02:54:19.229 [I] Progress on: 2.37kit/100kit rate:2.3it/s remaining:11:51:40 elapsed:18:44 postfix:- (105451:tqdm_logging.py:145)
02:54:29.289 [I] Progress on: 2.40kit/100kit rate:2.3it/s remaining:11:51:43 elapsed:18:54 postfix:- (105451:tqdm_logging.py:145)
Step 2400: grad_norm=0.1912, loss=0.0096, param_norm=1379.8989
02:54:39.387 [I] Progress on: 2.42kit/100kit rate:2.3it/s remaining:11:51:12 elapsed:19:04 postfix:- (105451:tqdm_logging.py:145)
02:54:49.447 [I] Progress on: 2.44kit/100kit rate:2.3it/s remaining:11:50:16 elapsed:19:14 postfix:- (105451:tqdm_logging.py:145)
slurmstepd: error: *** JOB 311879 ON dgx-46 CANCELLED AT 2025-11-02T02:54:57 DUE TO PREEMPTION ***
Sun Nov  2 03:50:31 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H800                    On  |   00000000:1B:00.0 Off |                    0 |
| N/A   28C    P0             71W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H800                    On  |   00000000:43:00.0 Off |                    0 |
| N/A   30C    P0             71W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H800                    On  |   00000000:52:00.0 Off |                    0 |
| N/A   40C    P0             73W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H800                    On  |   00000000:61:00.0 Off |                    0 |
| N/A   38C    P0             72W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
0,1,2,3
warning: The `tool.uv.dev-dependencies` field (used in `packages/openpi-client/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
03:51:24.293 [I] Running on: dgx-01                                                               (1756331:train.py:196)
INFO:2025-11-02 03:51:26,989:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
03:51:26.989 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (1756331:xla_bridge.py:925)
INFO:2025-11-02 03:51:27,009:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
03:51:27.009 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (1756331:xla_bridge.py:925)
03:51:29.647 [I] Wiped checkpoint directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (1756331:checkpoints.py:29)
03:51:29.648 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b5986810> (1756331:base_pytree_checkpoint_handler.py:334)
03:51:29.648 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b5986810> (1756331:base_pytree_checkpoint_handler.py:334)
03:51:29.648 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (1756331:multihost.py:390)
03:51:29.648 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x15532cc678d0>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bb04b90>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553e4f1dc50>}, handler_registry=None (1756331:checkpoint_manager.py:620)
03:51:29.648 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x15532cc678d0>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (1756331:composite_checkpoint_handler.py:234)
03:51:29.648 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bb04b90>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (1756331:composite_checkpoint_handler.py:234)
03:51:29.648 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553e4f1dc50>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (1756331:composite_checkpoint_handler.py:234)
03:51:29.648 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532bacca50>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (1756331:composite_checkpoint_handler.py:234)
03:51:29.648 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x15532cc678d0>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x15532cc678d0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bb04b90>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bb04b90>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553e4f1dc50>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x1553e4f1dc50>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532bacca50>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532bacca50>}). (1756331:composite_checkpoint_handler.py:502)
03:51:29.649 [I] orbax-checkpoint version: 0.11.13                                                (1756331:abstract_checkpointer.py:35)
03:51:29.649 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x15532bba40e0> timeout: 7200 secs and primary_host=0 for async checkpoint writes (1756331:async_checkpointer.py:170)
03:51:29.650 [I] Found 0 checkpoint steps in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (1756331:checkpoint_manager.py:1701)
03:51:29.650 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=True), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, prevent_write_metrics=False), root_directory=/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x15532bacea90> (1756331:checkpoint_manager.py:801)
wandb: Currently logged in as: heisen0928 (heisen0928-the-hong-kong-polytechnic-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/wandb/run-20251102_035130-8s6n14ch
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run real
wandb: ‚≠êÔ∏è View project at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi
wandb: üöÄ View run at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/8s6n14ch
03:51:32.224 [I] Loaded norm stats from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/assets/pi0_base_piper/aloha_sweeping (1756331:config.py:196)
03:51:32.225 [I] data_config: DataConfig(repo_id='aloha_sweeping', asset_id='aloha_sweeping', norm_stats={'state': NormStats(mean=array([ 0.47424394,  1.93239212, -1.21354711,  0.02150275,  0.90646011,
        0.49164048,  0.05461168]), std=array([0.17103249, 0.14320549, 0.25212812, 0.05638926, 0.14822352,
       0.11071946, 0.00993702]), q01=array([ 0.25117052,  1.69599698, -1.85752935, -0.0792199 ,  0.65580877,
        0.27204885,  0.0458824 ]), q99=array([ 0.82077601,  2.30108927, -0.91839277,  0.18234723,  1.21471596,
        0.7448781 ,  0.08129722])), 'actions': NormStats(mean=array([-0.0244057 , -0.00734879,  0.04024221,  0.0005264 , -0.03342618,
       -0.02444903,  0.03626091]), std=array([0.16685677, 0.14164105, 0.26111194, 0.04983826, 0.14566314,
       0.10277452, 0.03212533]), q01=array([-4.92804351e-01, -4.31920097e-01, -5.53970138e-01, -1.66209970e-01,
       -4.47979820e-01, -3.10425970e-01, -3.49400386e-05]), q99=array([0.26887509, 0.26059457, 0.77529773, 0.10606248, 0.26833984,
       0.21120921, 0.08889262]))}, repack_transforms=Group(inputs=[RepackTransform(structure={'images': {'cam_high': 'observation.images.cam_high', 'cam_right_wrist': 'observation.images.cam_right_wrist'}, 'state': 'observation.state', 'actions': 'action', 'prompt': 'prompt'})], outputs=()), data_transforms=Group(inputs=(PiperInputs(adapt_to_pi=False), DeltaActions(mask=(True, True, True, True, True, True, False))), outputs=(AbsoluteActions(mask=(True, True, True, True, True, True, False)), PiperOutputs(adapt_to_pi=False))), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizePrompt(tokenizer=<openpi.models.tokenizer.PaligemmaTokenizer object at 0x15532ba80ad0>, discrete_state_input=False), PadStatesAndActions(model_action_dim=32)], outputs=()), use_quantile_norm=False, action_sequence_keys=('action',), prompt_from_task=True, rlds_data_dir=None, action_space=None, filter_dict_path=None) (1756331:data_loader.py:243)
03:51:33.493 [I] local_batch_size: 32                                                             (1756331:data_loader.py:324)
03:51:56.566 [I] Initialized data loader:
[0].images['base_0_rgb']: (32, 224, 224, 3)@float32
[0].images['left_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].images['right_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (32,)@bool
[0].image_masks['left_wrist_0_rgb']: (32,)@bool
[0].image_masks['right_wrist_0_rgb']: (32,)@bool
[0].state: (32, 32)@float32
[0].tokenized_prompt: (32, 48)@int32
[0].tokenized_prompt_mask: (32, 48)@bool
[1]: (32, 50, 32)@float32 (1756331:train.py:227)
03:51:59.006 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.006 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.006 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.006 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['embedder']['input_embedding'].value of shape (257152, 2048) (1004.50 MiB) along axis 0 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value of shape (18, 8, 256, 2048) (144.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value of shape (18, 8, 256, 1024) (72.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value of shape (18, 2, 1, 2048, 256) (36.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value of shape (18, 2, 1, 1024, 256) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.007 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value of shape (18, 8, 2048, 256) (144.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value of shape (18, 8, 1024, 256) (72.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value of shape (18, 2, 2048, 16384) (2304.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['linear'].value of shape (18, 16384, 2048) (1152.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value of shape (18, 2, 1024, 4096) (288.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['linear'].value of shape (18, 4096, 1024) (144.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (1756331:sharding.py:89)
03:51:59.008 [I] Sharding .params['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.009 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].mu['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.010 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.011 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .opt_state[1][0].nu['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .opt_state[1][0].nu['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['llm']['embedder']['input_embedding'].value of shape (257152, 2048) (1004.50 MiB) along axis 0 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.012 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value of shape (18, 8, 256, 2048) (144.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value of shape (18, 8, 256, 1024) (72.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value of shape (18, 2, 1, 2048, 256) (36.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value of shape (18, 2, 1, 1024, 256) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value of shape (18, 8, 2048, 256) (144.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value of shape (18, 8, 1024, 256) (72.00 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value of shape (18, 2, 2048, 16384) (2304.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['linear'].value of shape (18, 16384, 2048) (1152.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.013 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.014 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value of shape (18, 2, 1024, 4096) (288.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.014 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (1756331:sharding.py:89)
03:51:59.014 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (1756331:sharding.py:89)
03:51:59.014 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['linear'].value of shape (18, 4096, 1024) (144.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.014 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.014 [I] Sharding .ema_params['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (1756331:sharding.py:89)
03:51:59.014 [I] Sharding .ema_params['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (1756331:sharding.py:89)
03:51:59.022 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b5986810> (1756331:base_pytree_checkpoint_handler.py:334)
03:51:59.079 [I] Restoring checkpoint from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (1756331:checkpointer.py:298)
03:52:06.939 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 1.5 GiB/s (total bytes: 12.1 GiB) (time elapsed: 7 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
03:52:06.940 [I] Finished restoring checkpoint in 7.86 seconds from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (1756331:checkpointer.py:309)
/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/.venv/lib/python3.11/site-packages/jax/_src/interpreters/mlir.py:1178: UserWarning: Some donated buffers were not usable: ShapedArray(float32[27,1152,4304]), ShapedArray(float32[27,4304,1152]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[27,16,72,1152]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[1152,2048]), ShapedArray(bfloat16[257152,2048]), ShapedArray(bfloat16[18,8,256,2048]), ShapedArray(bfloat16[18,8,256,1024]), ShapedArray(bfloat16[18,2,1,2048,256]), ShapedArray(bfloat16[18,2,1,1024,256]), ShapedArray(bfloat16[18,8,2048,256]), ShapedArray(bfloat16[18,8,1024,256]), ShapedArray(bfloat16[18,2,2048,16384]), ShapedArray(bfloat16[18,16384,2048]), ShapedArray(bfloat16[18,2,1024,4096]), ShapedArray(bfloat16[18,4096,1024]), ShapedArray(float32[2048,1024]), ShapedArray(float32[1024,1024]).
See an explanation at https://jax.readthedocs.io/en/latest/faq.html#buffer-donation.
  warnings.warn("Some donated buffers were not usable:"
03:52:14.704 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@float32
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@float32
['PaliGemma']['img']['head']['bias'].value: (2048,)@float32
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@float32
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@float32
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@bfloat16
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@bfloat16
['PaliGemma']['llm']['final_norm_1']['scale'].value: (1024,)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_a'].value: (18, 8, 256, 16)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value: (18, 8, 16, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value: (18, 8, 256, 32)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value: (18, 8, 32, 1024)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value: (18, 8, 256, 1024)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value: (18, 2, 1, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_b'].value: (18, 2, 1, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value: (18, 2, 1, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_b'].value: (18, 2, 1, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value: (18, 2, 1, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value: (18, 8, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_b'].value: (18, 8, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value: (18, 8, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value: (18, 8, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value: (18, 8, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value: (18, 2, 2048, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value: (18, 2, 16, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value: (18, 16384, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['linear_lora_b'].value: (18, 16, 2048)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value: (18, 2, 1024, 4096)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value: (18, 2, 1024, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value: (18, 2, 32, 4096)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear'].value: (18, 4096, 1024)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value: (18, 4096, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_b'].value: (18, 32, 1024)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['scale'].value: (18, 1024)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['scale'].value: (18, 1024)@bfloat16
['action_in_proj']['bias'].value: (1024,)@float32
['action_in_proj']['kernel'].value: (32, 1024)@float32
['action_out_proj']['bias'].value: (32,)@float32
['action_out_proj']['kernel'].value: (1024, 32)@float32
['action_time_mlp_in']['bias'].value: (1024,)@float32
['action_time_mlp_in']['kernel'].value: (2048, 1024)@float32
['action_time_mlp_out']['bias'].value: (1024,)@float32
['action_time_mlp_out']['kernel'].value: (1024, 1024)@float32
['state_proj']['bias'].value: (1024,)@float32
['state_proj']['kernel'].value: (32, 1024)@float32 (1756331:train.py:238)
03:52:14.712 [I] Progress on: -/100000 rate:- remaining:? elapsed:00:00 postfix:-                 (1756331:tqdm_logging.py:145)
Step 0: grad_norm=1.6388, loss=0.1104, param_norm=1379.7465
03:52:24.813 [I] Progress on: 7.00it/100kit rate:1.4it/s remaining:19:34:24 elapsed:00:10 postfix:- (1756331:tqdm_logging.py:145)
03:52:34.864 [I] Progress on: 30.0it/100kit rate:2.3it/s remaining:12:09:04 elapsed:00:20 postfix:- (1756331:tqdm_logging.py:145)
03:52:44.913 [I] Progress on: 53.0it/100kit rate:2.3it/s remaining:12:07:34 elapsed:00:30 postfix:- (1756331:tqdm_logging.py:145)
03:52:54.971 [I] Progress on: 76.0it/100kit rate:2.3it/s remaining:12:08:31 elapsed:00:40 postfix:- (1756331:tqdm_logging.py:145)
03:53:05.028 [I] Progress on: 99.0it/100kit rate:2.3it/s remaining:12:07:13 elapsed:00:50 postfix:- (1756331:tqdm_logging.py:145)
Step 100: grad_norm=0.9840, loss=0.0748, param_norm=1379.7463
03:53:15.212 [I] Progress on: 122it/100kit rate:2.3it/s remaining:12:08:36 elapsed:01:00 postfix:- (1756331:tqdm_logging.py:145)
03:53:25.263 [I] Progress on: 145it/100kit rate:2.3it/s remaining:12:07:17 elapsed:01:10 postfix:- (1756331:tqdm_logging.py:145)
03:53:35.317 [I] Progress on: 168it/100kit rate:2.3it/s remaining:12:08:02 elapsed:01:20 postfix:- (1756331:tqdm_logging.py:145)
03:53:45.370 [I] Progress on: 191it/100kit rate:2.3it/s remaining:12:06:31 elapsed:01:30 postfix:- (1756331:tqdm_logging.py:145)
Step 200: grad_norm=0.5280, loss=0.0381, param_norm=1379.7466
03:53:55.466 [I] Progress on: 214it/100kit rate:2.3it/s remaining:12:07:08 elapsed:01:40 postfix:- (1756331:tqdm_logging.py:145)
03:54:05.519 [I] Progress on: 237it/100kit rate:2.3it/s remaining:12:06:15 elapsed:01:50 postfix:- (1756331:tqdm_logging.py:145)
03:54:15.575 [I] Progress on: 260it/100kit rate:2.3it/s remaining:12:07:00 elapsed:02:00 postfix:- (1756331:tqdm_logging.py:145)
03:54:25.627 [I] Progress on: 283it/100kit rate:2.3it/s remaining:12:05:58 elapsed:02:10 postfix:- (1756331:tqdm_logging.py:145)
Step 300: grad_norm=0.4388, loss=0.0297, param_norm=1379.7469
03:54:35.724 [I] Progress on: 306it/100kit rate:2.3it/s remaining:12:04:41 elapsed:02:21 postfix:- (1756331:tqdm_logging.py:145)
03:54:45.778 [I] Progress on: 329it/100kit rate:2.3it/s remaining:12:06:04 elapsed:02:31 postfix:- (1756331:tqdm_logging.py:145)
03:54:55.834 [I] Progress on: 352it/100kit rate:2.3it/s remaining:12:06:31 elapsed:02:41 postfix:- (1756331:tqdm_logging.py:145)
03:55:05.890 [I] Progress on: 375it/100kit rate:2.3it/s remaining:12:05:55 elapsed:02:51 postfix:- (1756331:tqdm_logging.py:145)
03:55:15.947 [I] Progress on: 398it/100kit rate:2.3it/s remaining:12:06:34 elapsed:03:01 postfix:- (1756331:tqdm_logging.py:145)
Step 400: grad_norm=0.4176, loss=0.0262, param_norm=1379.7478
03:55:26.397 [I] Progress on: 421it/100kit rate:1.8it/s remaining:15:03:10 elapsed:03:11 postfix:- (1756331:tqdm_logging.py:145)
03:55:36.739 [I] Progress on: 445it/100kit rate:2.3it/s remaining:12:04:45 elapsed:03:22 postfix:- (1756331:tqdm_logging.py:145)
03:55:46.940 [I] Progress on: 468it/100kit rate:2.3it/s remaining:12:12:02 elapsed:03:32 postfix:- (1756331:tqdm_logging.py:145)
03:55:56.996 [I] Progress on: 491it/100kit rate:2.3it/s remaining:12:04:44 elapsed:03:42 postfix:- (1756331:tqdm_logging.py:145)
Step 500: grad_norm=0.3914, loss=0.0244, param_norm=1379.7496
03:56:07.095 [I] Progress on: 514it/100kit rate:2.3it/s remaining:12:05:20 elapsed:03:52 postfix:- (1756331:tqdm_logging.py:145)
03:56:17.148 [I] Progress on: 537it/100kit rate:2.3it/s remaining:12:04:17 elapsed:04:02 postfix:- (1756331:tqdm_logging.py:145)
03:56:27.206 [I] Progress on: 560it/100kit rate:2.3it/s remaining:12:05:36 elapsed:04:12 postfix:- (1756331:tqdm_logging.py:145)
03:56:37.257 [I] Progress on: 583it/100kit rate:2.3it/s remaining:12:03:28 elapsed:04:22 postfix:- (1756331:tqdm_logging.py:145)
Step 600: grad_norm=0.4475, loss=0.0242, param_norm=1379.7522
03:56:47.354 [I] Progress on: 606it/100kit rate:2.3it/s remaining:12:02:54 elapsed:04:32 postfix:- (1756331:tqdm_logging.py:145)
03:56:57.406 [I] Progress on: 629it/100kit rate:2.3it/s remaining:12:03:29 elapsed:04:42 postfix:- (1756331:tqdm_logging.py:145)
03:57:07.480 [I] Progress on: 652it/100kit rate:2.3it/s remaining:12:08:19 elapsed:04:52 postfix:- (1756331:tqdm_logging.py:145)
03:57:17.525 [I] Progress on: 675it/100kit rate:2.3it/s remaining:12:02:51 elapsed:05:02 postfix:- (1756331:tqdm_logging.py:145)
03:57:27.581 [I] Progress on: 698it/100kit rate:2.3it/s remaining:12:03:44 elapsed:05:12 postfix:- (1756331:tqdm_logging.py:145)
Step 700: grad_norm=0.4282, loss=0.0229, param_norm=1379.7559
03:57:37.674 [I] Progress on: 721it/100kit rate:2.3it/s remaining:12:02:38 elapsed:05:22 postfix:- (1756331:tqdm_logging.py:145)
03:57:47.728 [I] Progress on: 744it/100kit rate:2.3it/s remaining:12:03:16 elapsed:05:33 postfix:- (1756331:tqdm_logging.py:145)
03:57:57.780 [I] Progress on: 767it/100kit rate:2.3it/s remaining:12:02:11 elapsed:05:43 postfix:- (1756331:tqdm_logging.py:145)
03:58:07.837 [I] Progress on: 790it/100kit rate:2.3it/s remaining:12:03:58 elapsed:05:53 postfix:- (1756331:tqdm_logging.py:145)
Step 800: grad_norm=0.3800, loss=0.0221, param_norm=1379.7609
03:58:17.927 [I] Progress on: 813it/100kit rate:2.3it/s remaining:12:01:29 elapsed:06:03 postfix:- (1756331:tqdm_logging.py:145)
03:58:27.983 [I] Progress on: 836it/100kit rate:2.3it/s remaining:12:02:48 elapsed:06:13 postfix:- (1756331:tqdm_logging.py:145)
03:58:38.267 [I] Progress on: 859it/100kit rate:2.3it/s remaining:12:02:53 elapsed:06:23 postfix:- (1756331:tqdm_logging.py:145)
03:58:48.320 [I] Progress on: 882it/100kit rate:2.3it/s remaining:12:01:21 elapsed:06:33 postfix:- (1756331:tqdm_logging.py:145)
Step 900: grad_norm=0.3442, loss=0.0203, param_norm=1379.7675
03:58:58.419 [I] Progress on: 905it/100kit rate:2.3it/s remaining:12:00:09 elapsed:06:43 postfix:- (1756331:tqdm_logging.py:145)
03:59:08.473 [I] Progress on: 928it/100kit rate:2.3it/s remaining:12:01:31 elapsed:06:53 postfix:- (1756331:tqdm_logging.py:145)
03:59:18.530 [I] Progress on: 951it/100kit rate:2.3it/s remaining:12:02:36 elapsed:07:03 postfix:- (1756331:tqdm_logging.py:145)
03:59:28.584 [I] Progress on: 974it/100kit rate:2.3it/s remaining:12:00:42 elapsed:07:13 postfix:- (1756331:tqdm_logging.py:145)
03:59:38.642 [I] Progress on: 997it/100kit rate:2.3it/s remaining:12:01:43 elapsed:07:23 postfix:- (1756331:tqdm_logging.py:145)
Step 1000: grad_norm=0.3233, loss=0.0189, param_norm=1379.7748
03:59:40.589 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (1756331:checkpoint_manager.py:1987)
03:59:40.589 [I] [process=0] Saving checkpoint at step 1000                                       (1756331:checkpoint_manager.py:1408)
03:59:40.590 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (1756331:async_checkpointer.py:439)
03:59:40.592 [I] Using ThreadSafeKeyValueSignalingClient                                          (1756331:signaling_client.py:332)
03:59:40.602 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 (1756331:atomicity.py:144)
03:59:40.608 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (1756331:atomicity.py:144)
03:59:40.608 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (1756331:atomicity.py:144)
03:59:40.608 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 (1756331:atomicity.py:144)
03:59:40.608 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762027180604753485, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1762027180604753485, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (1756331:checkpoint.py:186)
03:59:40.641 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (1756331:replica_slices.py:341)
03:59:45.919 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (1756331:replica_slices.py:341)
03:59:45.966 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2/array_metadatas/process_0 (1756331:array_metadata_store.py:198)
03:59:48.504 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 905.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: 7 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
03:59:48.522 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.3 GiB/s (total bytes: 10.5 GiB) (time elapsed: 7 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
03:59:48.527 [I] [process=0][thread=async_save] Background save thread started.                   (1756331:async_checkpointer.py:77)
03:59:48.527 [I] Finished blocking save in 7.94 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (1756331:async_checkpointer.py:548)
03:59:48.527 [I] [process=0][thread=MainThread][step=1000] Starting CheckpointManager Save Finalize thread=save_finalize (1756331:checkpoint_manager.py:1453)
03:59:48.528 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (1756331:async_checkpointer.py:258)
03:59:48.528 [I] {'step': 1000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762027180.5894947, 'wait_for_prev_duration_secs': 0.0001933574676513672, 'checkpointer_blocking_start_time': 1762027180.5900083, 'checkpointer_blocking_duration_secs': 7.937815189361572, 'get_old_steps_start_time': 1762027188.527849, 'get_old_steps_duration_secs': 4.76837158203125e-06, 'checkpoint_manager_blocking_start_time': 1762027180.5893903, 'checkpoint_manager_blocking_duration_secs': 7.939306259155273} (1756331:standard_logger.py:34)
03:59:48.582 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3/array_metadatas/process_0 (1756331:array_metadata_store.py:198)
03:59:49.771 [I] Progress on: 1.00kit/100kit rate:2.4s/it remaining:65:39:46 elapsed:07:35 postfix:- (1756331:tqdm_logging.py:145)
03:59:59.219 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 384.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: 18 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:00:00.120 [I] Progress on: 1.02kit/100kit rate:2.3it/s remaining:12:05:56 elapsed:07:45 postfix:- (1756331:tqdm_logging.py:145)
04:00:01.918 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 503.6 MiB/s (total bytes: 10.5 GiB) (time elapsed: 21 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:00:01.918 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (1756331:async_checkpointer.py:87)
04:00:01.920 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762027180604753485, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (1756331:checkpoint.py:226)
04:00:01.920 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets (1756331:atomicity.py:289)
04:00:01.925 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'train_state': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762027180604753485, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (1756331:checkpoint.py:245)
04:00:01.928 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (1756331:array_metadata_store.py:362)
04:00:01.954 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state (1756331:atomicity.py:289)
04:00:01.958 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (1756331:array_metadata_store.py:362)
04:00:01.980 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params (1756331:atomicity.py:289)
04:00:01.981 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (1756331:atomicity.py:289)
04:00:01.986 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000`. (1756331:atomicity.py:573)
04:00:01.986 [I] Finished asynchronous save (blocking + background) in 21.40 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (1756331:async_checkpointer.py:412)
04:00:01.986 [I] [process=0][thread=async_save] Background save thread done.                      (1756331:async_checkpointer.py:143)
04:00:01.986 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (1756331:async_checkpointer.py:266)
04:00:01.987 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (1756331:async_checkpointer.py:276)
04:00:01.987 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is syncing with other hosts... (1756331:checkpoint_manager.py:2095)
04:00:01.987 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is done on all hosts. (1756331:checkpoint_manager.py:2110)
04:00:10.182 [I] Progress on: 1.05kit/100kit rate:2.3it/s remaining:12:00:56 elapsed:07:55 postfix:- (1756331:tqdm_logging.py:145)
04:00:20.234 [I] Progress on: 1.07kit/100kit rate:2.3it/s remaining:12:00:10 elapsed:08:05 postfix:- (1756331:tqdm_logging.py:145)
04:00:30.289 [I] Progress on: 1.09kit/100kit rate:2.3it/s remaining:12:00:23 elapsed:08:15 postfix:- (1756331:tqdm_logging.py:145)
Step 1100: grad_norm=0.2981, loss=0.0193, param_norm=1379.7837
04:00:40.386 [I] Progress on: 1.11kit/100kit rate:2.3it/s remaining:12:00:05 elapsed:08:25 postfix:- (1756331:tqdm_logging.py:145)
04:00:50.443 [I] Progress on: 1.14kit/100kit rate:2.3it/s remaining:12:00:21 elapsed:08:35 postfix:- (1756331:tqdm_logging.py:145)
04:01:00.499 [I] Progress on: 1.16kit/100kit rate:2.3it/s remaining:12:00:24 elapsed:08:45 postfix:- (1756331:tqdm_logging.py:145)
04:01:10.555 [I] Progress on: 1.18kit/100kit rate:2.3it/s remaining:11:59:36 elapsed:08:55 postfix:- (1756331:tqdm_logging.py:145)
Step 1200: grad_norm=0.2679, loss=0.0167, param_norm=1379.7930
04:01:20.655 [I] Progress on: 1.21kit/100kit rate:2.3it/s remaining:11:58:56 elapsed:09:05 postfix:- (1756331:tqdm_logging.py:145)
04:01:30.712 [I] Progress on: 1.23kit/100kit rate:2.3it/s remaining:12:00:08 elapsed:09:15 postfix:- (1756331:tqdm_logging.py:145)
04:01:40.767 [I] Progress on: 1.25kit/100kit rate:2.3it/s remaining:11:59:57 elapsed:09:26 postfix:- (1756331:tqdm_logging.py:145)
04:01:51.034 [I] Progress on: 1.28kit/100kit rate:2.3it/s remaining:11:59:27 elapsed:09:36 postfix:- (1756331:tqdm_logging.py:145)
04:02:01.088 [I] Progress on: 1.30kit/100kit rate:2.3it/s remaining:11:58:40 elapsed:09:46 postfix:- (1756331:tqdm_logging.py:145)
Step 1300: grad_norm=0.2458, loss=0.0153, param_norm=1379.8015
04:02:11.188 [I] Progress on: 1.32kit/100kit rate:2.3it/s remaining:11:58:56 elapsed:09:56 postfix:- (1756331:tqdm_logging.py:145)
04:02:21.384 [I] Progress on: 1.34kit/100kit rate:2.3it/s remaining:12:02:15 elapsed:10:06 postfix:- (1756331:tqdm_logging.py:145)
04:02:31.446 [I] Progress on: 1.37kit/100kit rate:2.3it/s remaining:11:59:22 elapsed:10:16 postfix:- (1756331:tqdm_logging.py:145)
04:02:41.507 [I] Progress on: 1.39kit/100kit rate:2.3it/s remaining:11:58:54 elapsed:10:26 postfix:- (1756331:tqdm_logging.py:145)
Step 1400: grad_norm=0.3014, loss=0.0153, param_norm=1379.8105
04:02:51.610 [I] Progress on: 1.41kit/100kit rate:2.3it/s remaining:11:58:13 elapsed:10:36 postfix:- (1756331:tqdm_logging.py:145)
04:03:01.673 [I] Progress on: 1.44kit/100kit rate:2.3it/s remaining:11:59:05 elapsed:10:46 postfix:- (1756331:tqdm_logging.py:145)
04:03:11.733 [I] Progress on: 1.46kit/100kit rate:2.3it/s remaining:11:58:23 elapsed:10:57 postfix:- (1756331:tqdm_logging.py:145)
04:03:21.795 [I] Progress on: 1.48kit/100kit rate:2.3it/s remaining:11:58:29 elapsed:11:07 postfix:- (1756331:tqdm_logging.py:145)
Step 1500: grad_norm=0.2421, loss=0.0140, param_norm=1379.8198
04:03:31.900 [I] Progress on: 1.51kit/100kit rate:2.3it/s remaining:11:56:05 elapsed:11:17 postfix:- (1756331:tqdm_logging.py:145)
04:03:41.961 [I] Progress on: 1.53kit/100kit rate:2.3it/s remaining:11:57:50 elapsed:11:27 postfix:- (1756331:tqdm_logging.py:145)
04:03:52.022 [I] Progress on: 1.55kit/100kit rate:2.3it/s remaining:11:57:49 elapsed:11:37 postfix:- (1756331:tqdm_logging.py:145)
04:04:02.084 [I] Progress on: 1.57kit/100kit rate:2.3it/s remaining:11:57:03 elapsed:11:47 postfix:- (1756331:tqdm_logging.py:145)
04:04:12.145 [I] Progress on: 1.60kit/100kit rate:2.3it/s remaining:11:57:06 elapsed:11:57 postfix:- (1756331:tqdm_logging.py:145)
Step 1600: grad_norm=0.3567, loss=0.0145, param_norm=1379.8286
04:04:22.254 [I] Progress on: 1.62kit/100kit rate:2.3it/s remaining:11:57:10 elapsed:12:07 postfix:- (1756331:tqdm_logging.py:145)
04:04:32.316 [I] Progress on: 1.64kit/100kit rate:2.3it/s remaining:11:57:13 elapsed:12:17 postfix:- (1756331:tqdm_logging.py:145)
04:04:42.377 [I] Progress on: 1.67kit/100kit rate:2.3it/s remaining:11:57:02 elapsed:12:27 postfix:- (1756331:tqdm_logging.py:145)
04:04:52.651 [I] Progress on: 1.69kit/100kit rate:2.3it/s remaining:12:05:05 elapsed:12:37 postfix:- (1756331:tqdm_logging.py:145)
Step 1700: grad_norm=0.2245, loss=0.0123, param_norm=1379.8373
04:05:02.764 [I] Progress on: 1.71kit/100kit rate:2.3it/s remaining:11:56:49 elapsed:12:48 postfix:- (1756331:tqdm_logging.py:145)
04:05:12.831 [I] Progress on: 1.74kit/100kit rate:2.3it/s remaining:11:56:49 elapsed:12:58 postfix:- (1756331:tqdm_logging.py:145)
04:05:22.897 [I] Progress on: 1.76kit/100kit rate:2.3it/s remaining:11:56:21 elapsed:13:08 postfix:- (1756331:tqdm_logging.py:145)
04:05:32.964 [I] Progress on: 1.78kit/100kit rate:2.3it/s remaining:11:56:26 elapsed:13:18 postfix:- (1756331:tqdm_logging.py:145)
Step 1800: grad_norm=0.2181, loss=0.0115, param_norm=1379.8466
04:05:43.074 [I] Progress on: 1.80kit/100kit rate:2.3it/s remaining:11:54:08 elapsed:13:28 postfix:- (1756331:tqdm_logging.py:145)
04:05:53.140 [I] Progress on: 1.83kit/100kit rate:2.3it/s remaining:11:56:05 elapsed:13:38 postfix:- (1756331:tqdm_logging.py:145)
04:06:03.207 [I] Progress on: 1.85kit/100kit rate:2.3it/s remaining:11:55:57 elapsed:13:48 postfix:- (1756331:tqdm_logging.py:145)
04:06:13.275 [I] Progress on: 1.87kit/100kit rate:2.3it/s remaining:11:55:47 elapsed:13:58 postfix:- (1756331:tqdm_logging.py:145)
04:06:23.345 [I] Progress on: 1.90kit/100kit rate:2.3it/s remaining:11:55:50 elapsed:14:08 postfix:- (1756331:tqdm_logging.py:145)
Step 1900: grad_norm=0.2344, loss=0.0117, param_norm=1379.8551
04:06:33.453 [I] Progress on: 1.92kit/100kit rate:2.3it/s remaining:11:55:36 elapsed:14:18 postfix:- (1756331:tqdm_logging.py:145)
04:06:43.519 [I] Progress on: 1.94kit/100kit rate:2.3it/s remaining:11:55:19 elapsed:14:28 postfix:- (1756331:tqdm_logging.py:145)
04:06:53.582 [I] Progress on: 1.97kit/100kit rate:2.3it/s remaining:11:54:38 elapsed:14:38 postfix:- (1756331:tqdm_logging.py:145)
04:07:03.649 [I] Progress on: 1.99kit/100kit rate:2.3it/s remaining:11:54:23 elapsed:14:48 postfix:- (1756331:tqdm_logging.py:145)
Step 2000: grad_norm=0.2104, loss=0.0106, param_norm=1379.8644
04:07:09.096 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (1756331:checkpoint_manager.py:1987)
04:07:09.096 [I] [process=0] Saving checkpoint at step 2000                                       (1756331:checkpoint_manager.py:1408)
04:07:09.097 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (1756331:async_checkpointer.py:439)
04:07:09.105 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 (1756331:atomicity.py:144)
04:07:09.113 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 (1756331:atomicity.py:144)
04:07:09.115 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 (1756331:atomicity.py:144)
04:07:09.115 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 (1756331:atomicity.py:144)
04:07:09.132 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (1756331:replica_slices.py:341)
04:07:09.676 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (1756331:replica_slices.py:341)
04:07:09.697 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6/array_metadatas/process_0 (1756331:array_metadata_store.py:198)
04:07:11.569 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:07:11.585 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 4.2 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:07:11.589 [I] [process=0][thread=async_save] Background save thread started.                   (1756331:async_checkpointer.py:77)
04:07:11.590 [I] Finished blocking save in 2.49 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (1756331:async_checkpointer.py:548)
04:07:11.591 [I] Deleting Checkpoint[step=1000 | time=2025-11-01 19:59:48.527833+00:00]: (Reason: old checkpoint). (1756331:checkpoint_manager.py:1963)
04:07:11.591 [I] [process=0][thread=MainThread][step=2000] Starting CheckpointManager Save Finalize thread=save_finalize (1756331:checkpoint_manager.py:1453)
04:07:11.592 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (1756331:async_checkpointer.py:258)
04:07:11.592 [I] {'step': 2000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762027629.096426, 'wait_for_prev_duration_secs': 0.00018858909606933594, 'checkpointer_blocking_start_time': 1762027629.0969343, 'checkpointer_blocking_duration_secs': 2.4942712783813477, 'get_old_steps_start_time': 1762027631.5912304, 'get_old_steps_duration_secs': 0.0002446174621582031, 'checkpoint_manager_blocking_start_time': 1762027629.096304, 'checkpoint_manager_blocking_duration_secs': 2.4959840774536133} (1756331:standard_logger.py:34)
04:07:11.635 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7/array_metadatas/process_0 (1756331:array_metadata_store.py:198)
04:07:14.005 [I] Progress on: 2.01kit/100kit rate:1.7it/s remaining:15:47:12 elapsed:14:59 postfix:- (1756331:tqdm_logging.py:145)
04:07:24.014 [I] Progress on: 2.02kit/100kit rate:2.2it/s remaining:12:26:12 elapsed:15:09 postfix:- (1756331:tqdm_logging.py:145)
04:07:25.011 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 450.3 MiB/s (total bytes: 7.0 GiB) (time elapsed: 15 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:07:25.011 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 675.0 MiB/s (total bytes: 10.5 GiB) (time elapsed: 15 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:07:25.011 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (1756331:async_checkpointer.py:87)
04:07:25.012 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets (1756331:atomicity.py:289)
04:07:25.017 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (1756331:array_metadata_store.py:362)
04:07:25.044 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state (1756331:atomicity.py:289)
04:07:25.048 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (1756331:array_metadata_store.py:362)
04:07:25.158 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params (1756331:atomicity.py:289)
04:07:25.159 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (1756331:atomicity.py:289)
04:07:25.164 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000`. (1756331:atomicity.py:573)
04:07:25.164 [I] Finished asynchronous save (blocking + background) in 16.07 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (1756331:async_checkpointer.py:412)
04:07:25.164 [I] [process=0][thread=async_save] Background save thread done.                      (1756331:async_checkpointer.py:143)
04:07:25.164 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (1756331:async_checkpointer.py:266)
04:07:25.164 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (1756331:async_checkpointer.py:276)
04:07:25.768 [I] Deleted step 1000.                                                               (1756331:deleter.py:114)
04:07:25.768 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is syncing with other hosts... (1756331:checkpoint_manager.py:2095)
04:07:25.768 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is done on all hosts. (1756331:checkpoint_manager.py:2110)
04:07:34.077 [I] Progress on: 2.05kit/100kit rate:2.3it/s remaining:11:53:42 elapsed:15:19 postfix:- (1756331:tqdm_logging.py:145)
04:07:44.140 [I] Progress on: 2.07kit/100kit rate:2.3it/s remaining:11:54:28 elapsed:15:29 postfix:- (1756331:tqdm_logging.py:145)
04:07:54.198 [I] Progress on: 2.09kit/100kit rate:2.3it/s remaining:11:53:48 elapsed:15:39 postfix:- (1756331:tqdm_logging.py:145)
Step 2100: grad_norm=0.2077, loss=0.0106, param_norm=1379.8728
04:08:04.558 [I] Progress on: 2.12kit/100kit rate:2.2it/s remaining:12:06:11 elapsed:15:49 postfix:- (1756331:tqdm_logging.py:145)
04:08:14.574 [I] Progress on: 2.14kit/100kit rate:2.3it/s remaining:11:41:10 elapsed:15:59 postfix:- (1756331:tqdm_logging.py:145)
04:08:24.672 [I] Progress on: 2.16kit/100kit rate:2.3it/s remaining:12:04:23 elapsed:16:09 postfix:- (1756331:tqdm_logging.py:145)
04:08:34.689 [I] Progress on: 2.19kit/100kit rate:2.3it/s remaining:11:41:13 elapsed:16:19 postfix:- (1756331:tqdm_logging.py:145)
Step 2200: grad_norm=0.3199, loss=0.0123, param_norm=1379.8813
04:08:44.855 [I] Progress on: 2.21kit/100kit rate:2.2it/s remaining:12:04:39 elapsed:16:30 postfix:- (1756331:tqdm_logging.py:145)
04:08:54.869 [I] Progress on: 2.23kit/100kit rate:2.3it/s remaining:11:40:43 elapsed:16:40 postfix:- (1756331:tqdm_logging.py:145)
04:09:04.964 [I] Progress on: 2.25kit/100kit rate:2.3it/s remaining:12:03:46 elapsed:16:50 postfix:- (1756331:tqdm_logging.py:145)
04:09:14.978 [I] Progress on: 2.28kit/100kit rate:2.3it/s remaining:11:40:17 elapsed:17:00 postfix:- (1756331:tqdm_logging.py:145)
Step 2300: grad_norm=0.1833, loss=0.0097, param_norm=1379.8901
04:09:25.215 [I] Progress on: 2.30kit/100kit rate:2.3it/s remaining:11:40:13 elapsed:17:10 postfix:- (1756331:tqdm_logging.py:145)
04:09:35.630 [I] Progress on: 2.33kit/100kit rate:2.3it/s remaining:12:03:23 elapsed:17:20 postfix:- (1756331:tqdm_logging.py:145)
04:09:45.798 [I] Progress on: 2.35kit/100kit rate:2.3it/s remaining:11:54:34 elapsed:17:31 postfix:- (1756331:tqdm_logging.py:145)
04:09:55.861 [I] Progress on: 2.37kit/100kit rate:2.3it/s remaining:11:51:27 elapsed:17:41 postfix:- (1756331:tqdm_logging.py:145)
04:10:05.928 [I] Progress on: 2.39kit/100kit rate:2.3it/s remaining:11:51:59 elapsed:17:51 postfix:- (1756331:tqdm_logging.py:145)
Step 2400: grad_norm=0.1912, loss=0.0096, param_norm=1379.8989
04:10:16.039 [I] Progress on: 2.42kit/100kit rate:2.3it/s remaining:11:51:34 elapsed:18:01 postfix:- (1756331:tqdm_logging.py:145)
04:10:26.102 [I] Progress on: 2.44kit/100kit rate:2.3it/s remaining:11:51:06 elapsed:18:11 postfix:- (1756331:tqdm_logging.py:145)
04:10:36.164 [I] Progress on: 2.46kit/100kit rate:2.3it/s remaining:11:50:44 elapsed:18:21 postfix:- (1756331:tqdm_logging.py:145)
04:10:46.229 [I] Progress on: 2.49kit/100kit rate:2.3it/s remaining:11:51:35 elapsed:18:31 postfix:- (1756331:tqdm_logging.py:145)
Step 2500: grad_norm=0.1873, loss=0.0091, param_norm=1379.9071
04:10:56.338 [I] Progress on: 2.51kit/100kit rate:2.3it/s remaining:11:50:01 elapsed:18:41 postfix:- (1756331:tqdm_logging.py:145)
04:11:06.621 [I] Progress on: 2.53kit/100kit rate:2.3it/s remaining:12:00:41 elapsed:18:51 postfix:- (1756331:tqdm_logging.py:145)
04:11:16.683 [I] Progress on: 2.56kit/100kit rate:2.3it/s remaining:11:50:54 elapsed:19:01 postfix:- (1756331:tqdm_logging.py:145)
04:11:26.746 [I] Progress on: 2.58kit/100kit rate:2.3it/s remaining:11:50:11 elapsed:19:12 postfix:- (1756331:tqdm_logging.py:145)
Step 2600: grad_norm=0.1907, loss=0.0097, param_norm=1379.9152
04:11:36.973 [I] Progress on: 2.60kit/100kit rate:2.3it/s remaining:11:50:17 elapsed:19:22 postfix:- (1756331:tqdm_logging.py:145)
04:11:47.355 [I] Progress on: 2.62kit/100kit rate:2.3it/s remaining:11:49:44 elapsed:19:32 postfix:- (1756331:tqdm_logging.py:145)
04:11:57.420 [I] Progress on: 2.65kit/100kit rate:2.3it/s remaining:11:49:51 elapsed:19:42 postfix:- (1756331:tqdm_logging.py:145)
04:12:07.485 [I] Progress on: 2.67kit/100kit rate:2.3it/s remaining:11:49:39 elapsed:19:52 postfix:- (1756331:tqdm_logging.py:145)
04:12:17.550 [I] Progress on: 2.69kit/100kit rate:2.3it/s remaining:11:50:39 elapsed:20:02 postfix:- (1756331:tqdm_logging.py:145)
Step 2700: grad_norm=0.1929, loss=0.0092, param_norm=1379.9237
04:12:27.653 [I] Progress on: 2.72kit/100kit rate:2.3it/s remaining:11:48:54 elapsed:20:12 postfix:- (1756331:tqdm_logging.py:145)
04:12:37.716 [I] Progress on: 2.74kit/100kit rate:2.3it/s remaining:11:49:30 elapsed:20:23 postfix:- (1756331:tqdm_logging.py:145)
04:12:47.780 [I] Progress on: 2.76kit/100kit rate:2.3it/s remaining:11:49:26 elapsed:20:33 postfix:- (1756331:tqdm_logging.py:145)
04:12:57.842 [I] Progress on: 2.79kit/100kit rate:2.3it/s remaining:11:48:57 elapsed:20:43 postfix:- (1756331:tqdm_logging.py:145)
Step 2800: grad_norm=0.1856, loss=0.0087, param_norm=1379.9321
04:13:07.948 [I] Progress on: 2.81kit/100kit rate:2.3it/s remaining:11:48:06 elapsed:20:53 postfix:- (1756331:tqdm_logging.py:145)
04:13:18.012 [I] Progress on: 2.83kit/100kit rate:2.3it/s remaining:11:48:44 elapsed:21:03 postfix:- (1756331:tqdm_logging.py:145)
04:13:28.076 [I] Progress on: 2.85kit/100kit rate:2.3it/s remaining:11:47:46 elapsed:21:13 postfix:- (1756331:tqdm_logging.py:145)
04:13:38.140 [I] Progress on: 2.88kit/100kit rate:2.3it/s remaining:11:47:54 elapsed:21:23 postfix:- (1756331:tqdm_logging.py:145)
Step 2900: grad_norm=0.2678, loss=0.0095, param_norm=1379.9406
04:13:48.370 [I] Progress on: 2.90kit/100kit rate:2.3it/s remaining:11:47:50 elapsed:21:33 postfix:- (1756331:tqdm_logging.py:145)
04:13:58.754 [I] Progress on: 2.92kit/100kit rate:2.3it/s remaining:11:48:33 elapsed:21:44 postfix:- (1756331:tqdm_logging.py:145)
04:14:09.032 [I] Progress on: 2.95kit/100kit rate:2.1it/s remaining:12:40:30 elapsed:21:54 postfix:- (1756331:tqdm_logging.py:145)
04:14:19.114 [I] Progress on: 2.97kit/100kit rate:2.2it/s remaining:11:59:19 elapsed:22:04 postfix:- (1756331:tqdm_logging.py:145)
04:14:29.137 [I] Progress on: 2.99kit/100kit rate:2.3it/s remaining:11:35:57 elapsed:22:14 postfix:- (1756331:tqdm_logging.py:145)
Step 3000: grad_norm=0.1758, loss=0.0083, param_norm=1379.9486
04:14:32.537 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (1756331:checkpoint_manager.py:1987)
04:14:32.538 [I] [process=0] Saving checkpoint at step 3000                                       (1756331:checkpoint_manager.py:1408)
04:14:32.538 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000. (1756331:async_checkpointer.py:439)
04:14:32.546 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8 (1756331:atomicity.py:144)
04:14:32.554 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10 (1756331:atomicity.py:144)
04:14:32.555 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets.orbax-checkpoint-tmp-9 (1756331:atomicity.py:144)
04:14:32.555 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11 (1756331:atomicity.py:144)
04:14:32.573 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (1756331:replica_slices.py:341)
04:14:33.216 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (1756331:replica_slices.py:341)
04:14:33.238 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10/array_metadatas/process_0 (1756331:array_metadata_store.py:198)
04:14:35.054 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:14:35.074 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 4.2 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:14:35.078 [I] [process=0][thread=async_save] Background save thread started.                   (1756331:async_checkpointer.py:77)
04:14:35.078 [I] Finished blocking save in 2.54 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000. (1756331:async_checkpointer.py:548)
04:14:35.079 [I] Deleting Checkpoint[step=2000 | time=2025-11-01 20:07:11.591216+00:00]: (Reason: old checkpoint). (1756331:checkpoint_manager.py:1963)
04:14:35.079 [I] [process=0][thread=MainThread][step=3000] Starting CheckpointManager Save Finalize thread=save_finalize (1756331:checkpoint_manager.py:1453)
04:14:35.080 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (1756331:async_checkpointer.py:258)
04:14:35.081 [I] {'step': 3000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762028072.5377219, 'wait_for_prev_duration_secs': 0.00020837783813476562, 'checkpointer_blocking_start_time': 1762028072.5382156, 'checkpointer_blocking_duration_secs': 2.541215419769287, 'get_old_steps_start_time': 1762028075.0794513, 'get_old_steps_duration_secs': 0.0003342628479003906, 'checkpoint_manager_blocking_start_time': 1762028072.5376, 'checkpoint_manager_blocking_duration_secs': 2.543456792831421} (1756331:standard_logger.py:34)
04:14:35.115 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11/array_metadatas/process_0 (1756331:array_metadata_store.py:198)
04:14:39.526 [I] Progress on: 3.01kit/100kit rate:2.1it/s remaining:12:35:32 elapsed:22:24 postfix:- (1756331:tqdm_logging.py:145)
04:14:47.242 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 487.3 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:14:47.587 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 713.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: 15 seconds) (per-host) (1756331:base_pytree_checkpoint_handler.py:114)
04:14:47.587 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (1756331:async_checkpointer.py:87)
04:14:47.589 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets.orbax-checkpoint-tmp-9 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets (1756331:atomicity.py:289)
04:14:47.594 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (1756331:array_metadata_store.py:362)
04:14:47.625 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state (1756331:atomicity.py:289)
04:14:47.630 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (1756331:array_metadata_store.py:362)
04:14:47.765 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params (1756331:atomicity.py:289)
04:14:47.767 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000 (1756331:atomicity.py:289)
04:14:47.771 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000`. (1756331:atomicity.py:573)
04:14:47.771 [I] Finished asynchronous save (blocking + background) in 15.23 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000 (1756331:async_checkpointer.py:412)
04:14:47.771 [I] [process=0][thread=async_save] Background save thread done.                      (1756331:async_checkpointer.py:143)
04:14:47.771 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (1756331:async_checkpointer.py:266)
04:14:47.771 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (1756331:async_checkpointer.py:276)
04:14:48.379 [I] Deleted step 2000.                                                               (1756331:deleter.py:114)
04:14:48.379 [I] [process=0][thread=save_finalize][step=3000] CheckpointManager Save Finalize is syncing with other hosts... (1756331:checkpoint_manager.py:2095)
04:14:48.380 [I] [process=0][thread=save_finalize][step=3000] CheckpointManager Save Finalize is done on all hosts. (1756331:checkpoint_manager.py:2110)
04:14:49.903 [I] Progress on: 3.03kit/100kit rate:2.3it/s remaining:11:48:22 elapsed:22:35 postfix:- (1756331:tqdm_logging.py:145)
04:14:59.967 [I] Progress on: 3.05kit/100kit rate:2.3it/s remaining:11:47:34 elapsed:22:45 postfix:- (1756331:tqdm_logging.py:145)
04:15:10.029 [I] Progress on: 3.08kit/100kit rate:2.3it/s remaining:11:46:38 elapsed:22:55 postfix:- (1756331:tqdm_logging.py:145)
04:15:20.096 [I] Progress on: 3.10kit/100kit rate:2.3it/s remaining:11:46:55 elapsed:23:05 postfix:- (1756331:tqdm_logging.py:145)
Step 3100: grad_norm=0.1819, loss=0.0079, param_norm=1379.9567
04:15:30.196 [I] Progress on: 3.12kit/100kit rate:2.3it/s remaining:11:45:54 elapsed:23:15 postfix:- (1756331:tqdm_logging.py:145)
04:15:40.251 [I] Progress on: 3.15kit/100kit rate:2.3it/s remaining:11:45:41 elapsed:23:25 postfix:- (1756331:tqdm_logging.py:145)
04:15:50.310 [I] Progress on: 3.17kit/100kit rate:2.3it/s remaining:11:45:18 elapsed:23:35 postfix:- (1756331:tqdm_logging.py:145)
04:16:00.367 [I] Progress on: 3.19kit/100kit rate:2.3it/s remaining:11:45:37 elapsed:23:45 postfix:- (1756331:tqdm_logging.py:145)
Step 3200: grad_norm=0.2092, loss=0.0087, param_norm=1379.9651
04:16:10.467 [I] Progress on: 3.21kit/100kit rate:2.3it/s remaining:11:45:01 elapsed:23:55 postfix:- (1756331:tqdm_logging.py:145)
04:16:20.525 [I] Progress on: 3.24kit/100kit rate:2.3it/s remaining:11:45:44 elapsed:24:05 postfix:- (1756331:tqdm_logging.py:145)
slurmstepd: error: *** JOB 311898 ON dgx-01 CANCELLED AT 2025-11-02T04:16:29 DUE TO PREEMPTION ***
Sun Nov  2 16:00:58 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H800                    On  |   00000000:43:00.0 Off |                    0 |
| N/A   27C    P0            106W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H800                    On  |   00000000:52:00.0 Off |                    0 |
| N/A   29C    P0             69W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H800                    On  |   00000000:61:00.0 Off |                    0 |
| N/A   32C    P0             69W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H800                    On  |   00000000:C3:00.0 Off |                    0 |
| N/A   22C    P0             70W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
0,1,2,3
warning: The `tool.uv.dev-dependencies` field (used in `packages/openpi-client/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
16:01:28.647 [I] Running on: dgx-54                                                               (2155867:train.py:196)
INFO:2025-11-02 16:01:30,569:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
16:01:30.569 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (2155867:xla_bridge.py:925)
INFO:2025-11-02 16:01:30,576:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
16:01:30.576 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (2155867:xla_bridge.py:925)
16:01:32.056 [I] Wiped checkpoint directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2155867:checkpoints.py:29)
16:01:32.057 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b2f83490> (2155867:base_pytree_checkpoint_handler.py:334)
16:01:32.057 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b2f83490> (2155867:base_pytree_checkpoint_handler.py:334)
16:01:32.057 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (2155867:multihost.py:390)
16:01:32.057 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x15532ba7b190>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba7abd0>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bb3b310>}, handler_registry=None (2155867:checkpoint_manager.py:620)
16:01:32.057 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x15532ba7b190>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (2155867:composite_checkpoint_handler.py:234)
16:01:32.058 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba7abd0>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2155867:composite_checkpoint_handler.py:234)
16:01:32.058 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bb3b310>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2155867:composite_checkpoint_handler.py:234)
16:01:32.058 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532c9ccc10>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (2155867:composite_checkpoint_handler.py:234)
16:01:32.058 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x15532ba7b190>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x15532ba7b190>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba7abd0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba7abd0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bb3b310>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532bb3b310>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532c9ccc10>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532c9ccc10>}). (2155867:composite_checkpoint_handler.py:502)
16:01:32.058 [I] orbax-checkpoint version: 0.11.13                                                (2155867:abstract_checkpointer.py:35)
16:01:32.058 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x15532bef80e0> timeout: 7200 secs and primary_host=0 for async checkpoint writes (2155867:async_checkpointer.py:170)
16:01:32.059 [I] Found 0 checkpoint steps in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2155867:checkpoint_manager.py:1701)
16:01:32.059 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=True), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, prevent_write_metrics=False), root_directory=/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x15532ba951d0> (2155867:checkpoint_manager.py:801)
wandb: Currently logged in as: heisen0928 (heisen0928-the-hong-kong-polytechnic-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/wandb/run-20251102_160132-6moz99i4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run real
wandb: ‚≠êÔ∏è View project at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi
wandb: üöÄ View run at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/6moz99i4
16:01:34.073 [I] Loaded norm stats from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/assets/pi0_base_piper/aloha_sweeping (2155867:config.py:196)
16:01:34.074 [I] data_config: DataConfig(repo_id='aloha_sweeping', asset_id='aloha_sweeping', norm_stats={'state': NormStats(mean=array([ 0.47424394,  1.93239212, -1.21354711,  0.02150275,  0.90646011,
        0.49164048,  0.05461168]), std=array([0.17103249, 0.14320549, 0.25212812, 0.05638926, 0.14822352,
       0.11071946, 0.00993702]), q01=array([ 0.25117052,  1.69599698, -1.85752935, -0.0792199 ,  0.65580877,
        0.27204885,  0.0458824 ]), q99=array([ 0.82077601,  2.30108927, -0.91839277,  0.18234723,  1.21471596,
        0.7448781 ,  0.08129722])), 'actions': NormStats(mean=array([-0.0244057 , -0.00734879,  0.04024221,  0.0005264 , -0.03342618,
       -0.02444903,  0.03626091]), std=array([0.16685677, 0.14164105, 0.26111194, 0.04983826, 0.14566314,
       0.10277452, 0.03212533]), q01=array([-4.92804351e-01, -4.31920097e-01, -5.53970138e-01, -1.66209970e-01,
       -4.47979820e-01, -3.10425970e-01, -3.49400386e-05]), q99=array([0.26887509, 0.26059457, 0.77529773, 0.10606248, 0.26833984,
       0.21120921, 0.08889262]))}, repack_transforms=Group(inputs=[RepackTransform(structure={'images': {'cam_high': 'observation.images.cam_high', 'cam_right_wrist': 'observation.images.cam_right_wrist'}, 'state': 'observation.state', 'actions': 'action', 'prompt': 'prompt'})], outputs=()), data_transforms=Group(inputs=(PiperInputs(adapt_to_pi=False), DeltaActions(mask=(True, True, True, True, True, True, False))), outputs=(AbsoluteActions(mask=(True, True, True, True, True, True, False)), PiperOutputs(adapt_to_pi=False))), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizePrompt(tokenizer=<openpi.models.tokenizer.PaligemmaTokenizer object at 0x15532bc438d0>, discrete_state_input=False), PadStatesAndActions(model_action_dim=32)], outputs=()), use_quantile_norm=False, action_sequence_keys=('action',), prompt_from_task=True, rlds_data_dir=None, action_space=None, filter_dict_path=None) (2155867:data_loader.py:243)
16:01:35.288 [I] local_batch_size: 32                                                             (2155867:data_loader.py:324)
16:01:56.099 [I] Initialized data loader:
[0].images['base_0_rgb']: (32, 224, 224, 3)@float32
[0].images['left_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].images['right_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (32,)@bool
[0].image_masks['left_wrist_0_rgb']: (32,)@bool
[0].image_masks['right_wrist_0_rgb']: (32,)@bool
[0].state: (32, 32)@float32
[0].tokenized_prompt: (32, 48)@int32
[0].tokenized_prompt_mask: (32, 48)@bool
[1]: (32, 50, 32)@float32 (2155867:train.py:227)
16:01:58.606 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.606 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.606 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.606 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['embedder']['input_embedding'].value of shape (257152, 2048) (1004.50 MiB) along axis 0 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value of shape (18, 8, 256, 2048) (144.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value of shape (18, 8, 256, 1024) (72.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value of shape (18, 2, 1, 2048, 256) (36.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value of shape (18, 2, 1, 1024, 256) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.607 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value of shape (18, 8, 2048, 256) (144.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value of shape (18, 8, 1024, 256) (72.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value of shape (18, 2, 2048, 16384) (2304.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['linear'].value of shape (18, 16384, 2048) (1152.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value of shape (18, 2, 1024, 4096) (288.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['linear'].value of shape (18, 4096, 1024) (144.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (2155867:sharding.py:89)
16:01:58.608 [I] Sharding .params['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.609 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].mu['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.610 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.611 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.611 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.611 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.611 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.611 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.611 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.611 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .opt_state[1][0].nu['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.612 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['embedder']['input_embedding'].value of shape (257152, 2048) (1004.50 MiB) along axis 0 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value of shape (18, 8, 256, 2048) (144.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value of shape (18, 8, 256, 1024) (72.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value of shape (18, 2, 1, 2048, 256) (36.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.613 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value of shape (18, 2, 1, 1024, 256) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value of shape (18, 8, 2048, 256) (144.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value of shape (18, 8, 1024, 256) (72.00 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value of shape (18, 2, 2048, 16384) (2304.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['linear'].value of shape (18, 16384, 2048) (1152.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value of shape (18, 2, 1024, 4096) (288.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['linear'].value of shape (18, 4096, 1024) (144.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.614 [I] Sharding .ema_params['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (2155867:sharding.py:89)
16:01:58.615 [I] Sharding .ema_params['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (2155867:sharding.py:89)
16:01:58.621 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b2f83490> (2155867:base_pytree_checkpoint_handler.py:334)
16:01:58.651 [I] Restoring checkpoint from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2155867:checkpointer.py:298)
16:02:06.123 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 1.6 GiB/s (total bytes: 12.1 GiB) (time elapsed: 7 seconds) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:02:06.124 [I] Finished restoring checkpoint in 7.47 seconds from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2155867:checkpointer.py:309)
/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/.venv/lib/python3.11/site-packages/jax/_src/interpreters/mlir.py:1178: UserWarning: Some donated buffers were not usable: ShapedArray(float32[27,1152,4304]), ShapedArray(float32[27,4304,1152]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[27,16,72,1152]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[1152,2048]), ShapedArray(bfloat16[257152,2048]), ShapedArray(bfloat16[18,8,256,2048]), ShapedArray(bfloat16[18,8,256,1024]), ShapedArray(bfloat16[18,2,1,2048,256]), ShapedArray(bfloat16[18,2,1,1024,256]), ShapedArray(bfloat16[18,8,2048,256]), ShapedArray(bfloat16[18,8,1024,256]), ShapedArray(bfloat16[18,2,2048,16384]), ShapedArray(bfloat16[18,16384,2048]), ShapedArray(bfloat16[18,2,1024,4096]), ShapedArray(bfloat16[18,4096,1024]), ShapedArray(float32[2048,1024]), ShapedArray(float32[1024,1024]).
See an explanation at https://jax.readthedocs.io/en/latest/faq.html#buffer-donation.
  warnings.warn("Some donated buffers were not usable:"
16:02:38.066 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@float32
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@float32
['PaliGemma']['img']['head']['bias'].value: (2048,)@float32
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@float32
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@float32
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@bfloat16
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@bfloat16
['PaliGemma']['llm']['final_norm_1']['scale'].value: (1024,)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_a'].value: (18, 8, 256, 16)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value: (18, 8, 16, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value: (18, 8, 256, 32)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value: (18, 8, 32, 1024)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value: (18, 8, 256, 1024)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value: (18, 2, 1, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_b'].value: (18, 2, 1, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value: (18, 2, 1, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_b'].value: (18, 2, 1, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value: (18, 2, 1, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value: (18, 8, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_b'].value: (18, 8, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value: (18, 8, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value: (18, 8, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value: (18, 8, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value: (18, 2, 2048, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value: (18, 2, 16, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value: (18, 16384, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['linear_lora_b'].value: (18, 16, 2048)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value: (18, 2, 1024, 4096)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value: (18, 2, 1024, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value: (18, 2, 32, 4096)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear'].value: (18, 4096, 1024)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value: (18, 4096, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_b'].value: (18, 32, 1024)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['scale'].value: (18, 1024)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['scale'].value: (18, 1024)@bfloat16
['action_in_proj']['bias'].value: (1024,)@float32
['action_in_proj']['kernel'].value: (32, 1024)@float32
['action_out_proj']['bias'].value: (32,)@float32
['action_out_proj']['kernel'].value: (1024, 32)@float32
['action_time_mlp_in']['bias'].value: (1024,)@float32
['action_time_mlp_in']['kernel'].value: (2048, 1024)@float32
['action_time_mlp_out']['bias'].value: (1024,)@float32
['action_time_mlp_out']['kernel'].value: (1024, 1024)@float32
['state_proj']['bias'].value: (1024,)@float32
['state_proj']['kernel'].value: (32, 1024)@float32 (2155867:train.py:238)
16:02:38.075 [I] Progress on: -/100000 rate:- remaining:? elapsed:00:00 postfix:-                 (2155867:tqdm_logging.py:145)
Step 0: grad_norm=1.6388, loss=0.1104, param_norm=1379.7465
16:02:48.200 [I] Progress on: 7.00it/100kit rate:1.4it/s remaining:20:16:43 elapsed:00:10 postfix:- (2155867:tqdm_logging.py:145)
16:02:58.548 [I] Progress on: 29.0it/100kit rate:2.1it/s remaining:13:02:53 elapsed:00:20 postfix:- (2155867:tqdm_logging.py:145)
16:03:08.907 [I] Progress on: 51.0it/100kit rate:2.1it/s remaining:13:04:06 elapsed:00:30 postfix:- (2155867:tqdm_logging.py:145)
16:03:19.258 [I] Progress on: 73.0it/100kit rate:2.1it/s remaining:13:02:36 elapsed:00:41 postfix:- (2155867:tqdm_logging.py:145)
16:03:29.609 [I] Progress on: 95.0it/100kit rate:2.1it/s remaining:13:02:36 elapsed:00:51 postfix:- (2155867:tqdm_logging.py:145)
Step 100: grad_norm=0.9854, loss=0.0749, param_norm=1379.7463
16:03:39.616 [I] Progress on: 116it/100kit rate:2.1it/s remaining:13:03:32 elapsed:01:01 postfix:- (2155867:tqdm_logging.py:145)
16:03:49.970 [I] Progress on: 138it/100kit rate:2.1it/s remaining:13:02:53 elapsed:01:11 postfix:- (2155867:tqdm_logging.py:145)
16:04:00.325 [I] Progress on: 160it/100kit rate:2.1it/s remaining:13:03:54 elapsed:01:22 postfix:- (2155867:tqdm_logging.py:145)
16:04:10.682 [I] Progress on: 182it/100kit rate:2.1it/s remaining:13:03:34 elapsed:01:32 postfix:- (2155867:tqdm_logging.py:145)
Step 200: grad_norm=0.5288, loss=0.0382, param_norm=1379.7466
16:04:21.077 [I] Progress on: 204it/100kit rate:2.1it/s remaining:12:59:06 elapsed:01:43 postfix:- (2155867:tqdm_logging.py:145)
16:04:31.427 [I] Progress on: 226it/100kit rate:2.1it/s remaining:13:03:10 elapsed:01:53 postfix:- (2155867:tqdm_logging.py:145)
16:04:41.783 [I] Progress on: 248it/100kit rate:2.1it/s remaining:13:03:05 elapsed:02:03 postfix:- (2155867:tqdm_logging.py:145)
16:04:52.138 [I] Progress on: 270it/100kit rate:2.1it/s remaining:13:03:01 elapsed:02:14 postfix:- (2155867:tqdm_logging.py:145)
16:05:02.490 [I] Progress on: 292it/100kit rate:2.1it/s remaining:13:02:28 elapsed:02:24 postfix:- (2155867:tqdm_logging.py:145)
Step 300: grad_norm=0.4396, loss=0.0297, param_norm=1379.7469
16:05:12.884 [I] Progress on: 314it/100kit rate:2.1it/s remaining:13:02:21 elapsed:02:34 postfix:- (2155867:tqdm_logging.py:145)
16:05:23.236 [I] Progress on: 336it/100kit rate:2.1it/s remaining:13:02:02 elapsed:02:45 postfix:- (2155867:tqdm_logging.py:145)
16:05:33.595 [I] Progress on: 358it/100kit rate:2.1it/s remaining:13:04:18 elapsed:02:55 postfix:- (2155867:tqdm_logging.py:145)
16:05:43.945 [I] Progress on: 380it/100kit rate:2.1it/s remaining:13:01:58 elapsed:03:05 postfix:- (2155867:tqdm_logging.py:145)
Step 400: grad_norm=0.4162, loss=0.0263, param_norm=1379.7478
16:05:54.002 [I] Progress on: 400it/100kit rate:2.1it/s remaining:13:01:27 elapsed:03:15 postfix:- (2155867:tqdm_logging.py:145)
16:06:04.424 [I] Progress on: 423it/100kit rate:2.0it/s remaining:13:33:30 elapsed:03:26 postfix:- (2155867:tqdm_logging.py:145)
16:06:14.775 [I] Progress on: 445it/100kit rate:2.1it/s remaining:13:00:35 elapsed:03:36 postfix:- (2155867:tqdm_logging.py:145)
16:06:25.126 [I] Progress on: 467it/100kit rate:2.1it/s remaining:13:00:12 elapsed:03:47 postfix:- (2155867:tqdm_logging.py:145)
16:06:35.481 [I] Progress on: 489it/100kit rate:2.1it/s remaining:13:00:14 elapsed:03:57 postfix:- (2155867:tqdm_logging.py:145)
Step 500: grad_norm=0.3969, loss=0.0246, param_norm=1379.7496
16:06:45.879 [I] Progress on: 511it/100kit rate:2.1it/s remaining:12:59:50 elapsed:04:07 postfix:- (2155867:tqdm_logging.py:145)
16:06:56.236 [I] Progress on: 533it/100kit rate:2.1it/s remaining:12:59:38 elapsed:04:18 postfix:- (2155867:tqdm_logging.py:145)
16:07:06.589 [I] Progress on: 555it/100kit rate:2.1it/s remaining:12:59:32 elapsed:04:28 postfix:- (2155867:tqdm_logging.py:145)
16:07:16.937 [I] Progress on: 577it/100kit rate:2.1it/s remaining:12:58:31 elapsed:04:38 postfix:- (2155867:tqdm_logging.py:145)
16:07:27.291 [I] Progress on: 599it/100kit rate:2.1it/s remaining:12:58:41 elapsed:04:49 postfix:- (2155867:tqdm_logging.py:145)
Step 600: grad_norm=0.4304, loss=0.0240, param_norm=1379.7522
16:07:37.683 [I] Progress on: 621it/100kit rate:2.1it/s remaining:12:58:51 elapsed:04:59 postfix:- (2155867:tqdm_logging.py:145)
16:07:47.716 [I] Progress on: 642it/100kit rate:2.1it/s remaining:13:01:59 elapsed:05:09 postfix:- (2155867:tqdm_logging.py:145)
16:07:58.067 [I] Progress on: 664it/100kit rate:2.1it/s remaining:12:59:26 elapsed:05:19 postfix:- (2155867:tqdm_logging.py:145)
16:08:08.421 [I] Progress on: 686it/100kit rate:2.1it/s remaining:12:59:26 elapsed:05:30 postfix:- (2155867:tqdm_logging.py:145)
Step 700: grad_norm=0.4416, loss=0.0227, param_norm=1379.7562
16:08:18.817 [I] Progress on: 708it/100kit rate:2.1it/s remaining:12:58:40 elapsed:05:40 postfix:- (2155867:tqdm_logging.py:145)
16:08:29.172 [I] Progress on: 730it/100kit rate:2.1it/s remaining:12:59:46 elapsed:05:51 postfix:- (2155867:tqdm_logging.py:145)
16:08:39.524 [I] Progress on: 752it/100kit rate:2.1it/s remaining:12:58:53 elapsed:06:01 postfix:- (2155867:tqdm_logging.py:145)
16:08:49.885 [I] Progress on: 774it/100kit rate:2.1it/s remaining:13:00:39 elapsed:06:11 postfix:- (2155867:tqdm_logging.py:145)
16:09:00.237 [I] Progress on: 796it/100kit rate:2.1it/s remaining:12:59:08 elapsed:06:22 postfix:- (2155867:tqdm_logging.py:145)
Step 800: grad_norm=0.3528, loss=0.0219, param_norm=1379.7614
16:09:10.633 [I] Progress on: 818it/100kit rate:2.1it/s remaining:13:00:29 elapsed:06:32 postfix:- (2155867:tqdm_logging.py:145)
16:09:20.981 [I] Progress on: 840it/100kit rate:2.1it/s remaining:12:57:55 elapsed:06:42 postfix:- (2155867:tqdm_logging.py:145)
16:09:31.059 [I] Progress on: 861it/100kit rate:2.2it/s remaining:12:46:52 elapsed:06:52 postfix:- (2155867:tqdm_logging.py:145)
16:09:41.414 [I] Progress on: 883it/100kit rate:2.2it/s remaining:12:47:13 elapsed:07:03 postfix:- (2155867:tqdm_logging.py:145)
Step 900: grad_norm=0.3833, loss=0.0204, param_norm=1379.7675
16:09:51.813 [I] Progress on: 905it/100kit rate:2.1it/s remaining:12:52:55 elapsed:07:13 postfix:- (2155867:tqdm_logging.py:145)
16:10:02.170 [I] Progress on: 927it/100kit rate:2.1it/s remaining:12:59:24 elapsed:07:24 postfix:- (2155867:tqdm_logging.py:145)
16:10:12.522 [I] Progress on: 949it/100kit rate:2.1it/s remaining:12:57:01 elapsed:07:34 postfix:- (2155867:tqdm_logging.py:145)
16:10:22.879 [I] Progress on: 971it/100kit rate:2.1it/s remaining:12:57:17 elapsed:07:44 postfix:- (2155867:tqdm_logging.py:145)
16:10:33.232 [I] Progress on: 993it/100kit rate:2.1it/s remaining:12:57:25 elapsed:07:55 postfix:- (2155867:tqdm_logging.py:145)
Step 1000: grad_norm=0.2976, loss=0.0189, param_norm=1379.7751
16:10:37.201 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2155867:checkpoint_manager.py:1987)
16:10:37.202 [I] [process=0] Saving checkpoint at step 1000                                       (2155867:checkpoint_manager.py:1408)
16:10:37.202 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (2155867:async_checkpointer.py:439)
16:10:37.204 [I] Using ThreadSafeKeyValueSignalingClient                                          (2155867:signaling_client.py:332)
16:10:37.215 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 (2155867:atomicity.py:144)
16:10:37.221 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 (2155867:atomicity.py:144)
16:10:37.221 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (2155867:atomicity.py:144)
16:10:37.221 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (2155867:atomicity.py:144)
16:10:37.222 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762071037217930640, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1762071037217930640, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2155867:checkpoint.py:186)
16:10:37.243 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2155867:replica_slices.py:341)
16:10:52.368 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2155867:replica_slices.py:341)
16:10:52.389 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2/array_metadatas/process_0 (2155867:array_metadata_store.py:198)
16:11:39.311 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 115.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:11:39.325 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 172.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:11:39.332 [I] [process=0][thread=async_save] Background save thread started.                   (2155867:async_checkpointer.py:77)
16:11:39.333 [I] Finished blocking save in 62.13 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (2155867:async_checkpointer.py:548)
16:11:39.334 [I] [process=0][thread=MainThread][step=1000] Starting CheckpointManager Save Finalize thread=save_finalize (2155867:checkpoint_manager.py:1453)
16:11:39.334 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2155867:async_checkpointer.py:258)
16:11:39.335 [I] {'step': 1000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762071037.2018447, 'wait_for_prev_duration_secs': 0.00020837783813476562, 'checkpointer_blocking_start_time': 1762071037.2023954, 'checkpointer_blocking_duration_secs': 62.13172793388367, 'get_old_steps_start_time': 1762071099.3341608, 'get_old_steps_duration_secs': 6.67572021484375e-06, 'checkpoint_manager_blocking_start_time': 1762071037.2017078, 'checkpoint_manager_blocking_duration_secs': 62.13323402404785} (2155867:standard_logger.py:34)
16:11:39.336 [I] Progress on: 1.00kit/100kit rate:19.2s/it remaining:527:15:20 elapsed:09:01 postfix:- (2155867:tqdm_logging.py:145)
16:11:39.391 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3/array_metadatas/process_0 (2155867:array_metadata_store.py:198)
16:11:49.411 [I] Progress on: 1.02kit/100kit rate:2.1it/s remaining:13:19:22 elapsed:09:11 postfix:- (2155867:tqdm_logging.py:145)
16:11:59.520 [I] Progress on: 1.04kit/100kit rate:2.1it/s remaining:13:03:00 elapsed:09:21 postfix:- (2155867:tqdm_logging.py:145)
16:12:01.145 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 85.3 MiB/s (total bytes: 7.0 GiB) (time elapsed: a minute) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:12:05.851 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 121.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:12:05.851 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2155867:async_checkpointer.py:87)
16:12:05.852 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762071037217930640, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2155867:checkpoint.py:226)
16:12:05.853 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets (2155867:atomicity.py:289)
16:12:05.856 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'train_state': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762071037217930640, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2155867:checkpoint.py:245)
16:12:05.859 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2155867:array_metadata_store.py:362)
16:12:05.974 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state (2155867:atomicity.py:289)
16:12:05.978 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2155867:array_metadata_store.py:362)
16:12:06.058 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params (2155867:atomicity.py:289)
16:12:06.060 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (2155867:atomicity.py:289)
16:12:06.064 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000`. (2155867:atomicity.py:573)
16:12:06.064 [I] Finished asynchronous save (blocking + background) in 88.86 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (2155867:async_checkpointer.py:412)
16:12:06.064 [I] [process=0][thread=async_save] Background save thread done.                      (2155867:async_checkpointer.py:143)
16:12:06.064 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2155867:async_checkpointer.py:266)
16:12:06.065 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2155867:async_checkpointer.py:276)
16:12:06.065 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is syncing with other hosts... (2155867:checkpoint_manager.py:2095)
16:12:06.065 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is done on all hosts. (2155867:checkpoint_manager.py:2110)
16:12:09.870 [I] Progress on: 1.06kit/100kit rate:2.1it/s remaining:12:55:52 elapsed:09:31 postfix:- (2155867:tqdm_logging.py:145)
16:12:20.230 [I] Progress on: 1.08kit/100kit rate:2.1it/s remaining:12:58:18 elapsed:09:42 postfix:- (2155867:tqdm_logging.py:145)
Step 1100: grad_norm=0.3038, loss=0.0192, param_norm=1379.7839
16:12:30.624 [I] Progress on: 1.11kit/100kit rate:2.1it/s remaining:12:55:02 elapsed:09:52 postfix:- (2155867:tqdm_logging.py:145)
16:12:40.979 [I] Progress on: 1.13kit/100kit rate:2.1it/s remaining:12:56:10 elapsed:10:02 postfix:- (2155867:tqdm_logging.py:145)
16:12:51.329 [I] Progress on: 1.15kit/100kit rate:2.1it/s remaining:12:55:10 elapsed:10:13 postfix:- (2155867:tqdm_logging.py:145)
16:13:01.682 [I] Progress on: 1.17kit/100kit rate:2.1it/s remaining:12:55:08 elapsed:10:23 postfix:- (2155867:tqdm_logging.py:145)
16:13:12.035 [I] Progress on: 1.19kit/100kit rate:2.1it/s remaining:12:54:43 elapsed:10:33 postfix:- (2155867:tqdm_logging.py:145)
Step 1200: grad_norm=0.2882, loss=0.0168, param_norm=1379.7927
16:13:22.441 [I] Progress on: 1.22kit/100kit rate:2.1it/s remaining:12:55:01 elapsed:10:44 postfix:- (2155867:tqdm_logging.py:145)
16:13:32.795 [I] Progress on: 1.24kit/100kit rate:2.1it/s remaining:12:54:32 elapsed:10:54 postfix:- (2155867:tqdm_logging.py:145)
16:13:43.147 [I] Progress on: 1.26kit/100kit rate:2.1it/s remaining:12:54:03 elapsed:11:05 postfix:- (2155867:tqdm_logging.py:145)
16:13:53.229 [I] Progress on: 1.28kit/100kit rate:2.1it/s remaining:12:54:29 elapsed:11:15 postfix:- (2155867:tqdm_logging.py:145)
Step 1300: grad_norm=0.2390, loss=0.0151, param_norm=1379.8013
16:14:03.640 [I] Progress on: 1.30kit/100kit rate:2.1it/s remaining:12:51:23 elapsed:11:25 postfix:- (2155867:tqdm_logging.py:145)
16:14:13.994 [I] Progress on: 1.32kit/100kit rate:2.1it/s remaining:12:54:36 elapsed:11:35 postfix:- (2155867:tqdm_logging.py:145)
16:14:24.350 [I] Progress on: 1.35kit/100kit rate:2.1it/s remaining:12:54:44 elapsed:11:46 postfix:- (2155867:tqdm_logging.py:145)
16:14:34.699 [I] Progress on: 1.37kit/100kit rate:2.1it/s remaining:12:54:02 elapsed:11:56 postfix:- (2155867:tqdm_logging.py:145)
16:14:45.052 [I] Progress on: 1.39kit/100kit rate:2.1it/s remaining:12:53:39 elapsed:12:06 postfix:- (2155867:tqdm_logging.py:145)
Step 1400: grad_norm=0.2702, loss=0.0153, param_norm=1379.8105
16:14:55.454 [I] Progress on: 1.41kit/100kit rate:2.1it/s remaining:12:52:54 elapsed:12:17 postfix:- (2155867:tqdm_logging.py:145)
16:15:05.806 [I] Progress on: 1.44kit/100kit rate:2.1it/s remaining:12:52:34 elapsed:12:27 postfix:- (2155867:tqdm_logging.py:145)
16:15:16.158 [I] Progress on: 1.46kit/100kit rate:2.1it/s remaining:12:53:10 elapsed:12:38 postfix:- (2155867:tqdm_logging.py:145)
16:15:26.509 [I] Progress on: 1.48kit/100kit rate:2.1it/s remaining:12:52:33 elapsed:12:48 postfix:- (2155867:tqdm_logging.py:145)
Step 1500: grad_norm=0.2469, loss=0.0139, param_norm=1379.8197
16:15:37.035 [I] Progress on: 1.50kit/100kit rate:2.1it/s remaining:12:52:58 elapsed:12:58 postfix:- (2155867:tqdm_logging.py:145)
16:15:47.487 [I] Progress on: 1.52kit/100kit rate:2.1it/s remaining:12:54:02 elapsed:13:09 postfix:- (2155867:tqdm_logging.py:145)
16:15:57.839 [I] Progress on: 1.54kit/100kit rate:2.1it/s remaining:12:52:37 elapsed:13:19 postfix:- (2155867:tqdm_logging.py:145)
16:16:08.190 [I] Progress on: 1.57kit/100kit rate:2.1it/s remaining:12:51:33 elapsed:13:30 postfix:- (2155867:tqdm_logging.py:145)
16:16:18.541 [I] Progress on: 1.59kit/100kit rate:2.1it/s remaining:12:52:50 elapsed:13:40 postfix:- (2155867:tqdm_logging.py:145)
Step 1600: grad_norm=0.2995, loss=0.0141, param_norm=1379.8286
16:16:28.938 [I] Progress on: 1.61kit/100kit rate:2.1it/s remaining:12:51:21 elapsed:13:50 postfix:- (2155867:tqdm_logging.py:145)
16:16:39.291 [I] Progress on: 1.63kit/100kit rate:2.1it/s remaining:12:51:30 elapsed:14:01 postfix:- (2155867:tqdm_logging.py:145)
16:16:49.644 [I] Progress on: 1.66kit/100kit rate:2.1it/s remaining:12:51:20 elapsed:14:11 postfix:- (2155867:tqdm_logging.py:145)
16:16:59.995 [I] Progress on: 1.68kit/100kit rate:2.1it/s remaining:12:50:48 elapsed:14:21 postfix:- (2155867:tqdm_logging.py:145)
16:17:10.076 [I] Progress on: 1.70kit/100kit rate:2.1it/s remaining:12:51:11 elapsed:14:32 postfix:- (2155867:tqdm_logging.py:145)
Step 1700: grad_norm=0.2337, loss=0.0123, param_norm=1379.8376
16:17:20.476 [I] Progress on: 1.72kit/100kit rate:2.1it/s remaining:12:49:56 elapsed:14:42 postfix:- (2155867:tqdm_logging.py:145)
16:17:30.827 [I] Progress on: 1.74kit/100kit rate:2.1it/s remaining:12:50:51 elapsed:14:52 postfix:- (2155867:tqdm_logging.py:145)
16:17:41.182 [I] Progress on: 1.76kit/100kit rate:2.1it/s remaining:12:50:04 elapsed:15:03 postfix:- (2155867:tqdm_logging.py:145)
16:17:51.532 [I] Progress on: 1.79kit/100kit rate:2.1it/s remaining:12:51:19 elapsed:15:13 postfix:- (2155867:tqdm_logging.py:145)
Step 1800: grad_norm=0.2209, loss=0.0115, param_norm=1379.8468
16:18:01.932 [I] Progress on: 1.81kit/100kit rate:2.1it/s remaining:12:48:43 elapsed:15:23 postfix:- (2155867:tqdm_logging.py:145)
16:18:12.286 [I] Progress on: 1.83kit/100kit rate:2.1it/s remaining:12:49:59 elapsed:15:34 postfix:- (2155867:tqdm_logging.py:145)
16:18:22.636 [I] Progress on: 1.85kit/100kit rate:2.1it/s remaining:12:48:52 elapsed:15:44 postfix:- (2155867:tqdm_logging.py:145)
16:18:32.989 [I] Progress on: 1.87kit/100kit rate:2.1it/s remaining:12:49:47 elapsed:15:54 postfix:- (2155867:tqdm_logging.py:145)
16:18:43.341 [I] Progress on: 1.90kit/100kit rate:2.1it/s remaining:12:49:04 elapsed:16:05 postfix:- (2155867:tqdm_logging.py:145)
Step 1900: grad_norm=0.2272, loss=0.0118, param_norm=1379.8557
16:18:53.744 [I] Progress on: 1.92kit/100kit rate:2.1it/s remaining:12:48:58 elapsed:16:15 postfix:- (2155867:tqdm_logging.py:145)
16:19:04.096 [I] Progress on: 1.94kit/100kit rate:2.1it/s remaining:12:49:20 elapsed:16:26 postfix:- (2155867:tqdm_logging.py:145)
16:19:14.450 [I] Progress on: 1.96kit/100kit rate:2.1it/s remaining:12:49:29 elapsed:16:36 postfix:- (2155867:tqdm_logging.py:145)
16:19:24.805 [I] Progress on: 1.98kit/100kit rate:2.1it/s remaining:12:49:31 elapsed:16:46 postfix:- (2155867:tqdm_logging.py:145)
Step 2000: grad_norm=0.2036, loss=0.0106, param_norm=1379.8644
16:19:33.017 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2155867:checkpoint_manager.py:1987)
16:19:33.017 [I] [process=0] Saving checkpoint at step 2000                                       (2155867:checkpoint_manager.py:1408)
16:19:33.017 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (2155867:async_checkpointer.py:439)
16:19:33.028 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 (2155867:atomicity.py:144)
16:19:33.033 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 (2155867:atomicity.py:144)
16:19:33.035 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 (2155867:atomicity.py:144)
16:19:33.035 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 (2155867:atomicity.py:144)
16:19:33.054 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2155867:replica_slices.py:341)
16:19:41.567 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2155867:replica_slices.py:341)
16:19:41.588 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6/array_metadatas/process_0 (2155867:array_metadata_store.py:198)
16:20:20.732 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 150.2 MiB/s (total bytes: 7.0 GiB) (time elapsed: 47 seconds) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:20:20.743 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 225.0 MiB/s (total bytes: 10.5 GiB) (time elapsed: 47 seconds) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:20:20.750 [I] [process=0][thread=async_save] Background save thread started.                   (2155867:async_checkpointer.py:77)
16:20:20.752 [I] Finished blocking save in 47.73 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (2155867:async_checkpointer.py:548)
16:20:20.753 [I] Deleting Checkpoint[step=1000 | time=2025-11-02 08:11:39.334141+00:00]: (Reason: old checkpoint). (2155867:checkpoint_manager.py:1963)
16:20:20.753 [I] [process=0][thread=MainThread][step=2000] Starting CheckpointManager Save Finalize thread=save_finalize (2155867:checkpoint_manager.py:1453)
16:20:20.753 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2155867:async_checkpointer.py:258)
16:20:20.754 [I] {'step': 2000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762071573.0169864, 'wait_for_prev_duration_secs': 0.0001609325408935547, 'checkpointer_blocking_start_time': 1762071573.0174212, 'checkpointer_blocking_duration_secs': 47.73579025268555, 'get_old_steps_start_time': 1762071620.7532346, 'get_old_steps_duration_secs': 0.00012183189392089844, 'checkpoint_manager_blocking_start_time': 1762071573.0168672, 'checkpoint_manager_blocking_duration_secs': 47.73745560646057} (2155867:standard_logger.py:34)
16:20:20.755 [I] Progress on: 2.00kit/100kit rate:14.9s/it remaining:404:24:19 elapsed:17:42 postfix:- (2155867:tqdm_logging.py:145)
16:20:20.800 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7/array_metadatas/process_0 (2155867:array_metadata_store.py:198)
16:20:30.797 [I] Progress on: 2.02kit/100kit rate:2.1it/s remaining:13:02:57 elapsed:17:52 postfix:- (2155867:tqdm_logging.py:145)
16:20:30.970 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 123.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: 57 seconds) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:20:34.785 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 173.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: a minute) (per-host) (2155867:base_pytree_checkpoint_handler.py:114)
16:20:34.785 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2155867:async_checkpointer.py:87)
16:20:34.789 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets (2155867:atomicity.py:289)
16:20:34.795 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2155867:array_metadata_store.py:362)
16:20:34.917 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state (2155867:atomicity.py:289)
16:20:35.132 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2155867:array_metadata_store.py:362)
16:20:35.132 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params (2155867:atomicity.py:289)
16:20:35.135 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (2155867:atomicity.py:289)
16:20:35.144 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000`. (2155867:atomicity.py:573)
16:20:35.145 [I] Finished asynchronous save (blocking + background) in 62.13 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (2155867:async_checkpointer.py:412)
16:20:35.145 [I] [process=0][thread=async_save] Background save thread done.                      (2155867:async_checkpointer.py:143)
16:20:35.145 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2155867:async_checkpointer.py:266)
16:20:35.145 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2155867:async_checkpointer.py:276)
16:20:35.910 [I] Deleted step 1000.                                                               (2155867:deleter.py:114)
16:20:35.911 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is syncing with other hosts... (2155867:checkpoint_manager.py:2095)
16:20:35.911 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is done on all hosts. (2155867:checkpoint_manager.py:2110)
16:20:41.143 [I] Progress on: 2.04kit/100kit rate:2.1it/s remaining:12:48:30 elapsed:18:03 postfix:- (2155867:tqdm_logging.py:145)
16:20:51.497 [I] Progress on: 2.07kit/100kit rate:2.1it/s remaining:12:48:16 elapsed:18:13 postfix:- (2155867:tqdm_logging.py:145)
16:21:01.848 [I] Progress on: 2.09kit/100kit rate:2.1it/s remaining:12:48:04 elapsed:18:23 postfix:- (2155867:tqdm_logging.py:145)
Step 2100: grad_norm=0.2388, loss=0.0108, param_norm=1379.8733
16:21:11.995 [I] Progress on: 2.11kit/100kit rate:2.1it/s remaining:13:04:50 elapsed:18:33 postfix:- (2155867:tqdm_logging.py:145)
16:21:22.345 [I] Progress on: 2.13kit/100kit rate:2.1it/s remaining:12:47:03 elapsed:18:44 postfix:- (2155867:tqdm_logging.py:145)
16:21:32.696 [I] Progress on: 2.15kit/100kit rate:2.1it/s remaining:12:47:12 elapsed:18:54 postfix:- (2155867:tqdm_logging.py:145)
16:21:43.047 [I] Progress on: 2.17kit/100kit rate:2.1it/s remaining:12:46:53 elapsed:19:04 postfix:- (2155867:tqdm_logging.py:145)
16:21:53.404 [I] Progress on: 2.20kit/100kit rate:2.1it/s remaining:12:47:00 elapsed:19:15 postfix:- (2155867:tqdm_logging.py:145)
Step 2200: grad_norm=0.2130, loss=0.0104, param_norm=1379.8817
16:22:03.807 [I] Progress on: 2.22kit/100kit rate:2.1it/s remaining:12:47:28 elapsed:19:25 postfix:- (2155867:tqdm_logging.py:145)
slurmstepd: error: *** JOB 312130 ON dgx-54 CANCELLED AT 2025-11-02T16:22:13 DUE TO PREEMPTION ***
Sun Nov  2 19:24:32 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.158.01             Driver Version: 570.158.01     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H800                    On  |   00000000:43:00.0 Off |                    0 |
| N/A   24C    P0            105W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H800                    On  |   00000000:52:00.0 Off |                    0 |
| N/A   27C    P0            116W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H800                    On  |   00000000:61:00.0 Off |                    0 |
| N/A   31C    P0             69W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H800                    On  |   00000000:9D:00.0 Off |                    0 |
| N/A   24C    P0             94W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
0,1,2,3
warning: The `tool.uv.dev-dependencies` field (used in `packages/openpi-client/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
19:25:01.301 [I] Running on: dgx-54                                                               (2531865:train.py:196)
INFO:2025-11-02 19:25:03,489:jax._src.xla_bridge:925: Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig'
19:25:03.489 [I] Unable to initialize backend 'rocm': module 'jaxlib.xla_extension' has no attribute 'GpuAllocatorConfig' (2531865:xla_bridge.py:925)
INFO:2025-11-02 19:25:03,494:jax._src.xla_bridge:925: Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
19:25:03.494 [I] Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory (2531865:xla_bridge.py:925)
19:25:05.647 [I] Wiped checkpoint directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2531865:checkpoints.py:29)
19:25:05.648 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b597e6d0> (2531865:base_pytree_checkpoint_handler.py:334)
19:25:05.648 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b597e6d0> (2531865:base_pytree_checkpoint_handler.py:334)
19:25:05.648 [I] [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID. (2531865:multihost.py:390)
19:25:05.648 [I] [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=None, item_handlers={'assets': <openpi.training.checkpoints.CallbackHandler object at 0x15532ba3df10>, 'train_state': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba3cad0>, 'params': <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba3ec90>}, handler_registry=None (2531865:checkpoint_manager.py:620)
19:25:05.649 [I] Deferred registration for item: "assets". Adding handler `<openpi.training.checkpoints.CallbackHandler object at 0x15532ba3df10>` for item "assets" and save args `<class 'openpi.training.checkpoints.CallbackSave'>` and restore args `<class 'openpi.training.checkpoints.CallbackRestore'>` to `_handler_registry`. (2531865:composite_checkpoint_handler.py:234)
19:25:05.649 [I] Deferred registration for item: "train_state". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba3cad0>` for item "train_state" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2531865:composite_checkpoint_handler.py:234)
19:25:05.649 [I] Deferred registration for item: "params". Adding handler `<orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba3ec90>` for item "params" and save args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>` to `_handler_registry`. (2531865:composite_checkpoint_handler.py:234)
19:25:05.649 [I] Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532ba3e1d0>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`. (2531865:composite_checkpoint_handler.py:234)
19:25:05.649 [I] Initialized registry DefaultCheckpointHandlerRegistry({('assets', <class 'openpi.training.checkpoints.CallbackSave'>): <openpi.training.checkpoints.CallbackHandler object at 0x15532ba3df10>, ('assets', <class 'openpi.training.checkpoints.CallbackRestore'>): <openpi.training.checkpoints.CallbackHandler object at 0x15532ba3df10>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba3cad0>, ('train_state', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba3cad0>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeSaveArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba3ec90>, ('params', <class 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeRestoreArgs'>): <orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler object at 0x15532ba3ec90>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532ba3e1d0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x15532ba3e1d0>}). (2531865:composite_checkpoint_handler.py:502)
19:25:05.649 [I] orbax-checkpoint version: 0.11.13                                                (2531865:abstract_checkpointer.py:35)
19:25:05.649 [I] [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x15532ba28b80> timeout: 7200 secs and primary_host=0 for async checkpoint writes (2531865:async_checkpointer.py:170)
19:25:05.650 [I] Found 0 checkpoint steps in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real (2531865:checkpoint_manager.py:1701)
19:25:05.650 [I] [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=5000, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=False, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=AsyncOptions(timeout_secs=7200, barrier_sync_fn=None, post_finalization_callback=None, create_directories_asynchronously=True), multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, prevent_write_metrics=False), root_directory=/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x15532ba3e650> (2531865:checkpoint_manager.py:801)
wandb: Currently logged in as: heisen0928 (heisen0928-the-hong-kong-polytechnic-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/wandb/run-20251102_192506-q4cdkwvz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run real
wandb: ‚≠êÔ∏è View project at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi
wandb: üöÄ View run at https://wandb.ai/heisen0928-the-hong-kong-polytechnic-university/openpi/runs/q4cdkwvz
19:25:07.548 [I] Loaded norm stats from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/assets/pi0_base_piper/aloha_sweeping (2531865:config.py:196)
19:25:07.549 [I] data_config: DataConfig(repo_id='aloha_sweeping', asset_id='aloha_sweeping', norm_stats={'state': NormStats(mean=array([ 0.47424394,  1.93239212, -1.21354711,  0.02150275,  0.90646011,
        0.49164048,  0.05461168]), std=array([0.17103249, 0.14320549, 0.25212812, 0.05638926, 0.14822352,
       0.11071946, 0.00993702]), q01=array([ 0.25117052,  1.69599698, -1.85752935, -0.0792199 ,  0.65580877,
        0.27204885,  0.0458824 ]), q99=array([ 0.82077601,  2.30108927, -0.91839277,  0.18234723,  1.21471596,
        0.7448781 ,  0.08129722])), 'actions': NormStats(mean=array([-0.0244057 , -0.00734879,  0.04024221,  0.0005264 , -0.03342618,
       -0.02444903,  0.03626091]), std=array([0.16685677, 0.14164105, 0.26111194, 0.04983826, 0.14566314,
       0.10277452, 0.03212533]), q01=array([-4.92804351e-01, -4.31920097e-01, -5.53970138e-01, -1.66209970e-01,
       -4.47979820e-01, -3.10425970e-01, -3.49400386e-05]), q99=array([0.26887509, 0.26059457, 0.77529773, 0.10606248, 0.26833984,
       0.21120921, 0.08889262]))}, repack_transforms=Group(inputs=[RepackTransform(structure={'images': {'cam_high': 'observation.images.cam_high', 'cam_right_wrist': 'observation.images.cam_right_wrist'}, 'state': 'observation.state', 'actions': 'action', 'prompt': 'prompt'})], outputs=()), data_transforms=Group(inputs=(PiperInputs(adapt_to_pi=False), DeltaActions(mask=(True, True, True, True, True, True, False))), outputs=(AbsoluteActions(mask=(True, True, True, True, True, True, False)), PiperOutputs(adapt_to_pi=False))), model_transforms=Group(inputs=[InjectDefaultPrompt(prompt=None), ResizeImages(height=224, width=224), TokenizePrompt(tokenizer=<openpi.models.tokenizer.PaligemmaTokenizer object at 0x15532ba0c9d0>, discrete_state_input=False), PadStatesAndActions(model_action_dim=32)], outputs=()), use_quantile_norm=False, action_sequence_keys=('action',), prompt_from_task=True, rlds_data_dir=None, action_space=None, filter_dict_path=None) (2531865:data_loader.py:243)
19:25:08.491 [I] local_batch_size: 32                                                             (2531865:data_loader.py:324)
19:25:29.331 [I] Initialized data loader:
[0].images['base_0_rgb']: (32, 224, 224, 3)@float32
[0].images['left_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].images['right_wrist_0_rgb']: (32, 224, 224, 3)@float32
[0].image_masks['base_0_rgb']: (32,)@bool
[0].image_masks['left_wrist_0_rgb']: (32,)@bool
[0].image_masks['right_wrist_0_rgb']: (32,)@bool
[0].state: (32, 32)@float32
[0].tokenized_prompt: (32, 48)@int32
[0].tokenized_prompt_mask: (32, 48)@bool
[1]: (32, 50, 32)@float32 (2531865:train.py:227)
19:25:31.616 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['llm']['embedder']['input_embedding'].value of shape (257152, 2048) (1004.50 MiB) along axis 0 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value of shape (18, 8, 256, 2048) (144.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value of shape (18, 8, 256, 1024) (72.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.617 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value of shape (18, 2, 1, 2048, 256) (36.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value of shape (18, 2, 1, 1024, 256) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value of shape (18, 8, 2048, 256) (144.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value of shape (18, 8, 1024, 256) (72.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value of shape (18, 2, 2048, 16384) (2304.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['linear'].value of shape (18, 16384, 2048) (1152.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value of shape (18, 2, 1024, 4096) (288.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.618 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['linear'].value of shape (18, 4096, 1024) (144.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .params['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .params['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .params['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.619 [I] Sharding .opt_state[1][0].mu['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.620 [I] Sharding .opt_state[1][0].mu['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].mu['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].mu['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.621 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .opt_state[1][0].nu['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value of shape (27, 1152, 4304) (510.68 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.622 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value of shape (27, 4304, 1152) (510.68 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value of shape (27, 16, 72, 1152) (136.69 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value of shape (27, 1152, 16, 72) (136.69 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['img']['head']['kernel'].value of shape (1152, 2048) (9.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['llm']['embedder']['input_embedding'].value of shape (257152, 2048) (1004.50 MiB) along axis 0 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value of shape (18, 8, 16, 2048) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value of shape (18, 8, 256, 2048) (144.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value of shape (18, 8, 256, 32) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value of shape (18, 8, 32, 1024) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value of shape (18, 8, 256, 1024) (72.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value of shape (18, 2, 1, 2048, 16) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.623 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value of shape (18, 2, 1, 2048, 256) (36.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value of shape (18, 2, 1, 1024, 32) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value of shape (18, 2, 1, 1024, 256) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value of shape (18, 8, 2048, 16) (18.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value of shape (18, 8, 2048, 256) (144.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value of shape (18, 8, 1024, 32) (18.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value of shape (18, 8, 32, 256) (4.50 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value of shape (18, 8, 1024, 256) (72.00 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value of shape (18, 2, 2048, 16384) (2304.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value of shape (18, 2, 2048, 16) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value of shape (18, 2, 16, 16384) (36.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['linear'].value of shape (18, 16384, 2048) (1152.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value of shape (18, 16384, 16) (18.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value of shape (18, 2, 1024, 4096) (288.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value of shape (18, 2, 1024, 32) (4.50 MiB) along axis 2 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value of shape (18, 2, 32, 4096) (18.00 MiB) along axis 3 (2531865:sharding.py:89)
19:25:31.624 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['linear'].value of shape (18, 4096, 1024) (144.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.625 [I] Sharding .ema_params['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value of shape (18, 4096, 32) (9.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.625 [I] Sharding .ema_params['action_time_mlp_in']['kernel'].value of shape (2048, 1024) (8.00 MiB) along axis 0 (2531865:sharding.py:89)
19:25:31.625 [I] Sharding .ema_params['action_time_mlp_out']['kernel'].value of shape (1024, 1024) (4.00 MiB) along axis 1 (2531865:sharding.py:89)
19:25:31.630 [I] Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x1554b597e6d0> (2531865:base_pytree_checkpoint_handler.py:334)
19:25:31.652 [I] Restoring checkpoint from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2531865:checkpointer.py:298)
19:25:37.172 [I] [process=0] /jax/checkpoint/read/bytes_per_sec: 2.2 GiB/s (total bytes: 12.1 GiB) (time elapsed: 5 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:25:37.173 [I] Finished restoring checkpoint in 5.52 seconds from /home/congcong/.cache/openpi/openpi-assets/checkpoints/pi0_base/params. (2531865:checkpointer.py:309)
/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/.venv/lib/python3.11/site-packages/jax/_src/interpreters/mlir.py:1178: UserWarning: Some donated buffers were not usable: ShapedArray(float32[27,1152,4304]), ShapedArray(float32[27,4304,1152]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[27,16,72,1152]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[27,1152,16,72]), ShapedArray(float32[1152,2048]), ShapedArray(bfloat16[257152,2048]), ShapedArray(bfloat16[18,8,256,2048]), ShapedArray(bfloat16[18,8,256,1024]), ShapedArray(bfloat16[18,2,1,2048,256]), ShapedArray(bfloat16[18,2,1,1024,256]), ShapedArray(bfloat16[18,8,2048,256]), ShapedArray(bfloat16[18,8,1024,256]), ShapedArray(bfloat16[18,2,2048,16384]), ShapedArray(bfloat16[18,16384,2048]), ShapedArray(bfloat16[18,2,1024,4096]), ShapedArray(bfloat16[18,4096,1024]), ShapedArray(float32[2048,1024]), ShapedArray(float32[1024,1024]).
See an explanation at https://jax.readthedocs.io/en/latest/faq.html#buffer-donation.
  warnings.warn("Some donated buffers were not usable:"
19:25:47.960 [I] Initialized train state:
['PaliGemma']['img']['Transformer']['encoder_norm']['bias'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoder_norm']['scale'].value: (1152,)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_0']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['LayerNorm_1']['scale'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['bias'].value: (27, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_0']['kernel'].value: (27, 1152, 4304)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MlpBlock_0']['Dense_1']['kernel'].value: (27, 4304, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['key']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['bias'].value: (27, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['out']['kernel'].value: (27, 16, 72, 1152)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['query']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['bias'].value: (27, 16, 72)@float32
['PaliGemma']['img']['Transformer']['encoderblock']['MultiHeadDotProductAttention_0']['value']['kernel'].value: (27, 1152, 16, 72)@float32
['PaliGemma']['img']['embedding']['bias'].value: (1152,)@float32
['PaliGemma']['img']['embedding']['kernel'].value: (14, 14, 3, 1152)@float32
['PaliGemma']['img']['head']['bias'].value: (2048,)@float32
['PaliGemma']['img']['head']['kernel'].value: (1152, 2048)@float32
['PaliGemma']['img']['pos_embedding'].value: (1, 256, 1152)@float32
['PaliGemma']['llm']['embedder']['input_embedding'].value: (257152, 2048)@bfloat16
['PaliGemma']['llm']['final_norm']['scale'].value: (2048,)@bfloat16
['PaliGemma']['llm']['final_norm_1']['scale'].value: (1024,)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_a'].value: (18, 8, 256, 16)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['lora_b'].value: (18, 8, 16, 2048)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum']['w'].value: (18, 8, 256, 2048)@bfloat16
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_a'].value: (18, 8, 256, 32)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['lora_b'].value: (18, 8, 32, 1024)@float32
['PaliGemma']['llm']['layers']['attn']['attn_vec_einsum_1']['w'].value: (18, 8, 256, 1024)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_a'].value: (18, 2, 1, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['lora_b'].value: (18, 2, 1, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum']['w'].value: (18, 2, 1, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_a'].value: (18, 2, 1, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['lora_b'].value: (18, 2, 1, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['kv_einsum_1']['w'].value: (18, 2, 1, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_a'].value: (18, 8, 2048, 16)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['lora_b'].value: (18, 8, 16, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum']['w'].value: (18, 8, 2048, 256)@bfloat16
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_a'].value: (18, 8, 1024, 32)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['lora_b'].value: (18, 8, 32, 256)@float32
['PaliGemma']['llm']['layers']['attn']['q_einsum_1']['w'].value: (18, 8, 1024, 256)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum'].value: (18, 2, 2048, 16384)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_a'].value: (18, 2, 2048, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['gating_einsum_lora_b'].value: (18, 2, 16, 16384)@float32
['PaliGemma']['llm']['layers']['mlp']['linear'].value: (18, 16384, 2048)@bfloat16
['PaliGemma']['llm']['layers']['mlp']['linear_lora_a'].value: (18, 16384, 16)@float32
['PaliGemma']['llm']['layers']['mlp']['linear_lora_b'].value: (18, 16, 2048)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum'].value: (18, 2, 1024, 4096)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_a'].value: (18, 2, 1024, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['gating_einsum_lora_b'].value: (18, 2, 32, 4096)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear'].value: (18, 4096, 1024)@bfloat16
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_a'].value: (18, 4096, 32)@float32
['PaliGemma']['llm']['layers']['mlp_1']['linear_lora_b'].value: (18, 32, 1024)@float32
['PaliGemma']['llm']['layers']['pre_attention_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_attention_norm_1']['scale'].value: (18, 1024)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm']['scale'].value: (18, 2048)@bfloat16
['PaliGemma']['llm']['layers']['pre_ffw_norm_1']['scale'].value: (18, 1024)@bfloat16
['action_in_proj']['bias'].value: (1024,)@float32
['action_in_proj']['kernel'].value: (32, 1024)@float32
['action_out_proj']['bias'].value: (32,)@float32
['action_out_proj']['kernel'].value: (1024, 32)@float32
['action_time_mlp_in']['bias'].value: (1024,)@float32
['action_time_mlp_in']['kernel'].value: (2048, 1024)@float32
['action_time_mlp_out']['bias'].value: (1024,)@float32
['action_time_mlp_out']['kernel'].value: (1024, 1024)@float32
['state_proj']['bias'].value: (1024,)@float32
['state_proj']['kernel'].value: (32, 1024)@float32 (2531865:train.py:238)
19:25:47.969 [I] Progress on: -/100000 rate:- remaining:? elapsed:00:00 postfix:-                 (2531865:tqdm_logging.py:145)
Step 0: grad_norm=1.6388, loss=0.1104, param_norm=1379.7465
19:25:58.041 [I] Progress on: 6.00it/100kit rate:1.1it/s remaining:24:26:49 elapsed:00:10 postfix:- (2531865:tqdm_logging.py:145)
19:26:08.376 [I] Progress on: 28.0it/100kit rate:2.1it/s remaining:13:02:44 elapsed:00:20 postfix:- (2531865:tqdm_logging.py:145)
19:26:18.719 [I] Progress on: 50.0it/100kit rate:2.1it/s remaining:13:04:26 elapsed:00:30 postfix:- (2531865:tqdm_logging.py:145)
19:26:29.043 [I] Progress on: 72.0it/100kit rate:2.1it/s remaining:13:02:49 elapsed:00:41 postfix:- (2531865:tqdm_logging.py:145)
19:26:39.381 [I] Progress on: 94.0it/100kit rate:2.1it/s remaining:13:03:33 elapsed:00:51 postfix:- (2531865:tqdm_logging.py:145)
Step 100: grad_norm=0.9854, loss=0.0749, param_norm=1379.7463
19:26:49.830 [I] Progress on: 116it/100kit rate:2.1it/s remaining:13:02:28 elapsed:01:01 postfix:- (2531865:tqdm_logging.py:145)
19:27:00.165 [I] Progress on: 138it/100kit rate:2.1it/s remaining:13:02:20 elapsed:01:12 postfix:- (2531865:tqdm_logging.py:145)
19:27:10.501 [I] Progress on: 160it/100kit rate:2.1it/s remaining:13:01:44 elapsed:01:22 postfix:- (2531865:tqdm_logging.py:145)
19:27:20.839 [I] Progress on: 182it/100kit rate:2.1it/s remaining:13:02:17 elapsed:01:32 postfix:- (2531865:tqdm_logging.py:145)
Step 200: grad_norm=0.5288, loss=0.0382, param_norm=1379.7466
19:27:31.215 [I] Progress on: 204it/100kit rate:2.1it/s remaining:12:56:26 elapsed:01:43 postfix:- (2531865:tqdm_logging.py:145)
19:27:41.552 [I] Progress on: 226it/100kit rate:2.1it/s remaining:13:01:35 elapsed:01:53 postfix:- (2531865:tqdm_logging.py:145)
19:27:51.890 [I] Progress on: 248it/100kit rate:2.1it/s remaining:13:00:54 elapsed:02:03 postfix:- (2531865:tqdm_logging.py:145)
19:28:02.229 [I] Progress on: 270it/100kit rate:2.1it/s remaining:13:01:19 elapsed:02:14 postfix:- (2531865:tqdm_logging.py:145)
19:28:12.565 [I] Progress on: 292it/100kit rate:2.1it/s remaining:13:00:26 elapsed:02:24 postfix:- (2531865:tqdm_logging.py:145)
Step 300: grad_norm=0.4396, loss=0.0297, param_norm=1379.7469
19:28:22.941 [I] Progress on: 314it/100kit rate:2.1it/s remaining:13:00:16 elapsed:02:34 postfix:- (2531865:tqdm_logging.py:145)
19:28:33.282 [I] Progress on: 336it/100kit rate:2.1it/s remaining:13:00:45 elapsed:02:45 postfix:- (2531865:tqdm_logging.py:145)
19:28:43.622 [I] Progress on: 358it/100kit rate:2.1it/s remaining:13:01:07 elapsed:02:55 postfix:- (2531865:tqdm_logging.py:145)
19:28:53.959 [I] Progress on: 380it/100kit rate:2.1it/s remaining:13:01:34 elapsed:03:05 postfix:- (2531865:tqdm_logging.py:145)
Step 400: grad_norm=0.4162, loss=0.0263, param_norm=1379.7478
19:29:04.004 [I] Progress on: 400it/100kit rate:2.1it/s remaining:13:00:56 elapsed:03:16 postfix:- (2531865:tqdm_logging.py:145)
19:29:14.409 [I] Progress on: 423it/100kit rate:2.0it/s remaining:13:31:53 elapsed:03:26 postfix:- (2531865:tqdm_logging.py:145)
19:29:24.751 [I] Progress on: 445it/100kit rate:2.1it/s remaining:13:00:20 elapsed:03:36 postfix:- (2531865:tqdm_logging.py:145)
19:29:35.088 [I] Progress on: 467it/100kit rate:2.1it/s remaining:13:00:07 elapsed:03:47 postfix:- (2531865:tqdm_logging.py:145)
19:29:45.424 [I] Progress on: 489it/100kit rate:2.1it/s remaining:13:00:16 elapsed:03:57 postfix:- (2531865:tqdm_logging.py:145)
Step 500: grad_norm=0.3969, loss=0.0246, param_norm=1379.7496
19:29:55.801 [I] Progress on: 511it/100kit rate:2.1it/s remaining:12:59:04 elapsed:04:07 postfix:- (2531865:tqdm_logging.py:145)
19:30:06.144 [I] Progress on: 533it/100kit rate:2.1it/s remaining:12:59:16 elapsed:04:18 postfix:- (2531865:tqdm_logging.py:145)
19:30:16.481 [I] Progress on: 555it/100kit rate:2.1it/s remaining:12:59:08 elapsed:04:28 postfix:- (2531865:tqdm_logging.py:145)
19:30:26.540 [I] Progress on: 576it/100kit rate:2.1it/s remaining:13:08:46 elapsed:04:38 postfix:- (2531865:tqdm_logging.py:145)
19:30:36.880 [I] Progress on: 598it/100kit rate:2.1it/s remaining:12:58:54 elapsed:04:48 postfix:- (2531865:tqdm_logging.py:145)
Step 600: grad_norm=0.4304, loss=0.0240, param_norm=1379.7522
19:30:47.267 [I] Progress on: 620it/100kit rate:2.1it/s remaining:12:57:55 elapsed:04:59 postfix:- (2531865:tqdm_logging.py:145)
19:30:57.606 [I] Progress on: 642it/100kit rate:2.1it/s remaining:12:58:02 elapsed:05:09 postfix:- (2531865:tqdm_logging.py:145)
19:31:07.946 [I] Progress on: 664it/100kit rate:2.1it/s remaining:12:57:37 elapsed:05:19 postfix:- (2531865:tqdm_logging.py:145)
19:31:18.284 [I] Progress on: 686it/100kit rate:2.1it/s remaining:12:57:19 elapsed:05:30 postfix:- (2531865:tqdm_logging.py:145)
Step 700: grad_norm=0.4416, loss=0.0227, param_norm=1379.7562
19:31:28.668 [I] Progress on: 708it/100kit rate:2.1it/s remaining:12:56:08 elapsed:05:40 postfix:- (2531865:tqdm_logging.py:145)
19:31:39.008 [I] Progress on: 730it/100kit rate:2.1it/s remaining:12:57:21 elapsed:05:51 postfix:- (2531865:tqdm_logging.py:145)
19:31:49.345 [I] Progress on: 752it/100kit rate:2.1it/s remaining:12:56:43 elapsed:06:01 postfix:- (2531865:tqdm_logging.py:145)
19:31:59.690 [I] Progress on: 774it/100kit rate:2.1it/s remaining:12:57:27 elapsed:06:11 postfix:- (2531865:tqdm_logging.py:145)
19:32:10.027 [I] Progress on: 796it/100kit rate:2.1it/s remaining:12:56:56 elapsed:06:22 postfix:- (2531865:tqdm_logging.py:145)
Step 800: grad_norm=0.3528, loss=0.0219, param_norm=1379.7614
19:32:20.408 [I] Progress on: 818it/100kit rate:2.1it/s remaining:12:57:48 elapsed:06:32 postfix:- (2531865:tqdm_logging.py:145)
19:32:30.746 [I] Progress on: 840it/100kit rate:2.1it/s remaining:12:56:18 elapsed:06:42 postfix:- (2531865:tqdm_logging.py:145)
19:32:40.838 [I] Progress on: 861it/100kit rate:2.1it/s remaining:12:57:01 elapsed:06:52 postfix:- (2531865:tqdm_logging.py:145)
19:32:51.176 [I] Progress on: 883it/100kit rate:2.1it/s remaining:12:55:14 elapsed:07:03 postfix:- (2531865:tqdm_logging.py:145)
Step 900: grad_norm=0.3833, loss=0.0204, param_norm=1379.7675
19:33:01.560 [I] Progress on: 905it/100kit rate:2.1it/s remaining:12:53:07 elapsed:07:13 postfix:- (2531865:tqdm_logging.py:145)
19:33:11.895 [I] Progress on: 927it/100kit rate:2.1it/s remaining:12:55:08 elapsed:07:23 postfix:- (2531865:tqdm_logging.py:145)
19:33:22.235 [I] Progress on: 949it/100kit rate:2.1it/s remaining:12:55:53 elapsed:07:34 postfix:- (2531865:tqdm_logging.py:145)
19:33:32.577 [I] Progress on: 971it/100kit rate:2.1it/s remaining:12:55:08 elapsed:07:44 postfix:- (2531865:tqdm_logging.py:145)
19:33:42.919 [I] Progress on: 993it/100kit rate:2.1it/s remaining:12:54:54 elapsed:07:54 postfix:- (2531865:tqdm_logging.py:145)
Step 1000: grad_norm=0.2976, loss=0.0189, param_norm=1379.7751
19:33:46.889 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
19:33:46.890 [I] [process=0] Saving checkpoint at step 1000                                       (2531865:checkpoint_manager.py:1408)
19:33:46.890 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (2531865:async_checkpointer.py:439)
19:33:46.892 [I] Using ThreadSafeKeyValueSignalingClient                                          (2531865:signaling_client.py:332)
19:33:46.904 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 (2531865:atomicity.py:144)
19:33:46.910 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 (2531865:atomicity.py:144)
19:33:46.910 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 (2531865:atomicity.py:144)
19:33:46.910 [I] Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762083226906723478, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1762083226906723478, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2531865:checkpoint.py:186)
19:33:46.910 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 (2531865:atomicity.py:144)
19:33:46.934 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
19:33:52.267 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
19:33:52.290 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
19:33:55.548 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 827.8 MiB/s (total bytes: 7.0 GiB) (time elapsed: 8 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:33:55.556 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.2 GiB/s (total bytes: 10.5 GiB) (time elapsed: 8 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:33:55.574 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
19:33:55.575 [I] Finished blocking save in 8.68 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000. (2531865:async_checkpointer.py:548)
19:33:55.576 [I] [process=0][thread=MainThread][step=1000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
19:33:55.577 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
19:33:55.578 [I] {'step': 1000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762083226.8897946, 'wait_for_prev_duration_secs': 0.0002467632293701172, 'checkpointer_blocking_start_time': 1762083226.890453, 'checkpointer_blocking_duration_secs': 8.686126232147217, 'get_old_steps_start_time': 1762083235.5766165, 'get_old_steps_duration_secs': 6.9141387939453125e-06, 'checkpoint_manager_blocking_start_time': 1762083226.889642, 'checkpoint_manager_blocking_duration_secs': 8.688359498977661} (2531865:standard_logger.py:34)
19:33:55.578 [I] Progress on: 1.00kit/100kit rate:3.1s/it remaining:86:19:17 elapsed:08:07 postfix:- (2531865:tqdm_logging.py:145)
19:33:55.607 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
19:34:05.940 [I] Progress on: 1.02kit/100kit rate:2.1it/s remaining:12:58:06 elapsed:08:17 postfix:- (2531865:tqdm_logging.py:145)
19:34:08.478 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 331.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: 21 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:34:08.478 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 497.6 MiB/s (total bytes: 10.5 GiB) (time elapsed: 21 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:34:08.478 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
19:34:08.479 [I] Read Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762083226906723478, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} from /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2531865:checkpoint.py:226)
19:34:08.480 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets.orbax-checkpoint-tmp-1 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/assets (2531865:atomicity.py:289)
19:34:08.482 [I] Updated Metadata={'item_handlers': {'assets': 'openpi.training.checkpoints.CallbackHandler', 'params': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler', 'train_state': 'orbax.checkpoint._src.handlers.pytree_checkpoint_handler.PyTreeCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1762083226906723478, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/_CHECKPOINT_METADATA (2531865:checkpoint.py:245)
19:34:08.485 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
19:34:08.515 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state.orbax-checkpoint-tmp-3 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/train_state (2531865:atomicity.py:289)
19:34:08.523 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
19:34:08.544 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params.orbax-checkpoint-tmp-2 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0/params (2531865:atomicity.py:289)
19:34:08.546 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000.orbax-checkpoint-tmp-0 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (2531865:atomicity.py:289)
19:34:08.550 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000`. (2531865:atomicity.py:573)
19:34:08.550 [I] Finished asynchronous save (blocking + background) in 21.66 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/1000 (2531865:async_checkpointer.py:412)
19:34:08.550 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
19:34:08.550 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
19:34:08.551 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
19:34:08.551 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
19:34:08.551 [I] [process=0][thread=save_finalize][step=1000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
19:34:16.285 [I] Progress on: 1.04kit/100kit rate:2.1it/s remaining:12:55:15 elapsed:08:28 postfix:- (2531865:tqdm_logging.py:145)
19:34:26.621 [I] Progress on: 1.06kit/100kit rate:2.1it/s remaining:12:55:01 elapsed:08:38 postfix:- (2531865:tqdm_logging.py:145)
19:34:36.966 [I] Progress on: 1.09kit/100kit rate:2.1it/s remaining:12:55:23 elapsed:08:48 postfix:- (2531865:tqdm_logging.py:145)
Step 1100: grad_norm=0.3038, loss=0.0192, param_norm=1379.7839
19:34:47.356 [I] Progress on: 1.11kit/100kit rate:2.1it/s remaining:12:53:50 elapsed:08:59 postfix:- (2531865:tqdm_logging.py:145)
19:34:57.698 [I] Progress on: 1.13kit/100kit rate:2.1it/s remaining:12:54:25 elapsed:09:09 postfix:- (2531865:tqdm_logging.py:145)
19:35:08.037 [I] Progress on: 1.15kit/100kit rate:2.1it/s remaining:12:54:19 elapsed:09:20 postfix:- (2531865:tqdm_logging.py:145)
19:35:18.380 [I] Progress on: 1.18kit/100kit rate:2.1it/s remaining:12:54:23 elapsed:09:30 postfix:- (2531865:tqdm_logging.py:145)
19:35:28.720 [I] Progress on: 1.20kit/100kit rate:2.1it/s remaining:12:53:28 elapsed:09:40 postfix:- (2531865:tqdm_logging.py:145)
Step 1200: grad_norm=0.2882, loss=0.0168, param_norm=1379.7927
19:35:39.114 [I] Progress on: 1.22kit/100kit rate:2.1it/s remaining:12:53:13 elapsed:09:51 postfix:- (2531865:tqdm_logging.py:145)
19:35:49.454 [I] Progress on: 1.24kit/100kit rate:2.1it/s remaining:12:53:07 elapsed:10:01 postfix:- (2531865:tqdm_logging.py:145)
19:36:00.199 [I] Progress on: 1.26kit/100kit rate:1.7it/s remaining:16:12:42 elapsed:10:12 postfix:- (2531865:tqdm_logging.py:145)
19:36:10.387 [I] Progress on: 1.28kit/100kit rate:2.1it/s remaining:12:53:28 elapsed:10:22 postfix:- (2531865:tqdm_logging.py:145)
Step 1300: grad_norm=0.2390, loss=0.0151, param_norm=1379.8013
19:36:20.785 [I] Progress on: 1.31kit/100kit rate:2.1it/s remaining:12:52:44 elapsed:10:32 postfix:- (2531865:tqdm_logging.py:145)
19:36:31.131 [I] Progress on: 1.33kit/100kit rate:2.1it/s remaining:12:53:38 elapsed:10:43 postfix:- (2531865:tqdm_logging.py:145)
19:36:41.475 [I] Progress on: 1.35kit/100kit rate:2.1it/s remaining:12:54:02 elapsed:10:53 postfix:- (2531865:tqdm_logging.py:145)
19:36:51.815 [I] Progress on: 1.37kit/100kit rate:2.1it/s remaining:12:52:39 elapsed:11:03 postfix:- (2531865:tqdm_logging.py:145)
19:37:02.156 [I] Progress on: 1.40kit/100kit rate:2.1it/s remaining:12:52:47 elapsed:11:14 postfix:- (2531865:tqdm_logging.py:145)
Step 1400: grad_norm=0.2702, loss=0.0153, param_norm=1379.8105
19:37:12.550 [I] Progress on: 1.42kit/100kit rate:2.1it/s remaining:12:52:00 elapsed:11:24 postfix:- (2531865:tqdm_logging.py:145)
19:37:22.890 [I] Progress on: 1.44kit/100kit rate:2.1it/s remaining:12:49:58 elapsed:11:34 postfix:- (2531865:tqdm_logging.py:145)
19:37:33.236 [I] Progress on: 1.46kit/100kit rate:2.1it/s remaining:12:51:28 elapsed:11:45 postfix:- (2531865:tqdm_logging.py:145)
19:37:43.446 [I] Progress on: 1.48kit/100kit rate:2.1it/s remaining:12:55:42 elapsed:11:55 postfix:- (2531865:tqdm_logging.py:145)
Step 1500: grad_norm=0.2469, loss=0.0139, param_norm=1379.8197
19:37:53.841 [I] Progress on: 1.50kit/100kit rate:2.1it/s remaining:12:49:34 elapsed:12:05 postfix:- (2531865:tqdm_logging.py:145)
19:38:04.185 [I] Progress on: 1.53kit/100kit rate:2.1it/s remaining:12:51:44 elapsed:12:16 postfix:- (2531865:tqdm_logging.py:145)
19:38:14.522 [I] Progress on: 1.55kit/100kit rate:2.1it/s remaining:12:51:58 elapsed:12:26 postfix:- (2531865:tqdm_logging.py:145)
19:38:24.865 [I] Progress on: 1.57kit/100kit rate:2.1it/s remaining:12:51:02 elapsed:12:36 postfix:- (2531865:tqdm_logging.py:145)
19:38:35.206 [I] Progress on: 1.59kit/100kit rate:2.1it/s remaining:12:50:43 elapsed:12:47 postfix:- (2531865:tqdm_logging.py:145)
Step 1600: grad_norm=0.2995, loss=0.0141, param_norm=1379.8286
19:38:45.609 [I] Progress on: 1.61kit/100kit rate:2.1it/s remaining:12:52:59 elapsed:12:57 postfix:- (2531865:tqdm_logging.py:145)
19:38:55.944 [I] Progress on: 1.64kit/100kit rate:2.1it/s remaining:12:50:28 elapsed:13:07 postfix:- (2531865:tqdm_logging.py:145)
19:39:06.285 [I] Progress on: 1.66kit/100kit rate:2.1it/s remaining:12:50:49 elapsed:13:18 postfix:- (2531865:tqdm_logging.py:145)
19:39:16.627 [I] Progress on: 1.68kit/100kit rate:2.1it/s remaining:12:50:07 elapsed:13:28 postfix:- (2531865:tqdm_logging.py:145)
Step 1700: grad_norm=0.2337, loss=0.0123, param_norm=1379.8376
19:39:26.894 [I] Progress on: 1.70kit/100kit rate:2.1it/s remaining:12:50:42 elapsed:13:38 postfix:- (2531865:tqdm_logging.py:145)
19:39:37.118 [I] Progress on: 1.72kit/100kit rate:2.1it/s remaining:12:50:08 elapsed:13:49 postfix:- (2531865:tqdm_logging.py:145)
19:39:47.455 [I] Progress on: 1.75kit/100kit rate:2.1it/s remaining:12:48:28 elapsed:13:59 postfix:- (2531865:tqdm_logging.py:145)
19:39:57.795 [I] Progress on: 1.77kit/100kit rate:2.1it/s remaining:12:49:27 elapsed:14:09 postfix:- (2531865:tqdm_logging.py:145)
19:40:08.142 [I] Progress on: 1.79kit/100kit rate:2.1it/s remaining:12:50:11 elapsed:14:20 postfix:- (2531865:tqdm_logging.py:145)
Step 1800: grad_norm=0.2209, loss=0.0115, param_norm=1379.8468
19:40:18.533 [I] Progress on: 1.81kit/100kit rate:2.1it/s remaining:12:47:55 elapsed:14:30 postfix:- (2531865:tqdm_logging.py:145)
19:40:28.878 [I] Progress on: 1.83kit/100kit rate:2.1it/s remaining:12:51:00 elapsed:14:40 postfix:- (2531865:tqdm_logging.py:145)
19:40:39.216 [I] Progress on: 1.85kit/100kit rate:2.1it/s remaining:12:49:24 elapsed:14:51 postfix:- (2531865:tqdm_logging.py:145)
19:40:49.559 [I] Progress on: 1.88kit/100kit rate:2.1it/s remaining:12:48:21 elapsed:15:01 postfix:- (2531865:tqdm_logging.py:145)
19:40:59.902 [I] Progress on: 1.90kit/100kit rate:2.1it/s remaining:12:48:48 elapsed:15:11 postfix:- (2531865:tqdm_logging.py:145)
Step 1900: grad_norm=0.2272, loss=0.0118, param_norm=1379.8557
19:41:10.295 [I] Progress on: 1.92kit/100kit rate:2.1it/s remaining:12:47:36 elapsed:15:22 postfix:- (2531865:tqdm_logging.py:145)
19:41:20.631 [I] Progress on: 1.94kit/100kit rate:2.1it/s remaining:12:47:46 elapsed:15:32 postfix:- (2531865:tqdm_logging.py:145)
19:41:30.978 [I] Progress on: 1.97kit/100kit rate:2.1it/s remaining:12:47:37 elapsed:15:43 postfix:- (2531865:tqdm_logging.py:145)
19:41:41.316 [I] Progress on: 1.99kit/100kit rate:2.1it/s remaining:12:45:55 elapsed:15:53 postfix:- (2531865:tqdm_logging.py:145)
Step 2000: grad_norm=0.2036, loss=0.0106, param_norm=1379.8644
19:41:48.109 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
19:41:48.109 [I] [process=0] Saving checkpoint at step 2000                                       (2531865:checkpoint_manager.py:1408)
19:41:48.110 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (2531865:async_checkpointer.py:439)
19:41:48.120 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 (2531865:atomicity.py:144)
19:41:48.127 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 (2531865:atomicity.py:144)
19:41:48.127 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 (2531865:atomicity.py:144)
19:41:48.127 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 (2531865:atomicity.py:144)
19:41:48.147 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
19:41:48.772 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
19:41:48.795 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
19:41:51.048 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.4 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:41:51.063 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.6 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:41:51.070 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
19:41:51.070 [I] Finished blocking save in 2.96 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000. (2531865:async_checkpointer.py:548)
19:41:51.071 [I] Deleting Checkpoint[step=1000 | time=2025-11-02 11:33:55.576597+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
19:41:51.072 [I] [process=0][thread=MainThread][step=2000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
19:41:51.072 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
19:41:51.072 [I] {'step': 2000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762083708.1094909, 'wait_for_prev_duration_secs': 0.0001583099365234375, 'checkpointer_blocking_start_time': 1762083708.1099486, 'checkpointer_blocking_duration_secs': 2.9617676734924316, 'get_old_steps_start_time': 1762083711.0717392, 'get_old_steps_duration_secs': 0.0003311634063720703, 'checkpoint_manager_blocking_start_time': 1762083708.1093645, 'checkpoint_manager_blocking_duration_secs': 2.9634571075439453} (2531865:standard_logger.py:34)
19:41:51.405 [I] Progress on: 2.00kit/100kit rate:1.1s/it remaining:29:48:09 elapsed:16:03 postfix:- (2531865:tqdm_logging.py:145)
19:41:51.757 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
19:42:01.580 [I] Progress on: 2.02kit/100kit rate:2.1it/s remaining:12:46:22 elapsed:16:13 postfix:- (2531865:tqdm_logging.py:145)
19:42:07.923 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 361.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: 19 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:42:07.923 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 542.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: 19 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:42:07.923 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
19:42:07.925 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets.orbax-checkpoint-tmp-5 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/assets (2531865:atomicity.py:289)
19:42:07.933 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
19:42:07.988 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state.orbax-checkpoint-tmp-7 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/train_state (2531865:atomicity.py:289)
19:42:07.997 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
19:42:08.125 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params.orbax-checkpoint-tmp-6 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4/params (2531865:atomicity.py:289)
19:42:08.133 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000.orbax-checkpoint-tmp-4 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (2531865:atomicity.py:289)
19:42:08.151 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000`. (2531865:atomicity.py:573)
19:42:08.151 [I] Finished asynchronous save (blocking + background) in 20.04 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/2000 (2531865:async_checkpointer.py:412)
19:42:08.151 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
19:42:08.151 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
19:42:08.151 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
19:42:08.782 [I] Deleted step 1000.                                                               (2531865:deleter.py:114)
19:42:08.783 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
19:42:08.783 [I] [process=0][thread=save_finalize][step=2000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
19:42:11.927 [I] Progress on: 2.04kit/100kit rate:2.1it/s remaining:12:47:55 elapsed:16:23 postfix:- (2531865:tqdm_logging.py:145)
19:42:22.263 [I] Progress on: 2.07kit/100kit rate:2.1it/s remaining:12:46:57 elapsed:16:34 postfix:- (2531865:tqdm_logging.py:145)
19:42:32.602 [I] Progress on: 2.09kit/100kit rate:2.1it/s remaining:12:47:49 elapsed:16:44 postfix:- (2531865:tqdm_logging.py:145)
Step 2100: grad_norm=0.2388, loss=0.0108, param_norm=1379.8733
19:42:42.736 [I] Progress on: 2.11kit/100kit rate:2.1it/s remaining:12:59:20 elapsed:16:54 postfix:- (2531865:tqdm_logging.py:145)
19:42:53.081 [I] Progress on: 2.13kit/100kit rate:2.1it/s remaining:12:47:11 elapsed:17:05 postfix:- (2531865:tqdm_logging.py:145)
19:43:03.419 [I] Progress on: 2.15kit/100kit rate:2.1it/s remaining:12:46:46 elapsed:17:15 postfix:- (2531865:tqdm_logging.py:145)
19:43:13.757 [I] Progress on: 2.18kit/100kit rate:2.1it/s remaining:12:45:34 elapsed:17:25 postfix:- (2531865:tqdm_logging.py:145)
19:43:24.107 [I] Progress on: 2.20kit/100kit rate:2.1it/s remaining:12:47:14 elapsed:17:36 postfix:- (2531865:tqdm_logging.py:145)
Step 2200: grad_norm=0.2130, loss=0.0104, param_norm=1379.8817
19:43:34.500 [I] Progress on: 2.22kit/100kit rate:2.1it/s remaining:12:46:47 elapsed:17:46 postfix:- (2531865:tqdm_logging.py:145)
19:43:44.842 [I] Progress on: 2.24kit/100kit rate:2.1it/s remaining:12:46:33 elapsed:17:56 postfix:- (2531865:tqdm_logging.py:145)
19:43:55.181 [I] Progress on: 2.26kit/100kit rate:2.1it/s remaining:12:45:33 elapsed:18:07 postfix:- (2531865:tqdm_logging.py:145)
19:44:05.523 [I] Progress on: 2.29kit/100kit rate:2.1it/s remaining:12:45:52 elapsed:18:17 postfix:- (2531865:tqdm_logging.py:145)
Step 2300: grad_norm=0.1877, loss=0.0097, param_norm=1379.8903
19:44:15.917 [I] Progress on: 2.31kit/100kit rate:2.1it/s remaining:12:44:16 elapsed:18:27 postfix:- (2531865:tqdm_logging.py:145)
19:44:26.264 [I] Progress on: 2.33kit/100kit rate:2.1it/s remaining:12:46:05 elapsed:18:38 postfix:- (2531865:tqdm_logging.py:145)
19:44:36.607 [I] Progress on: 2.35kit/100kit rate:2.1it/s remaining:12:45:08 elapsed:18:48 postfix:- (2531865:tqdm_logging.py:145)
19:44:46.951 [I] Progress on: 2.37kit/100kit rate:2.1it/s remaining:12:45:13 elapsed:18:58 postfix:- (2531865:tqdm_logging.py:145)
19:44:57.292 [I] Progress on: 2.40kit/100kit rate:2.1it/s remaining:12:45:06 elapsed:19:09 postfix:- (2531865:tqdm_logging.py:145)
Step 2400: grad_norm=0.1917, loss=0.0097, param_norm=1379.8990
19:45:07.685 [I] Progress on: 2.42kit/100kit rate:2.1it/s remaining:12:44:33 elapsed:19:19 postfix:- (2531865:tqdm_logging.py:145)
19:45:18.028 [I] Progress on: 2.44kit/100kit rate:2.1it/s remaining:12:44:58 elapsed:19:30 postfix:- (2531865:tqdm_logging.py:145)
19:45:28.367 [I] Progress on: 2.46kit/100kit rate:2.1it/s remaining:12:43:59 elapsed:19:40 postfix:- (2531865:tqdm_logging.py:145)
19:45:38.470 [I] Progress on: 2.48kit/100kit rate:2.1it/s remaining:12:46:35 elapsed:19:50 postfix:- (2531865:tqdm_logging.py:145)
Step 2500: grad_norm=0.2837, loss=0.0097, param_norm=1379.9075
19:45:48.867 [I] Progress on: 2.50kit/100kit rate:2.1it/s remaining:12:42:05 elapsed:20:00 postfix:- (2531865:tqdm_logging.py:145)
19:45:59.100 [I] Progress on: 2.53kit/100kit rate:1.7it/s remaining:15:40:42 elapsed:20:11 postfix:- (2531865:tqdm_logging.py:145)
19:46:09.289 [I] Progress on: 2.55kit/100kit rate:2.1it/s remaining:12:45:39 elapsed:20:21 postfix:- (2531865:tqdm_logging.py:145)
19:46:19.628 [I] Progress on: 2.57kit/100kit rate:2.1it/s remaining:12:43:53 elapsed:20:31 postfix:- (2531865:tqdm_logging.py:145)
19:46:29.976 [I] Progress on: 2.59kit/100kit rate:2.1it/s remaining:12:44:24 elapsed:20:42 postfix:- (2531865:tqdm_logging.py:145)
Step 2600: grad_norm=0.1857, loss=0.0096, param_norm=1379.9156
19:46:40.376 [I] Progress on: 2.61kit/100kit rate:2.1it/s remaining:12:43:57 elapsed:20:52 postfix:- (2531865:tqdm_logging.py:145)
19:46:50.721 [I] Progress on: 2.64kit/100kit rate:2.1it/s remaining:12:44:53 elapsed:21:02 postfix:- (2531865:tqdm_logging.py:145)
19:47:01.061 [I] Progress on: 2.66kit/100kit rate:2.1it/s remaining:12:43:02 elapsed:21:13 postfix:- (2531865:tqdm_logging.py:145)
19:47:11.402 [I] Progress on: 2.68kit/100kit rate:2.1it/s remaining:12:41:49 elapsed:21:23 postfix:- (2531865:tqdm_logging.py:145)
Step 2700: grad_norm=0.1915, loss=0.0093, param_norm=1379.9242
19:47:21.448 [I] Progress on: 2.70kit/100kit rate:2.1it/s remaining:12:43:32 elapsed:21:33 postfix:- (2531865:tqdm_logging.py:145)
19:47:31.667 [I] Progress on: 2.72kit/100kit rate:2.1it/s remaining:12:40:37 elapsed:21:43 postfix:- (2531865:tqdm_logging.py:145)
19:47:42.011 [I] Progress on: 2.75kit/100kit rate:2.1it/s remaining:12:41:10 elapsed:21:54 postfix:- (2531865:tqdm_logging.py:145)
19:47:52.353 [I] Progress on: 2.77kit/100kit rate:2.1it/s remaining:12:40:43 elapsed:22:04 postfix:- (2531865:tqdm_logging.py:145)
19:48:02.693 [I] Progress on: 2.79kit/100kit rate:2.1it/s remaining:12:39:59 elapsed:22:14 postfix:- (2531865:tqdm_logging.py:145)
Step 2800: grad_norm=0.1852, loss=0.0087, param_norm=1379.9330
19:48:13.093 [I] Progress on: 2.81kit/100kit rate:2.1it/s remaining:12:40:55 elapsed:22:25 postfix:- (2531865:tqdm_logging.py:145)
19:48:23.435 [I] Progress on: 2.83kit/100kit rate:2.1it/s remaining:12:41:01 elapsed:22:35 postfix:- (2531865:tqdm_logging.py:145)
19:48:33.777 [I] Progress on: 2.85kit/100kit rate:2.1it/s remaining:12:40:44 elapsed:22:45 postfix:- (2531865:tqdm_logging.py:145)
19:48:44.118 [I] Progress on: 2.88kit/100kit rate:2.1it/s remaining:12:39:58 elapsed:22:56 postfix:- (2531865:tqdm_logging.py:145)
19:48:54.459 [I] Progress on: 2.90kit/100kit rate:2.1it/s remaining:12:38:35 elapsed:23:06 postfix:- (2531865:tqdm_logging.py:145)
Step 2900: grad_norm=0.2050, loss=0.0090, param_norm=1379.9410
19:49:04.855 [I] Progress on: 2.92kit/100kit rate:2.1it/s remaining:12:40:28 elapsed:23:16 postfix:- (2531865:tqdm_logging.py:145)
19:49:15.193 [I] Progress on: 2.94kit/100kit rate:2.1it/s remaining:12:39:40 elapsed:23:27 postfix:- (2531865:tqdm_logging.py:145)
19:49:25.265 [I] Progress on: 2.96kit/100kit rate:2.1it/s remaining:12:39:36 elapsed:23:37 postfix:- (2531865:tqdm_logging.py:145)
19:49:35.615 [I] Progress on: 2.99kit/100kit rate:2.1it/s remaining:12:41:49 elapsed:23:47 postfix:- (2531865:tqdm_logging.py:145)
Step 3000: grad_norm=0.1888, loss=0.0085, param_norm=1379.9497
19:49:42.875 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
19:49:42.875 [I] [process=0] Saving checkpoint at step 3000                                       (2531865:checkpoint_manager.py:1408)
19:49:42.875 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000. (2531865:async_checkpointer.py:439)
19:49:42.887 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8 (2531865:atomicity.py:144)
19:49:42.892 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11 (2531865:atomicity.py:144)
19:49:42.892 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets.orbax-checkpoint-tmp-9 (2531865:atomicity.py:144)
19:49:42.893 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10 (2531865:atomicity.py:144)
19:49:42.913 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
19:49:43.662 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
19:49:43.685 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
19:49:45.817 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.4 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:49:45.823 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.6 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:49:45.839 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
19:49:45.839 [I] Finished blocking save in 2.96 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000. (2531865:async_checkpointer.py:548)
19:49:45.842 [I] Deleting Checkpoint[step=2000 | time=2025-11-02 11:41:51.071726+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
19:49:45.843 [I] [process=0][thread=MainThread][step=3000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
19:49:45.845 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
19:49:45.845 [I] {'step': 3000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762084182.8751671, 'wait_for_prev_duration_secs': 0.00020051002502441406, 'checkpointer_blocking_start_time': 1762084182.875624, 'checkpointer_blocking_duration_secs': 2.9670348167419434, 'get_old_steps_start_time': 1762084185.8426988, 'get_old_steps_duration_secs': 0.0007925033569335938, 'checkpoint_manager_blocking_start_time': 1762084182.8750422, 'checkpoint_manager_blocking_duration_secs': 2.9701945781707764} (2531865:standard_logger.py:34)
19:49:45.847 [I] Progress on: 3.00kit/100kit rate:1.4s/it remaining:38:25:23 elapsed:23:57 postfix:- (2531865:tqdm_logging.py:145)
19:49:45.981 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
19:49:56.215 [I] Progress on: 3.02kit/100kit rate:2.0it/s remaining:13:25:21 elapsed:24:08 postfix:- (2531865:tqdm_logging.py:145)
19:49:59.679 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 426.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:49:59.679 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 639.2 MiB/s (total bytes: 10.5 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:49:59.679 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
19:49:59.681 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets.orbax-checkpoint-tmp-9 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/assets (2531865:atomicity.py:289)
19:49:59.686 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
19:49:59.729 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state.orbax-checkpoint-tmp-11 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/train_state (2531865:atomicity.py:289)
19:49:59.733 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
19:49:59.819 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params.orbax-checkpoint-tmp-10 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8/params (2531865:atomicity.py:289)
19:49:59.822 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000.orbax-checkpoint-tmp-8 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000 (2531865:atomicity.py:289)
19:49:59.826 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000`. (2531865:atomicity.py:573)
19:49:59.826 [I] Finished asynchronous save (blocking + background) in 16.95 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/3000 (2531865:async_checkpointer.py:412)
19:49:59.826 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
19:49:59.826 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
19:49:59.827 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
19:50:00.336 [I] Deleted step 2000.                                                               (2531865:deleter.py:114)
19:50:00.336 [I] [process=0][thread=save_finalize][step=3000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
19:50:00.336 [I] [process=0][thread=save_finalize][step=3000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
19:50:06.551 [I] Progress on: 3.04kit/100kit rate:2.1it/s remaining:12:39:58 elapsed:24:18 postfix:- (2531865:tqdm_logging.py:145)
19:50:16.890 [I] Progress on: 3.07kit/100kit rate:2.1it/s remaining:12:39:52 elapsed:24:28 postfix:- (2531865:tqdm_logging.py:145)
19:50:27.232 [I] Progress on: 3.09kit/100kit rate:2.1it/s remaining:12:39:25 elapsed:24:39 postfix:- (2531865:tqdm_logging.py:145)
Step 3100: grad_norm=0.1607, loss=0.0078, param_norm=1379.9578
19:50:37.618 [I] Progress on: 3.11kit/100kit rate:2.1it/s remaining:12:39:17 elapsed:24:49 postfix:- (2531865:tqdm_logging.py:145)
19:50:47.955 [I] Progress on: 3.13kit/100kit rate:2.1it/s remaining:12:39:19 elapsed:24:59 postfix:- (2531865:tqdm_logging.py:145)
19:50:58.296 [I] Progress on: 3.15kit/100kit rate:2.1it/s remaining:12:39:54 elapsed:25:10 postfix:- (2531865:tqdm_logging.py:145)
19:51:08.637 [I] Progress on: 3.18kit/100kit rate:2.1it/s remaining:12:39:04 elapsed:25:20 postfix:- (2531865:tqdm_logging.py:145)
19:51:18.979 [I] Progress on: 3.20kit/100kit rate:2.1it/s remaining:12:38:53 elapsed:25:31 postfix:- (2531865:tqdm_logging.py:145)
Step 3200: grad_norm=0.1993, loss=0.0086, param_norm=1379.9659
19:51:29.364 [I] Progress on: 3.22kit/100kit rate:2.1it/s remaining:12:39:09 elapsed:25:41 postfix:- (2531865:tqdm_logging.py:145)
19:51:39.705 [I] Progress on: 3.24kit/100kit rate:2.1it/s remaining:12:38:45 elapsed:25:51 postfix:- (2531865:tqdm_logging.py:145)
19:51:50.047 [I] Progress on: 3.26kit/100kit rate:2.1it/s remaining:12:38:29 elapsed:26:02 postfix:- (2531865:tqdm_logging.py:145)
19:52:00.393 [I] Progress on: 3.29kit/100kit rate:2.1it/s remaining:12:40:21 elapsed:26:12 postfix:- (2531865:tqdm_logging.py:145)
Step 3300: grad_norm=0.1715, loss=0.0076, param_norm=1379.9742
19:52:10.779 [I] Progress on: 3.31kit/100kit rate:2.1it/s remaining:12:37:32 elapsed:26:22 postfix:- (2531865:tqdm_logging.py:145)
19:52:21.118 [I] Progress on: 3.33kit/100kit rate:2.1it/s remaining:12:37:45 elapsed:26:33 postfix:- (2531865:tqdm_logging.py:145)
19:52:31.460 [I] Progress on: 3.35kit/100kit rate:2.1it/s remaining:12:39:05 elapsed:26:43 postfix:- (2531865:tqdm_logging.py:145)
19:52:41.513 [I] Progress on: 3.37kit/100kit rate:2.1it/s remaining:12:35:11 elapsed:26:53 postfix:- (2531865:tqdm_logging.py:145)
19:52:51.856 [I] Progress on: 3.40kit/100kit rate:2.2it/s remaining:12:24:53 elapsed:27:03 postfix:- (2531865:tqdm_logging.py:145)
Step 3400: grad_norm=0.1801, loss=0.0078, param_norm=1379.9824
19:53:02.244 [I] Progress on: 3.42kit/100kit rate:2.1it/s remaining:12:38:24 elapsed:27:14 postfix:- (2531865:tqdm_logging.py:145)
19:53:12.582 [I] Progress on: 3.44kit/100kit rate:2.1it/s remaining:12:36:39 elapsed:27:24 postfix:- (2531865:tqdm_logging.py:145)
19:53:22.648 [I] Progress on: 3.46kit/100kit rate:2.1it/s remaining:12:37:41 elapsed:27:34 postfix:- (2531865:tqdm_logging.py:145)
19:53:32.988 [I] Progress on: 3.48kit/100kit rate:2.1it/s remaining:12:35:16 elapsed:27:45 postfix:- (2531865:tqdm_logging.py:145)
Step 3500: grad_norm=0.1736, loss=0.0077, param_norm=1379.9905
19:53:43.379 [I] Progress on: 3.50kit/100kit rate:2.1it/s remaining:12:32:10 elapsed:27:55 postfix:- (2531865:tqdm_logging.py:145)
19:53:53.722 [I] Progress on: 3.53kit/100kit rate:2.1it/s remaining:12:35:33 elapsed:28:05 postfix:- (2531865:tqdm_logging.py:145)
19:54:04.063 [I] Progress on: 3.55kit/100kit rate:2.1it/s remaining:12:34:43 elapsed:28:16 postfix:- (2531865:tqdm_logging.py:145)
19:54:14.404 [I] Progress on: 3.57kit/100kit rate:2.1it/s remaining:12:35:22 elapsed:28:26 postfix:- (2531865:tqdm_logging.py:145)
19:54:24.743 [I] Progress on: 3.59kit/100kit rate:2.1it/s remaining:12:34:25 elapsed:28:36 postfix:- (2531865:tqdm_logging.py:145)
Step 3600: grad_norm=0.1765, loss=0.0076, param_norm=1379.9985
19:54:35.136 [I] Progress on: 3.61kit/100kit rate:2.1it/s remaining:12:34:19 elapsed:28:47 postfix:- (2531865:tqdm_logging.py:145)
19:54:45.480 [I] Progress on: 3.64kit/100kit rate:2.1it/s remaining:12:33:58 elapsed:28:57 postfix:- (2531865:tqdm_logging.py:145)
19:54:55.822 [I] Progress on: 3.66kit/100kit rate:2.1it/s remaining:12:33:56 elapsed:29:07 postfix:- (2531865:tqdm_logging.py:145)
19:55:06.162 [I] Progress on: 3.68kit/100kit rate:2.1it/s remaining:12:33:56 elapsed:29:18 postfix:- (2531865:tqdm_logging.py:145)
Step 3700: grad_norm=0.1939, loss=0.0080, param_norm=1380.0070
19:55:16.208 [I] Progress on: 3.70kit/100kit rate:2.1it/s remaining:12:33:41 elapsed:29:28 postfix:- (2531865:tqdm_logging.py:145)
19:55:26.426 [I] Progress on: 3.72kit/100kit rate:2.1it/s remaining:12:35:18 elapsed:29:38 postfix:- (2531865:tqdm_logging.py:145)
19:55:36.764 [I] Progress on: 3.75kit/100kit rate:2.1it/s remaining:12:34:55 elapsed:29:48 postfix:- (2531865:tqdm_logging.py:145)
19:55:47.105 [I] Progress on: 3.77kit/100kit rate:2.1it/s remaining:12:34:08 elapsed:29:59 postfix:- (2531865:tqdm_logging.py:145)
19:55:57.833 [I] Progress on: 3.79kit/100kit rate:1.7it/s remaining:15:40:23 elapsed:30:09 postfix:- (2531865:tqdm_logging.py:145)
Step 3800: grad_norm=0.2192, loss=0.0079, param_norm=1380.0156
19:56:08.060 [I] Progress on: 3.81kit/100kit rate:2.1it/s remaining:12:32:16 elapsed:30:20 postfix:- (2531865:tqdm_logging.py:145)
19:56:18.403 [I] Progress on: 3.83kit/100kit rate:2.1it/s remaining:12:32:12 elapsed:30:30 postfix:- (2531865:tqdm_logging.py:145)
19:56:28.744 [I] Progress on: 3.85kit/100kit rate:2.1it/s remaining:12:32:07 elapsed:30:40 postfix:- (2531865:tqdm_logging.py:145)
19:56:39.085 [I] Progress on: 3.88kit/100kit rate:2.1it/s remaining:12:32:06 elapsed:30:51 postfix:- (2531865:tqdm_logging.py:145)
19:56:49.427 [I] Progress on: 3.90kit/100kit rate:2.1it/s remaining:12:32:18 elapsed:31:01 postfix:- (2531865:tqdm_logging.py:145)
Step 3900: grad_norm=0.1714, loss=0.0068, param_norm=1380.0236
19:56:59.817 [I] Progress on: 3.92kit/100kit rate:2.1it/s remaining:12:31:52 elapsed:31:11 postfix:- (2531865:tqdm_logging.py:145)
19:57:10.160 [I] Progress on: 3.94kit/100kit rate:2.1it/s remaining:12:31:46 elapsed:31:22 postfix:- (2531865:tqdm_logging.py:145)
19:57:20.500 [I] Progress on: 3.96kit/100kit rate:2.1it/s remaining:12:32:03 elapsed:31:32 postfix:- (2531865:tqdm_logging.py:145)
19:57:30.840 [I] Progress on: 3.99kit/100kit rate:2.1it/s remaining:12:31:03 elapsed:31:42 postfix:- (2531865:tqdm_logging.py:145)
Step 4000: grad_norm=0.2392, loss=0.0075, param_norm=1380.0317
19:57:37.630 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
19:57:37.630 [I] [process=0] Saving checkpoint at step 4000                                       (2531865:checkpoint_manager.py:1408)
19:57:37.630 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000. (2531865:async_checkpointer.py:439)
19:57:37.641 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12 (2531865:atomicity.py:144)
19:57:37.649 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/train_state.orbax-checkpoint-tmp-15 (2531865:atomicity.py:144)
19:57:37.649 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 (2531865:atomicity.py:144)
19:57:37.649 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 (2531865:atomicity.py:144)
19:57:37.666 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
19:57:38.237 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
19:57:38.258 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
19:57:41.810 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.7 GiB/s (total bytes: 7.0 GiB) (time elapsed: 4 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:57:41.826 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.5 GiB/s (total bytes: 10.5 GiB) (time elapsed: 4 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:57:41.829 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
19:57:41.830 [I] Finished blocking save in 4.20 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000. (2531865:async_checkpointer.py:548)
19:57:41.830 [I] Deleting Checkpoint[step=3000 | time=2025-11-02 11:49:45.842673+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
19:57:41.831 [I] [process=0][thread=MainThread][step=4000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
19:57:41.831 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
19:57:41.831 [I] {'step': 4000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762084657.630026, 'wait_for_prev_duration_secs': 0.0002110004425048828, 'checkpointer_blocking_start_time': 1762084657.6305802, 'checkpointer_blocking_duration_secs': 4.200252294540405, 'get_old_steps_start_time': 1762084661.8308609, 'get_old_steps_duration_secs': 0.000263214111328125, 'checkpoint_manager_blocking_start_time': 1762084657.629874, 'checkpoint_manager_blocking_duration_secs': 4.202051401138306} (2531865:standard_logger.py:34)
19:57:41.832 [I] Progress on: 4.00kit/100kit rate:1.8s/it remaining:47:48:57 elapsed:31:53 postfix:- (2531865:tqdm_logging.py:145)
19:57:41.885 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/train_state.orbax-checkpoint-tmp-15/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
19:57:52.049 [I] Progress on: 4.02kit/100kit rate:1.4s/it remaining:37:39:16 elapsed:32:04 postfix:- (2531865:tqdm_logging.py:145)
19:57:53.305 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 457.1 MiB/s (total bytes: 7.0 GiB) (time elapsed: 15 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:57:53.896 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 660.4 MiB/s (total bytes: 10.5 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
19:57:53.896 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
19:57:53.897 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/assets.orbax-checkpoint-tmp-13 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/assets (2531865:atomicity.py:289)
19:57:53.903 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
19:57:53.932 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/train_state.orbax-checkpoint-tmp-15 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/train_state (2531865:atomicity.py:289)
19:57:53.937 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
19:57:53.957 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/params.orbax-checkpoint-tmp-14 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12/params (2531865:atomicity.py:289)
19:57:53.958 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000.orbax-checkpoint-tmp-12 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000 (2531865:atomicity.py:289)
19:57:53.963 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000`. (2531865:atomicity.py:573)
19:57:53.963 [I] Finished asynchronous save (blocking + background) in 16.33 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/4000 (2531865:async_checkpointer.py:412)
19:57:53.963 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
19:57:53.963 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
19:57:53.963 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
19:57:54.463 [I] Deleted step 3000.                                                               (2531865:deleter.py:114)
19:57:54.464 [I] [process=0][thread=save_finalize][step=4000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
19:57:54.464 [I] [process=0][thread=save_finalize][step=4000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
19:58:02.241 [I] Progress on: 4.04kit/100kit rate:2.1it/s remaining:12:32:20 elapsed:32:14 postfix:- (2531865:tqdm_logging.py:145)
19:58:12.576 [I] Progress on: 4.06kit/100kit rate:2.1it/s remaining:12:35:01 elapsed:32:24 postfix:- (2531865:tqdm_logging.py:145)
19:58:22.908 [I] Progress on: 4.08kit/100kit rate:2.1it/s remaining:12:31:32 elapsed:32:34 postfix:- (2531865:tqdm_logging.py:145)
Step 4100: grad_norm=0.1590, loss=0.0067, param_norm=1380.0397
19:58:33.310 [I] Progress on: 4.10kit/100kit rate:2.1it/s remaining:12:29:49 elapsed:32:45 postfix:- (2531865:tqdm_logging.py:145)
19:58:43.646 [I] Progress on: 4.13kit/100kit rate:2.1it/s remaining:12:31:10 elapsed:32:55 postfix:- (2531865:tqdm_logging.py:145)
19:58:53.983 [I] Progress on: 4.15kit/100kit rate:2.1it/s remaining:12:32:22 elapsed:33:06 postfix:- (2531865:tqdm_logging.py:145)
19:59:04.317 [I] Progress on: 4.17kit/100kit rate:2.1it/s remaining:12:29:39 elapsed:33:16 postfix:- (2531865:tqdm_logging.py:145)
19:59:14.661 [I] Progress on: 4.19kit/100kit rate:2.1it/s remaining:12:30:42 elapsed:33:26 postfix:- (2531865:tqdm_logging.py:145)
Step 4200: grad_norm=0.1775, loss=0.0072, param_norm=1380.0475
19:59:24.794 [I] Progress on: 4.21kit/100kit rate:2.1it/s remaining:12:47:15 elapsed:33:36 postfix:- (2531865:tqdm_logging.py:145)
19:59:35.130 [I] Progress on: 4.24kit/100kit rate:2.2it/s remaining:12:17:25 elapsed:33:47 postfix:- (2531865:tqdm_logging.py:145)
19:59:45.468 [I] Progress on: 4.26kit/100kit rate:2.2it/s remaining:12:18:25 elapsed:33:57 postfix:- (2531865:tqdm_logging.py:145)
19:59:55.803 [I] Progress on: 4.28kit/100kit rate:2.2it/s remaining:12:16:49 elapsed:34:07 postfix:- (2531865:tqdm_logging.py:145)
Step 4300: grad_norm=0.1957, loss=0.0069, param_norm=1380.0549
20:00:06.343 [I] Progress on: 4.30kit/100kit rate:2.1it/s remaining:12:41:29 elapsed:34:18 postfix:- (2531865:tqdm_logging.py:145)
20:00:16.540 [I] Progress on: 4.32kit/100kit rate:2.1it/s remaining:12:29:48 elapsed:34:28 postfix:- (2531865:tqdm_logging.py:145)
20:00:26.874 [I] Progress on: 4.34kit/100kit rate:2.1it/s remaining:12:29:17 elapsed:34:38 postfix:- (2531865:tqdm_logging.py:145)
20:00:37.216 [I] Progress on: 4.37kit/100kit rate:2.1it/s remaining:12:29:43 elapsed:34:49 postfix:- (2531865:tqdm_logging.py:145)
20:00:47.556 [I] Progress on: 4.39kit/100kit rate:2.1it/s remaining:12:29:31 elapsed:34:59 postfix:- (2531865:tqdm_logging.py:145)
Step 4400: grad_norm=0.2023, loss=0.0071, param_norm=1380.0626
20:00:57.946 [I] Progress on: 4.41kit/100kit rate:2.1it/s remaining:12:30:54 elapsed:35:09 postfix:- (2531865:tqdm_logging.py:145)
20:01:08.280 [I] Progress on: 4.43kit/100kit rate:2.1it/s remaining:12:28:17 elapsed:35:20 postfix:- (2531865:tqdm_logging.py:145)
20:01:18.369 [I] Progress on: 4.45kit/100kit rate:2.1it/s remaining:12:28:03 elapsed:35:30 postfix:- (2531865:tqdm_logging.py:145)
20:01:28.712 [I] Progress on: 4.48kit/100kit rate:2.1it/s remaining:12:28:29 elapsed:35:40 postfix:- (2531865:tqdm_logging.py:145)
20:01:39.050 [I] Progress on: 4.50kit/100kit rate:2.1it/s remaining:12:29:20 elapsed:35:51 postfix:- (2531865:tqdm_logging.py:145)
Step 4500: grad_norm=0.1732, loss=0.0066, param_norm=1380.0710
20:01:49.440 [I] Progress on: 4.52kit/100kit rate:2.1it/s remaining:12:27:51 elapsed:36:01 postfix:- (2531865:tqdm_logging.py:145)
20:01:59.779 [I] Progress on: 4.54kit/100kit rate:2.1it/s remaining:12:27:56 elapsed:36:11 postfix:- (2531865:tqdm_logging.py:145)
20:02:10.110 [I] Progress on: 4.56kit/100kit rate:2.1it/s remaining:12:25:22 elapsed:36:22 postfix:- (2531865:tqdm_logging.py:145)
20:02:20.456 [I] Progress on: 4.59kit/100kit rate:2.1it/s remaining:12:27:26 elapsed:36:32 postfix:- (2531865:tqdm_logging.py:145)
Step 4600: grad_norm=0.1554, loss=0.0064, param_norm=1380.0793
20:02:30.844 [I] Progress on: 4.61kit/100kit rate:2.1it/s remaining:12:26:27 elapsed:36:42 postfix:- (2531865:tqdm_logging.py:145)
20:02:41.184 [I] Progress on: 4.63kit/100kit rate:2.1it/s remaining:12:26:31 elapsed:36:53 postfix:- (2531865:tqdm_logging.py:145)
20:02:51.406 [I] Progress on: 4.65kit/100kit rate:2.1it/s remaining:12:37:00 elapsed:37:03 postfix:- (2531865:tqdm_logging.py:145)
20:03:01.751 [I] Progress on: 4.67kit/100kit rate:2.1it/s remaining:12:39:38 elapsed:37:13 postfix:- (2531865:tqdm_logging.py:145)
20:03:12.090 [I] Progress on: 4.70kit/100kit rate:2.1it/s remaining:12:38:40 elapsed:37:24 postfix:- (2531865:tqdm_logging.py:145)
Step 4700: grad_norm=0.1636, loss=0.0064, param_norm=1380.0870
20:03:22.507 [I] Progress on: 4.72kit/100kit rate:2.1it/s remaining:12:38:18 elapsed:37:34 postfix:- (2531865:tqdm_logging.py:145)
20:03:32.848 [I] Progress on: 4.74kit/100kit rate:2.1it/s remaining:12:38:24 elapsed:37:44 postfix:- (2531865:tqdm_logging.py:145)
20:03:43.184 [I] Progress on: 4.76kit/100kit rate:2.1it/s remaining:12:37:48 elapsed:37:55 postfix:- (2531865:tqdm_logging.py:145)
20:03:53.528 [I] Progress on: 4.78kit/100kit rate:2.1it/s remaining:12:38:33 elapsed:38:05 postfix:- (2531865:tqdm_logging.py:145)
Step 4800: grad_norm=0.1553, loss=0.0061, param_norm=1380.0948
20:04:03.926 [I] Progress on: 4.80kit/100kit rate:2.1it/s remaining:12:36:54 elapsed:38:15 postfix:- (2531865:tqdm_logging.py:145)
20:04:14.271 [I] Progress on: 4.83kit/100kit rate:2.1it/s remaining:12:37:30 elapsed:38:26 postfix:- (2531865:tqdm_logging.py:145)
20:04:24.606 [I] Progress on: 4.85kit/100kit rate:2.1it/s remaining:12:35:13 elapsed:38:36 postfix:- (2531865:tqdm_logging.py:145)
20:04:34.956 [I] Progress on: 4.87kit/100kit rate:2.1it/s remaining:12:37:45 elapsed:38:46 postfix:- (2531865:tqdm_logging.py:145)
20:04:45.297 [I] Progress on: 4.89kit/100kit rate:2.1it/s remaining:12:38:18 elapsed:38:57 postfix:- (2531865:tqdm_logging.py:145)
Step 4900: grad_norm=0.1606, loss=0.0064, param_norm=1380.1024
20:04:55.707 [I] Progress on: 4.92kit/100kit rate:2.1it/s remaining:12:36:11 elapsed:39:07 postfix:- (2531865:tqdm_logging.py:145)
20:05:06.046 [I] Progress on: 4.94kit/100kit rate:2.1it/s remaining:12:36:14 elapsed:39:18 postfix:- (2531865:tqdm_logging.py:145)
20:05:16.386 [I] Progress on: 4.96kit/100kit rate:2.1it/s remaining:12:35:35 elapsed:39:28 postfix:- (2531865:tqdm_logging.py:145)
20:05:26.726 [I] Progress on: 4.98kit/100kit rate:2.1it/s remaining:12:35:42 elapsed:39:38 postfix:- (2531865:tqdm_logging.py:145)
Step 5000: grad_norm=0.1691, loss=0.0063, param_norm=1380.1100
20:05:36.337 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
20:05:36.337 [I] [process=0] Saving checkpoint at step 5000                                       (2531865:checkpoint_manager.py:1408)
20:05:36.338 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000. (2531865:async_checkpointer.py:439)
20:05:36.348 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16 (2531865:atomicity.py:144)
20:05:36.353 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/assets.orbax-checkpoint-tmp-17 (2531865:atomicity.py:144)
20:05:36.354 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/train_state.orbax-checkpoint-tmp-19 (2531865:atomicity.py:144)
20:05:36.354 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/params.orbax-checkpoint-tmp-18 (2531865:atomicity.py:144)
20:05:36.373 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:05:36.930 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:05:36.950 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/params.orbax-checkpoint-tmp-18/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:05:40.921 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.5 GiB/s (total bytes: 7.0 GiB) (time elapsed: 4 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:05:40.931 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.3 GiB/s (total bytes: 10.5 GiB) (time elapsed: 4 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:05:40.942 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
20:05:40.942 [I] Finished blocking save in 4.61 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000. (2531865:async_checkpointer.py:548)
20:05:40.944 [I] Deleting Checkpoint[step=4000 | time=2025-11-02 11:57:41.830842+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
20:05:40.944 [I] [process=0][thread=MainThread][step=5000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
20:05:40.945 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
20:05:40.946 [I] {'step': 5000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762085136.3373249, 'wait_for_prev_duration_secs': 0.0002205371856689453, 'checkpointer_blocking_start_time': 1762085136.337815, 'checkpointer_blocking_duration_secs': 4.606858730316162, 'get_old_steps_start_time': 1762085140.9447012, 'get_old_steps_duration_secs': 0.00012302398681640625, 'checkpoint_manager_blocking_start_time': 1762085136.337208, 'checkpoint_manager_blocking_duration_secs': 4.608757257461548} (2531865:standard_logger.py:34)
20:05:40.946 [I] Progress on: 5.00kit/100kit rate:1.9s/it remaining:50:46:07 elapsed:39:52 postfix:- (2531865:tqdm_logging.py:145)
20:05:41.041 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/train_state.orbax-checkpoint-tmp-19/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:05:50.671 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 499.9 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:05:51.428 [I] Progress on: 5.01kit/100kit rate:1.8it/s remaining:14:32:22 elapsed:40:03 postfix:- (2531865:tqdm_logging.py:145)
20:05:53.124 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 639.9 MiB/s (total bytes: 10.5 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:05:53.125 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
20:05:53.126 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/assets.orbax-checkpoint-tmp-17 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/assets (2531865:atomicity.py:289)
20:05:53.131 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:05:53.184 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/train_state.orbax-checkpoint-tmp-19 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/train_state (2531865:atomicity.py:289)
20:05:53.188 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:05:53.207 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/params.orbax-checkpoint-tmp-18 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16/params (2531865:atomicity.py:289)
20:05:53.208 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000.orbax-checkpoint-tmp-16 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000 (2531865:atomicity.py:289)
20:05:53.213 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000`. (2531865:atomicity.py:573)
20:05:53.213 [I] Finished asynchronous save (blocking + background) in 16.88 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/5000 (2531865:async_checkpointer.py:412)
20:05:53.213 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
20:05:53.213 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
20:05:53.214 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
20:05:53.820 [I] Deleted step 4000.                                                               (2531865:deleter.py:114)
20:05:53.820 [I] [process=0][thread=save_finalize][step=5000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
20:05:53.820 [I] [process=0][thread=save_finalize][step=5000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
20:06:01.792 [I] Progress on: 5.04kit/100kit rate:2.1it/s remaining:12:43:04 elapsed:40:13 postfix:- (2531865:tqdm_logging.py:145)
20:06:11.874 [I] Progress on: 5.06kit/100kit rate:2.1it/s remaining:12:46:24 elapsed:40:23 postfix:- (2531865:tqdm_logging.py:145)
20:06:22.215 [I] Progress on: 5.08kit/100kit rate:2.1it/s remaining:12:36:08 elapsed:40:34 postfix:- (2531865:tqdm_logging.py:145)
Step 5100: grad_norm=0.1549, loss=0.0060, param_norm=1380.1173
20:06:32.229 [I] Progress on: 5.10kit/100kit rate:2.1it/s remaining:12:36:18 elapsed:40:44 postfix:- (2531865:tqdm_logging.py:145)
20:06:42.425 [I] Progress on: 5.12kit/100kit rate:2.1it/s remaining:12:24:12 elapsed:40:54 postfix:- (2531865:tqdm_logging.py:145)
20:06:52.764 [I] Progress on: 5.14kit/100kit rate:2.1it/s remaining:12:23:13 elapsed:41:04 postfix:- (2531865:tqdm_logging.py:145)
20:07:03.098 [I] Progress on: 5.17kit/100kit rate:2.1it/s remaining:12:22:32 elapsed:41:15 postfix:- (2531865:tqdm_logging.py:145)
20:07:13.436 [I] Progress on: 5.19kit/100kit rate:2.1it/s remaining:12:22:54 elapsed:41:25 postfix:- (2531865:tqdm_logging.py:145)
Step 5200: grad_norm=0.1579, loss=0.0064, param_norm=1380.1246
20:07:23.820 [I] Progress on: 5.21kit/100kit rate:2.1it/s remaining:12:22:22 elapsed:41:35 postfix:- (2531865:tqdm_logging.py:145)
20:07:34.160 [I] Progress on: 5.23kit/100kit rate:2.1it/s remaining:12:22:48 elapsed:41:46 postfix:- (2531865:tqdm_logging.py:145)
20:07:44.498 [I] Progress on: 5.25kit/100kit rate:2.1it/s remaining:12:22:41 elapsed:41:56 postfix:- (2531865:tqdm_logging.py:145)
20:07:54.837 [I] Progress on: 5.28kit/100kit rate:2.1it/s remaining:12:21:59 elapsed:42:06 postfix:- (2531865:tqdm_logging.py:145)
20:08:05.183 [I] Progress on: 5.30kit/100kit rate:2.1it/s remaining:12:23:26 elapsed:42:17 postfix:- (2531865:tqdm_logging.py:145)
Step 5300: grad_norm=0.1614, loss=0.0061, param_norm=1380.1323
20:08:15.571 [I] Progress on: 5.32kit/100kit rate:2.1it/s remaining:12:22:13 elapsed:42:27 postfix:- (2531865:tqdm_logging.py:145)
20:08:25.912 [I] Progress on: 5.34kit/100kit rate:2.1it/s remaining:12:22:27 elapsed:42:37 postfix:- (2531865:tqdm_logging.py:145)
20:08:36.249 [I] Progress on: 5.37kit/100kit rate:2.1it/s remaining:12:20:50 elapsed:42:48 postfix:- (2531865:tqdm_logging.py:145)
20:08:46.586 [I] Progress on: 5.39kit/100kit rate:2.1it/s remaining:12:21:15 elapsed:42:58 postfix:- (2531865:tqdm_logging.py:145)
Step 5400: grad_norm=0.1525, loss=0.0059, param_norm=1380.1400
20:08:56.704 [I] Progress on: 5.41kit/100kit rate:2.1it/s remaining:12:21:04 elapsed:43:08 postfix:- (2531865:tqdm_logging.py:145)
20:09:07.043 [I] Progress on: 5.43kit/100kit rate:2.1it/s remaining:12:20:46 elapsed:43:19 postfix:- (2531865:tqdm_logging.py:145)
20:09:17.378 [I] Progress on: 5.45kit/100kit rate:2.1it/s remaining:12:20:10 elapsed:43:29 postfix:- (2531865:tqdm_logging.py:145)
20:09:27.612 [I] Progress on: 5.47kit/100kit rate:1.7it/s remaining:15:13:01 elapsed:43:39 postfix:- (2531865:tqdm_logging.py:145)
20:09:37.793 [I] Progress on: 5.50kit/100kit rate:2.1it/s remaining:12:20:18 elapsed:43:49 postfix:- (2531865:tqdm_logging.py:145)
Step 5500: grad_norm=0.1532, loss=0.0061, param_norm=1380.1472
20:09:48.179 [I] Progress on: 5.52kit/100kit rate:2.1it/s remaining:12:20:06 elapsed:44:00 postfix:- (2531865:tqdm_logging.py:145)
20:09:58.522 [I] Progress on: 5.54kit/100kit rate:2.1it/s remaining:12:20:34 elapsed:44:10 postfix:- (2531865:tqdm_logging.py:145)
20:10:08.861 [I] Progress on: 5.56kit/100kit rate:2.1it/s remaining:12:19:58 elapsed:44:20 postfix:- (2531865:tqdm_logging.py:145)
20:10:19.201 [I] Progress on: 5.58kit/100kit rate:2.1it/s remaining:12:19:00 elapsed:44:31 postfix:- (2531865:tqdm_logging.py:145)
Step 5600: grad_norm=0.1510, loss=0.0056, param_norm=1380.1543
20:10:29.592 [I] Progress on: 5.61kit/100kit rate:2.1it/s remaining:12:18:08 elapsed:44:41 postfix:- (2531865:tqdm_logging.py:145)
20:10:39.927 [I] Progress on: 5.63kit/100kit rate:2.1it/s remaining:12:19:05 elapsed:44:51 postfix:- (2531865:tqdm_logging.py:145)
20:10:50.267 [I] Progress on: 5.65kit/100kit rate:2.1it/s remaining:12:19:21 elapsed:45:02 postfix:- (2531865:tqdm_logging.py:145)
20:11:00.604 [I] Progress on: 5.67kit/100kit rate:2.1it/s remaining:12:19:02 elapsed:45:12 postfix:- (2531865:tqdm_logging.py:145)
20:11:10.943 [I] Progress on: 5.69kit/100kit rate:2.1it/s remaining:12:18:44 elapsed:45:22 postfix:- (2531865:tqdm_logging.py:145)
Step 5700: grad_norm=0.1625, loss=0.0055, param_norm=1380.1621
20:11:21.328 [I] Progress on: 5.71kit/100kit rate:2.1it/s remaining:12:18:28 elapsed:45:33 postfix:- (2531865:tqdm_logging.py:145)
20:11:31.666 [I] Progress on: 5.74kit/100kit rate:2.1it/s remaining:12:18:08 elapsed:45:43 postfix:- (2531865:tqdm_logging.py:145)
20:11:42.007 [I] Progress on: 5.76kit/100kit rate:2.1it/s remaining:12:18:54 elapsed:45:54 postfix:- (2531865:tqdm_logging.py:145)
20:11:52.345 [I] Progress on: 5.78kit/100kit rate:2.1it/s remaining:12:18:41 elapsed:46:04 postfix:- (2531865:tqdm_logging.py:145)
Step 5800: grad_norm=0.1745, loss=0.0060, param_norm=1380.1693
20:12:02.733 [I] Progress on: 5.80kit/100kit rate:2.1it/s remaining:12:14:41 elapsed:46:14 postfix:- (2531865:tqdm_logging.py:145)
20:12:13.069 [I] Progress on: 5.83kit/100kit rate:2.1it/s remaining:12:17:27 elapsed:46:25 postfix:- (2531865:tqdm_logging.py:145)
20:12:23.409 [I] Progress on: 5.85kit/100kit rate:2.1it/s remaining:12:17:37 elapsed:46:35 postfix:- (2531865:tqdm_logging.py:145)
20:12:33.744 [I] Progress on: 5.87kit/100kit rate:2.1it/s remaining:12:17:03 elapsed:46:45 postfix:- (2531865:tqdm_logging.py:145)
20:12:44.083 [I] Progress on: 5.89kit/100kit rate:2.1it/s remaining:12:16:45 elapsed:46:56 postfix:- (2531865:tqdm_logging.py:145)
Step 5900: grad_norm=0.1516, loss=0.0056, param_norm=1380.1765
20:12:54.218 [I] Progress on: 5.91kit/100kit rate:2.1it/s remaining:12:16:48 elapsed:47:06 postfix:- (2531865:tqdm_logging.py:145)
20:13:04.555 [I] Progress on: 5.93kit/100kit rate:2.1it/s remaining:12:16:28 elapsed:47:16 postfix:- (2531865:tqdm_logging.py:145)
20:13:14.893 [I] Progress on: 5.96kit/100kit rate:2.1it/s remaining:12:16:14 elapsed:47:26 postfix:- (2531865:tqdm_logging.py:145)
20:13:25.229 [I] Progress on: 5.98kit/100kit rate:2.1it/s remaining:12:15:39 elapsed:47:37 postfix:- (2531865:tqdm_logging.py:145)
20:13:35.568 [I] Progress on: 6.00kit/100kit rate:2.1it/s remaining:12:15:32 elapsed:47:47 postfix:- (2531865:tqdm_logging.py:145)
Step 6000: grad_norm=0.1419, loss=0.0053, param_norm=1380.1833
20:13:36.251 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
20:13:36.252 [I] [process=0] Saving checkpoint at step 6000                                       (2531865:checkpoint_manager.py:1408)
20:13:36.252 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000. (2531865:async_checkpointer.py:439)
20:13:36.263 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20 (2531865:atomicity.py:144)
20:13:36.268 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/params.orbax-checkpoint-tmp-22 (2531865:atomicity.py:144)
20:13:36.268 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/assets.orbax-checkpoint-tmp-21 (2531865:atomicity.py:144)
20:13:36.268 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/train_state.orbax-checkpoint-tmp-23 (2531865:atomicity.py:144)
20:13:36.288 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:13:36.789 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:13:36.814 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/params.orbax-checkpoint-tmp-22/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:13:38.776 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:13:38.790 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 4.1 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:13:38.796 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
20:13:38.796 [I] Finished blocking save in 2.54 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000. (2531865:async_checkpointer.py:548)
20:13:38.797 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
20:13:38.797 [I] [process=0][thread=MainThread][step=6000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
20:13:38.798 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
20:13:38.798 [I] {'step': 6000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762085616.2518003, 'wait_for_prev_duration_secs': 0.0002117156982421875, 'checkpointer_blocking_start_time': 1762085616.252335, 'checkpointer_blocking_duration_secs': 2.545142650604248, 'get_old_steps_start_time': 1762085618.797504, 'get_old_steps_duration_secs': 0.000125885009765625, 'checkpoint_manager_blocking_start_time': 1762085616.2516537, 'checkpoint_manager_blocking_duration_secs': 2.5468008518218994} (2531865:standard_logger.py:34)
20:13:38.825 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/train_state.orbax-checkpoint-tmp-23/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:13:45.727 [I] Progress on: 6.01kit/100kit rate:1.3it/s remaining:20:01:45 elapsed:47:57 postfix:- (2531865:tqdm_logging.py:145)
20:13:49.941 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 523.4 MiB/s (total bytes: 7.0 GiB) (time elapsed: 13 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:13:53.771 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 613.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: 17 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:13:53.771 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
20:13:53.773 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/assets.orbax-checkpoint-tmp-21 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/assets (2531865:atomicity.py:289)
20:13:53.778 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:13:53.917 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/train_state.orbax-checkpoint-tmp-23 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/train_state (2531865:atomicity.py:289)
20:13:53.922 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:13:54.009 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/params.orbax-checkpoint-tmp-22 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20/params (2531865:atomicity.py:289)
20:13:54.011 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000.orbax-checkpoint-tmp-20 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000 (2531865:atomicity.py:289)
20:13:54.015 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000`. (2531865:atomicity.py:573)
20:13:54.016 [I] Finished asynchronous save (blocking + background) in 17.76 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/6000 (2531865:async_checkpointer.py:412)
20:13:54.016 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
20:13:54.016 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
20:13:54.016 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
20:13:54.016 [I] [process=0][thread=save_finalize][step=6000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
20:13:54.016 [I] [process=0][thread=save_finalize][step=6000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
20:13:55.936 [I] Progress on: 6.03kit/100kit rate:2.1it/s remaining:12:15:57 elapsed:48:07 postfix:- (2531865:tqdm_logging.py:145)
20:14:06.276 [I] Progress on: 6.05kit/100kit rate:2.1it/s remaining:12:15:40 elapsed:48:18 postfix:- (2531865:tqdm_logging.py:145)
20:14:16.613 [I] Progress on: 6.08kit/100kit rate:2.1it/s remaining:12:15:32 elapsed:48:28 postfix:- (2531865:tqdm_logging.py:145)
20:14:26.951 [I] Progress on: 6.10kit/100kit rate:2.1it/s remaining:12:15:28 elapsed:48:38 postfix:- (2531865:tqdm_logging.py:145)
Step 6100: grad_norm=0.1482, loss=0.0054, param_norm=1380.1903
20:14:37.344 [I] Progress on: 6.12kit/100kit rate:2.1it/s remaining:12:14:34 elapsed:48:49 postfix:- (2531865:tqdm_logging.py:145)
20:14:47.680 [I] Progress on: 6.14kit/100kit rate:2.1it/s remaining:12:14:44 elapsed:48:59 postfix:- (2531865:tqdm_logging.py:145)
20:14:58.022 [I] Progress on: 6.16kit/100kit rate:2.1it/s remaining:12:15:25 elapsed:49:10 postfix:- (2531865:tqdm_logging.py:145)
20:15:08.358 [I] Progress on: 6.19kit/100kit rate:2.1it/s remaining:12:13:58 elapsed:49:20 postfix:- (2531865:tqdm_logging.py:145)
Step 6200: grad_norm=0.1609, loss=0.0059, param_norm=1380.1978
20:15:18.749 [I] Progress on: 6.21kit/100kit rate:2.1it/s remaining:12:13:37 elapsed:49:30 postfix:- (2531865:tqdm_logging.py:145)
20:15:29.089 [I] Progress on: 6.23kit/100kit rate:2.1it/s remaining:12:14:19 elapsed:49:41 postfix:- (2531865:tqdm_logging.py:145)
20:15:39.427 [I] Progress on: 6.25kit/100kit rate:2.1it/s remaining:12:13:54 elapsed:49:51 postfix:- (2531865:tqdm_logging.py:145)
20:15:49.767 [I] Progress on: 6.27kit/100kit rate:2.1it/s remaining:12:14:27 elapsed:50:01 postfix:- (2531865:tqdm_logging.py:145)
20:16:00.112 [I] Progress on: 6.30kit/100kit rate:2.1it/s remaining:12:16:24 elapsed:50:12 postfix:- (2531865:tqdm_logging.py:145)
Step 6300: grad_norm=0.1561, loss=0.0054, param_norm=1380.2048
20:16:10.447 [I] Progress on: 6.32kit/100kit rate:2.0it/s remaining:13:02:13 elapsed:50:22 postfix:- (2531865:tqdm_logging.py:145)
20:16:20.784 [I] Progress on: 6.34kit/100kit rate:2.1it/s remaining:12:24:06 elapsed:50:32 postfix:- (2531865:tqdm_logging.py:145)
20:16:31.122 [I] Progress on: 6.36kit/100kit rate:2.1it/s remaining:12:23:41 elapsed:50:43 postfix:- (2531865:tqdm_logging.py:145)
20:16:41.458 [I] Progress on: 6.38kit/100kit rate:2.1it/s remaining:12:23:25 elapsed:50:53 postfix:- (2531865:tqdm_logging.py:145)
Step 6400: grad_norm=0.1475, loss=0.0054, param_norm=1380.2115
20:16:51.860 [I] Progress on: 6.41kit/100kit rate:2.1it/s remaining:12:23:56 elapsed:51:03 postfix:- (2531865:tqdm_logging.py:145)
20:17:02.198 [I] Progress on: 6.43kit/100kit rate:2.1it/s remaining:12:23:42 elapsed:51:14 postfix:- (2531865:tqdm_logging.py:145)
20:17:12.206 [I] Progress on: 6.45kit/100kit rate:2.1it/s remaining:12:13:07 elapsed:51:24 postfix:- (2531865:tqdm_logging.py:145)
20:17:22.546 [I] Progress on: 6.47kit/100kit rate:2.1it/s remaining:12:12:52 elapsed:51:34 postfix:- (2531865:tqdm_logging.py:145)
20:17:32.887 [I] Progress on: 6.49kit/100kit rate:2.1it/s remaining:12:12:52 elapsed:51:44 postfix:- (2531865:tqdm_logging.py:145)
Step 6500: grad_norm=0.1463, loss=0.0053, param_norm=1380.2184
20:17:43.272 [I] Progress on: 6.51kit/100kit rate:2.1it/s remaining:12:12:17 elapsed:51:55 postfix:- (2531865:tqdm_logging.py:145)
20:17:53.609 [I] Progress on: 6.54kit/100kit rate:2.1it/s remaining:12:11:53 elapsed:52:05 postfix:- (2531865:tqdm_logging.py:145)
20:18:03.951 [I] Progress on: 6.56kit/100kit rate:2.1it/s remaining:12:12:02 elapsed:52:15 postfix:- (2531865:tqdm_logging.py:145)
20:18:14.290 [I] Progress on: 6.58kit/100kit rate:2.1it/s remaining:12:11:30 elapsed:52:26 postfix:- (2531865:tqdm_logging.py:145)
Step 6600: grad_norm=0.1633, loss=0.0052, param_norm=1380.2256
20:18:24.330 [I] Progress on: 6.60kit/100kit rate:2.1it/s remaining:12:11:37 elapsed:52:36 postfix:- (2531865:tqdm_logging.py:145)
20:18:34.542 [I] Progress on: 6.62kit/100kit rate:2.1it/s remaining:12:11:13 elapsed:52:46 postfix:- (2531865:tqdm_logging.py:145)
20:18:44.880 [I] Progress on: 6.64kit/100kit rate:2.1it/s remaining:12:10:24 elapsed:52:56 postfix:- (2531865:tqdm_logging.py:145)
20:18:55.220 [I] Progress on: 6.67kit/100kit rate:2.1it/s remaining:12:10:33 elapsed:53:07 postfix:- (2531865:tqdm_logging.py:145)
20:19:05.560 [I] Progress on: 6.69kit/100kit rate:2.1it/s remaining:12:10:31 elapsed:53:17 postfix:- (2531865:tqdm_logging.py:145)
Step 6700: grad_norm=0.1366, loss=0.0050, param_norm=1380.2324
20:19:15.942 [I] Progress on: 6.71kit/100kit rate:2.1it/s remaining:12:10:05 elapsed:53:27 postfix:- (2531865:tqdm_logging.py:145)
20:19:26.279 [I] Progress on: 6.73kit/100kit rate:2.1it/s remaining:12:09:36 elapsed:53:38 postfix:- (2531865:tqdm_logging.py:145)
20:19:36.356 [I] Progress on: 6.75kit/100kit rate:2.1it/s remaining:12:10:27 elapsed:53:48 postfix:- (2531865:tqdm_logging.py:145)
20:19:46.695 [I] Progress on: 6.78kit/100kit rate:2.1it/s remaining:12:10:21 elapsed:53:58 postfix:- (2531865:tqdm_logging.py:145)
20:19:57.032 [I] Progress on: 6.80kit/100kit rate:2.1it/s remaining:12:09:31 elapsed:54:09 postfix:- (2531865:tqdm_logging.py:145)
Step 6800: grad_norm=0.1525, loss=0.0055, param_norm=1380.2394
20:20:07.421 [I] Progress on: 6.82kit/100kit rate:2.1it/s remaining:12:10:45 elapsed:54:19 postfix:- (2531865:tqdm_logging.py:145)
20:20:17.758 [I] Progress on: 6.84kit/100kit rate:2.1it/s remaining:12:10:12 elapsed:54:29 postfix:- (2531865:tqdm_logging.py:145)
20:20:28.097 [I] Progress on: 6.86kit/100kit rate:2.1it/s remaining:12:09:46 elapsed:54:40 postfix:- (2531865:tqdm_logging.py:145)
20:20:38.435 [I] Progress on: 6.89kit/100kit rate:2.1it/s remaining:12:09:33 elapsed:54:50 postfix:- (2531865:tqdm_logging.py:145)
Step 6900: grad_norm=0.1495, loss=0.0049, param_norm=1380.2463
20:20:48.824 [I] Progress on: 6.91kit/100kit rate:2.1it/s remaining:12:08:30 elapsed:55:00 postfix:- (2531865:tqdm_logging.py:145)
20:20:59.159 [I] Progress on: 6.93kit/100kit rate:2.1it/s remaining:12:08:35 elapsed:55:11 postfix:- (2531865:tqdm_logging.py:145)
20:21:09.498 [I] Progress on: 6.95kit/100kit rate:2.1it/s remaining:12:08:43 elapsed:55:21 postfix:- (2531865:tqdm_logging.py:145)
20:21:19.834 [I] Progress on: 6.97kit/100kit rate:2.1it/s remaining:12:08:18 elapsed:55:31 postfix:- (2531865:tqdm_logging.py:145)
20:21:30.172 [I] Progress on: 7.00kit/100kit rate:2.1it/s remaining:12:08:13 elapsed:55:42 postfix:- (2531865:tqdm_logging.py:145)
Step 7000: grad_norm=0.1462, loss=0.0052, param_norm=1380.2533
20:21:32.728 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
20:21:32.728 [I] [process=0] Saving checkpoint at step 7000                                       (2531865:checkpoint_manager.py:1408)
20:21:32.729 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000. (2531865:async_checkpointer.py:439)
20:21:32.732 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24 (2531865:atomicity.py:144)
20:21:32.743 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 (2531865:atomicity.py:144)
20:21:32.744 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/train_state.orbax-checkpoint-tmp-27 (2531865:atomicity.py:144)
20:21:32.744 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 (2531865:atomicity.py:144)
20:21:32.765 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:21:33.564 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:21:33.588 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:21:36.089 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.1 GiB/s (total bytes: 7.0 GiB) (time elapsed: 3 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:21:36.101 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.1 GiB/s (total bytes: 10.5 GiB) (time elapsed: 3 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:21:36.110 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
20:21:36.110 [I] Finished blocking save in 3.38 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000. (2531865:async_checkpointer.py:548)
20:21:36.111 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
20:21:36.112 [I] Deleting Checkpoint[step=6000 | time=2025-11-02 12:13:38.797489+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
20:21:36.112 [I] [process=0][thread=MainThread][step=7000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
20:21:36.113 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
20:21:36.113 [I] {'step': 7000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762086092.7283032, 'wait_for_prev_duration_secs': 0.00024056434631347656, 'checkpointer_blocking_start_time': 1762086092.728861, 'checkpointer_blocking_duration_secs': 3.382845163345337, 'get_old_steps_start_time': 1762086096.1117318, 'get_old_steps_duration_secs': 0.0006201267242431641, 'checkpoint_manager_blocking_start_time': 1762086092.7281528, 'checkpoint_manager_blocking_duration_secs': 3.3850247859954834} (2531865:standard_logger.py:34)
20:21:36.165 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/train_state.orbax-checkpoint-tmp-27/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:21:41.428 [I] Progress on: 7.00kit/100kit rate:1.7s/it remaining:43:32:21 elapsed:55:53 postfix:- (2531865:tqdm_logging.py:145)
20:21:47.587 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 482.3 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:21:51.579 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 569.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: 18 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:21:51.579 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
20:21:51.580 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/assets.orbax-checkpoint-tmp-25 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/assets (2531865:atomicity.py:289)
20:21:51.586 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:21:51.607 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/train_state.orbax-checkpoint-tmp-27 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/train_state (2531865:atomicity.py:289)
20:21:51.612 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:21:51.714 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/params.orbax-checkpoint-tmp-26 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24/params (2531865:atomicity.py:289)
20:21:51.716 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000.orbax-checkpoint-tmp-24 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000 (2531865:atomicity.py:289)
20:21:51.720 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000`. (2531865:atomicity.py:573)
20:21:51.720 [I] Finished asynchronous save (blocking + background) in 18.99 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/7000 (2531865:async_checkpointer.py:412)
20:21:51.720 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
20:21:51.721 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
20:21:51.721 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
20:21:51.860 [I] Progress on: 7.03kit/100kit rate:2.1it/s remaining:12:05:58 elapsed:56:03 postfix:- (2531865:tqdm_logging.py:145)
20:21:52.154 [I] Deleted step 6000.                                                               (2531865:deleter.py:114)
20:21:52.154 [I] [process=0][thread=save_finalize][step=7000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
20:21:52.154 [I] [process=0][thread=save_finalize][step=7000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
20:22:02.193 [I] Progress on: 7.05kit/100kit rate:2.1it/s remaining:12:07:48 elapsed:56:14 postfix:- (2531865:tqdm_logging.py:145)
20:22:12.531 [I] Progress on: 7.07kit/100kit rate:2.1it/s remaining:12:07:51 elapsed:56:24 postfix:- (2531865:tqdm_logging.py:145)
20:22:22.872 [I] Progress on: 7.09kit/100kit rate:2.1it/s remaining:12:09:01 elapsed:56:34 postfix:- (2531865:tqdm_logging.py:145)
Step 7100: grad_norm=0.1810, loss=0.0055, param_norm=1380.2606
20:22:33.272 [I] Progress on: 7.11kit/100kit rate:2.1it/s remaining:12:08:08 elapsed:56:45 postfix:- (2531865:tqdm_logging.py:145)
20:22:43.612 [I] Progress on: 7.14kit/100kit rate:2.1it/s remaining:12:06:58 elapsed:56:55 postfix:- (2531865:tqdm_logging.py:145)
20:22:53.869 [I] Progress on: 7.16kit/100kit rate:1.7it/s remaining:15:08:14 elapsed:57:05 postfix:- (2531865:tqdm_logging.py:145)
20:23:04.071 [I] Progress on: 7.18kit/100kit rate:2.1it/s remaining:12:18:16 elapsed:57:16 postfix:- (2531865:tqdm_logging.py:145)
Step 7200: grad_norm=0.1550, loss=0.0054, param_norm=1380.2672
20:23:14.565 [I] Progress on: 7.20kit/100kit rate:2.2it/s remaining:11:55:36 elapsed:57:26 postfix:- (2531865:tqdm_logging.py:145)
20:23:24.814 [I] Progress on: 7.22kit/100kit rate:2.1it/s remaining:12:17:34 elapsed:57:36 postfix:- (2531865:tqdm_logging.py:145)
20:23:35.153 [I] Progress on: 7.25kit/100kit rate:2.1it/s remaining:12:17:42 elapsed:57:47 postfix:- (2531865:tqdm_logging.py:145)
20:23:45.491 [I] Progress on: 7.27kit/100kit rate:2.1it/s remaining:12:17:53 elapsed:57:57 postfix:- (2531865:tqdm_logging.py:145)
20:23:55.829 [I] Progress on: 7.29kit/100kit rate:2.1it/s remaining:12:17:01 elapsed:58:07 postfix:- (2531865:tqdm_logging.py:145)
Step 7300: grad_norm=0.1500, loss=0.0049, param_norm=1380.2740
20:24:06.230 [I] Progress on: 7.31kit/100kit rate:2.1it/s remaining:12:17:16 elapsed:58:18 postfix:- (2531865:tqdm_logging.py:145)
20:24:16.567 [I] Progress on: 7.33kit/100kit rate:2.1it/s remaining:12:16:41 elapsed:58:28 postfix:- (2531865:tqdm_logging.py:145)
20:24:26.905 [I] Progress on: 7.36kit/100kit rate:2.1it/s remaining:12:17:04 elapsed:58:38 postfix:- (2531865:tqdm_logging.py:145)
20:24:37.243 [I] Progress on: 7.38kit/100kit rate:2.1it/s remaining:12:17:15 elapsed:58:49 postfix:- (2531865:tqdm_logging.py:145)
20:24:47.582 [I] Progress on: 7.40kit/100kit rate:2.1it/s remaining:12:17:47 elapsed:58:59 postfix:- (2531865:tqdm_logging.py:145)
Step 7400: grad_norm=0.1495, loss=0.0051, param_norm=1380.2810
20:24:57.986 [I] Progress on: 7.42kit/100kit rate:2.1it/s remaining:12:16:33 elapsed:59:10 postfix:- (2531865:tqdm_logging.py:145)
20:25:08.035 [I] Progress on: 7.44kit/100kit rate:2.1it/s remaining:12:12:05 elapsed:59:20 postfix:- (2531865:tqdm_logging.py:145)
20:25:18.374 [I] Progress on: 7.46kit/100kit rate:2.1it/s remaining:12:05:14 elapsed:59:30 postfix:- (2531865:tqdm_logging.py:145)
20:25:28.712 [I] Progress on: 7.49kit/100kit rate:2.1it/s remaining:12:04:57 elapsed:59:40 postfix:- (2531865:tqdm_logging.py:145)
Step 7500: grad_norm=0.1481, loss=0.0054, param_norm=1380.2876
20:25:39.098 [I] Progress on: 7.51kit/100kit rate:2.1it/s remaining:12:03:45 elapsed:59:51 postfix:- (2531865:tqdm_logging.py:145)
20:25:49.433 [I] Progress on: 7.53kit/100kit rate:2.1it/s remaining:12:03:55 elapsed:1:00:01 postfix:- (2531865:tqdm_logging.py:145)
20:25:59.773 [I] Progress on: 7.55kit/100kit rate:2.1it/s remaining:12:03:57 elapsed:1:00:11 postfix:- (2531865:tqdm_logging.py:145)
20:26:10.109 [I] Progress on: 7.57kit/100kit rate:2.1it/s remaining:12:03:55 elapsed:1:00:22 postfix:- (2531865:tqdm_logging.py:145)
20:26:20.187 [I] Progress on: 7.59kit/100kit rate:2.2it/s remaining:11:52:28 elapsed:1:00:32 postfix:- (2531865:tqdm_logging.py:145)
Step 7600: grad_norm=0.1460, loss=0.0050, param_norm=1380.2941
20:26:30.573 [I] Progress on: 7.62kit/100kit rate:2.1it/s remaining:12:04:05 elapsed:1:00:42 postfix:- (2531865:tqdm_logging.py:145)
20:26:40.909 [I] Progress on: 7.64kit/100kit rate:2.1it/s remaining:12:02:46 elapsed:1:00:52 postfix:- (2531865:tqdm_logging.py:145)
20:26:51.245 [I] Progress on: 7.66kit/100kit rate:2.1it/s remaining:12:02:38 elapsed:1:01:03 postfix:- (2531865:tqdm_logging.py:145)
20:27:01.581 [I] Progress on: 7.68kit/100kit rate:2.1it/s remaining:12:02:33 elapsed:1:01:13 postfix:- (2531865:tqdm_logging.py:145)
Step 7700: grad_norm=0.1332, loss=0.0048, param_norm=1380.3005
20:27:11.964 [I] Progress on: 7.71kit/100kit rate:2.1it/s remaining:11:59:54 elapsed:1:01:23 postfix:- (2531865:tqdm_logging.py:145)
20:27:22.303 [I] Progress on: 7.73kit/100kit rate:2.1it/s remaining:12:02:34 elapsed:1:01:34 postfix:- (2531865:tqdm_logging.py:145)
20:27:32.642 [I] Progress on: 7.75kit/100kit rate:2.1it/s remaining:12:02:14 elapsed:1:01:44 postfix:- (2531865:tqdm_logging.py:145)
20:27:42.977 [I] Progress on: 7.77kit/100kit rate:2.1it/s remaining:12:01:37 elapsed:1:01:55 postfix:- (2531865:tqdm_logging.py:145)
20:27:53.314 [I] Progress on: 7.79kit/100kit rate:2.1it/s remaining:12:01:45 elapsed:1:02:05 postfix:- (2531865:tqdm_logging.py:145)
Step 7800: grad_norm=0.1363, loss=0.0049, param_norm=1380.3070
20:28:03.697 [I] Progress on: 7.82kit/100kit rate:2.1it/s remaining:12:00:48 elapsed:1:02:15 postfix:- (2531865:tqdm_logging.py:145)
20:28:14.038 [I] Progress on: 7.84kit/100kit rate:2.1it/s remaining:12:01:22 elapsed:1:02:26 postfix:- (2531865:tqdm_logging.py:145)
20:28:24.377 [I] Progress on: 7.86kit/100kit rate:2.1it/s remaining:12:01:46 elapsed:1:02:36 postfix:- (2531865:tqdm_logging.py:145)
20:28:34.715 [I] Progress on: 7.88kit/100kit rate:2.1it/s remaining:12:01:28 elapsed:1:02:46 postfix:- (2531865:tqdm_logging.py:145)
Step 7900: grad_norm=0.1428, loss=0.0047, param_norm=1380.3131
20:28:45.105 [I] Progress on: 7.90kit/100kit rate:2.1it/s remaining:11:57:10 elapsed:1:02:57 postfix:- (2531865:tqdm_logging.py:145)
20:28:55.440 [I] Progress on: 7.92kit/100kit rate:2.1it/s remaining:12:00:30 elapsed:1:03:07 postfix:- (2531865:tqdm_logging.py:145)
20:29:05.779 [I] Progress on: 7.95kit/100kit rate:2.1it/s remaining:12:00:43 elapsed:1:03:17 postfix:- (2531865:tqdm_logging.py:145)
20:29:16.117 [I] Progress on: 7.97kit/100kit rate:2.1it/s remaining:12:00:07 elapsed:1:03:28 postfix:- (2531865:tqdm_logging.py:145)
20:29:26.458 [I] Progress on: 7.99kit/100kit rate:2.1it/s remaining:12:01:10 elapsed:1:03:38 postfix:- (2531865:tqdm_logging.py:145)
Step 8000: grad_norm=0.1467, loss=0.0046, param_norm=1380.3193
20:29:31.626 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
20:29:31.626 [I] [process=0] Saving checkpoint at step 8000                                       (2531865:checkpoint_manager.py:1408)
20:29:31.627 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000. (2531865:async_checkpointer.py:439)
20:29:31.639 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28 (2531865:atomicity.py:144)
20:29:31.644 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/assets.orbax-checkpoint-tmp-29 (2531865:atomicity.py:144)
20:29:31.644 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/train_state.orbax-checkpoint-tmp-31 (2531865:atomicity.py:144)
20:29:31.645 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/params.orbax-checkpoint-tmp-30 (2531865:atomicity.py:144)
20:29:31.677 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:29:32.152 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:29:32.175 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/params.orbax-checkpoint-tmp-30/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:29:34.152 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.8 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:29:34.169 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 4.1 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:29:34.174 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
20:29:34.174 [I] Finished blocking save in 2.55 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000. (2531865:async_checkpointer.py:548)
20:29:34.175 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
20:29:34.175 [I] Deleting Checkpoint[step=7000 | time=2025-11-02 12:21:36.111717+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
20:29:34.176 [I] [process=0][thread=MainThread][step=8000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
20:29:34.176 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
20:29:34.177 [I] {'step': 8000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762086571.6264567, 'wait_for_prev_duration_secs': 0.00024890899658203125, 'checkpointer_blocking_start_time': 1762086571.6270049, 'checkpointer_blocking_duration_secs': 2.548352003097534, 'get_old_steps_start_time': 1762086574.1753836, 'get_old_steps_duration_secs': 0.0006124973297119141, 'checkpoint_manager_blocking_start_time': 1762086571.6263041, 'checkpoint_manager_blocking_duration_secs': 2.5507607460021973} (2531865:standard_logger.py:34)
20:29:34.205 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/train_state.orbax-checkpoint-tmp-31/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:29:36.853 [I] Progress on: 8.01kit/100kit rate:1.6it/s remaining:16:25:29 elapsed:1:03:48 postfix:- (2531865:tqdm_logging.py:145)
20:29:46.030 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 497.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:29:47.014 [I] Progress on: 8.02kit/100kit rate:2.1it/s remaining:12:03:01 elapsed:1:03:59 postfix:- (2531865:tqdm_logging.py:145)
20:29:49.739 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 593.0 MiB/s (total bytes: 10.5 GiB) (time elapsed: 18 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:29:49.739 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
20:29:49.741 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/assets.orbax-checkpoint-tmp-29 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/assets (2531865:atomicity.py:289)
20:29:49.746 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:29:49.768 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/train_state.orbax-checkpoint-tmp-31 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/train_state (2531865:atomicity.py:289)
20:29:49.773 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:29:49.793 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/params.orbax-checkpoint-tmp-30 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28/params (2531865:atomicity.py:289)
20:29:49.794 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000.orbax-checkpoint-tmp-28 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000 (2531865:atomicity.py:289)
20:29:49.798 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000`. (2531865:atomicity.py:573)
20:29:49.798 [I] Finished asynchronous save (blocking + background) in 18.17 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/8000 (2531865:async_checkpointer.py:412)
20:29:49.798 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
20:29:49.799 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
20:29:49.799 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
20:29:50.297 [I] Deleted step 7000.                                                               (2531865:deleter.py:114)
20:29:50.297 [I] [process=0][thread=save_finalize][step=8000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
20:29:50.298 [I] [process=0][thread=save_finalize][step=8000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
20:29:57.352 [I] Progress on: 8.04kit/100kit rate:2.2it/s remaining:11:48:19 elapsed:1:04:09 postfix:- (2531865:tqdm_logging.py:145)
20:30:07.691 [I] Progress on: 8.07kit/100kit rate:2.2it/s remaining:11:48:13 elapsed:1:04:19 postfix:- (2531865:tqdm_logging.py:145)
20:30:18.029 [I] Progress on: 8.09kit/100kit rate:2.2it/s remaining:11:48:09 elapsed:1:04:30 postfix:- (2531865:tqdm_logging.py:145)
Step 8100: grad_norm=0.1513, loss=0.0050, param_norm=1380.3259
20:30:28.440 [I] Progress on: 8.11kit/100kit rate:2.2it/s remaining:11:48:29 elapsed:1:04:40 postfix:- (2531865:tqdm_logging.py:145)
20:30:38.778 [I] Progress on: 8.13kit/100kit rate:2.2it/s remaining:11:48:32 elapsed:1:04:50 postfix:- (2531865:tqdm_logging.py:145)
20:30:49.120 [I] Progress on: 8.15kit/100kit rate:2.2it/s remaining:11:48:33 elapsed:1:05:01 postfix:- (2531865:tqdm_logging.py:145)
20:30:59.459 [I] Progress on: 8.18kit/100kit rate:2.2it/s remaining:11:47:36 elapsed:1:05:11 postfix:- (2531865:tqdm_logging.py:145)
20:31:09.802 [I] Progress on: 8.20kit/100kit rate:2.2it/s remaining:11:47:11 elapsed:1:05:21 postfix:- (2531865:tqdm_logging.py:145)
Step 8200: grad_norm=0.1366, loss=0.0045, param_norm=1380.3322
20:31:20.212 [I] Progress on: 8.22kit/100kit rate:2.2it/s remaining:11:47:38 elapsed:1:05:32 postfix:- (2531865:tqdm_logging.py:145)
20:31:30.552 [I] Progress on: 8.24kit/100kit rate:2.2it/s remaining:11:47:38 elapsed:1:05:42 postfix:- (2531865:tqdm_logging.py:145)
20:31:40.892 [I] Progress on: 8.26kit/100kit rate:2.2it/s remaining:11:47:53 elapsed:1:05:52 postfix:- (2531865:tqdm_logging.py:145)
20:31:51.232 [I] Progress on: 8.29kit/100kit rate:2.2it/s remaining:11:47:38 elapsed:1:06:03 postfix:- (2531865:tqdm_logging.py:145)
Step 8300: grad_norm=0.1439, loss=0.0046, param_norm=1380.3384
20:32:01.641 [I] Progress on: 8.31kit/100kit rate:2.2it/s remaining:11:47:22 elapsed:1:06:13 postfix:- (2531865:tqdm_logging.py:145)
20:32:11.980 [I] Progress on: 8.33kit/100kit rate:2.2it/s remaining:11:45:03 elapsed:1:06:24 postfix:- (2531865:tqdm_logging.py:145)
20:32:22.321 [I] Progress on: 8.35kit/100kit rate:2.2it/s remaining:11:45:00 elapsed:1:06:34 postfix:- (2531865:tqdm_logging.py:145)
20:32:32.658 [I] Progress on: 8.37kit/100kit rate:2.2it/s remaining:11:44:26 elapsed:1:06:44 postfix:- (2531865:tqdm_logging.py:145)
20:32:42.995 [I] Progress on: 8.40kit/100kit rate:2.2it/s remaining:11:44:39 elapsed:1:06:55 postfix:- (2531865:tqdm_logging.py:145)
Step 8400: grad_norm=0.1320, loss=0.0045, param_norm=1380.3444
20:32:53.417 [I] Progress on: 8.42kit/100kit rate:2.2it/s remaining:11:44:25 elapsed:1:07:05 postfix:- (2531865:tqdm_logging.py:145)
20:33:03.515 [I] Progress on: 8.44kit/100kit rate:1.7it/s remaining:15:20:09 elapsed:1:07:15 postfix:- (2531865:tqdm_logging.py:145)
20:33:13.716 [I] Progress on: 8.46kit/100kit rate:2.1it/s remaining:12:07:41 elapsed:1:07:25 postfix:- (2531865:tqdm_logging.py:145)
20:33:24.065 [I] Progress on: 8.48kit/100kit rate:2.1it/s remaining:12:12:01 elapsed:1:07:36 postfix:- (2531865:tqdm_logging.py:145)
Step 8500: grad_norm=0.1438, loss=0.0049, param_norm=1380.3505
20:33:34.417 [I] Progress on: 8.50kit/100kit rate:2.1it/s remaining:11:53:20 elapsed:1:07:46 postfix:- (2531865:tqdm_logging.py:145)
20:33:44.758 [I] Progress on: 8.53kit/100kit rate:2.1it/s remaining:11:56:37 elapsed:1:07:56 postfix:- (2531865:tqdm_logging.py:145)
20:33:55.094 [I] Progress on: 8.55kit/100kit rate:2.1it/s remaining:11:55:46 elapsed:1:08:07 postfix:- (2531865:tqdm_logging.py:145)
20:34:05.432 [I] Progress on: 8.57kit/100kit rate:2.1it/s remaining:11:55:23 elapsed:1:08:17 postfix:- (2531865:tqdm_logging.py:145)
20:34:15.770 [I] Progress on: 8.59kit/100kit rate:2.1it/s remaining:11:55:23 elapsed:1:08:27 postfix:- (2531865:tqdm_logging.py:145)
Step 8600: grad_norm=0.1824, loss=0.0052, param_norm=1380.3572
20:34:26.164 [I] Progress on: 8.61kit/100kit rate:2.1it/s remaining:11:54:23 elapsed:1:08:38 postfix:- (2531865:tqdm_logging.py:145)
20:34:36.505 [I] Progress on: 8.64kit/100kit rate:2.1it/s remaining:11:55:11 elapsed:1:08:48 postfix:- (2531865:tqdm_logging.py:145)
20:34:46.845 [I] Progress on: 8.66kit/100kit rate:2.1it/s remaining:11:54:56 elapsed:1:08:58 postfix:- (2531865:tqdm_logging.py:145)
20:34:57.183 [I] Progress on: 8.68kit/100kit rate:2.1it/s remaining:11:55:07 elapsed:1:09:09 postfix:- (2531865:tqdm_logging.py:145)
Step 8700: grad_norm=0.1516, loss=0.0049, param_norm=1380.3634
20:35:07.221 [I] Progress on: 8.70kit/100kit rate:2.1it/s remaining:11:55:11 elapsed:1:09:19 postfix:- (2531865:tqdm_logging.py:145)
20:35:17.451 [I] Progress on: 8.72kit/100kit rate:2.1it/s remaining:11:55:12 elapsed:1:09:29 postfix:- (2531865:tqdm_logging.py:145)
20:35:27.792 [I] Progress on: 8.74kit/100kit rate:2.1it/s remaining:11:55:23 elapsed:1:09:39 postfix:- (2531865:tqdm_logging.py:145)
20:35:38.133 [I] Progress on: 8.77kit/100kit rate:2.1it/s remaining:11:55:21 elapsed:1:09:50 postfix:- (2531865:tqdm_logging.py:145)
20:35:48.469 [I] Progress on: 8.79kit/100kit rate:2.1it/s remaining:11:54:36 elapsed:1:10:00 postfix:- (2531865:tqdm_logging.py:145)
Step 8800: grad_norm=0.1367, loss=0.0044, param_norm=1380.3690
20:35:58.868 [I] Progress on: 8.81kit/100kit rate:2.1it/s remaining:11:54:58 elapsed:1:10:10 postfix:- (2531865:tqdm_logging.py:145)
20:36:09.204 [I] Progress on: 8.83kit/100kit rate:2.1it/s remaining:11:54:31 elapsed:1:10:21 postfix:- (2531865:tqdm_logging.py:145)
20:36:19.284 [I] Progress on: 8.85kit/100kit rate:2.1it/s remaining:11:55:01 elapsed:1:10:31 postfix:- (2531865:tqdm_logging.py:145)
20:36:29.616 [I] Progress on: 8.88kit/100kit rate:2.1it/s remaining:11:53:44 elapsed:1:10:41 postfix:- (2531865:tqdm_logging.py:145)
20:36:39.961 [I] Progress on: 8.90kit/100kit rate:2.1it/s remaining:11:53:53 elapsed:1:10:51 postfix:- (2531865:tqdm_logging.py:145)
Step 8900: grad_norm=0.1435, loss=0.0049, param_norm=1380.3750
20:36:50.358 [I] Progress on: 8.92kit/100kit rate:2.1it/s remaining:11:52:53 elapsed:1:11:02 postfix:- (2531865:tqdm_logging.py:145)
20:37:00.696 [I] Progress on: 8.94kit/100kit rate:2.1it/s remaining:11:53:13 elapsed:1:11:12 postfix:- (2531865:tqdm_logging.py:145)
20:37:11.031 [I] Progress on: 8.96kit/100kit rate:2.1it/s remaining:11:52:33 elapsed:1:11:23 postfix:- (2531865:tqdm_logging.py:145)
20:37:21.371 [I] Progress on: 8.99kit/100kit rate:2.1it/s remaining:11:52:57 elapsed:1:11:33 postfix:- (2531865:tqdm_logging.py:145)
Step 9000: grad_norm=0.1409, loss=0.0047, param_norm=1380.3812
20:37:28.632 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
20:37:28.633 [I] [process=0] Saving checkpoint at step 9000                                       (2531865:checkpoint_manager.py:1408)
20:37:28.633 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000. (2531865:async_checkpointer.py:439)
20:37:28.643 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32 (2531865:atomicity.py:144)
20:37:28.649 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/params.orbax-checkpoint-tmp-34 (2531865:atomicity.py:144)
20:37:28.651 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/train_state.orbax-checkpoint-tmp-35 (2531865:atomicity.py:144)
20:37:28.651 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/assets.orbax-checkpoint-tmp-33 (2531865:atomicity.py:144)
20:37:28.669 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:37:29.160 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:37:29.188 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/params.orbax-checkpoint-tmp-34/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:37:31.017 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.9 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:37:31.038 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 4.4 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:37:31.043 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
20:37:31.044 [I] Finished blocking save in 2.41 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000. (2531865:async_checkpointer.py:548)
20:37:31.044 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
20:37:31.045 [I] Deleting Checkpoint[step=8000 | time=2025-11-02 12:29:34.175369+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
20:37:31.045 [I] [process=0][thread=MainThread][step=9000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
20:37:31.045 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
20:37:31.046 [I] {'step': 9000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762087048.6326225, 'wait_for_prev_duration_secs': 0.00021314620971679688, 'checkpointer_blocking_start_time': 1762087048.6330917, 'checkpointer_blocking_duration_secs': 2.4117636680603027, 'get_old_steps_start_time': 1762087051.0448747, 'get_old_steps_duration_secs': 0.0004858970642089844, 'checkpoint_manager_blocking_start_time': 1762087048.6325216, 'checkpoint_manager_blocking_duration_secs': 2.4143731594085693} (2531865:standard_logger.py:34)
20:37:31.154 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/train_state.orbax-checkpoint-tmp-35/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:37:32.015 [I] Progress on: 9.00kit/100kit rate:1.2s/it remaining:29:35:11 elapsed:1:11:44 postfix:- (2531865:tqdm_logging.py:145)
20:37:42.206 [I] Progress on: 9.02kit/100kit rate:2.1it/s remaining:11:54:36 elapsed:1:11:54 postfix:- (2531865:tqdm_logging.py:145)
20:37:44.734 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 445.0 MiB/s (total bytes: 7.0 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:37:47.921 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 556.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: 19 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:37:47.921 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
20:37:47.922 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/assets.orbax-checkpoint-tmp-33 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/assets (2531865:atomicity.py:289)
20:37:47.927 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:37:48.046 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/train_state.orbax-checkpoint-tmp-35 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/train_state (2531865:atomicity.py:289)
20:37:48.051 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:37:48.072 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/params.orbax-checkpoint-tmp-34 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32/params (2531865:atomicity.py:289)
20:37:48.074 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000.orbax-checkpoint-tmp-32 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000 (2531865:atomicity.py:289)
20:37:48.078 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000`. (2531865:atomicity.py:573)
20:37:48.078 [I] Finished asynchronous save (blocking + background) in 19.45 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/9000 (2531865:async_checkpointer.py:412)
20:37:48.078 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
20:37:48.078 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
20:37:48.078 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
20:37:48.594 [I] Deleted step 8000.                                                               (2531865:deleter.py:114)
20:37:48.594 [I] [process=0][thread=save_finalize][step=9000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
20:37:48.594 [I] [process=0][thread=save_finalize][step=9000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
20:37:52.545 [I] Progress on: 9.05kit/100kit rate:2.1it/s remaining:11:53:03 elapsed:1:12:04 postfix:- (2531865:tqdm_logging.py:145)
20:38:02.883 [I] Progress on: 9.07kit/100kit rate:2.1it/s remaining:11:52:40 elapsed:1:12:14 postfix:- (2531865:tqdm_logging.py:145)
20:38:13.219 [I] Progress on: 9.09kit/100kit rate:2.1it/s remaining:11:51:44 elapsed:1:12:25 postfix:- (2531865:tqdm_logging.py:145)
Step 9100: grad_norm=0.1294, loss=0.0043, param_norm=1380.3872
20:38:23.615 [I] Progress on: 9.11kit/100kit rate:2.1it/s remaining:11:52:21 elapsed:1:12:35 postfix:- (2531865:tqdm_logging.py:145)
20:38:33.955 [I] Progress on: 9.13kit/100kit rate:2.1it/s remaining:11:51:08 elapsed:1:12:45 postfix:- (2531865:tqdm_logging.py:145)
20:38:44.295 [I] Progress on: 9.16kit/100kit rate:2.1it/s remaining:11:51:31 elapsed:1:12:56 postfix:- (2531865:tqdm_logging.py:145)
20:38:54.632 [I] Progress on: 9.18kit/100kit rate:2.1it/s remaining:11:51:33 elapsed:1:13:06 postfix:- (2531865:tqdm_logging.py:145)
20:39:04.967 [I] Progress on: 9.20kit/100kit rate:2.1it/s remaining:11:50:25 elapsed:1:13:16 postfix:- (2531865:tqdm_logging.py:145)
Step 9200: grad_norm=0.1344, loss=0.0044, param_norm=1380.3925
20:39:15.366 [I] Progress on: 9.22kit/100kit rate:2.1it/s remaining:11:52:00 elapsed:1:13:27 postfix:- (2531865:tqdm_logging.py:145)
20:39:25.705 [I] Progress on: 9.24kit/100kit rate:2.1it/s remaining:11:51:38 elapsed:1:13:37 postfix:- (2531865:tqdm_logging.py:145)
20:39:35.778 [I] Progress on: 9.27kit/100kit rate:2.1it/s remaining:12:12:28 elapsed:1:13:47 postfix:- (2531865:tqdm_logging.py:145)
20:39:46.122 [I] Progress on: 9.29kit/100kit rate:2.1it/s remaining:11:51:00 elapsed:1:13:58 postfix:- (2531865:tqdm_logging.py:145)
Step 9300: grad_norm=0.1395, loss=0.0043, param_norm=1380.3982
20:39:56.523 [I] Progress on: 9.31kit/100kit rate:2.1it/s remaining:11:51:01 elapsed:1:14:08 postfix:- (2531865:tqdm_logging.py:145)
20:40:06.863 [I] Progress on: 9.33kit/100kit rate:2.1it/s remaining:11:50:09 elapsed:1:14:18 postfix:- (2531865:tqdm_logging.py:145)
20:40:17.200 [I] Progress on: 9.35kit/100kit rate:2.1it/s remaining:11:49:39 elapsed:1:14:29 postfix:- (2531865:tqdm_logging.py:145)
20:40:27.548 [I] Progress on: 9.38kit/100kit rate:2.1it/s remaining:11:51:40 elapsed:1:14:39 postfix:- (2531865:tqdm_logging.py:145)
20:40:37.889 [I] Progress on: 9.40kit/100kit rate:2.1it/s remaining:11:49:49 elapsed:1:14:49 postfix:- (2531865:tqdm_logging.py:145)
Step 9400: grad_norm=0.1280, loss=0.0042, param_norm=1380.4041
20:40:48.281 [I] Progress on: 9.42kit/100kit rate:2.1it/s remaining:11:48:42 elapsed:1:15:00 postfix:- (2531865:tqdm_logging.py:145)
20:40:58.423 [I] Progress on: 9.44kit/100kit rate:2.1it/s remaining:11:51:06 elapsed:1:15:10 postfix:- (2531865:tqdm_logging.py:145)
20:41:08.756 [I] Progress on: 9.46kit/100kit rate:2.1it/s remaining:11:48:48 elapsed:1:15:20 postfix:- (2531865:tqdm_logging.py:145)
20:41:19.098 [I] Progress on: 9.48kit/100kit rate:2.1it/s remaining:11:48:33 elapsed:1:15:31 postfix:- (2531865:tqdm_logging.py:145)
Step 9500: grad_norm=0.1462, loss=0.0042, param_norm=1380.4097
20:41:29.492 [I] Progress on: 9.51kit/100kit rate:2.1it/s remaining:11:48:36 elapsed:1:15:41 postfix:- (2531865:tqdm_logging.py:145)
20:41:39.827 [I] Progress on: 9.53kit/100kit rate:2.1it/s remaining:11:48:55 elapsed:1:15:51 postfix:- (2531865:tqdm_logging.py:145)
20:41:50.162 [I] Progress on: 9.55kit/100kit rate:2.1it/s remaining:11:47:52 elapsed:1:16:02 postfix:- (2531865:tqdm_logging.py:145)
20:42:00.502 [I] Progress on: 9.57kit/100kit rate:2.1it/s remaining:11:48:29 elapsed:1:16:12 postfix:- (2531865:tqdm_logging.py:145)
20:42:10.837 [I] Progress on: 9.59kit/100kit rate:2.1it/s remaining:11:47:44 elapsed:1:16:22 postfix:- (2531865:tqdm_logging.py:145)
Step 9600: grad_norm=0.1490, loss=0.0046, param_norm=1380.4153
20:42:21.231 [I] Progress on: 9.62kit/100kit rate:2.1it/s remaining:11:48:13 elapsed:1:16:33 postfix:- (2531865:tqdm_logging.py:145)
20:42:31.574 [I] Progress on: 9.64kit/100kit rate:2.1it/s remaining:11:47:44 elapsed:1:16:43 postfix:- (2531865:tqdm_logging.py:145)
20:42:41.912 [I] Progress on: 9.66kit/100kit rate:2.1it/s remaining:11:47:21 elapsed:1:16:53 postfix:- (2531865:tqdm_logging.py:145)
20:42:52.251 [I] Progress on: 9.68kit/100kit rate:2.1it/s remaining:11:46:57 elapsed:1:17:04 postfix:- (2531865:tqdm_logging.py:145)
Step 9700: grad_norm=0.1322, loss=0.0040, param_norm=1380.4210
20:43:02.383 [I] Progress on: 9.70kit/100kit rate:2.1it/s remaining:11:45:40 elapsed:1:17:14 postfix:- (2531865:tqdm_logging.py:145)
20:43:12.723 [I] Progress on: 9.72kit/100kit rate:2.1it/s remaining:11:46:58 elapsed:1:17:24 postfix:- (2531865:tqdm_logging.py:145)
20:43:23.063 [I] Progress on: 9.75kit/100kit rate:2.1it/s remaining:11:47:13 elapsed:1:17:35 postfix:- (2531865:tqdm_logging.py:145)
20:43:33.402 [I] Progress on: 9.77kit/100kit rate:2.1it/s remaining:11:46:49 elapsed:1:17:45 postfix:- (2531865:tqdm_logging.py:145)
20:43:43.742 [I] Progress on: 9.79kit/100kit rate:2.1it/s remaining:11:46:19 elapsed:1:17:55 postfix:- (2531865:tqdm_logging.py:145)
Step 9800: grad_norm=0.1464, loss=0.0044, param_norm=1380.4263
20:43:54.133 [I] Progress on: 9.81kit/100kit rate:2.1it/s remaining:11:47:13 elapsed:1:18:06 postfix:- (2531865:tqdm_logging.py:145)
20:44:04.473 [I] Progress on: 9.84kit/100kit rate:2.1it/s remaining:11:46:35 elapsed:1:18:16 postfix:- (2531865:tqdm_logging.py:145)
20:44:14.812 [I] Progress on: 9.86kit/100kit rate:2.1it/s remaining:11:46:04 elapsed:1:18:26 postfix:- (2531865:tqdm_logging.py:145)
20:44:25.150 [I] Progress on: 9.88kit/100kit rate:2.1it/s remaining:11:45:38 elapsed:1:18:37 postfix:- (2531865:tqdm_logging.py:145)
Step 9900: grad_norm=0.1233, loss=0.0040, param_norm=1380.4315
20:44:35.862 [I] Progress on: 9.90kit/100kit rate:2.1it/s remaining:11:45:59 elapsed:1:18:47 postfix:- (2531865:tqdm_logging.py:145)
20:44:46.275 [I] Progress on: 9.92kit/100kit rate:2.1it/s remaining:11:44:57 elapsed:1:18:58 postfix:- (2531865:tqdm_logging.py:145)
20:44:56.616 [I] Progress on: 9.95kit/100kit rate:2.1it/s remaining:11:45:28 elapsed:1:19:08 postfix:- (2531865:tqdm_logging.py:145)
20:45:06.954 [I] Progress on: 9.97kit/100kit rate:2.1it/s remaining:11:45:08 elapsed:1:19:18 postfix:- (2531865:tqdm_logging.py:145)
20:45:17.293 [I] Progress on: 9.99kit/100kit rate:2.1it/s remaining:11:44:47 elapsed:1:19:29 postfix:- (2531865:tqdm_logging.py:145)
Step 10000: grad_norm=0.1398, loss=0.0044, param_norm=1380.4369
20:45:23.142 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
20:45:23.143 [I] [process=0] Saving checkpoint at step 10000                                      (2531865:checkpoint_manager.py:1408)
20:45:23.143 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000. (2531865:async_checkpointer.py:439)
20:45:23.146 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36 (2531865:atomicity.py:144)
20:45:23.160 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/params.orbax-checkpoint-tmp-38 (2531865:atomicity.py:144)
20:45:23.160 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/train_state.orbax-checkpoint-tmp-39 (2531865:atomicity.py:144)
20:45:23.160 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/assets.orbax-checkpoint-tmp-37 (2531865:atomicity.py:144)
20:45:23.181 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:45:24.148 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:45:24.174 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/params.orbax-checkpoint-tmp-38/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:45:26.636 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.0 GiB/s (total bytes: 7.0 GiB) (time elapsed: 3 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:45:26.655 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.0 GiB/s (total bytes: 10.5 GiB) (time elapsed: 3 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:45:26.659 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
20:45:26.659 [I] Finished blocking save in 3.52 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000. (2531865:async_checkpointer.py:548)
20:45:26.660 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
20:45:26.660 [I] Deleting Checkpoint[step=9000 | time=2025-11-02 12:37:31.044862+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
20:45:26.660 [I] [process=0][thread=MainThread][step=10000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
20:45:26.661 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
20:45:26.661 [I] {'step': 10000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762087523.1428397, 'wait_for_prev_duration_secs': 0.0002148151397705078, 'checkpointer_blocking_start_time': 1762087523.143314, 'checkpointer_blocking_duration_secs': 3.516885280609131, 'get_old_steps_start_time': 1762087526.6602197, 'get_old_steps_duration_secs': 0.0003116130828857422, 'checkpoint_manager_blocking_start_time': 1762087523.1427383, 'checkpoint_manager_blocking_duration_secs': 3.518697738647461} (2531865:standard_logger.py:34)
20:45:26.709 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/train_state.orbax-checkpoint-tmp-39/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:45:27.584 [I] Progress on: 10.0kit/100kit rate:1.4s/it remaining:34:42:45 elapsed:1:19:39 postfix:- (2531865:tqdm_logging.py:145)
20:45:37.793 [I] Progress on: 10.0kit/100kit rate:2.1it/s remaining:11:45:01 elapsed:1:19:49 postfix:- (2531865:tqdm_logging.py:145)
20:45:38.108 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 478.8 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:45:39.246 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 667.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:45:39.246 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
20:45:39.248 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/assets.orbax-checkpoint-tmp-37 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/assets (2531865:atomicity.py:289)
20:45:39.258 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:45:39.283 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/train_state.orbax-checkpoint-tmp-39 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/train_state (2531865:atomicity.py:289)
20:45:39.288 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:45:39.317 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/params.orbax-checkpoint-tmp-38 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36/params (2531865:atomicity.py:289)
20:45:39.318 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000.orbax-checkpoint-tmp-36 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000 (2531865:atomicity.py:289)
20:45:39.322 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000`. (2531865:atomicity.py:573)
20:45:39.322 [I] Finished asynchronous save (blocking + background) in 16.18 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/10000 (2531865:async_checkpointer.py:412)
20:45:39.323 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
20:45:39.323 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
20:45:39.323 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
20:45:39.727 [I] Deleted step 9000.                                                               (2531865:deleter.py:114)
20:45:39.727 [I] [process=0][thread=save_finalize][step=10000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
20:45:39.728 [I] [process=0][thread=save_finalize][step=10000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
20:45:48.132 [I] Progress on: 10.0kit/100kit rate:2.1it/s remaining:11:43:47 elapsed:1:20:00 postfix:- (2531865:tqdm_logging.py:145)
20:45:58.471 [I] Progress on: 10.1kit/100kit rate:2.1it/s remaining:11:45:26 elapsed:1:20:10 postfix:- (2531865:tqdm_logging.py:145)
20:46:08.810 [I] Progress on: 10.1kit/100kit rate:2.1it/s remaining:11:45:09 elapsed:1:20:20 postfix:- (2531865:tqdm_logging.py:145)
Step 10100: grad_norm=0.1211, loss=0.0041, param_norm=1380.4423
20:46:18.927 [I] Progress on: 10.1kit/100kit rate:2.1it/s remaining:11:38:21 elapsed:1:20:30 postfix:- (2531865:tqdm_logging.py:145)
20:46:29.263 [I] Progress on: 10.1kit/100kit rate:2.2it/s remaining:11:31:32 elapsed:1:20:41 postfix:- (2531865:tqdm_logging.py:145)
20:46:39.598 [I] Progress on: 10.2kit/100kit rate:2.2it/s remaining:11:31:26 elapsed:1:20:51 postfix:- (2531865:tqdm_logging.py:145)
20:46:49.937 [I] Progress on: 10.2kit/100kit rate:2.2it/s remaining:11:31:13 elapsed:1:21:01 postfix:- (2531865:tqdm_logging.py:145)
20:47:00.274 [I] Progress on: 10.2kit/100kit rate:2.2it/s remaining:11:31:03 elapsed:1:21:12 postfix:- (2531865:tqdm_logging.py:145)
Step 10200: grad_norm=0.1314, loss=0.0041, param_norm=1380.4478
20:47:10.666 [I] Progress on: 10.2kit/100kit rate:2.1it/s remaining:11:43:08 elapsed:1:21:22 postfix:- (2531865:tqdm_logging.py:145)
20:47:21.008 [I] Progress on: 10.2kit/100kit rate:2.1it/s remaining:11:43:05 elapsed:1:21:33 postfix:- (2531865:tqdm_logging.py:145)
20:47:31.344 [I] Progress on: 10.3kit/100kit rate:2.1it/s remaining:11:42:56 elapsed:1:21:43 postfix:- (2531865:tqdm_logging.py:145)
20:47:41.685 [I] Progress on: 10.3kit/100kit rate:2.1it/s remaining:11:42:31 elapsed:1:21:53 postfix:- (2531865:tqdm_logging.py:145)
Step 10300: grad_norm=0.1308, loss=0.0041, param_norm=1380.4529
20:47:52.073 [I] Progress on: 10.3kit/100kit rate:2.1it/s remaining:11:42:26 elapsed:1:22:04 postfix:- (2531865:tqdm_logging.py:145)
20:48:02.412 [I] Progress on: 10.3kit/100kit rate:2.1it/s remaining:11:41:55 elapsed:1:22:14 postfix:- (2531865:tqdm_logging.py:145)
20:48:12.756 [I] Progress on: 10.4kit/100kit rate:2.1it/s remaining:11:42:37 elapsed:1:22:24 postfix:- (2531865:tqdm_logging.py:145)
20:48:23.093 [I] Progress on: 10.4kit/100kit rate:2.1it/s remaining:11:41:18 elapsed:1:22:35 postfix:- (2531865:tqdm_logging.py:145)
20:48:33.434 [I] Progress on: 10.4kit/100kit rate:2.1it/s remaining:11:41:22 elapsed:1:22:45 postfix:- (2531865:tqdm_logging.py:145)
Step 10400: grad_norm=0.1317, loss=0.0040, param_norm=1380.4581
20:48:43.591 [I] Progress on: 10.4kit/100kit rate:2.0it/s remaining:12:17:53 elapsed:1:22:55 postfix:- (2531865:tqdm_logging.py:145)
20:48:53.935 [I] Progress on: 10.4kit/100kit rate:2.1it/s remaining:11:42:43 elapsed:1:23:05 postfix:- (2531865:tqdm_logging.py:145)
20:49:04.275 [I] Progress on: 10.5kit/100kit rate:2.1it/s remaining:11:41:39 elapsed:1:23:16 postfix:- (2531865:tqdm_logging.py:145)
20:49:14.617 [I] Progress on: 10.5kit/100kit rate:2.1it/s remaining:11:41:47 elapsed:1:23:26 postfix:- (2531865:tqdm_logging.py:145)
Step 10500: grad_norm=0.1385, loss=0.0043, param_norm=1380.4631
20:49:25.018 [I] Progress on: 10.5kit/100kit rate:2.1it/s remaining:11:41:03 elapsed:1:23:37 postfix:- (2531865:tqdm_logging.py:145)
20:49:35.134 [I] Progress on: 10.5kit/100kit rate:2.0it/s remaining:12:29:45 elapsed:1:23:47 postfix:- (2531865:tqdm_logging.py:145)
20:49:45.477 [I] Progress on: 10.5kit/100kit rate:2.1it/s remaining:11:52:49 elapsed:1:23:57 postfix:- (2531865:tqdm_logging.py:145)
20:49:55.815 [I] Progress on: 10.6kit/100kit rate:2.1it/s remaining:11:52:52 elapsed:1:24:07 postfix:- (2531865:tqdm_logging.py:145)
20:50:06.157 [I] Progress on: 10.6kit/100kit rate:2.1it/s remaining:11:52:46 elapsed:1:24:18 postfix:- (2531865:tqdm_logging.py:145)
Step 10600: grad_norm=0.1409, loss=0.0038, param_norm=1380.4678
20:50:16.578 [I] Progress on: 10.6kit/100kit rate:2.1it/s remaining:11:52:55 elapsed:1:24:28 postfix:- (2531865:tqdm_logging.py:145)
20:50:26.919 [I] Progress on: 10.6kit/100kit rate:2.1it/s remaining:11:51:57 elapsed:1:24:38 postfix:- (2531865:tqdm_logging.py:145)
20:50:37.258 [I] Progress on: 10.7kit/100kit rate:2.1it/s remaining:11:51:36 elapsed:1:24:49 postfix:- (2531865:tqdm_logging.py:145)
20:50:47.595 [I] Progress on: 10.7kit/100kit rate:2.1it/s remaining:11:50:44 elapsed:1:24:59 postfix:- (2531865:tqdm_logging.py:145)
Step 10700: grad_norm=0.1509, loss=0.0044, param_norm=1380.4731
20:50:58.015 [I] Progress on: 10.7kit/100kit rate:2.1it/s remaining:11:55:35 elapsed:1:25:10 postfix:- (2531865:tqdm_logging.py:145)
20:51:08.357 [I] Progress on: 10.7kit/100kit rate:2.1it/s remaining:11:51:27 elapsed:1:25:20 postfix:- (2531865:tqdm_logging.py:145)
20:51:18.694 [I] Progress on: 10.7kit/100kit rate:2.1it/s remaining:11:51:25 elapsed:1:25:30 postfix:- (2531865:tqdm_logging.py:145)
20:51:29.035 [I] Progress on: 10.8kit/100kit rate:2.1it/s remaining:11:50:30 elapsed:1:25:41 postfix:- (2531865:tqdm_logging.py:145)
20:51:39.374 [I] Progress on: 10.8kit/100kit rate:2.1it/s remaining:11:49:48 elapsed:1:25:51 postfix:- (2531865:tqdm_logging.py:145)
Step 10800: grad_norm=0.1292, loss=0.0042, param_norm=1380.4784
20:51:49.789 [I] Progress on: 10.8kit/100kit rate:2.1it/s remaining:11:49:43 elapsed:1:26:01 postfix:- (2531865:tqdm_logging.py:145)
20:52:00.137 [I] Progress on: 10.8kit/100kit rate:2.1it/s remaining:11:51:45 elapsed:1:26:12 postfix:- (2531865:tqdm_logging.py:145)
20:52:10.472 [I] Progress on: 10.9kit/100kit rate:2.1it/s remaining:11:49:13 elapsed:1:26:22 postfix:- (2531865:tqdm_logging.py:145)
20:52:20.817 [I] Progress on: 10.9kit/100kit rate:2.1it/s remaining:11:50:15 elapsed:1:26:32 postfix:- (2531865:tqdm_logging.py:145)
Step 10900: grad_norm=0.1284, loss=0.0038, param_norm=1380.4834
20:52:31.305 [I] Progress on: 10.9kit/100kit rate:2.2it/s remaining:11:25:43 elapsed:1:26:43 postfix:- (2531865:tqdm_logging.py:145)
20:52:41.570 [I] Progress on: 10.9kit/100kit rate:2.1it/s remaining:11:48:45 elapsed:1:26:53 postfix:- (2531865:tqdm_logging.py:145)
20:52:51.886 [I] Progress on: 10.9kit/100kit rate:2.1it/s remaining:11:38:06 elapsed:1:27:03 postfix:- (2531865:tqdm_logging.py:145)
20:53:01.973 [I] Progress on: 11.0kit/100kit rate:2.1it/s remaining:11:37:35 elapsed:1:27:14 postfix:- (2531865:tqdm_logging.py:145)
20:53:12.311 [I] Progress on: 11.0kit/100kit rate:2.1it/s remaining:11:37:18 elapsed:1:27:24 postfix:- (2531865:tqdm_logging.py:145)
Step 11000: grad_norm=0.1208, loss=0.0037, param_norm=1380.4880
20:53:18.631 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
20:53:18.631 [I] [process=0] Saving checkpoint at step 11000                                      (2531865:checkpoint_manager.py:1408)
20:53:18.631 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000. (2531865:async_checkpointer.py:439)
20:53:18.641 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40 (2531865:atomicity.py:144)
20:53:18.649 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/assets.orbax-checkpoint-tmp-41 (2531865:atomicity.py:144)
20:53:18.649 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/params.orbax-checkpoint-tmp-42 (2531865:atomicity.py:144)
20:53:18.649 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/train_state.orbax-checkpoint-tmp-43 (2531865:atomicity.py:144)
20:53:18.666 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:53:19.123 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
20:53:19.144 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/params.orbax-checkpoint-tmp-42/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:53:24.729 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.1 GiB/s (total bytes: 7.0 GiB) (time elapsed: 6 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:53:24.738 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 1.7 GiB/s (total bytes: 10.5 GiB) (time elapsed: 6 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:53:24.749 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
20:53:24.751 [I] Finished blocking save in 6.12 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000. (2531865:async_checkpointer.py:548)
20:53:24.752 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
20:53:24.752 [I] Preserving Checkpoint[step=10000 | time=2025-11-02 12:45:26.660204+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
20:53:24.752 [I] [process=0][thread=MainThread][step=11000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
20:53:24.753 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
20:53:24.753 [I] {'step': 11000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762087998.6311777, 'wait_for_prev_duration_secs': 0.0001628398895263672, 'checkpointer_blocking_start_time': 1762087998.6315765, 'checkpointer_blocking_duration_secs': 6.120548725128174, 'get_old_steps_start_time': 1762088004.7521422, 'get_old_steps_duration_secs': 0.000278472900390625, 'checkpoint_manager_blocking_start_time': 1762087998.6310844, 'checkpoint_manager_blocking_duration_secs': 6.122508764266968} (2531865:standard_logger.py:34)
20:53:24.755 [I] Progress on: 11.0kit/100kit rate:2.4s/it remaining:58:35:16 elapsed:1:27:36 postfix:- (2531865:tqdm_logging.py:145)
20:53:24.784 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/train_state.orbax-checkpoint-tmp-43/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
20:53:34.806 [I] Progress on: 11.0kit/100kit rate:2.1it/s remaining:11:39:17 elapsed:1:27:46 postfix:- (2531865:tqdm_logging.py:145)
20:53:35.423 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 426.7 MiB/s (total bytes: 7.0 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:53:38.347 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 544.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: 19 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
20:53:38.347 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
20:53:38.348 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/assets.orbax-checkpoint-tmp-41 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/assets (2531865:atomicity.py:289)
20:53:38.358 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:53:38.455 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/train_state.orbax-checkpoint-tmp-43 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/train_state (2531865:atomicity.py:289)
20:53:38.460 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
20:53:38.509 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/params.orbax-checkpoint-tmp-42 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40/params (2531865:atomicity.py:289)
20:53:38.510 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000.orbax-checkpoint-tmp-40 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000 (2531865:atomicity.py:289)
20:53:38.515 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000`. (2531865:atomicity.py:573)
20:53:38.515 [I] Finished asynchronous save (blocking + background) in 19.88 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/11000 (2531865:async_checkpointer.py:412)
20:53:38.515 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
20:53:38.515 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
20:53:38.516 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
20:53:38.516 [I] [process=0][thread=save_finalize][step=11000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
20:53:38.516 [I] [process=0][thread=save_finalize][step=11000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
20:53:45.142 [I] Progress on: 11.0kit/100kit rate:2.1it/s remaining:11:36:33 elapsed:1:27:57 postfix:- (2531865:tqdm_logging.py:145)
20:53:55.480 [I] Progress on: 11.1kit/100kit rate:2.1it/s remaining:11:37:28 elapsed:1:28:07 postfix:- (2531865:tqdm_logging.py:145)
20:54:05.822 [I] Progress on: 11.1kit/100kit rate:2.1it/s remaining:11:37:13 elapsed:1:28:17 postfix:- (2531865:tqdm_logging.py:145)
Step 11100: grad_norm=0.1232, loss=0.0040, param_norm=1380.4930
20:54:16.215 [I] Progress on: 11.1kit/100kit rate:2.1it/s remaining:11:36:39 elapsed:1:28:28 postfix:- (2531865:tqdm_logging.py:145)
20:54:26.558 [I] Progress on: 11.1kit/100kit rate:2.1it/s remaining:11:36:16 elapsed:1:28:38 postfix:- (2531865:tqdm_logging.py:145)
20:54:36.898 [I] Progress on: 11.2kit/100kit rate:2.1it/s remaining:11:36:10 elapsed:1:28:48 postfix:- (2531865:tqdm_logging.py:145)
20:54:47.236 [I] Progress on: 11.2kit/100kit rate:2.1it/s remaining:11:35:57 elapsed:1:28:59 postfix:- (2531865:tqdm_logging.py:145)
20:54:57.578 [I] Progress on: 11.2kit/100kit rate:2.1it/s remaining:11:36:00 elapsed:1:29:09 postfix:- (2531865:tqdm_logging.py:145)
Step 11200: grad_norm=0.2095, loss=0.0047, param_norm=1380.4978
20:55:07.968 [I] Progress on: 11.2kit/100kit rate:2.1it/s remaining:11:35:31 elapsed:1:29:19 postfix:- (2531865:tqdm_logging.py:145)
20:55:18.310 [I] Progress on: 11.2kit/100kit rate:2.1it/s remaining:11:35:05 elapsed:1:29:30 postfix:- (2531865:tqdm_logging.py:145)
20:55:28.649 [I] Progress on: 11.3kit/100kit rate:2.1it/s remaining:11:35:00 elapsed:1:29:40 postfix:- (2531865:tqdm_logging.py:145)
20:55:38.988 [I] Progress on: 11.3kit/100kit rate:2.1it/s remaining:11:35:02 elapsed:1:29:51 postfix:- (2531865:tqdm_logging.py:145)
Step 11300: grad_norm=0.1118, loss=0.0036, param_norm=1380.5024
20:55:49.377 [I] Progress on: 11.3kit/100kit rate:2.1it/s remaining:11:33:54 elapsed:1:30:01 postfix:- (2531865:tqdm_logging.py:145)
20:55:59.721 [I] Progress on: 11.3kit/100kit rate:2.1it/s remaining:11:35:32 elapsed:1:30:11 postfix:- (2531865:tqdm_logging.py:145)
20:56:10.061 [I] Progress on: 11.4kit/100kit rate:2.1it/s remaining:11:34:44 elapsed:1:30:22 postfix:- (2531865:tqdm_logging.py:145)
20:56:20.147 [I] Progress on: 11.4kit/100kit rate:2.1it/s remaining:11:41:30 elapsed:1:30:32 postfix:- (2531865:tqdm_logging.py:145)
20:56:30.249 [I] Progress on: 11.4kit/100kit rate:2.1it/s remaining:11:36:12 elapsed:1:30:42 postfix:- (2531865:tqdm_logging.py:145)
Step 11400: grad_norm=0.1332, loss=0.0039, param_norm=1380.5072
20:56:40.638 [I] Progress on: 11.4kit/100kit rate:2.1it/s remaining:11:34:05 elapsed:1:30:52 postfix:- (2531865:tqdm_logging.py:145)
20:56:50.976 [I] Progress on: 11.4kit/100kit rate:2.1it/s remaining:11:33:35 elapsed:1:31:03 postfix:- (2531865:tqdm_logging.py:145)
20:57:01.321 [I] Progress on: 11.5kit/100kit rate:2.1it/s remaining:11:34:22 elapsed:1:31:13 postfix:- (2531865:tqdm_logging.py:145)
20:57:11.660 [I] Progress on: 11.5kit/100kit rate:2.1it/s remaining:11:33:34 elapsed:1:31:23 postfix:- (2531865:tqdm_logging.py:145)
Step 11500: grad_norm=0.1224, loss=0.0035, param_norm=1380.5120
20:57:22.052 [I] Progress on: 11.5kit/100kit rate:2.1it/s remaining:11:30:57 elapsed:1:31:34 postfix:- (2531865:tqdm_logging.py:145)
20:57:32.394 [I] Progress on: 11.5kit/100kit rate:2.1it/s remaining:11:33:16 elapsed:1:31:44 postfix:- (2531865:tqdm_logging.py:145)
20:57:42.736 [I] Progress on: 11.5kit/100kit rate:2.1it/s remaining:11:33:18 elapsed:1:31:54 postfix:- (2531865:tqdm_logging.py:145)
20:57:53.078 [I] Progress on: 11.6kit/100kit rate:2.1it/s remaining:11:32:51 elapsed:1:32:05 postfix:- (2531865:tqdm_logging.py:145)
20:58:03.419 [I] Progress on: 11.6kit/100kit rate:2.1it/s remaining:11:32:33 elapsed:1:32:15 postfix:- (2531865:tqdm_logging.py:145)
Step 11600: grad_norm=0.1292, loss=0.0038, param_norm=1380.5165
20:58:13.808 [I] Progress on: 11.6kit/100kit rate:2.1it/s remaining:11:32:22 elapsed:1:32:25 postfix:- (2531865:tqdm_logging.py:145)
20:58:24.150 [I] Progress on: 11.6kit/100kit rate:2.1it/s remaining:11:32:10 elapsed:1:32:36 postfix:- (2531865:tqdm_logging.py:145)
20:58:34.493 [I] Progress on: 11.7kit/100kit rate:2.1it/s remaining:11:32:01 elapsed:1:32:46 postfix:- (2531865:tqdm_logging.py:145)
20:58:44.835 [I] Progress on: 11.7kit/100kit rate:2.1it/s remaining:11:31:50 elapsed:1:32:56 postfix:- (2531865:tqdm_logging.py:145)
Step 11700: grad_norm=0.1561, loss=0.0042, param_norm=1380.5212
20:58:54.877 [I] Progress on: 11.7kit/100kit rate:2.1it/s remaining:11:31:54 elapsed:1:33:06 postfix:- (2531865:tqdm_logging.py:145)
20:59:05.099 [I] Progress on: 11.7kit/100kit rate:2.1it/s remaining:11:31:14 elapsed:1:33:17 postfix:- (2531865:tqdm_logging.py:145)
20:59:15.436 [I] Progress on: 11.7kit/100kit rate:2.1it/s remaining:11:31:30 elapsed:1:33:27 postfix:- (2531865:tqdm_logging.py:145)
20:59:25.776 [I] Progress on: 11.8kit/100kit rate:2.1it/s remaining:11:30:03 elapsed:1:33:37 postfix:- (2531865:tqdm_logging.py:145)
20:59:36.030 [I] Progress on: 11.8kit/100kit rate:1.7it/s remaining:14:17:07 elapsed:1:33:48 postfix:- (2531865:tqdm_logging.py:145)
Step 11800: grad_norm=0.1193, loss=0.0039, param_norm=1380.5259
20:59:46.269 [I] Progress on: 11.8kit/100kit rate:2.1it/s remaining:11:30:07 elapsed:1:33:58 postfix:- (2531865:tqdm_logging.py:145)
20:59:56.619 [I] Progress on: 11.8kit/100kit rate:2.1it/s remaining:11:31:25 elapsed:1:34:08 postfix:- (2531865:tqdm_logging.py:145)
21:00:06.963 [I] Progress on: 11.9kit/100kit rate:2.1it/s remaining:11:31:28 elapsed:1:34:18 postfix:- (2531865:tqdm_logging.py:145)
21:00:17.299 [I] Progress on: 11.9kit/100kit rate:2.1it/s remaining:11:30:45 elapsed:1:34:29 postfix:- (2531865:tqdm_logging.py:145)
21:00:27.645 [I] Progress on: 11.9kit/100kit rate:2.1it/s remaining:11:33:35 elapsed:1:34:39 postfix:- (2531865:tqdm_logging.py:145)
Step 11900: grad_norm=0.1240, loss=0.0039, param_norm=1380.5300
21:00:38.042 [I] Progress on: 11.9kit/100kit rate:2.1it/s remaining:11:30:24 elapsed:1:34:50 postfix:- (2531865:tqdm_logging.py:145)
21:00:48.383 [I] Progress on: 11.9kit/100kit rate:2.1it/s remaining:11:30:51 elapsed:1:35:00 postfix:- (2531865:tqdm_logging.py:145)
21:00:58.720 [I] Progress on: 12.0kit/100kit rate:2.1it/s remaining:11:29:18 elapsed:1:35:10 postfix:- (2531865:tqdm_logging.py:145)
21:01:09.060 [I] Progress on: 12.0kit/100kit rate:2.1it/s remaining:11:29:18 elapsed:1:35:21 postfix:- (2531865:tqdm_logging.py:145)
Step 12000: grad_norm=0.1278, loss=0.0038, param_norm=1380.5343
21:01:16.324 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
21:01:16.324 [I] [process=0] Saving checkpoint at step 12000                                      (2531865:checkpoint_manager.py:1408)
21:01:16.325 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000. (2531865:async_checkpointer.py:439)
21:01:16.328 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44 (2531865:atomicity.py:144)
21:01:16.344 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/params.orbax-checkpoint-tmp-46 (2531865:atomicity.py:144)
21:01:16.344 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/train_state.orbax-checkpoint-tmp-47 (2531865:atomicity.py:144)
21:01:16.344 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/assets.orbax-checkpoint-tmp-45 (2531865:atomicity.py:144)
21:01:16.363 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:01:16.749 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:01:16.770 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/params.orbax-checkpoint-tmp-46/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:01:32.336 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 447.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:01:32.352 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 670.3 MiB/s (total bytes: 10.5 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:01:32.357 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
21:01:32.357 [I] Finished blocking save in 16.03 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000. (2531865:async_checkpointer.py:548)
21:01:32.358 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:01:32.358 [I] Preserving Checkpoint[step=10000 | time=2025-11-02 12:45:26.660204+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:01:32.358 [I] Deleting Checkpoint[step=11000 | time=2025-11-02 12:53:24.752130+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
21:01:32.358 [I] [process=0][thread=MainThread][step=12000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
21:01:32.358 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
21:01:32.358 [I] {'step': 12000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762088476.3244758, 'wait_for_prev_duration_secs': 0.0002052783966064453, 'checkpointer_blocking_start_time': 1762088476.3249707, 'checkpointer_blocking_duration_secs': 16.032981872558594, 'get_old_steps_start_time': 1762088492.3579724, 'get_old_steps_duration_secs': 0.00022125244140625, 'checkpoint_manager_blocking_start_time': 1762088476.3243504, 'checkpoint_manager_blocking_duration_secs': 16.034323930740356} (2531865:standard_logger.py:34)
21:01:32.360 [I] Progress on: 12.0kit/100kit rate:5.3s/it remaining:130:38:17 elapsed:1:35:44 postfix:- (2531865:tqdm_logging.py:145)
21:01:32.412 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/train_state.orbax-checkpoint-tmp-47/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:01:42.817 [I] Progress on: 12.0kit/100kit rate:2.1it/s remaining:11:33:42 elapsed:1:35:54 postfix:- (2531865:tqdm_logging.py:145)
21:01:43.341 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 265.2 MiB/s (total bytes: 7.0 GiB) (time elapsed: 27 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:01:45.853 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 363.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: 29 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:01:45.853 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
21:01:45.854 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/assets.orbax-checkpoint-tmp-45 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/assets (2531865:atomicity.py:289)
21:01:45.859 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:01:45.956 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/train_state.orbax-checkpoint-tmp-47 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/train_state (2531865:atomicity.py:289)
21:01:45.961 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:01:46.028 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/params.orbax-checkpoint-tmp-46 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44/params (2531865:atomicity.py:289)
21:01:46.030 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000.orbax-checkpoint-tmp-44 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000 (2531865:atomicity.py:289)
21:01:46.035 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000`. (2531865:atomicity.py:573)
21:01:46.035 [I] Finished asynchronous save (blocking + background) in 29.71 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/12000 (2531865:async_checkpointer.py:412)
21:01:46.035 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
21:01:46.035 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
21:01:46.036 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
21:01:46.566 [I] Deleted step 11000.                                                              (2531865:deleter.py:114)
21:01:46.566 [I] [process=0][thread=save_finalize][step=12000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
21:01:46.566 [I] [process=0][thread=save_finalize][step=12000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
21:01:53.147 [I] Progress on: 12.0kit/100kit rate:2.1it/s remaining:11:28:37 elapsed:1:36:05 postfix:- (2531865:tqdm_logging.py:145)
21:02:03.487 [I] Progress on: 12.1kit/100kit rate:2.1it/s remaining:11:26:17 elapsed:1:36:15 postfix:- (2531865:tqdm_logging.py:145)
21:02:13.826 [I] Progress on: 12.1kit/100kit rate:2.1it/s remaining:11:27:45 elapsed:1:36:25 postfix:- (2531865:tqdm_logging.py:145)
Step 12100: grad_norm=0.1287, loss=0.0037, param_norm=1380.5385
21:02:24.220 [I] Progress on: 12.1kit/100kit rate:2.1it/s remaining:11:28:32 elapsed:1:36:36 postfix:- (2531865:tqdm_logging.py:145)
21:02:34.563 [I] Progress on: 12.1kit/100kit rate:2.1it/s remaining:11:28:20 elapsed:1:36:46 postfix:- (2531865:tqdm_logging.py:145)
21:02:44.899 [I] Progress on: 12.2kit/100kit rate:2.1it/s remaining:11:28:15 elapsed:1:36:56 postfix:- (2531865:tqdm_logging.py:145)
21:02:55.238 [I] Progress on: 12.2kit/100kit rate:2.1it/s remaining:11:27:51 elapsed:1:37:07 postfix:- (2531865:tqdm_logging.py:145)
21:03:05.578 [I] Progress on: 12.2kit/100kit rate:2.1it/s remaining:11:27:12 elapsed:1:37:17 postfix:- (2531865:tqdm_logging.py:145)
Step 12200: grad_norm=0.1147, loss=0.0035, param_norm=1380.5425
21:03:15.722 [I] Progress on: 12.2kit/100kit rate:2.1it/s remaining:11:30:25 elapsed:1:37:27 postfix:- (2531865:tqdm_logging.py:145)
21:03:26.057 [I] Progress on: 12.2kit/100kit rate:2.1it/s remaining:11:27:56 elapsed:1:37:38 postfix:- (2531865:tqdm_logging.py:145)
21:03:36.400 [I] Progress on: 12.3kit/100kit rate:2.1it/s remaining:11:27:32 elapsed:1:37:48 postfix:- (2531865:tqdm_logging.py:145)
21:03:46.737 [I] Progress on: 12.3kit/100kit rate:2.1it/s remaining:11:26:30 elapsed:1:37:58 postfix:- (2531865:tqdm_logging.py:145)
Step 12300: grad_norm=0.1267, loss=0.0038, param_norm=1380.5465
21:03:57.129 [I] Progress on: 12.3kit/100kit rate:2.1it/s remaining:11:26:11 elapsed:1:38:09 postfix:- (2531865:tqdm_logging.py:145)
21:04:07.468 [I] Progress on: 12.3kit/100kit rate:2.1it/s remaining:11:25:54 elapsed:1:38:19 postfix:- (2531865:tqdm_logging.py:145)
21:04:17.574 [I] Progress on: 12.4kit/100kit rate:2.1it/s remaining:11:26:04 elapsed:1:38:29 postfix:- (2531865:tqdm_logging.py:145)
21:04:27.916 [I] Progress on: 12.4kit/100kit rate:2.1it/s remaining:11:25:44 elapsed:1:38:39 postfix:- (2531865:tqdm_logging.py:145)
21:04:38.256 [I] Progress on: 12.4kit/100kit rate:2.1it/s remaining:11:26:25 elapsed:1:38:50 postfix:- (2531865:tqdm_logging.py:145)
Step 12400: grad_norm=0.1159, loss=0.0036, param_norm=1380.5510
21:04:48.654 [I] Progress on: 12.4kit/100kit rate:2.1it/s remaining:11:26:39 elapsed:1:39:00 postfix:- (2531865:tqdm_logging.py:145)
21:04:58.989 [I] Progress on: 12.4kit/100kit rate:2.1it/s remaining:11:24:22 elapsed:1:39:11 postfix:- (2531865:tqdm_logging.py:145)
21:05:09.328 [I] Progress on: 12.5kit/100kit rate:2.1it/s remaining:11:25:48 elapsed:1:39:21 postfix:- (2531865:tqdm_logging.py:145)
21:05:19.667 [I] Progress on: 12.5kit/100kit rate:2.1it/s remaining:11:25:20 elapsed:1:39:31 postfix:- (2531865:tqdm_logging.py:145)
Step 12500: grad_norm=0.1212, loss=0.0035, param_norm=1380.5548
21:05:30.053 [I] Progress on: 12.5kit/100kit rate:2.1it/s remaining:11:22:44 elapsed:1:39:42 postfix:- (2531865:tqdm_logging.py:145)
21:05:40.393 [I] Progress on: 12.5kit/100kit rate:2.1it/s remaining:11:24:39 elapsed:1:39:52 postfix:- (2531865:tqdm_logging.py:145)
21:05:50.733 [I] Progress on: 12.5kit/100kit rate:2.1it/s remaining:11:24:37 elapsed:1:40:02 postfix:- (2531865:tqdm_logging.py:145)
21:06:01.072 [I] Progress on: 12.6kit/100kit rate:2.1it/s remaining:11:23:53 elapsed:1:40:13 postfix:- (2531865:tqdm_logging.py:145)
21:06:11.410 [I] Progress on: 12.6kit/100kit rate:2.1it/s remaining:11:24:02 elapsed:1:40:23 postfix:- (2531865:tqdm_logging.py:145)
Step 12600: grad_norm=0.1163, loss=0.0034, param_norm=1380.5591
21:06:21.794 [I] Progress on: 12.6kit/100kit rate:2.1it/s remaining:11:24:13 elapsed:1:40:33 postfix:- (2531865:tqdm_logging.py:145)
21:06:31.871 [I] Progress on: 12.6kit/100kit rate:2.1it/s remaining:11:31:38 elapsed:1:40:43 postfix:- (2531865:tqdm_logging.py:145)
21:06:42.208 [I] Progress on: 12.7kit/100kit rate:2.1it/s remaining:11:23:41 elapsed:1:40:54 postfix:- (2531865:tqdm_logging.py:145)
21:06:52.547 [I] Progress on: 12.7kit/100kit rate:2.1it/s remaining:11:25:14 elapsed:1:41:04 postfix:- (2531865:tqdm_logging.py:145)
Step 12700: grad_norm=0.1473, loss=0.0038, param_norm=1380.5631
21:07:02.586 [I] Progress on: 12.7kit/100kit rate:2.1it/s remaining:11:23:36 elapsed:1:41:14 postfix:- (2531865:tqdm_logging.py:145)
21:07:12.794 [I] Progress on: 12.7kit/100kit rate:2.1it/s remaining:11:22:55 elapsed:1:41:24 postfix:- (2531865:tqdm_logging.py:145)
21:07:23.132 [I] Progress on: 12.7kit/100kit rate:2.1it/s remaining:11:23:05 elapsed:1:41:35 postfix:- (2531865:tqdm_logging.py:145)
21:07:33.469 [I] Progress on: 12.8kit/100kit rate:2.1it/s remaining:11:22:58 elapsed:1:41:45 postfix:- (2531865:tqdm_logging.py:145)
21:07:43.807 [I] Progress on: 12.8kit/100kit rate:2.1it/s remaining:11:22:31 elapsed:1:41:55 postfix:- (2531865:tqdm_logging.py:145)
Step 12800: grad_norm=0.1173, loss=0.0036, param_norm=1380.5671
21:07:54.194 [I] Progress on: 12.8kit/100kit rate:2.1it/s remaining:11:22:24 elapsed:1:42:06 postfix:- (2531865:tqdm_logging.py:145)
21:08:04.532 [I] Progress on: 12.8kit/100kit rate:2.1it/s remaining:11:22:26 elapsed:1:42:16 postfix:- (2531865:tqdm_logging.py:145)
21:08:14.869 [I] Progress on: 12.9kit/100kit rate:2.1it/s remaining:11:21:51 elapsed:1:42:26 postfix:- (2531865:tqdm_logging.py:145)
21:08:25.208 [I] Progress on: 12.9kit/100kit rate:2.1it/s remaining:11:22:12 elapsed:1:42:37 postfix:- (2531865:tqdm_logging.py:145)
21:08:35.544 [I] Progress on: 12.9kit/100kit rate:2.1it/s remaining:11:22:11 elapsed:1:42:47 postfix:- (2531865:tqdm_logging.py:145)
Step 12900: grad_norm=0.1155, loss=0.0034, param_norm=1380.5709
21:08:45.934 [I] Progress on: 12.9kit/100kit rate:2.1it/s remaining:11:22:18 elapsed:1:42:57 postfix:- (2531865:tqdm_logging.py:145)
21:08:56.268 [I] Progress on: 12.9kit/100kit rate:2.1it/s remaining:11:21:31 elapsed:1:43:08 postfix:- (2531865:tqdm_logging.py:145)
21:09:06.607 [I] Progress on: 13.0kit/100kit rate:2.1it/s remaining:11:21:29 elapsed:1:43:18 postfix:- (2531865:tqdm_logging.py:145)
21:09:16.947 [I] Progress on: 13.0kit/100kit rate:2.1it/s remaining:11:21:28 elapsed:1:43:28 postfix:- (2531865:tqdm_logging.py:145)
Step 13000: grad_norm=0.1150, loss=0.0034, param_norm=1380.5743
21:09:23.740 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
21:09:23.741 [I] [process=0] Saving checkpoint at step 13000                                      (2531865:checkpoint_manager.py:1408)
21:09:23.741 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000. (2531865:async_checkpointer.py:439)
21:09:23.751 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48 (2531865:atomicity.py:144)
21:09:23.756 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/assets.orbax-checkpoint-tmp-49 (2531865:atomicity.py:144)
21:09:23.756 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/train_state.orbax-checkpoint-tmp-51 (2531865:atomicity.py:144)
21:09:23.756 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/params.orbax-checkpoint-tmp-50 (2531865:atomicity.py:144)
21:09:23.775 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:09:24.184 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:09:24.204 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/params.orbax-checkpoint-tmp-50/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:09:25.730 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.5 GiB/s (total bytes: 7.0 GiB) (time elapsed: a second) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:09:25.734 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 5.3 GiB/s (total bytes: 10.5 GiB) (time elapsed: a second) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:09:25.751 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
21:09:25.751 [I] Finished blocking save in 2.01 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000. (2531865:async_checkpointer.py:548)
21:09:25.753 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:09:25.754 [I] Preserving Checkpoint[step=10000 | time=2025-11-02 12:45:26.660204+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:09:25.754 [I] Deleting Checkpoint[step=12000 | time=2025-11-02 13:01:32.357958+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
21:09:25.754 [I] [process=0][thread=MainThread][step=13000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
21:09:25.755 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
21:09:25.755 [I] {'step': 13000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762088963.7407107, 'wait_for_prev_duration_secs': 0.00017404556274414062, 'checkpointer_blocking_start_time': 1762088963.7411335, 'checkpointer_blocking_duration_secs': 2.0125889778137207, 'get_old_steps_start_time': 1762088965.7537408, 'get_old_steps_duration_secs': 0.0008320808410644531, 'checkpoint_manager_blocking_start_time': 1762088963.7406132, 'checkpoint_manager_blocking_duration_secs': 2.014695405960083} (2531865:standard_logger.py:34)
21:09:25.830 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/train_state.orbax-checkpoint-tmp-51/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:09:27.317 [I] Progress on: 13.0kit/100kit rate:1.1it/s remaining:22:33:51 elapsed:1:43:39 postfix:- (2531865:tqdm_logging.py:145)
21:09:37.498 [I] Progress on: 13.0kit/100kit rate:2.1it/s remaining:11:19:46 elapsed:1:43:49 postfix:- (2531865:tqdm_logging.py:145)
21:09:38.284 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 492.7 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:09:39.204 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 694.6 MiB/s (total bytes: 10.5 GiB) (time elapsed: 15 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:09:39.204 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
21:09:39.205 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/assets.orbax-checkpoint-tmp-49 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/assets (2531865:atomicity.py:289)
21:09:39.210 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:09:39.233 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/train_state.orbax-checkpoint-tmp-51 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/train_state (2531865:atomicity.py:289)
21:09:39.237 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:09:39.342 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/params.orbax-checkpoint-tmp-50 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48/params (2531865:atomicity.py:289)
21:09:39.346 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000.orbax-checkpoint-tmp-48 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000 (2531865:atomicity.py:289)
21:09:39.351 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000`. (2531865:atomicity.py:573)
21:09:39.351 [I] Finished asynchronous save (blocking + background) in 15.61 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/13000 (2531865:async_checkpointer.py:412)
21:09:39.352 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
21:09:39.352 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
21:09:39.352 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
21:09:39.991 [I] Deleted step 12000.                                                              (2531865:deleter.py:114)
21:09:39.992 [I] [process=0][thread=save_finalize][step=13000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
21:09:39.992 [I] [process=0][thread=save_finalize][step=13000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
21:09:47.836 [I] Progress on: 13.0kit/100kit rate:2.1it/s remaining:11:21:41 elapsed:1:43:59 postfix:- (2531865:tqdm_logging.py:145)
21:09:57.914 [I] Progress on: 13.1kit/100kit rate:2.1it/s remaining:11:20:24 elapsed:1:44:09 postfix:- (2531865:tqdm_logging.py:145)
21:10:08.252 [I] Progress on: 13.1kit/100kit rate:2.1it/s remaining:11:20:54 elapsed:1:44:20 postfix:- (2531865:tqdm_logging.py:145)
Step 13100: grad_norm=0.1486, loss=0.0039, param_norm=1380.5784
21:10:18.639 [I] Progress on: 13.1kit/100kit rate:2.1it/s remaining:11:20:32 elapsed:1:44:30 postfix:- (2531865:tqdm_logging.py:145)
21:10:28.974 [I] Progress on: 13.1kit/100kit rate:2.1it/s remaining:11:20:28 elapsed:1:44:41 postfix:- (2531865:tqdm_logging.py:145)
21:10:39.308 [I] Progress on: 13.2kit/100kit rate:2.1it/s remaining:11:20:22 elapsed:1:44:51 postfix:- (2531865:tqdm_logging.py:145)
21:10:49.643 [I] Progress on: 13.2kit/100kit rate:2.1it/s remaining:11:19:25 elapsed:1:45:01 postfix:- (2531865:tqdm_logging.py:145)
21:10:59.981 [I] Progress on: 13.2kit/100kit rate:2.1it/s remaining:11:20:02 elapsed:1:45:12 postfix:- (2531865:tqdm_logging.py:145)
Step 13200: grad_norm=0.1487, loss=0.0036, param_norm=1380.5825
21:11:10.370 [I] Progress on: 13.2kit/100kit rate:2.1it/s remaining:11:20:00 elapsed:1:45:22 postfix:- (2531865:tqdm_logging.py:145)
21:11:20.706 [I] Progress on: 13.2kit/100kit rate:2.1it/s remaining:11:19:30 elapsed:1:45:32 postfix:- (2531865:tqdm_logging.py:145)
21:11:31.043 [I] Progress on: 13.3kit/100kit rate:2.1it/s remaining:11:19:31 elapsed:1:45:43 postfix:- (2531865:tqdm_logging.py:145)
21:11:41.381 [I] Progress on: 13.3kit/100kit rate:2.1it/s remaining:11:19:15 elapsed:1:45:53 postfix:- (2531865:tqdm_logging.py:145)
Step 13300: grad_norm=0.1203, loss=0.0034, param_norm=1380.5859
21:11:51.531 [I] Progress on: 13.3kit/100kit rate:2.1it/s remaining:11:23:57 elapsed:1:46:03 postfix:- (2531865:tqdm_logging.py:145)
21:12:01.591 [I] Progress on: 13.3kit/100kit rate:2.1it/s remaining:11:25:51 elapsed:1:46:13 postfix:- (2531865:tqdm_logging.py:145)
21:12:11.927 [I] Progress on: 13.4kit/100kit rate:2.1it/s remaining:11:18:24 elapsed:1:46:23 postfix:- (2531865:tqdm_logging.py:145)
21:12:22.263 [I] Progress on: 13.4kit/100kit rate:2.1it/s remaining:11:18:30 elapsed:1:46:34 postfix:- (2531865:tqdm_logging.py:145)
21:12:32.595 [I] Progress on: 13.4kit/100kit rate:2.1it/s remaining:11:17:49 elapsed:1:46:44 postfix:- (2531865:tqdm_logging.py:145)
Step 13400: grad_norm=0.1210, loss=0.0035, param_norm=1380.5896
21:12:42.979 [I] Progress on: 13.4kit/100kit rate:2.1it/s remaining:11:18:01 elapsed:1:46:55 postfix:- (2531865:tqdm_logging.py:145)
21:12:53.314 [I] Progress on: 13.4kit/100kit rate:2.1it/s remaining:11:17:36 elapsed:1:47:05 postfix:- (2531865:tqdm_logging.py:145)
21:13:03.652 [I] Progress on: 13.5kit/100kit rate:2.1it/s remaining:11:17:50 elapsed:1:47:15 postfix:- (2531865:tqdm_logging.py:145)
21:13:13.724 [I] Progress on: 13.5kit/100kit rate:2.2it/s remaining:11:08:20 elapsed:1:47:25 postfix:- (2531865:tqdm_logging.py:145)
Step 13500: grad_norm=0.1164, loss=0.0034, param_norm=1380.5931
21:13:24.114 [I] Progress on: 13.5kit/100kit rate:2.1it/s remaining:11:13:02 elapsed:1:47:36 postfix:- (2531865:tqdm_logging.py:145)
21:13:34.451 [I] Progress on: 13.5kit/100kit rate:2.1it/s remaining:11:17:08 elapsed:1:47:46 postfix:- (2531865:tqdm_logging.py:145)
21:13:44.785 [I] Progress on: 13.5kit/100kit rate:2.1it/s remaining:11:16:24 elapsed:1:47:56 postfix:- (2531865:tqdm_logging.py:145)
21:13:55.124 [I] Progress on: 13.6kit/100kit rate:2.1it/s remaining:11:16:33 elapsed:1:48:07 postfix:- (2531865:tqdm_logging.py:145)
21:14:05.461 [I] Progress on: 13.6kit/100kit rate:2.1it/s remaining:11:16:16 elapsed:1:48:17 postfix:- (2531865:tqdm_logging.py:145)
Step 13600: grad_norm=0.1270, loss=0.0038, param_norm=1380.5968
21:14:15.847 [I] Progress on: 13.6kit/100kit rate:2.1it/s remaining:11:16:14 elapsed:1:48:27 postfix:- (2531865:tqdm_logging.py:145)
21:14:26.184 [I] Progress on: 13.6kit/100kit rate:2.1it/s remaining:11:16:04 elapsed:1:48:38 postfix:- (2531865:tqdm_logging.py:145)
21:14:36.521 [I] Progress on: 13.7kit/100kit rate:2.1it/s remaining:11:15:53 elapsed:1:48:48 postfix:- (2531865:tqdm_logging.py:145)
21:14:46.860 [I] Progress on: 13.7kit/100kit rate:2.1it/s remaining:11:15:38 elapsed:1:48:58 postfix:- (2531865:tqdm_logging.py:145)
Step 13700: grad_norm=0.1107, loss=0.0033, param_norm=1380.6005
21:14:57.249 [I] Progress on: 13.7kit/100kit rate:2.1it/s remaining:11:12:45 elapsed:1:49:09 postfix:- (2531865:tqdm_logging.py:145)
21:15:07.583 [I] Progress on: 13.7kit/100kit rate:2.1it/s remaining:11:15:27 elapsed:1:49:19 postfix:- (2531865:tqdm_logging.py:145)
21:15:17.921 [I] Progress on: 13.7kit/100kit rate:2.1it/s remaining:11:15:06 elapsed:1:49:29 postfix:- (2531865:tqdm_logging.py:145)
21:15:28.259 [I] Progress on: 13.8kit/100kit rate:2.1it/s remaining:11:15:34 elapsed:1:49:40 postfix:- (2531865:tqdm_logging.py:145)
21:15:38.594 [I] Progress on: 13.8kit/100kit rate:2.1it/s remaining:11:14:42 elapsed:1:49:50 postfix:- (2531865:tqdm_logging.py:145)
Step 13800: grad_norm=0.1434, loss=0.0038, param_norm=1380.6040
21:15:48.982 [I] Progress on: 13.8kit/100kit rate:2.1it/s remaining:11:14:23 elapsed:1:50:01 postfix:- (2531865:tqdm_logging.py:145)
21:15:59.321 [I] Progress on: 13.8kit/100kit rate:2.1it/s remaining:11:13:58 elapsed:1:50:11 postfix:- (2531865:tqdm_logging.py:145)
21:16:09.660 [I] Progress on: 13.9kit/100kit rate:2.1it/s remaining:11:14:25 elapsed:1:50:21 postfix:- (2531865:tqdm_logging.py:145)
21:16:19.997 [I] Progress on: 13.9kit/100kit rate:2.1it/s remaining:11:13:48 elapsed:1:50:32 postfix:- (2531865:tqdm_logging.py:145)
21:16:30.052 [I] Progress on: 13.9kit/100kit rate:2.1it/s remaining:11:08:17 elapsed:1:50:42 postfix:- (2531865:tqdm_logging.py:145)
Step 13900: grad_norm=0.1187, loss=0.0035, param_norm=1380.6078
21:16:40.457 [I] Progress on: 13.9kit/100kit rate:2.2it/s remaining:11:04:03 elapsed:1:50:52 postfix:- (2531865:tqdm_logging.py:145)
21:16:50.793 [I] Progress on: 13.9kit/100kit rate:2.2it/s remaining:11:03:32 elapsed:1:51:02 postfix:- (2531865:tqdm_logging.py:145)
21:17:01.133 [I] Progress on: 14.0kit/100kit rate:2.2it/s remaining:11:03:30 elapsed:1:51:13 postfix:- (2531865:tqdm_logging.py:145)
21:17:11.472 [I] Progress on: 14.0kit/100kit rate:2.2it/s remaining:11:03:29 elapsed:1:51:23 postfix:- (2531865:tqdm_logging.py:145)
Step 14000: grad_norm=0.1107, loss=0.0033, param_norm=1380.6110
21:17:17.834 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
21:17:17.834 [I] [process=0] Saving checkpoint at step 14000                                      (2531865:checkpoint_manager.py:1408)
21:17:17.835 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000. (2531865:async_checkpointer.py:439)
21:17:17.845 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52 (2531865:atomicity.py:144)
21:17:17.850 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/assets.orbax-checkpoint-tmp-53 (2531865:atomicity.py:144)
21:17:17.852 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/params.orbax-checkpoint-tmp-54 (2531865:atomicity.py:144)
21:17:17.852 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/train_state.orbax-checkpoint-tmp-55 (2531865:atomicity.py:144)
21:17:17.868 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:17:18.671 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:17:18.693 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/params.orbax-checkpoint-tmp-54/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:17:20.960 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.2 GiB/s (total bytes: 7.0 GiB) (time elapsed: 3 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:17:20.968 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.4 GiB/s (total bytes: 10.5 GiB) (time elapsed: 3 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:17:20.982 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
21:17:20.982 [I] Finished blocking save in 3.15 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000. (2531865:async_checkpointer.py:548)
21:17:20.983 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:17:20.984 [I] Preserving Checkpoint[step=10000 | time=2025-11-02 12:45:26.660204+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:17:20.984 [I] Deleting Checkpoint[step=13000 | time=2025-11-02 13:09:25.753727+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
21:17:20.984 [I] [process=0][thread=MainThread][step=14000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
21:17:20.985 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
21:17:20.985 [I] {'step': 14000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762089437.8342483, 'wait_for_prev_duration_secs': 0.00023484230041503906, 'checkpointer_blocking_start_time': 1762089437.83478, 'checkpointer_blocking_duration_secs': 3.1489973068237305, 'get_old_steps_start_time': 1762089440.9837954, 'get_old_steps_duration_secs': 0.0007617473602294922, 'checkpoint_manager_blocking_start_time': 1762089437.8341234, 'checkpoint_manager_blocking_duration_secs': 3.1514248847961426} (2531865:standard_logger.py:34)
21:17:21.037 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/train_state.orbax-checkpoint-tmp-55/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:17:22.246 [I] Progress on: 14.0kit/100kit rate:1.1s/it remaining:25:45:33 elapsed:1:51:34 postfix:- (2531865:tqdm_logging.py:145)
21:17:31.479 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 525.2 MiB/s (total bytes: 7.0 GiB) (time elapsed: 13 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:17:32.445 [I] Progress on: 14.0kit/100kit rate:2.1it/s remaining:11:22:40 elapsed:1:51:44 postfix:- (2531865:tqdm_logging.py:145)
21:17:34.810 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 632.7 MiB/s (total bytes: 10.5 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:17:34.810 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
21:17:34.812 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/assets.orbax-checkpoint-tmp-53 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/assets (2531865:atomicity.py:289)
21:17:34.818 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:17:34.880 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/train_state.orbax-checkpoint-tmp-55 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/train_state (2531865:atomicity.py:289)
21:17:34.885 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:17:34.916 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/params.orbax-checkpoint-tmp-54 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52/params (2531865:atomicity.py:289)
21:17:34.918 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000.orbax-checkpoint-tmp-52 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000 (2531865:atomicity.py:289)
21:17:34.923 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000`. (2531865:atomicity.py:573)
21:17:34.923 [I] Finished asynchronous save (blocking + background) in 17.09 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/14000 (2531865:async_checkpointer.py:412)
21:17:34.923 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
21:17:34.923 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
21:17:34.923 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
21:17:35.516 [I] Deleted step 13000.                                                              (2531865:deleter.py:114)
21:17:35.516 [I] [process=0][thread=save_finalize][step=14000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
21:17:35.516 [I] [process=0][thread=save_finalize][step=14000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
21:17:42.785 [I] Progress on: 14.0kit/100kit rate:2.1it/s remaining:11:23:28 elapsed:1:51:54 postfix:- (2531865:tqdm_logging.py:145)
21:17:53.125 [I] Progress on: 14.1kit/100kit rate:2.1it/s remaining:11:23:33 elapsed:1:52:05 postfix:- (2531865:tqdm_logging.py:145)
21:18:03.463 [I] Progress on: 14.1kit/100kit rate:2.1it/s remaining:11:23:31 elapsed:1:52:15 postfix:- (2531865:tqdm_logging.py:145)
Step 14100: grad_norm=0.1080, loss=0.0031, param_norm=1380.6140
21:18:13.868 [I] Progress on: 14.1kit/100kit rate:2.1it/s remaining:11:23:19 elapsed:1:52:25 postfix:- (2531865:tqdm_logging.py:145)
21:18:24.206 [I] Progress on: 14.1kit/100kit rate:2.1it/s remaining:11:23:34 elapsed:1:52:36 postfix:- (2531865:tqdm_logging.py:145)
21:18:34.542 [I] Progress on: 14.2kit/100kit rate:2.1it/s remaining:11:22:58 elapsed:1:52:46 postfix:- (2531865:tqdm_logging.py:145)
21:18:44.879 [I] Progress on: 14.2kit/100kit rate:2.1it/s remaining:11:23:15 elapsed:1:52:56 postfix:- (2531865:tqdm_logging.py:145)
Step 14200: grad_norm=0.1123, loss=0.0033, param_norm=1380.6172
21:18:55.366 [I] Progress on: 14.2kit/100kit rate:2.2it/s remaining:10:59:21 elapsed:1:53:07 postfix:- (2531865:tqdm_logging.py:145)
21:19:05.622 [I] Progress on: 14.2kit/100kit rate:2.1it/s remaining:11:22:56 elapsed:1:53:17 postfix:- (2531865:tqdm_logging.py:145)
21:19:15.956 [I] Progress on: 14.2kit/100kit rate:2.1it/s remaining:11:22:03 elapsed:1:53:27 postfix:- (2531865:tqdm_logging.py:145)
21:19:26.296 [I] Progress on: 14.3kit/100kit rate:2.1it/s remaining:11:22:57 elapsed:1:53:38 postfix:- (2531865:tqdm_logging.py:145)
21:19:36.634 [I] Progress on: 14.3kit/100kit rate:2.1it/s remaining:11:22:10 elapsed:1:53:48 postfix:- (2531865:tqdm_logging.py:145)
Step 14300: grad_norm=0.1354, loss=0.0037, param_norm=1380.6205
21:19:47.038 [I] Progress on: 14.3kit/100kit rate:2.1it/s remaining:11:21:59 elapsed:1:53:59 postfix:- (2531865:tqdm_logging.py:145)
21:19:57.288 [I] Progress on: 14.3kit/100kit rate:2.1it/s remaining:11:11:22 elapsed:1:54:09 postfix:- (2531865:tqdm_logging.py:145)
21:20:07.624 [I] Progress on: 14.4kit/100kit rate:2.1it/s remaining:11:10:37 elapsed:1:54:19 postfix:- (2531865:tqdm_logging.py:145)
21:20:17.963 [I] Progress on: 14.4kit/100kit rate:2.1it/s remaining:11:10:45 elapsed:1:54:29 postfix:- (2531865:tqdm_logging.py:145)
21:20:28.299 [I] Progress on: 14.4kit/100kit rate:2.1it/s remaining:11:10:23 elapsed:1:54:40 postfix:- (2531865:tqdm_logging.py:145)
Step 14400: grad_norm=0.1074, loss=0.0033, param_norm=1380.6238
21:20:38.684 [I] Progress on: 14.4kit/100kit rate:2.1it/s remaining:11:10:25 elapsed:1:54:50 postfix:- (2531865:tqdm_logging.py:145)
21:20:49.022 [I] Progress on: 14.4kit/100kit rate:2.1it/s remaining:11:10:12 elapsed:1:55:01 postfix:- (2531865:tqdm_logging.py:145)
21:20:59.362 [I] Progress on: 14.5kit/100kit rate:2.1it/s remaining:11:09:49 elapsed:1:55:11 postfix:- (2531865:tqdm_logging.py:145)
21:21:09.700 [I] Progress on: 14.5kit/100kit rate:2.1it/s remaining:11:09:41 elapsed:1:55:21 postfix:- (2531865:tqdm_logging.py:145)
Step 14500: grad_norm=0.1147, loss=0.0032, param_norm=1380.6272
21:21:20.083 [I] Progress on: 14.5kit/100kit rate:2.1it/s remaining:11:08:53 elapsed:1:55:32 postfix:- (2531865:tqdm_logging.py:145)
21:21:30.419 [I] Progress on: 14.5kit/100kit rate:2.1it/s remaining:11:09:27 elapsed:1:55:42 postfix:- (2531865:tqdm_logging.py:145)
21:21:40.758 [I] Progress on: 14.6kit/100kit rate:2.1it/s remaining:11:09:58 elapsed:1:55:52 postfix:- (2531865:tqdm_logging.py:145)
21:21:51.094 [I] Progress on: 14.6kit/100kit rate:2.1it/s remaining:11:08:51 elapsed:1:56:03 postfix:- (2531865:tqdm_logging.py:145)
21:22:01.432 [I] Progress on: 14.6kit/100kit rate:2.1it/s remaining:11:08:54 elapsed:1:56:13 postfix:- (2531865:tqdm_logging.py:145)
Step 14600: grad_norm=0.1108, loss=0.0032, param_norm=1380.6302
21:22:11.817 [I] Progress on: 14.6kit/100kit rate:2.1it/s remaining:11:09:06 elapsed:1:56:23 postfix:- (2531865:tqdm_logging.py:145)
21:22:22.155 [I] Progress on: 14.6kit/100kit rate:2.1it/s remaining:11:08:35 elapsed:1:56:34 postfix:- (2531865:tqdm_logging.py:145)
21:22:32.490 [I] Progress on: 14.7kit/100kit rate:2.1it/s remaining:11:08:07 elapsed:1:56:44 postfix:- (2531865:tqdm_logging.py:145)
21:22:42.828 [I] Progress on: 14.7kit/100kit rate:2.1it/s remaining:11:08:30 elapsed:1:56:54 postfix:- (2531865:tqdm_logging.py:145)
Step 14700: grad_norm=0.1135, loss=0.0032, param_norm=1380.6334
21:22:53.212 [I] Progress on: 14.7kit/100kit rate:2.1it/s remaining:11:06:27 elapsed:1:57:05 postfix:- (2531865:tqdm_logging.py:145)
21:23:03.550 [I] Progress on: 14.7kit/100kit rate:2.1it/s remaining:11:08:32 elapsed:1:57:15 postfix:- (2531865:tqdm_logging.py:145)
21:23:13.667 [I] Progress on: 14.7kit/100kit rate:2.1it/s remaining:11:19:13 elapsed:1:57:25 postfix:- (2531865:tqdm_logging.py:145)
21:23:24.003 [I] Progress on: 14.8kit/100kit rate:2.1it/s remaining:11:17:56 elapsed:1:57:36 postfix:- (2531865:tqdm_logging.py:145)
21:23:34.343 [I] Progress on: 14.8kit/100kit rate:2.1it/s remaining:11:18:19 elapsed:1:57:46 postfix:- (2531865:tqdm_logging.py:145)
Step 14800: grad_norm=0.1112, loss=0.0032, param_norm=1380.6364
21:23:44.753 [I] Progress on: 14.8kit/100kit rate:2.1it/s remaining:11:17:49 elapsed:1:57:56 postfix:- (2531865:tqdm_logging.py:145)
21:23:55.099 [I] Progress on: 14.8kit/100kit rate:2.1it/s remaining:11:21:05 elapsed:1:58:07 postfix:- (2531865:tqdm_logging.py:145)
21:24:05.428 [I] Progress on: 14.9kit/100kit rate:2.1it/s remaining:11:17:55 elapsed:1:58:17 postfix:- (2531865:tqdm_logging.py:145)
21:24:15.766 [I] Progress on: 14.9kit/100kit rate:2.1it/s remaining:11:18:31 elapsed:1:58:27 postfix:- (2531865:tqdm_logging.py:145)
Step 14900: grad_norm=0.1602, loss=0.0038, param_norm=1380.6394
21:24:26.173 [I] Progress on: 14.9kit/100kit rate:2.1it/s remaining:11:20:14 elapsed:1:58:38 postfix:- (2531865:tqdm_logging.py:145)
21:24:36.512 [I] Progress on: 14.9kit/100kit rate:2.1it/s remaining:11:17:59 elapsed:1:58:48 postfix:- (2531865:tqdm_logging.py:145)
21:24:46.843 [I] Progress on: 14.9kit/100kit rate:2.1it/s remaining:11:15:59 elapsed:1:58:58 postfix:- (2531865:tqdm_logging.py:145)
21:24:57.182 [I] Progress on: 15.0kit/100kit rate:2.1it/s remaining:11:16:57 elapsed:1:59:09 postfix:- (2531865:tqdm_logging.py:145)
21:25:07.517 [I] Progress on: 15.0kit/100kit rate:2.1it/s remaining:11:16:33 elapsed:1:59:19 postfix:- (2531865:tqdm_logging.py:145)
Step 15000: grad_norm=0.1117, loss=0.0034, param_norm=1380.6425
21:25:12.423 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
21:25:12.423 [I] [process=0] Saving checkpoint at step 15000                                      (2531865:checkpoint_manager.py:1408)
21:25:12.424 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000. (2531865:async_checkpointer.py:439)
21:25:12.435 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56 (2531865:atomicity.py:144)
21:25:12.442 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/assets.orbax-checkpoint-tmp-57 (2531865:atomicity.py:144)
21:25:12.442 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/params.orbax-checkpoint-tmp-58 (2531865:atomicity.py:144)
21:25:12.442 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/train_state.orbax-checkpoint-tmp-59 (2531865:atomicity.py:144)
21:25:12.460 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:25:12.904 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:25:12.926 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/params.orbax-checkpoint-tmp-58/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:25:14.497 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.4 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:25:14.513 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 5.0 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:25:14.517 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
21:25:14.517 [I] Finished blocking save in 2.09 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000. (2531865:async_checkpointer.py:548)
21:25:14.518 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:25:14.518 [I] Preserving Checkpoint[step=10000 | time=2025-11-02 12:45:26.660204+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:25:14.518 [I] Deleting Checkpoint[step=14000 | time=2025-11-02 13:17:20.983782+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
21:25:14.518 [I] [process=0][thread=MainThread][step=15000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
21:25:14.519 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
21:25:14.519 [I] {'step': 15000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762089912.4234157, 'wait_for_prev_duration_secs': 0.0002512931823730469, 'checkpointer_blocking_start_time': 1762089912.4239974, 'checkpointer_blocking_duration_secs': 2.0942227840423584, 'get_old_steps_start_time': 1762089914.51824, 'get_old_steps_duration_secs': 0.0005731582641601562, 'checkpoint_manager_blocking_start_time': 1762089912.423283, 'checkpoint_manager_blocking_duration_secs': 2.0962748527526855} (2531865:standard_logger.py:34)
21:25:14.577 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/train_state.orbax-checkpoint-tmp-59/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:25:17.657 [I] Progress on: 15.0kit/100kit rate:1.7it/s remaining:13:37:48 elapsed:1:59:29 postfix:- (2531865:tqdm_logging.py:145)
21:25:27.091 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 488.6 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:25:27.998 [I] Progress on: 15.0kit/100kit rate:2.1it/s remaining:11:15:13 elapsed:1:59:40 postfix:- (2531865:tqdm_logging.py:145)
21:25:30.512 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 593.8 MiB/s (total bytes: 10.5 GiB) (time elapsed: 18 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:25:30.513 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
21:25:30.514 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/assets.orbax-checkpoint-tmp-57 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/assets (2531865:atomicity.py:289)
21:25:30.519 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:25:30.647 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/train_state.orbax-checkpoint-tmp-59 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/train_state (2531865:atomicity.py:289)
21:25:30.651 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:25:30.754 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/params.orbax-checkpoint-tmp-58 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56/params (2531865:atomicity.py:289)
21:25:30.756 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000.orbax-checkpoint-tmp-56 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000 (2531865:atomicity.py:289)
21:25:30.760 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000`. (2531865:atomicity.py:573)
21:25:30.760 [I] Finished asynchronous save (blocking + background) in 18.34 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/15000 (2531865:async_checkpointer.py:412)
21:25:30.760 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
21:25:30.760 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
21:25:30.760 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
21:25:31.345 [I] Deleted step 14000.                                                              (2531865:deleter.py:114)
21:25:31.345 [I] [process=0][thread=save_finalize][step=15000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
21:25:31.345 [I] [process=0][thread=save_finalize][step=15000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
21:25:38.351 [I] Progress on: 15.1kit/100kit rate:2.1it/s remaining:11:18:01 elapsed:1:59:50 postfix:- (2531865:tqdm_logging.py:145)
21:25:48.684 [I] Progress on: 15.1kit/100kit rate:2.1it/s remaining:11:16:34 elapsed:2:00:00 postfix:- (2531865:tqdm_logging.py:145)
21:25:59.033 [I] Progress on: 15.1kit/100kit rate:2.1it/s remaining:11:20:29 elapsed:2:00:11 postfix:- (2531865:tqdm_logging.py:145)
Step 15100: grad_norm=0.1125, loss=0.0034, param_norm=1380.6451
21:26:09.432 [I] Progress on: 15.1kit/100kit rate:2.1it/s remaining:11:16:22 elapsed:2:00:21 postfix:- (2531865:tqdm_logging.py:145)
21:26:19.769 [I] Progress on: 15.1kit/100kit rate:2.1it/s remaining:11:15:46 elapsed:2:00:31 postfix:- (2531865:tqdm_logging.py:145)
21:26:29.870 [I] Progress on: 15.2kit/100kit rate:2.0it/s remaining:11:33:33 elapsed:2:00:41 postfix:- (2531865:tqdm_logging.py:145)
21:26:40.205 [I] Progress on: 15.2kit/100kit rate:2.1it/s remaining:11:15:12 elapsed:2:00:52 postfix:- (2531865:tqdm_logging.py:145)
Step 15200: grad_norm=0.1129, loss=0.0031, param_norm=1380.6481
21:26:50.544 [I] Progress on: 15.2kit/100kit rate:2.1it/s remaining:10:58:27 elapsed:2:01:02 postfix:- (2531865:tqdm_logging.py:145)
21:27:00.882 [I] Progress on: 15.2kit/100kit rate:2.1it/s remaining:11:03:39 elapsed:2:01:12 postfix:- (2531865:tqdm_logging.py:145)
21:27:11.219 [I] Progress on: 15.2kit/100kit rate:2.1it/s remaining:11:03:59 elapsed:2:01:23 postfix:- (2531865:tqdm_logging.py:145)
21:27:21.557 [I] Progress on: 15.3kit/100kit rate:2.1it/s remaining:11:03:51 elapsed:2:01:33 postfix:- (2531865:tqdm_logging.py:145)
21:27:31.893 [I] Progress on: 15.3kit/100kit rate:2.1it/s remaining:11:03:15 elapsed:2:01:43 postfix:- (2531865:tqdm_logging.py:145)
Step 15300: grad_norm=0.1104, loss=0.0032, param_norm=1380.6509
21:27:42.275 [I] Progress on: 15.3kit/100kit rate:2.1it/s remaining:11:03:08 elapsed:2:01:54 postfix:- (2531865:tqdm_logging.py:145)
21:27:52.359 [I] Progress on: 15.3kit/100kit rate:2.1it/s remaining:11:08:00 elapsed:2:02:04 postfix:- (2531865:tqdm_logging.py:145)
21:28:02.694 [I] Progress on: 15.4kit/100kit rate:2.1it/s remaining:11:02:14 elapsed:2:02:14 postfix:- (2531865:tqdm_logging.py:145)
21:28:13.032 [I] Progress on: 15.4kit/100kit rate:2.1it/s remaining:11:03:09 elapsed:2:02:25 postfix:- (2531865:tqdm_logging.py:145)
Step 15400: grad_norm=0.1445, loss=0.0034, param_norm=1380.6537
21:28:23.541 [I] Progress on: 15.4kit/100kit rate:2.1it/s remaining:11:02:17 elapsed:2:02:35 postfix:- (2531865:tqdm_logging.py:145)
21:28:33.753 [I] Progress on: 15.4kit/100kit rate:2.1it/s remaining:11:02:21 elapsed:2:02:45 postfix:- (2531865:tqdm_logging.py:145)
21:28:44.091 [I] Progress on: 15.4kit/100kit rate:2.1it/s remaining:11:01:49 elapsed:2:02:56 postfix:- (2531865:tqdm_logging.py:145)
21:28:54.433 [I] Progress on: 15.5kit/100kit rate:2.1it/s remaining:11:02:55 elapsed:2:03:06 postfix:- (2531865:tqdm_logging.py:145)
21:29:04.769 [I] Progress on: 15.5kit/100kit rate:2.1it/s remaining:11:01:33 elapsed:2:03:16 postfix:- (2531865:tqdm_logging.py:145)
Step 15500: grad_norm=0.1055, loss=0.0028, param_norm=1380.6565
21:29:15.156 [I] Progress on: 15.5kit/100kit rate:2.1it/s remaining:11:01:00 elapsed:2:03:27 postfix:- (2531865:tqdm_logging.py:145)
21:29:25.495 [I] Progress on: 15.5kit/100kit rate:2.1it/s remaining:11:01:32 elapsed:2:03:37 postfix:- (2531865:tqdm_logging.py:145)
21:29:35.831 [I] Progress on: 15.6kit/100kit rate:2.1it/s remaining:11:01:17 elapsed:2:03:47 postfix:- (2531865:tqdm_logging.py:145)
21:29:46.556 [I] Progress on: 15.6kit/100kit rate:1.7it/s remaining:13:44:57 elapsed:2:03:58 postfix:- (2531865:tqdm_logging.py:145)
21:29:56.720 [I] Progress on: 15.6kit/100kit rate:2.1it/s remaining:11:01:03 elapsed:2:04:08 postfix:- (2531865:tqdm_logging.py:145)
Step 15600: grad_norm=0.1144, loss=0.0033, param_norm=1380.6593
21:30:07.107 [I] Progress on: 15.6kit/100kit rate:2.1it/s remaining:11:00:25 elapsed:2:04:19 postfix:- (2531865:tqdm_logging.py:145)
21:30:17.442 [I] Progress on: 15.6kit/100kit rate:2.1it/s remaining:11:00:08 elapsed:2:04:29 postfix:- (2531865:tqdm_logging.py:145)
21:30:27.782 [I] Progress on: 15.7kit/100kit rate:2.1it/s remaining:11:00:36 elapsed:2:04:39 postfix:- (2531865:tqdm_logging.py:145)
21:30:38.122 [I] Progress on: 15.7kit/100kit rate:2.1it/s remaining:11:01:22 elapsed:2:04:50 postfix:- (2531865:tqdm_logging.py:145)
Step 15700: grad_norm=0.1376, loss=0.0034, param_norm=1380.6619
21:30:48.504 [I] Progress on: 15.7kit/100kit rate:2.1it/s remaining:10:59:37 elapsed:2:05:00 postfix:- (2531865:tqdm_logging.py:145)
21:30:58.841 [I] Progress on: 15.7kit/100kit rate:2.1it/s remaining:10:59:43 elapsed:2:05:10 postfix:- (2531865:tqdm_logging.py:145)
21:31:09.178 [I] Progress on: 15.8kit/100kit rate:2.1it/s remaining:10:59:29 elapsed:2:05:21 postfix:- (2531865:tqdm_logging.py:145)
21:31:19.516 [I] Progress on: 15.8kit/100kit rate:2.1it/s remaining:10:59:54 elapsed:2:05:31 postfix:- (2531865:tqdm_logging.py:145)
21:31:29.851 [I] Progress on: 15.8kit/100kit rate:2.1it/s remaining:10:59:27 elapsed:2:05:41 postfix:- (2531865:tqdm_logging.py:145)
Step 15800: grad_norm=0.1169, loss=0.0033, param_norm=1380.6643
21:31:40.239 [I] Progress on: 15.8kit/100kit rate:2.1it/s remaining:10:59:14 elapsed:2:05:52 postfix:- (2531865:tqdm_logging.py:145)
21:31:50.576 [I] Progress on: 15.8kit/100kit rate:2.1it/s remaining:10:58:43 elapsed:2:06:02 postfix:- (2531865:tqdm_logging.py:145)
21:32:00.914 [I] Progress on: 15.9kit/100kit rate:2.1it/s remaining:10:58:55 elapsed:2:06:12 postfix:- (2531865:tqdm_logging.py:145)
21:32:11.251 [I] Progress on: 15.9kit/100kit rate:2.1it/s remaining:10:58:41 elapsed:2:06:23 postfix:- (2531865:tqdm_logging.py:145)
Step 15900: grad_norm=0.0995, loss=0.0028, param_norm=1380.6671
21:32:21.633 [I] Progress on: 15.9kit/100kit rate:2.1it/s remaining:10:57:29 elapsed:2:06:33 postfix:- (2531865:tqdm_logging.py:145)
21:32:31.969 [I] Progress on: 15.9kit/100kit rate:2.1it/s remaining:10:58:18 elapsed:2:06:43 postfix:- (2531865:tqdm_logging.py:145)
21:32:42.305 [I] Progress on: 16.0kit/100kit rate:2.1it/s remaining:10:57:42 elapsed:2:06:54 postfix:- (2531865:tqdm_logging.py:145)
21:32:52.645 [I] Progress on: 16.0kit/100kit rate:2.1it/s remaining:10:58:09 elapsed:2:07:04 postfix:- (2531865:tqdm_logging.py:145)
21:33:02.981 [I] Progress on: 16.0kit/100kit rate:2.1it/s remaining:10:57:02 elapsed:2:07:15 postfix:- (2531865:tqdm_logging.py:145)
Step 16000: grad_norm=0.0985, loss=0.0029, param_norm=1380.6697
21:33:06.232 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
21:33:06.232 [I] [process=0] Saving checkpoint at step 16000                                      (2531865:checkpoint_manager.py:1408)
21:33:06.233 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000. (2531865:async_checkpointer.py:439)
21:33:06.246 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60 (2531865:atomicity.py:144)
21:33:06.251 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/train_state.orbax-checkpoint-tmp-63 (2531865:atomicity.py:144)
21:33:06.251 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/params.orbax-checkpoint-tmp-62 (2531865:atomicity.py:144)
21:33:06.252 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/assets.orbax-checkpoint-tmp-61 (2531865:atomicity.py:144)
21:33:06.286 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:33:06.722 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:33:06.747 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/params.orbax-checkpoint-tmp-62/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:33:08.328 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.3 GiB/s (total bytes: 7.0 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:33:08.343 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 5.0 GiB/s (total bytes: 10.5 GiB) (time elapsed: 2 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:33:08.349 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
21:33:08.350 [I] Finished blocking save in 2.12 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000. (2531865:async_checkpointer.py:548)
21:33:08.351 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:33:08.351 [I] Preserving Checkpoint[step=10000 | time=2025-11-02 12:45:26.660204+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:33:08.351 [I] Preserving Checkpoint[step=15000 | time=2025-11-02 13:25:14.518227+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:33:08.351 [I] [process=0][thread=MainThread][step=16000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
21:33:08.352 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
21:33:08.352 [I] {'step': 16000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762090386.2322273, 'wait_for_prev_duration_secs': 0.0002186298370361328, 'checkpointer_blocking_start_time': 1762090386.2327433, 'checkpointer_blocking_duration_secs': 2.1184985637664795, 'get_old_steps_start_time': 1762090388.3512592, 'get_old_steps_duration_secs': 0.00041413307189941406, 'checkpoint_manager_blocking_start_time': 1762090386.2321, 'checkpoint_manager_blocking_duration_secs': 2.1201114654541016} (2531865:standard_logger.py:34)
21:33:08.422 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/train_state.orbax-checkpoint-tmp-63/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:33:13.008 [I] Progress on: 16.0kit/100kit rate:2.0it/s remaining:11:33:52 elapsed:2:07:25 postfix:- (2531865:tqdm_logging.py:145)
21:33:20.533 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 501.2 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:33:22.833 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 647.1 MiB/s (total bytes: 10.5 GiB) (time elapsed: 16 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:33:22.833 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
21:33:22.834 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/assets.orbax-checkpoint-tmp-61 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/assets (2531865:atomicity.py:289)
21:33:22.839 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:33:22.862 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/train_state.orbax-checkpoint-tmp-63 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/train_state (2531865:atomicity.py:289)
21:33:22.867 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:33:22.886 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/params.orbax-checkpoint-tmp-62 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60/params (2531865:atomicity.py:289)
21:33:22.888 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000.orbax-checkpoint-tmp-60 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000 (2531865:atomicity.py:289)
21:33:22.892 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000`. (2531865:atomicity.py:573)
21:33:22.892 [I] Finished asynchronous save (blocking + background) in 16.66 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/16000 (2531865:async_checkpointer.py:412)
21:33:22.892 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
21:33:22.892 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
21:33:22.893 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
21:33:22.893 [I] [process=0][thread=save_finalize][step=16000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
21:33:22.893 [I] [process=0][thread=save_finalize][step=16000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
21:33:23.113 [I] Progress on: 16.0kit/100kit rate:2.1it/s remaining:10:59:33 elapsed:2:07:35 postfix:- (2531865:tqdm_logging.py:145)
21:33:33.446 [I] Progress on: 16.1kit/100kit rate:2.1it/s remaining:10:57:32 elapsed:2:07:45 postfix:- (2531865:tqdm_logging.py:145)
21:33:43.783 [I] Progress on: 16.1kit/100kit rate:2.1it/s remaining:10:56:36 elapsed:2:07:55 postfix:- (2531865:tqdm_logging.py:145)
21:33:54.121 [I] Progress on: 16.1kit/100kit rate:2.1it/s remaining:10:56:39 elapsed:2:08:06 postfix:- (2531865:tqdm_logging.py:145)
Step 16100: grad_norm=0.1050, loss=0.0029, param_norm=1380.6720
21:34:04.509 [I] Progress on: 16.1kit/100kit rate:2.1it/s remaining:10:56:15 elapsed:2:08:16 postfix:- (2531865:tqdm_logging.py:145)
21:34:14.850 [I] Progress on: 16.1kit/100kit rate:2.1it/s remaining:10:57:47 elapsed:2:08:26 postfix:- (2531865:tqdm_logging.py:145)
21:34:25.186 [I] Progress on: 16.2kit/100kit rate:2.1it/s remaining:10:56:37 elapsed:2:08:37 postfix:- (2531865:tqdm_logging.py:145)
21:34:35.525 [I] Progress on: 16.2kit/100kit rate:2.1it/s remaining:10:56:10 elapsed:2:08:47 postfix:- (2531865:tqdm_logging.py:145)
Step 16200: grad_norm=0.1062, loss=0.0030, param_norm=1380.6747
21:34:45.906 [I] Progress on: 16.2kit/100kit rate:2.1it/s remaining:10:55:04 elapsed:2:08:57 postfix:- (2531865:tqdm_logging.py:145)
21:34:56.245 [I] Progress on: 16.2kit/100kit rate:2.1it/s remaining:10:55:42 elapsed:2:09:08 postfix:- (2531865:tqdm_logging.py:145)
21:35:06.583 [I] Progress on: 16.3kit/100kit rate:2.1it/s remaining:10:55:28 elapsed:2:09:18 postfix:- (2531865:tqdm_logging.py:145)
21:35:16.922 [I] Progress on: 16.3kit/100kit rate:2.1it/s remaining:10:55:47 elapsed:2:09:28 postfix:- (2531865:tqdm_logging.py:145)
21:35:27.263 [I] Progress on: 16.3kit/100kit rate:2.1it/s remaining:10:55:15 elapsed:2:09:39 postfix:- (2531865:tqdm_logging.py:145)
Step 16300: grad_norm=0.1013, loss=0.0028, param_norm=1380.6765
21:35:37.652 [I] Progress on: 16.3kit/100kit rate:2.1it/s remaining:10:55:15 elapsed:2:09:49 postfix:- (2531865:tqdm_logging.py:145)
21:35:47.987 [I] Progress on: 16.3kit/100kit rate:2.1it/s remaining:10:54:54 elapsed:2:10:00 postfix:- (2531865:tqdm_logging.py:145)
21:35:58.040 [I] Progress on: 16.4kit/100kit rate:2.1it/s remaining:10:58:53 elapsed:2:10:10 postfix:- (2531865:tqdm_logging.py:145)
21:36:08.380 [I] Progress on: 16.4kit/100kit rate:2.1it/s remaining:10:55:23 elapsed:2:10:20 postfix:- (2531865:tqdm_logging.py:145)
Step 16400: grad_norm=0.1050, loss=0.0030, param_norm=1380.6791
21:36:18.767 [I] Progress on: 16.4kit/100kit rate:2.1it/s remaining:10:52:47 elapsed:2:10:30 postfix:- (2531865:tqdm_logging.py:145)
21:36:28.863 [I] Progress on: 16.4kit/100kit rate:2.1it/s remaining:11:03:23 elapsed:2:10:40 postfix:- (2531865:tqdm_logging.py:145)
21:36:39.202 [I] Progress on: 16.4kit/100kit rate:2.1it/s remaining:10:54:16 elapsed:2:10:51 postfix:- (2531865:tqdm_logging.py:145)
21:36:49.538 [I] Progress on: 16.5kit/100kit rate:2.1it/s remaining:10:53:48 elapsed:2:11:01 postfix:- (2531865:tqdm_logging.py:145)
21:36:59.875 [I] Progress on: 16.5kit/100kit rate:2.1it/s remaining:10:53:57 elapsed:2:11:11 postfix:- (2531865:tqdm_logging.py:145)
Step 16500: grad_norm=0.0969, loss=0.0029, param_norm=1380.6815
21:37:10.261 [I] Progress on: 16.5kit/100kit rate:2.1it/s remaining:10:54:37 elapsed:2:11:22 postfix:- (2531865:tqdm_logging.py:145)
21:37:20.596 [I] Progress on: 16.5kit/100kit rate:2.1it/s remaining:10:53:43 elapsed:2:11:32 postfix:- (2531865:tqdm_logging.py:145)
21:37:30.933 [I] Progress on: 16.6kit/100kit rate:2.1it/s remaining:10:53:54 elapsed:2:11:42 postfix:- (2531865:tqdm_logging.py:145)
21:37:41.272 [I] Progress on: 16.6kit/100kit rate:2.1it/s remaining:10:53:33 elapsed:2:11:53 postfix:- (2531865:tqdm_logging.py:145)
Step 16600: grad_norm=0.1071, loss=0.0030, param_norm=1380.6837
21:37:51.779 [I] Progress on: 16.6kit/100kit rate:2.1it/s remaining:10:53:42 elapsed:2:12:03 postfix:- (2531865:tqdm_logging.py:145)
21:38:01.997 [I] Progress on: 16.6kit/100kit rate:2.1it/s remaining:10:52:35 elapsed:2:12:14 postfix:- (2531865:tqdm_logging.py:145)
21:38:12.335 [I] Progress on: 16.6kit/100kit rate:2.1it/s remaining:10:53:02 elapsed:2:12:24 postfix:- (2531865:tqdm_logging.py:145)
21:38:22.672 [I] Progress on: 16.7kit/100kit rate:2.1it/s remaining:10:52:54 elapsed:2:12:34 postfix:- (2531865:tqdm_logging.py:145)
21:38:33.009 [I] Progress on: 16.7kit/100kit rate:2.1it/s remaining:10:52:33 elapsed:2:12:45 postfix:- (2531865:tqdm_logging.py:145)
Step 16700: grad_norm=0.0997, loss=0.0027, param_norm=1380.6859
21:38:43.397 [I] Progress on: 16.7kit/100kit rate:2.1it/s remaining:10:52:54 elapsed:2:12:55 postfix:- (2531865:tqdm_logging.py:145)
21:38:53.733 [I] Progress on: 16.7kit/100kit rate:2.1it/s remaining:10:51:55 elapsed:2:13:05 postfix:- (2531865:tqdm_logging.py:145)
21:39:04.071 [I] Progress on: 16.8kit/100kit rate:2.1it/s remaining:10:51:44 elapsed:2:13:16 postfix:- (2531865:tqdm_logging.py:145)
21:39:14.408 [I] Progress on: 16.8kit/100kit rate:2.1it/s remaining:10:51:52 elapsed:2:13:26 postfix:- (2531865:tqdm_logging.py:145)
21:39:24.747 [I] Progress on: 16.8kit/100kit rate:2.1it/s remaining:10:52:11 elapsed:2:13:36 postfix:- (2531865:tqdm_logging.py:145)
Step 16800: grad_norm=0.0993, loss=0.0029, param_norm=1380.6881
21:39:35.129 [I] Progress on: 16.8kit/100kit rate:2.1it/s remaining:10:51:44 elapsed:2:13:47 postfix:- (2531865:tqdm_logging.py:145)
21:39:45.199 [I] Progress on: 16.8kit/100kit rate:2.0it/s remaining:11:19:24 elapsed:2:13:57 postfix:- (2531865:tqdm_logging.py:145)
21:39:55.533 [I] Progress on: 16.9kit/100kit rate:2.1it/s remaining:10:50:22 elapsed:2:14:07 postfix:- (2531865:tqdm_logging.py:145)
21:40:05.870 [I] Progress on: 16.9kit/100kit rate:2.1it/s remaining:10:51:27 elapsed:2:14:17 postfix:- (2531865:tqdm_logging.py:145)
Step 16900: grad_norm=0.1085, loss=0.0032, param_norm=1380.6903
21:40:16.323 [I] Progress on: 16.9kit/100kit rate:2.1it/s remaining:10:49:49 elapsed:2:14:28 postfix:- (2531865:tqdm_logging.py:145)
21:40:26.658 [I] Progress on: 16.9kit/100kit rate:2.1it/s remaining:10:50:04 elapsed:2:14:38 postfix:- (2531865:tqdm_logging.py:145)
21:40:36.996 [I] Progress on: 17.0kit/100kit rate:2.1it/s remaining:10:50:09 elapsed:2:14:49 postfix:- (2531865:tqdm_logging.py:145)
21:40:47.333 [I] Progress on: 17.0kit/100kit rate:2.1it/s remaining:10:49:43 elapsed:2:14:59 postfix:- (2531865:tqdm_logging.py:145)
21:40:57.670 [I] Progress on: 17.0kit/100kit rate:2.1it/s remaining:10:49:55 elapsed:2:15:09 postfix:- (2531865:tqdm_logging.py:145)
Step 17000: grad_norm=0.1012, loss=0.0028, param_norm=1380.6925
21:41:00.227 [I] [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning. (2531865:checkpoint_manager.py:1987)
21:41:00.227 [I] [process=0] Saving checkpoint at step 17000                                      (2531865:checkpoint_manager.py:1408)
21:41:00.227 [I] [process=0] Started async saving checkpoint to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000. (2531865:async_checkpointer.py:439)
21:41:00.238 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64 (2531865:atomicity.py:144)
21:41:00.245 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/train_state.orbax-checkpoint-tmp-67 (2531865:atomicity.py:144)
21:41:00.246 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/assets.orbax-checkpoint-tmp-65 (2531865:atomicity.py:144)
21:41:00.246 [I] Creating tmp directory /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/params.orbax-checkpoint-tmp-66 (2531865:atomicity.py:144)
21:41:00.262 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:41:01.096 [I] Transferring arrays to host memory with options: use_replica_parallel=True, enable_pinned_host_transfer=False (2531865:replica_slices.py:341)
21:41:01.121 [I] [process=0][thread=array_type_handler] Wrote 70 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/params.orbax-checkpoint-tmp-66/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:41:03.328 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 2.3 GiB/s (total bytes: 7.0 GiB) (time elapsed: 3 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:41:03.333 [I] [process=0] /jax/checkpoint/write/blocking_bytes_per_sec: 3.4 GiB/s (total bytes: 10.5 GiB) (time elapsed: 3 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:41:03.349 [I] [process=0][thread=async_save] Background save thread started.                   (2531865:async_checkpointer.py:77)
21:41:03.350 [I] Finished blocking save in 3.12 seconds. Continuing to save asynchronously to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000. (2531865:async_checkpointer.py:548)
21:41:03.351 [I] Preserving Checkpoint[step=5000 | time=2025-11-02 12:05:40.944684+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:41:03.351 [I] Preserving Checkpoint[step=10000 | time=2025-11-02 12:45:26.660204+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:41:03.351 [I] Preserving Checkpoint[step=15000 | time=2025-11-02 13:25:14.518227+00:00]: (Reason: on keep_period=5000). (2531865:checkpoint_manager.py:1949)
21:41:03.351 [I] Deleting Checkpoint[step=16000 | time=2025-11-02 13:33:08.351247+00:00]: (Reason: old checkpoint). (2531865:checkpoint_manager.py:1963)
21:41:03.352 [I] [process=0][thread=MainThread][step=17000] Starting CheckpointManager Save Finalize thread=save_finalize (2531865:checkpoint_manager.py:1453)
21:41:03.352 [I] [process=0][thread=save_finalize] Waiting for background save thread=async_save. (2531865:async_checkpointer.py:258)
21:41:03.353 [I] {'step': 17000, 'event_type': 'save', 'directory': '/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': False, 'wait_for_prev_start_time': 1762090860.2270966, 'wait_for_prev_duration_secs': 0.0002148151397705078, 'checkpointer_blocking_start_time': 1762090860.2276042, 'checkpointer_blocking_duration_secs': 3.123600959777832, 'get_old_steps_start_time': 1762090863.3512244, 'get_old_steps_duration_secs': 0.0009829998016357422, 'checkpoint_manager_blocking_start_time': 1762090860.2269647, 'checkpoint_manager_blocking_duration_secs': 3.126138687133789} (2531865:standard_logger.py:34)
21:41:03.399 [I] [process=0][thread=array_type_handler] Wrote 179 array_metadata.ArrayMetadata to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/train_state.orbax-checkpoint-tmp-67/array_metadatas/process_0 (2531865:array_metadata_store.py:198)
21:41:10.276 [I] Progress on: 17.0kit/100kit rate:1.7s/it remaining:39:31:20 elapsed:2:15:22 postfix:- (2531865:tqdm_logging.py:145)
21:41:14.985 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 485.5 MiB/s (total bytes: 7.0 GiB) (time elapsed: 14 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:41:16.140 [I] [process=0] /jax/checkpoint/write/bytes_per_sec: 675.0 MiB/s (total bytes: 10.5 GiB) (time elapsed: 15 seconds) (per-host) (2531865:base_pytree_checkpoint_handler.py:114)
21:41:16.140 [I] [process=0][thread=async_save] 5 Handler Commit operations completed.            (2531865:async_checkpointer.py:87)
21:41:16.141 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/assets.orbax-checkpoint-tmp-65 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/assets (2531865:atomicity.py:289)
21:41:16.146 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:41:16.171 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/train_state.orbax-checkpoint-tmp-67 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/train_state (2531865:atomicity.py:289)
21:41:16.176 [I] [process=0][thread=async_save] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0. (2531865:array_metadata_store.py:362)
21:41:16.243 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/params.orbax-checkpoint-tmp-66 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64/params (2531865:atomicity.py:289)
21:41:16.244 [I] Renaming /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000.orbax-checkpoint-tmp-64 to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000 (2531865:atomicity.py:289)
21:41:16.249 [I] [process=0][thread=async_save] Finished saving checkpoint (finalized tmp dir) to `/project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000`. (2531865:atomicity.py:573)
21:41:16.249 [I] Finished asynchronous save (blocking + background) in 16.02 seconds to /project/peilab/yanzhengyang/RoboTwin/policy/yzy_openpi/checkpoints/pi0_base_piper/real/17000 (2531865:async_checkpointer.py:412)
21:41:16.249 [I] [process=0][thread=async_save] Background save thread done.                      (2531865:async_checkpointer.py:143)
21:41:16.249 [I] [process=0][thread=save_finalize] Done with waiting for background save thread=async_save. (2531865:async_checkpointer.py:266)
21:41:16.249 [I] [process=0][thread=save_finalize] No errors found in background save thread=async_save. (2531865:async_checkpointer.py:276)
21:41:16.799 [I] Deleted step 16000.                                                              (2531865:deleter.py:114)
21:41:16.799 [I] [process=0][thread=save_finalize][step=17000] CheckpointManager Save Finalize is syncing with other hosts... (2531865:checkpoint_manager.py:2095)
21:41:16.800 [I] [process=0][thread=save_finalize][step=17000] CheckpointManager Save Finalize is done on all hosts. (2531865:checkpoint_manager.py:2110)
21:41:20.456 [I] Progress on: 17.0kit/100kit rate:2.1it/s remaining:10:50:24 elapsed:2:15:32 postfix:- (2531865:tqdm_logging.py:145)
21:41:30.793 [I] Progress on: 17.1kit/100kit rate:2.1it/s remaining:10:49:52 elapsed:2:15:42 postfix:- (2531865:tqdm_logging.py:145)
21:41:41.131 [I] Progress on: 17.1kit/100kit rate:2.1it/s remaining:10:49:31 elapsed:2:15:53 postfix:- (2531865:tqdm_logging.py:145)
21:41:51.468 [I] Progress on: 17.1kit/100kit rate:2.1it/s remaining:10:49:15 elapsed:2:16:03 postfix:- (2531865:tqdm_logging.py:145)
Step 17100: grad_norm=0.1069, loss=0.0030, param_norm=1380.6947
21:42:01.853 [I] Progress on: 17.1kit/100kit rate:2.1it/s remaining:10:49:07 elapsed:2:16:13 postfix:- (2531865:tqdm_logging.py:145)
21:42:12.187 [I] Progress on: 17.1kit/100kit rate:2.1it/s remaining:10:48:52 elapsed:2:16:24 postfix:- (2531865:tqdm_logging.py:145)
21:42:22.524 [I] Progress on: 17.2kit/100kit rate:2.1it/s remaining:10:48:41 elapsed:2:16:34 postfix:- (2531865:tqdm_logging.py:145)
21:42:32.859 [I] Progress on: 17.2kit/100kit rate:2.1it/s remaining:10:48:15 elapsed:2:16:44 postfix:- (2531865:tqdm_logging.py:145)
Step 17200: grad_norm=0.0980, loss=0.0024, param_norm=1380.6965
21:42:43.247 [I] Progress on: 17.2kit/100kit rate:2.1it/s remaining:10:46:54 elapsed:2:16:55 postfix:- (2531865:tqdm_logging.py:145)
21:42:53.588 [I] Progress on: 17.2kit/100kit rate:2.1it/s remaining:10:49:47 elapsed:2:17:05 postfix:- (2531865:tqdm_logging.py:145)
21:43:03.924 [I] Progress on: 17.2kit/100kit rate:2.1it/s remaining:10:48:28 elapsed:2:17:15 postfix:- (2531865:tqdm_logging.py:145)
21:43:13.995 [I] Progress on: 17.3kit/100kit rate:2.2it/s remaining:10:40:03 elapsed:2:17:26 postfix:- (2531865:tqdm_logging.py:145)
21:43:24.339 [I] Progress on: 17.3kit/100kit rate:2.2it/s remaining:10:37:16 elapsed:2:17:36 postfix:- (2531865:tqdm_logging.py:145)
Step 17300: grad_norm=0.1010, loss=0.0028, param_norm=1380.6986
21:43:34.747 [I] Progress on: 17.3kit/100kit rate:2.2it/s remaining:10:36:37 elapsed:2:17:46 postfix:- (2531865:tqdm_logging.py:145)
21:43:45.084 [I] Progress on: 17.3kit/100kit rate:2.2it/s remaining:10:36:22 elapsed:2:17:57 postfix:- (2531865:tqdm_logging.py:145)
21:43:55.153 [I] Progress on: 17.4kit/100kit rate:2.1it/s remaining:10:54:21 elapsed:2:18:07 postfix:- (2531865:tqdm_logging.py:145)
21:44:05.489 [I] Progress on: 17.4kit/100kit rate:2.1it/s remaining:10:46:30 elapsed:2:18:17 postfix:- (2531865:tqdm_logging.py:145)
Step 17400: grad_norm=0.0978, loss=0.0027, param_norm=1380.7006
21:44:16.000 [I] Progress on: 17.4kit/100kit rate:2.1it/s remaining:10:47:14 elapsed:2:18:28 postfix:- (2531865:tqdm_logging.py:145)
21:44:26.215 [I] Progress on: 17.4kit/100kit rate:2.1it/s remaining:10:46:29 elapsed:2:18:38 postfix:- (2531865:tqdm_logging.py:145)
21:44:36.550 [I] Progress on: 17.4kit/100kit rate:2.1it/s remaining:10:45:34 elapsed:2:18:48 postfix:- (2531865:tqdm_logging.py:145)
21:44:46.890 [I] Progress on: 17.5kit/100kit rate:2.1it/s remaining:10:46:51 elapsed:2:18:58 postfix:- (2531865:tqdm_logging.py:145)
21:44:57.227 [I] Progress on: 17.5kit/100kit rate:2.1it/s remaining:10:45:35 elapsed:2:19:09 postfix:- (2531865:tqdm_logging.py:145)
Step 17500: grad_norm=0.1047, loss=0.0029, param_norm=1380.7021
21:45:07.610 [I] Progress on: 17.5kit/100kit rate:2.1it/s remaining:10:45:26 elapsed:2:19:19 postfix:- (2531865:tqdm_logging.py:145)
21:45:17.949 [I] Progress on: 17.5kit/100kit rate:2.1it/s remaining:10:44:55 elapsed:2:19:29 postfix:- (2531865:tqdm_logging.py:145)
21:45:28.287 [I] Progress on: 17.6kit/100kit rate:2.1it/s remaining:10:45:26 elapsed:2:19:40 postfix:- (2531865:tqdm_logging.py:145)
21:45:38.623 [I] Progress on: 17.6kit/100kit rate:2.1it/s remaining:10:45:10 elapsed:2:19:50 postfix:- (2531865:tqdm_logging.py:145)
21:45:48.962 [I] Progress on: 17.6kit/100kit rate:2.1it/s remaining:10:45:13 elapsed:2:20:00 postfix:- (2531865:tqdm_logging.py:145)
Step 17600: grad_norm=0.1008, loss=0.0028, param_norm=1380.7043
21:45:59.343 [I] Progress on: 17.6kit/100kit rate:2.1it/s remaining:10:44:40 elapsed:2:20:11 postfix:- (2531865:tqdm_logging.py:145)
21:46:09.678 [I] Progress on: 17.6kit/100kit rate:2.1it/s remaining:10:44:44 elapsed:2:20:21 postfix:- (2531865:tqdm_logging.py:145)
21:46:20.018 [I] Progress on: 17.7kit/100kit rate:2.1it/s remaining:10:44:40 elapsed:2:20:32 postfix:- (2531865:tqdm_logging.py:145)
21:46:30.115 [I] Progress on: 17.7kit/100kit rate:2.1it/s remaining:11:07:55 elapsed:2:20:42 postfix:- (2531865:tqdm_logging.py:145)
Step 17700: grad_norm=0.0960, loss=0.0026, param_norm=1380.7062
21:46:40.457 [I] Progress on: 17.7kit/100kit rate:2.1it/s remaining:10:43:38 elapsed:2:20:52 postfix:- (2531865:tqdm_logging.py:145)
21:46:50.795 [I] Progress on: 17.7kit/100kit rate:2.1it/s remaining:10:44:25 elapsed:2:21:02 postfix:- (2531865:tqdm_logging.py:145)
21:47:01.133 [I] Progress on: 17.8kit/100kit rate:2.1it/s remaining:10:44:20 elapsed:2:21:13 postfix:- (2531865:tqdm_logging.py:145)
21:47:11.471 [I] Progress on: 17.8kit/100kit rate:2.1it/s remaining:10:44:06 elapsed:2:21:23 postfix:- (2531865:tqdm_logging.py:145)
21:47:21.808 [I] Progress on: 17.8kit/100kit rate:2.1it/s remaining:10:44:17 elapsed:2:21:33 postfix:- (2531865:tqdm_logging.py:145)
Step 17800: grad_norm=0.0932, loss=0.0026, param_norm=1380.7081
21:47:32.190 [I] Progress on: 17.8kit/100kit rate:2.1it/s remaining:10:44:05 elapsed:2:21:44 postfix:- (2531865:tqdm_logging.py:145)
21:47:42.528 [I] Progress on: 17.8kit/100kit rate:2.1it/s remaining:10:43:11 elapsed:2:21:54 postfix:- (2531865:tqdm_logging.py:145)
21:47:52.864 [I] Progress on: 17.9kit/100kit rate:2.1it/s remaining:10:43:23 elapsed:2:22:04 postfix:- (2531865:tqdm_logging.py:145)
21:48:03.201 [I] Progress on: 17.9kit/100kit rate:2.1it/s remaining:10:43:01 elapsed:2:22:15 postfix:- (2531865:tqdm_logging.py:145)
Step 17900: grad_norm=0.1039, loss=0.0029, param_norm=1380.7100
21:48:13.585 [I] Progress on: 17.9kit/100kit rate:2.1it/s remaining:10:41:42 elapsed:2:22:25 postfix:- (2531865:tqdm_logging.py:145)
21:48:23.922 [I] Progress on: 17.9kit/100kit rate:2.1it/s remaining:10:43:10 elapsed:2:22:35 postfix:- (2531865:tqdm_logging.py:145)
slurmstepd: error: *** JOB 312155 ON dgx-54 CANCELLED AT 2025-11-02T21:48:28 DUE TO PREEMPTION ***
